"use strict";(self.webpackChunkreactjs=self.webpackChunkreactjs||[]).push([[2175],{38094:function(e,t,r){r.d(t,{A:function(){return l}});var n=r(41481),a=r(10270);class o extends n.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){(new a.Ay).errorProbe(e,t)}onClick=e=>{this.setState({hasError:!1}),e.stopPropagation()};render(){const{hasError:e}=this.state,{name:t,children:r}=this.props;return e?n.createElement("div",{className:"tytGhyRryKmh9blZ_97Q"},"Error when rendering the component (",t,")",n.createElement("button",{type:"button",onClick:this.onClick},"Try again")):r}}var l=o},94919:function(e,t,r){r.d(t,{F:function(){return a},Z:function(){return o}});var n=r(45659);const[a,o]=(0,n.A)("PageRendererContext")},19645:function(e,t,r){r.d(t,{EC:function(){return _},Ay:function(){return F},v5:function(){return C}});var n=r(41481),a=r(94919),o=r(60546),l=r(96136),i=r(23706),s=r(22392),c=function(e,t){const r=(0,l.m)(),{i18n:a}=(0,n.useContext)(i.gJ),{dataset:c}=r.useCatalogDataset2(e,a.shortLanguageCode),{records:u,isLoading:d}=r.useDatasetRecords(e,{select:(0,o.p_)(`min(${t}) as min_date`,`max(${t}) as max_date`),limit:1}),m=(0,n.useMemo)((()=>{if(d||!u||!u.length)return null;const{min_date:e,max_date:t}=u[0];return{earliest:e,latest:t}}),[u,d]);return{precision:(0,n.useMemo)((()=>{if(!c||!t)return;const e=(0,s.gz)(c,t);return e&&(0,s.le)(e)||void 0}),[c,t]),...m}},u=r(97006),d=r(26589),m=r(96812),p=r(19266),f=r(88151),y={[p.Xl.DayToday]:()=>({from:new Date,to:new Date}),[p.Xl.DayYesterday]:()=>({from:(0,m.WM)(1),to:(0,m.WM)(1)}),[p.Xl.DayLast7Days]:()=>({from:(0,m.WM)(6),to:new Date}),[p.Xl.DayLast30Days]:()=>({from:(0,m.WM)(29),to:new Date}),[p.Xl.DayLast90Days]:()=>({from:(0,m.WM)(89),to:new Date}),[p.Xl.DayOngoingWeek]:()=>({from:(0,m.to)(),to:new Date}),[p.Xl.DayOngoingMonth]:()=>({from:(0,m.TU)(0),to:new Date}),[p.Xl.DayOngoingYear]:()=>({from:(0,m.Yo)(0),to:new Date}),[p.NU.MonthLastMonth]:()=>({from:(0,m.TU)(1),to:(0,m.x5)(1)}),[p.NU.MonthLast3Months]:()=>({from:(0,m.TU)(2),to:(0,m.x5)(0)}),[p.NU.MonthLast6Months]:()=>({from:(0,m.TU)(5),to:(0,m.x5)(0)}),[p.NU.MonthLast12Months]:()=>({from:(0,m.TU)(11),to:(0,m.x5)(0)}),[p.NU.MonthOngoingMonth]:()=>({from:(0,m.TU)(0),to:(0,m.x5)(0)}),[p.NU.MonthOngoingYear]:()=>({from:(0,m.Yo)(0),to:(0,m.x5)(0)}),[p.qn.YearLastYear]:()=>({from:(0,m.Yo)(1),to:(0,m.Cj)(1)}),[p.qn.YearLast5Years]:()=>({from:(0,m.Yo)(4),to:(0,m.Cj)(0)}),[p.qn.YearLast10Years]:()=>({from:(0,m.Yo)(9),to:(0,m.Cj)(0)}),[p.qn.YearLast25Years]:()=>({from:(0,m.Yo)(24),to:(0,m.Cj)(0)}),[p.qn.YearLast50Years]:()=>({from:(0,m.Yo)(49),to:(0,m.Cj)(0)}),[p.qn.YearOngoingYear]:()=>({from:(0,m.Yo)(0),to:(0,m.Cj)(0)})};var g=function(e){let{fieldName:t,defaultValues:r,dataProviderUid:o}=e;const{dataProviders:l}=(0,a.F)(),i=l[o]?.datasetId,{latest:s}=c(i,t);return(0,n.useMemo)((()=>((e,t)=>{if(e.type===p.JP.Fixed){const{range:t}=e;return t.from&&""===t.to?{from:new Date(t.from),to:new Date(t.from)>new Date?null:(0,m.tx)(new Date)}:t.from&&t.to?{from:new Date(t.from),to:new Date(t.to)}:null}if(e.type===p.JP.Sliding){if((e=>{if(e.type!==p.JP.Sliding)return!1;const{slidingTimeRange:t}=e;return t===p.Xl.DayLatestDate||t===p.NU.MonthLatestMonth||t===p.qn.YearLatestYear})(e)){if(t){const{slidingTimeRange:r}=e;return((e,t)=>{switch(e){case p.Xl.DayLatestDate:return{from:t,to:t};case p.NU.MonthLatestMonth:return{from:(0,m.b)(t),to:(0,m.hT)(t)};case p.qn.YearLatestYear:return{from:(0,m.cP)(t),to:(0,m.gP)(t)};default:return(0,f.d)(e)}})(r,new Date(t))}return null}const{slidingTimeRange:r}=e;return y[r]()}return null})(r,s)),[r,s])},h=r(43525),b=r(46601);const v={from:null,to:null},C=e=>{let{value:t,handleChange:r,earliest:n,latest:a}=e;return{inputValue:null===t?v:t,onChange:e=>{if(!e)return;const t=(e=>{let{value:t,earliest:r,latest:n}=e,{from:a,to:o}=t;if(a||o){if(t.from&&n){const e=new Date(n);a=t.from<=e?t.from:e}if(t.to&&r){const e=new Date(r);o=t.to>=e?t.to:e}return{from:a,to:o}}return t})({value:e,earliest:n,latest:a});r(t)}}},E=e=>(0,o.RD)((0,m.pZ)(e.toISOString()));var _=(e,t)=>{if(t&&e&&(e.from||e.to)){const r=(0,o.ZZ)(t);if(e.from&&e.to)return`${r} IN [${E(e.from)}..${E(e.to)}]`;if(e.from)return`${r} >= ${E(e.from)}`;if(e.to)return`${r} <= ${E(e.to)}`}return null},F=function(e){let{handleFilter:t,filter:r,value:o,as:l=u.A}=e;const{configuration:{parameters:{fieldName:i},styles:{defaultValues:s},target:{dataProviderUid:m},interactive:p=!0}}=r,f=g({fieldName:i,dataProviderUid:m,defaultValues:s});(0,n.useEffect)((()=>{o===h.A&&t(f)}),[o,t,f]);const{dataProviders:y}=(0,a.F)(),{earliest:v,latest:E,precision:_}=c(y[m]?.datasetId,i),F=(0,b.A)(r),{inputValue:x,onChange:S}=C({value:o,handleChange:t,earliest:v,latest:E});return n.createElement(d.A,{isLoading:!E,condition:o!==h.A},n.createElement(l,{value:x,readonly:!p,label:F,onChange:S,minDate:v?new Date(v):void 0,maxDate:E?new Date(E):void 0,precisionFormat:_}))}},19266:function(e,t,r){r.d(t,{JP:function(){return n},NU:function(){return o},Xl:function(){return a},qn:function(){return l}});let n=function(e){return e.None="none",e.Fixed="fixed",e.Sliding="sliding",e}({}),a=function(e){return e.DayToday="day.today",e.DayYesterday="day.yesterday",e.DayLatestDate="day.latest_day",e.DayLast7Days="day.last_7_days",e.DayLast30Days="day.last_30_days",e.DayLast90Days="day.last_90_days",e.DayOngoingWeek="day.ongoing_week",e.DayOngoingMonth="day.ongoing_month",e.DayOngoingYear="day.ongoing_year",e}({}),o=function(e){return e.MonthLatestMonth="month.latest_month",e.MonthLastMonth="month.last_month",e.MonthLast3Months="month.last_3_months",e.MonthLast6Months="month.last_6_months",e.MonthLast12Months="month.last_12_months",e.MonthOngoingMonth="month.ongoing_month",e.MonthOngoingYear="month.ongoing_year",e}({}),l=function(e){return e.YearLatestYear="year.latest_year",e.YearLastYear="year.last_year",e.YearLast5Years="year.last_5_years",e.YearLast10Years="year.last_10_years",e.YearLast25Years="year.last_25_years",e.YearLast50Years="year.last_50_years",e.YearOngoingYear="year.ongoing_year",e}({})},28836:function(e,t,r){r.d(t,{A:function(){return c}});var n=r(41481),a=r(88151),o=r(32273),l=r(63451),i=r(89666),s=r(19645);function c(e){let{filter:t}=e;const{uid:r,type:c}=t,{filterValues:u,setFilterValue:d}=(0,l.$0)(),m=(0,n.useCallback)((e=>{d(r,e)}),[d,r]),p=u[r];switch(c){case o.R.Select:return n.createElement(i.Ay,{filter:t,handleFilter:m,value:p});case o.R.Date:return n.createElement(s.Ay,{filter:t,handleFilter:m,value:p});default:return(0,a.d)(c)}}},95851:function(e,t,r){r.d(t,{A:function(){return c}});var n=r(41481),a=r(28836),o=r(38094),l=r(94919);function i(e){let{children:t,className:r}=e;return n.createElement("div",{className:r},t)}function s(e){let{filter:t}=e;const{filterWrapper:r}=(0,l.F)(),s=r?r[t?.type||"default"]:i;return n.createElement(o.A,{name:`${t.type} : ${t.uid}`},n.createElement(s,{className:"rods-page-renderer__filter",filter:t},t?.type&&n.createElement(a.A,{filter:t})))}function c(){const{filters:e}=(0,l.F)();return n.createElement(n.Fragment,null,e.layout.map((e=>n.createElement(s,{filter:e,key:e.uid}))))}},89666:function(e,t,r){r.d(t,{SX:function(){return f},Ay:function(){return y}});var n=r(41481),a=r(34142),o=r(78464),l=r(26589),i=r(46601),s=r(60546),c=r(96136),u=r(94919),d=r(58566),m=r(84477),p=r(43525),f=(e,t)=>{if(!e||!t)return null;let r=[];return Array.isArray(e)&&(r=e.map((e=>e.value))),(0,s.xH)(...r.map((e=>(0,s.Fe)(t,e))))},y=function(e){let{value:t,handleFilter:r,filter:f,as:y=a.Ay}=e;const{uid:g,configuration:{target:{dataProviderUid:h},parameters:{fieldName:b},styles:{layout:v,defaultValues:C},menuIsOpen:E,interactive:_=!0}}=f,{data:F,isLoading:x}=function(e){let{uid:t,dataProviderUid:r,fieldName:n}=e;const a=(0,c.m)(),{dataProviders:o}=(0,u.F)(),{getFilterValuesForDataProvider:l}=(0,m.s)(),i=l(r,[t]),{data:p,isLoading:f}=a.useDatasetFieldValues(o[r]?.datasetId,n,{...i,where:(0,s.Q7)(i.where,(0,d.uS)(n))});return{data:p,isLoading:f}}({uid:g,dataProviderUid:h,fieldName:b}),S=(0,n.useMemo)((()=>(0,a.i1)(F)),[F]),k=[o.G.MultipleSelection,o.G.MultipleSelectionSearchable].includes(v),M=[o.G.SingleSelectionSearchable,o.G.MultipleSelectionSearchable].includes(v),w=(0,n.useMemo)((()=>C.map((e=>({label:e,value:e})))),[C]);(0,n.useEffect)((()=>{t===p.A&&r(w)}),[t,w,r]);const D=(0,i.A)(f);return n.createElement(l.A,{condition:F&&t!==p.A,isLoading:x},n.createElement(y,{menuIsOpen:E,readonly:!_,isMulti:k,isSearchable:M,isClearable:!0,inputLabel:D,options:S,onChange:r,value:t,handleReset:()=>{r(w)},defaultValue:w,getDefault:()=>w,sortOptions:!0,className:"rods-advanced-select-input-filter",labelClassName:"rods-filter__label"}))}},78464:function(e,t,r){r.d(t,{G:function(){return n}});let n=function(e){return e.SingleSelection="layout_single_selection",e.SingleSelectionSearchable="layout_single_selection_and_searchable",e.MultipleSelection="layout_multiple_selection",e.MultipleSelectionSearchable="layout_multiple_selection_and_searchable",e}({})},26589:function(e,t,r){r.d(t,{A:function(){return a}});var n=r(15785);function a(e){let{children:t,condition:r=!0,isLoading:a}=e;return(0,n.A)((()=>r&&t?t:null),a)}},84477:function(e,t,r){r.d(t,{$:function(){return o},s:function(){return a}});var n=r(45659);const[a,o]=(0,n.A)("FilterValuesContextType")},1312:function(e,t,r){var n=r(41481),a=r(60546),o=r(68098),l=r(32273),i=r(19645),s=r(89666),c=r(43525);t.A=e=>{const t=Object.fromEntries(e.layout.map((e=>[e.uid,c.A]))),[r,u]=(0,n.useState)(t),d=(0,o.D)(),m=(0,n.useCallback)(((e,t)=>{u((r=>r[e]!==t?{...r,[e]:t}:r))}),[u]),p=(0,n.useCallback)(((t,n)=>{if(!t||!e?.layout)return{where:null,refine:null,facet:null};const o=e.layout.filter((e=>e.configuration?.target&&e.configuration.target.dataProviderUid===t)).filter((e=>!n||!n.includes(e.uid))).map((e=>((e,t)=>{const r=e?.configuration?.parameters?.fieldName;switch(e.type){case l.R.Select:return(0,s.SX)(t,r);case l.R.Date:return(0,i.EC)(t,r);default:return null}})(e,r[e.uid]||null)));return{where:(0,a.Q7)(...o,d?.where),refine:d?.refine||null,facet:d?.facet||null}}),[d,e,r]),f=(0,n.useCallback)((()=>{const t=e.layout.reduce(((e,t)=>({...e,[t.uid]:null})),{});u(t)}),[e]),y=e.layout.filter((e=>t=>{const r=e[t.uid];return Array.isArray(r)?r.length>0:Boolean(r)})(r)).length,g=y>0;return(0,n.useMemo)((()=>({setFilterValue:m,filterValues:r,getFilterValuesForDataProvider:p,isFiltered:g,activeFiltersNumber:y,clearAllValues:f})),[m,p,g,y,r,f])}},43525:function(e,t){const r=Symbol("default filter value");t.A=r},61855:function(e,t,r){var n=r(32273),a=r(78464);const o={[n.R.Select]:{singleSelection:a.G.SingleSelection,singleSelectionSearchable:a.G.SingleSelectionSearchable,multipleSelection:a.G.MultipleSelection,multipleSelectionSearchable:a.G.MultipleSelectionSearchable},[n.R.Date]:{}};n.R.Select,o[n.R.Select].singleSelection},32273:function(e,t,r){r.d(t,{R:function(){return n}});let n=function(e){return e.Select="select",e.Date="date",e}({})},46601:function(e,t,r){var n=r(41481),a=r(22392),o=r(23706),l=r(96136),i=r(94919);t.A=function(e){const{i18n:t}=(0,n.useContext)(o.gJ),{dataProviders:r}=(0,i.F)(),s=(0,l.m)(),{configuration:{target:{dataProviderUid:c},parameters:{fieldName:u},styles:{title:d=null}}}=e,{dataset:m}=s.useCatalogDataset2(d?null:r[c]?.datasetId,t.shortLanguageCode);return d||(0,a.lu)(m,u)}},46841:function(e,t,r){r.d(t,{A:function(){return ua}});var n=r(29894),a=r(41481),o=r(64516),l=r.n(o),i=r(32730),s=r(17960),c=r(94919),u=r(50173),d=r(77981),m=r(23706),p=r(87753),f=r(76997);function y(e){const{i18n:t}=(0,a.useContext)(m.gJ),{options:r}=(0,c.F)(),n=e?.datasetId;return(0,a.useMemo)((()=>n&&!r.hideSourceLink?{href:`/explore/dataset/${n}/table`,label:t.translate("View source"),style:"border-top: solid 1px rgba(0,0,0,0.1); padding: 8px 8px 0px 8px;"}:void 0),[n,r.hideSourceLink,t])}var g=r(60546),h=r(96136);const b=/Unknown field: ([a-z_-]*)./,v=(e,t,r)=>{if(!t||!r)return null;if("NotFoundResource"===t.error_code)return e.translate("Dataset {datasetId} doesn't exist or you don't have access to it.",{datasetId:r.datasetId});if("ODSQLError"===t.error_code){const n=b.exec(t.message);if(n){const t=n[1];return e.translate("Dataset {datasetId} doesn't have a field named {fieldName} or you don't have access to it.",{datasetId:r.datasetId,fieldName:t})}}return t.message};function C(e,t,r){const n=(0,h.m)(),{i18n:o}=(0,a.useContext)(m.gJ),l=function(e,t){return(0,a.useMemo)((()=>e&&t?.(e.datasetId)),[e,t])}(e,t),{getFilterValuesForDataProvider:i}=(0,s.$0)(),c=(0,a.useMemo)((()=>i(e?.uid)),[i,e?.uid]),u=(0,a.useMemo)((()=>{if(!l)return l;if(!Object.values(c).map(Boolean))return l;let e=[...l];return c.where&&(e=e.map((e=>e.where((e=>(0,g.Q7)(e,c.where)))))),c.refine&&(e=e.map((e=>{let t=e;return c.refine?.forEach((e=>{t=t.refine(e)})),t}))),c.facet&&(e=e.map((e=>{let t=e;return c.facet?.forEach((e=>{t=t.facet(e)})),t}))),e}),[c,l]),{data:d,isValidating:p,error:f}=n.useExploreApi(u);return(0,a.useMemo)((()=>({data:{value:d&&r&&r(d),loading:u&&(!f&&!d||p),error:v(o,f,e)||void 0},queries:u})),[u,d,r,f,p,e,o])}function E(e,t,r){return C(e,(0,a.useMemo)((()=>{if(t)return e=>{const r=t(e);return r&&[r]}}),[t]),(0,a.useMemo)((()=>{if(r)return e=>r(e[0])}),[r]))}var _=r(88151),F=r(45497);let x=function(e){return e.Standard="standard",e.CompactShort="compact_short",e.CompactLong="compact_long",e}({});function S(e){const{i18n:{languageCode:t}}=(0,a.useContext)(m.gJ);return(0,a.useMemo)((()=>new Intl.NumberFormat(t,e)),[t,e])}function k(e){let t={};const{maximumFractionDigits:r,notation:n}=e||{},a=r?Number(r):2;switch(n){case x.Standard:t={notation:"standard",maximumFractionDigits:a};break;case x.CompactShort:t={notation:"compact",maximumFractionDigits:a};break;case x.CompactLong:t={notation:"compact",compactDisplay:"long",maximumFractionDigits:a};break;default:t={notation:"compact",maximumFractionDigits:1}}return t}function M(e){const{maximumFractionDigits:t}=e||{},r=t?Number(t):1;return{notation:x.Standard,maximumFractionDigits:r,style:"percent"}}x.Standard,x.CompactShort,x.CompactLong;var w=r(96472),D=r.n(w),A=r(66209),L=r.n(A),N=r(48787),P=r.n(N),T=r(57783),R=r.n(T),I=r(35807),$=r.n(I);var O=r(29193),U=r(8216),Y=function(){return a.createElement("div",{className:"GAykMX35S6wwr170332S"},a.createElement("div",{className:"YNOmKsO4kVlkHAHDvyif"},a.createElement(U.A,{translationKey:"No records"})))},X=r(90590),V=function(e){let{error:t}=e;const{i18n:r}=(0,a.useContext)(m.gJ);return a.createElement(X.Ay,null,a.createElement(X.Ay.Header,{title:r.translate("Error")},a.createElement("span",null,t)))},q=r(87419),W=r(57875);const B="small",J="layout_tt_da",Z="layout_xy_gr",G="layout_tt",j="layout_tt_sc",H="layout_xy_gr_do",Q="layout_xy_tt_gr",z="layout_xy_tt_gr_do",K="layout_tt_su_gr",ee="layout_xy_da",te="layout_tt_su_da",re="layout_tt_le",ne="layout_tt_le_va",ae="layout_tt_se_na",oe="layout_tt_se_na_va",le="layout_tt_xy_da",ie="layout_da",se={[F.XD.TimeSeries.Lines]:z,[F.XD.TimeSeries.Areas]:z,[F.XD.Comparison.Columns]:Q,[F.XD.Comparison.Bars]:Q,[F.XD.Composition.Pie]:ae,[F.XD.Composition.Doughnut]:ae,[F.XD.Comparison.Radar]:j},ce={[J]:{[O.Xn]:!0,[O.WC]:!0,[O.Ro]:!0,[O.nU]:!0,[O.yy]:!0},[H]:{[O.an]:!0,[O.rp]:!0,[O.WC]:!0,[O.r$]:!0,[O.nU]:!1},[Q]:{[O.Xn]:!0,[O.an]:!0,[O.rp]:!0,[O.WC]:!0,[O.r$]:!0,[O.nU]:!0},[z]:{[O.Xn]:!0,[O.an]:!0,[O.rp]:!0,[O.WC]:!0,[O.r$]:!0,[O.nU]:!1},[K]:{[O.Xn]:!0,[O.r3]:!0,[O.WC]:!0,[O.r$]:!0,[O.nU]:!0},[ie]:{[O.WC]:!0,[O.Ro]:!0,[O.nU]:!0},[Z]:{[O.an]:!0,[O.rp]:!0,[O.WC]:!0,[O.r$]:!0},[ee]:{[O.an]:!0,[O.rp]:!0,[O.WC]:!0,[O.Ro]:!0},[te]:{[O.Xn]:!0,[O.r3]:!0,[O.WC]:!0,[O.Ro]:!0},[le]:{[O.Xn]:!0,[O.an]:!0,[O.rp]:!0,[O.WC]:!0,[O.Ro]:!0},[G]:{[O.Xn]:!0,[O.yy]:!0},[j]:{[O.Xn]:!0,[O.yy]:!0,[O.Ih]:!0},[re]:{[O.Xn]:!0,[O.Ix]:!0},[ne]:{[O.Xn]:!0,[O.Ix]:!0,[O.G6]:!0},[ae]:{[O.Xn]:!0,[O.WC]:!0,[O.Ro]:!0,[O.j5]:!0},[oe]:{[O.Xn]:!0,[O.WC]:!0,[O.Ro]:!0,[O.Wk]:!0}},ue="separate",de="stacked",me="percentage",pe=ue;function fe(e){return{...!!ce[e][O.nU]&&{pointRadius:0}}}function ye(e,t){const{layout:r,xLabel:n}=e;return{display:!0,title:{display:!!ce[r][O.an],text:n,align:"center",color:t},gridLines:{display:!1},ticks:{color:t}}}function ge(e,t,r){const{layout:n,yLabel:a}=e;return{display:!!ce[n][O.WC],type:"linear",title:{display:!!ce[n][O.rp],text:a,align:"center",color:r},gridLines:{display:!!ce[n][O.r$]||"single"},ticks:{display:!!ce[n][O.r$]||"single",format:t,color:r}}}function he(e){const{layout:t,title:r}=e;return{display:!!ce[t][O.Xn],text:r}}function be(e){const{layout:t,subtitle:r}=e;return{display:!!ce[t][O.r3],text:r,align:"start"}}function ve(e,t){const{layout:r}=e;return{ticks:{display:!!ce[r][O.Ih],format:t},gridLines:{display:!!ce[r][O.yy]}}}function Ce(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{yField:r,yFunction:n,customFunction:a}=t;return!e||!n||F.oC[n].aggFieldRequired&&!r||"custom"===n&&!a}function Ee(e){let{styles:t,colors:r,dataFrame:n,numberFormatter:a,key:o,forceHide:l=!1}=e;return{display:!l&&!!ce[t.layout][O.Ro]&&"auto",align(e){return n[e][o]>=0?"end":"start"},anchor(e){return n[e][o]>=0?"end":"start"},color:r,text(e){return a(n[e][o])},...ce[t.layout][O.j5]&&{text(e){return n[e].x}},...ce[t.layout][O.Wk]&&{text(e){return[n[e].x,a(n[e][o])]}}}}function _e(e){let{styles:t,numberFormatter:r,dataFrame:n,boxStyle:a="rect",key:o="y",isMultiSeries:l=!1}=e;const{layout:i}=t;if(ce[i][O.G6]&&l)throw new Error("Legend with values layout cannot be used with multi-series.");return{display:l||!!ce[i][O.Ix],position:l?"bottom":"right",boxStyle:a,...ce[i][O.G6]&&{labels:{text(e){return`${n[e].x} - ${r(n[e][o])}`}}}}}function Fe(e){return{stacked:e===de||e===me,percentaged:e===me}}const xe={[B]:"50%",medium:"65%",large:"80%"};function Se(e){switch(e){case"year":return 317088e5;case"month":return 27648e5;case"day":return 9e7;case"hour":return 366e4;default:return 61e3}}function ke(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5?arguments[5]:void 0;const{series:l,...i}=t||{};return{layout:r,title:e.translate(F.FX),subtitle:e.translate(F.Bs),description:"",xLabel:n?e.translate(F.ph):e.translate(F.Pt),yLabel:n?e.translate(F.Pt):e.translate(F.ph),displayFormat:{notation:x.CompactShort,maximumFractionDigits:"1"},series:a.reduce(((t,r,n)=>({...t,[r]:{color:(0,W.bZ)(l?.[r]?.color||o.chart[n%o.chart.length],o),legend:l?.[r]?.legend||e.translate("Series {index}",{index:n+1})}})),{}),...i}}function Me(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4?arguments[4]:void 0;const{series:o,...l}=t||{};return{layout:r,title:e.translate(F.FX),description:"",displayFormat:{notation:x.CompactShort,maximumFractionDigits:"1"},series:n.reduce(((t,r,n)=>({...t,[r]:{color:(0,W.bZ)(o?.[r]?.color||a.chart[n%a.chart.length],a),legend:o?.[r]?.legend||e.translate("Series {index}",{index:n+1})}})),{}),...l}}function we(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],l=arguments.length>6?arguments[6]:void 0,i=arguments.length>7?arguments[7]:void 0,s=arguments.length>8?arguments[8]:void 0;const c=r[0],u=Me(n,t.styles,se[e],[],a),d=o.map(((e,t)=>l[t%l.length]))||l;return{labelColumn:"x",padding:48,series:[{type:q._R.Pie,valueColumn:c,backgroundColor:d,dataLabels:Ee({styles:u,colors:d,dataFrame:o,numberFormatter:i,key:c,forceHide:Ce(t.parameters?.query?.xField,t.parameters?.query?.series?.[c])})}],title:he(u),description:u.description||"",legend:_e({styles:u,numberFormatter:s,dataFrame:o,key:c}),tooltip:{numberFormatter:i,rtl:n.isRTL()}}}function De(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0;const{chart:l,text:i}=r,{seriesUIDs:s=[]}=e;switch(e.chartType){case F.XD.Comparison.Bars:{const l=ke(o,e.styles,se[F.XD.Comparison.Bars],!0,s,r);return{labelColumn:"x",padding:{left:24,top:24,right:24,bottom:8},series:s.map((e=>({label:l.series?.[e]?.legend,type:q._R.Bar,valueColumn:e,indexAxis:"y",borderColor:(0,W.E2)(l.series?.[e]?.color||"#000000"),backgroundColor:(0,W.E2)(l.series?.[e]?.color||"#000000",.5),dataLabels:Ee({styles:l,colors:(0,W.E2)(l.series?.[e]?.color||"#000000"),dataFrame:t,numberFormatter:n,key:e})}))),axis:{x:ge(l,a,i),y:{...ye(l,i),type:"category"},assemblage:Fe(e.parameters?.axisAssemblage||pe)},title:he(l),subtitle:be(l),description:l.description||"",legend:_e({styles:l,numberFormatter:a,dataFrame:t,isMultiSeries:s.length>1}),tooltip:{numberFormatter:n,rtl:o.isRTL()}}}case F.XD.Comparison.Columns:{const l=ke(o,e.styles,se[F.XD.Comparison.Columns],!1,s,r);return{labelColumn:"x",padding:{left:24,top:24,right:24,bottom:8},series:s.map((e=>({label:l.series?.[e]?.legend,type:q._R.Bar,valueColumn:e,borderColor:(0,W.E2)(l.series?.[e]?.color||"#000000"),backgroundColor:(0,W.E2)(l.series?.[e]?.color||"#000000",.5),dataLabels:Ee({styles:l,colors:(0,W.E2)(l.series?.[e]?.color||"#000000"),dataFrame:t,numberFormatter:n,key:e})}))),axis:{x:{...ye(l,i),type:"category",offset:!0},y:ge(l,a,i),assemblage:Fe(e.parameters?.axisAssemblage||pe)},title:he(l),subtitle:be(l),description:l.description||"",legend:_e({styles:l,numberFormatter:a,dataFrame:t,isMultiSeries:s.length>1}),tooltip:{numberFormatter:n,rtl:o.isRTL()}}}case F.XD.Comparison.Radar:{const l=Me(o,e.styles,se[F.XD.Comparison.Radar],s,r);return{labelColumn:"x",padding:{left:24,top:24,right:24,bottom:8},series:s.map((e=>({label:l.series?.[e]?.legend,type:q._R.Radar,valueColumn:e,borderColor:(0,W.E2)(l.series?.[e]?.color||"#000000"),backgroundColor:(0,W.E2)(l.series?.[e]?.color||"#000000",.5),dataLabels:Ee({styles:l,colors:(0,W.E2)(l.series?.[e]?.color||"#000000"),dataFrame:t,numberFormatter:n,key:e})}))),axis:{r:ve(l,a)},title:he(l),description:l.description||"",legend:_e({styles:l,numberFormatter:a,dataFrame:t,isMultiSeries:s.length>1}),tooltip:{numberFormatter:n,rtl:o.isRTL()}}}case F.XD.Composition.Doughnut:{const i=we(e.chartType,e,s,o,r,t,l,n,a);return{...i,series:i.series.map((t=>({...t,type:q._R.Doughnut,cutout:xe[e.styles?.cutout||B]})))}}case F.XD.Composition.Pie:return we(e.chartType,e,s,o,r,t,l,n,a);case F.XD.TimeSeries.Areas:case F.XD.TimeSeries.Lines:{const l=ke(o,e.styles,se[e.chartType],!1,s,r),c=e.parameters?.query?.xTimescale;return{labelColumn:"x",padding:{left:24,top:24,right:24,bottom:8},series:s.map((r=>({label:l.series?.[r]?.legend,type:q._R.Line,valueColumn:r,fill:e.chartType===F.XD.TimeSeries.Areas||e.parameters?.axisAssemblage===de||e.parameters?.axisAssemblage===me?{mode:"origin"}:void 0,backgroundColor:(0,W.E2)(l.series?.[r]?.color||"#000000",.26),borderColor:(0,W.E2)(l.series?.[r]?.color||"#000000"),dataLabels:Ee({styles:l,colors:(0,W.E2)(l.series?.[r]?.color||"#000000"),dataFrame:t,numberFormatter:n,key:r}),...fe(l.layout),spanGaps:Se(c)}))),axis:{x:{...ye(l,i),type:"time",timeUnit:c},y:ge(l,a,i),assemblage:Fe(e.parameters?.axisAssemblage||pe)},title:he(l),subtitle:be(l),description:l.description||"",legend:_e({styles:l,numberFormatter:a,dataFrame:t,boxStyle:e.chartType===F.XD.TimeSeries.Lines&&e.parameters?.axisAssemblage===ue?"line":"rect",isMultiSeries:s.length>1}),tooltip:{numberFormatter:n,rtl:o.isRTL()}}}default:throw new Error(`Unknown chart type : ${e.chartType}`)}}var Ae=(e,t,r,n)=>{(0,a.useEffect)((()=>{t&&!t.loading&&(r||t.error)&&n&&n(e,r,t.error)}),[n,t,r,e])};const Le={notation:"compact"};var Ne=function(e){let{block:t,width:r}=e;const{i18n:n}=(0,a.useContext)(m.gJ),{languageCode:o}=n,l=(0,d.d4)((e=>e.entities.domain.theme_colors)),i=(0,c.F)(),s=t.source?i.dataProviders[t.source]:void 0,u=y(s),g=t.configuration.parameters?.query,{seriesUIDs:h}=t.configuration,b=(0,a.useCallback)((e=>{const t=(0,f.sN)(e);return(0,f.ze)(t,g)}),[g]),v=(0,a.useCallback)((e=>{if(!t?.configuration?.chartType||e&&e.every((e=>0===e.results.length)))return[];const r=e.map((e=>e.results));return function(e,t,r){if(!r||!r.length)return[];const n=r.reduce(((e,t)=>({...e,[t]:null})),{});return $()(R()(P()(...t),"x"),D()((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return L()({...n},...t)}))).sort(e)}(function(e,t,r){if("x"!==t.by&&!t.by.startsWith(F.Um))throw new Error(`Unsupported axis: ${t.by}`);const n="x"===t.by?function(e){for(const t of e)for(const e of t)if(e.x)return typeof e.x;throw new Error("No x field found")}(e):"number";if("string"===n)return t.direction===F.bz.ASC?(e,t)=>function(e,t,r){return new Intl.Collator(r).compare(e.x,t.x)}(e,t,r):(e,t)=>function(e,t,r){return new Intl.Collator(r).compare(t.x,e.x)}(e,t,r);if("number"===n)return t.direction===F.bz.ASC?(e,r)=>function(e,t,r){const{[r]:n=0}=e,{[r]:a=0}=t;return n-a}(e,r,t.by):(e,r)=>function(e,t,r){const{[r]:n=0}=e,{[r]:a=0}=t;return a-n}(e,r,t.by);throw new Error(`Unsupported type ${n} for ${t.by} axis`)}(r,g?.order||function(e,t){switch(e){case F.XD.TimeSeries.Lines:case F.XD.TimeSeries.Areas:return{by:"x",direction:F.bz.ASC};case F.XD.Comparison.Bars:case F.XD.Comparison.Radar:case F.XD.Composition.Doughnut:case F.XD.Composition.Pie:if(!t)throw new Error("Series UID is required for comparison charts");return{by:t,direction:F.bz.DESC};case F.XD.Comparison.Columns:if(!t)throw new Error("Series UID is required for comparison charts");return{by:t,direction:F.bz.ASC};default:return(0,_.d)(e)}}(t?.configuration?.chartType,h?.[0]),o),r,h)}),[t?.configuration?.chartType,g?.order,o,h]),{data:E,queries:x}=C(s,b,v),{styles:M}=t.configuration,w=S((0,a.useMemo)((()=>({...k(M?.displayFormat)})),[M?.displayFormat])),A=S(Le),N=(0,a.useMemo)((()=>({...De(t.configuration,E.value,l,w.format,A.format,n),source:u,aspectRatio:(0,O.XF)(r,i.verticalLayout)})),[t.configuration,E.value,l,i.verticalLayout,w.format,A.format,n,u,r]);return Ae(t.uid,E,x,i.onBlockRender),E.value&&0===E.value.length?a.createElement(Y,null):E.error?a.createElement(V,{error:E.error}):a.createElement(p.t1,{data:E,options:N})},Pe=r(62400),Te=r.n(Pe),Re=r(19864),Ie=r.n(Re),$e=r.p+"bc41f851d89243eb6f22.svg";const Oe="layout_context_only",Ue="layout_title_only",Ye="layout_image_and_title",Xe="layout_context_and_image",Ve="context",qe="title",We="image",Be={[F.Vj.Simple]:Oe,[F.Vj.Comparison]:Oe,[F.Vj.Ratio]:Oe},Je={[Oe]:{[Ve]:!0},[Ue]:{[qe]:!0},[Ye]:{[We]:!0,[qe]:!0,row:!0},[Xe]:{[Ve]:!0,[We]:!0}},Ze=e=>e&&"row"in Je[e];function Ge(e,t,r,n,a){const{layout:o,title:l,context:i,imgUrl:s}=function(e,t){const{imgUrl:r,...n}=t.styles||{},a=Ie()(r)?$e:r;return{layout:Be[t.kpiType||"simple"],title:e.translate(F.RQ),context:e.translate(F.w7),imgUrl:a,...n}}(e,t),c={source:r,format:n,formatCompact:a};Je[o][Ve]&&(c.description=i),Je[o][qe]&&(c.title=l),Je[o][We]&&(c.imgSrc=s);const{format:u}=t.parameters||{};if(u){const{prefix:e,suffix:t}=u;e&&(c.prefix=e),t&&(c.suffix=t)}return c}var je="r9uDgGdKu6k_KJiuwZyt",He="ox81BFa8G2wfss7GvVVe";const Qe=e=>e.loading||e.error||e.value?e:{...e,value:0},ze=e=>Te()(e),Ke=e=>{let t=e.results[0]?.y;return null===t&&(t=void 0),t};function et(e){return{...e,notation:x.Standard}}function tt(e){let{uid:t,configuration:r,source:n}=e;const{i18n:o}=(0,a.useContext)(m.gJ),{dataProviders:i,onBlockRender:s}=(0,c.F)(),u=n?i[n]:void 0,{parameters:d,styles:g}=r,h=(0,a.useCallback)((e=>{const t=(0,f.sN)(e);return(0,f.UF)(t,d?.query)}),[d]),{data:b,queries:v}=E(u,h,Ke);Ae(t,b,v,s);const C=(0,a.useMemo)((()=>Qe(b)),[b]),_=(0,a.useMemo)((()=>k(g?.displayFormat)),[g?.displayFormat]),F=S((0,a.useMemo)((()=>k(et(g?.displayFormat))),[g?.displayFormat])),x=S(_),M=y(u),w=(0,a.useMemo)((()=>Ge(o,r,M,F.format,x.format)),[o,r,M,F.format,x.format]);return C.error?a.createElement(V,{error:C.error}):a.createElement("div",{className:l()(He,{[je]:Ze(g?.layout)})},a.createElement(p.nO,{data:C,options:w}))}const rt={[F.hL.Difference]:{[F.l1.Normal]:(e,t)=>e-t,[F.l1.Reversed]:(e,t)=>t-e},[F.hL.PercentageChange]:{[F.l1.Normal]:(e,t)=>e/t-1,[F.l1.Reversed]:(e,t)=>t/e-1}};function nt(e){let{uid:t,configuration:r,source:n}=e;const{i18n:o}=(0,a.useContext)(m.gJ),{dataProviders:i,onBlockRender:s}=(0,c.F)(),u=n?i[n]:void 0,{parameters:d,styles:g}=r,h=(0,a.useCallback)((e=>{const t=(0,f.sN)(e);return(0,f.UF)(t,d?.queryLeft)}),[d]),b=(0,a.useCallback)((e=>{const t=(0,f.sN)(e);return(0,f.UF)(t,d?.queryRight)}),[d]),{data:v,queries:C}=E(u,h,Ke),{data:_,queries:F}=E(u,b,Ke),x={loading:v.loading||_.loading,error:[v?.error,_?.error]},w=(0,a.useMemo)((()=>[...C??[],...F??[]]),[C,F]);Ae(t,x,w,s);const{op:D,direction:A}=d||{},L=(0,a.useMemo)((()=>{let e;return ze(v.value)&&ze(_.value)&&D&&A&&(e=rt[D][A](v.value,_.value)),Qe({loading:v.loading||_.loading,error:v.error||_.error,value:e})}),[v,_,D,A]),N=(0,a.useMemo)((()=>({..."percentage_change"===D?M(g?.displayFormat):k(g?.displayFormat),signDisplay:"exceptZero"})),[D,g?.displayFormat]),P=S((0,a.useMemo)((()=>({..."percentage_change"===D?M(et(g?.displayFormat)):k(et(g?.displayFormat)),signDisplay:"exceptZero"})),[D,g?.displayFormat])),T=S(N),R=y(u),I=(0,a.useMemo)((()=>Ge(o,r,R,P.format,T.format)),[o,r,R,P.format,T.format]);return L.error?a.createElement(V,{error:L.error}):a.createElement("div",{className:l()(He,{[je]:Ze(g?.layout)})},a.createElement(p.nO,{data:L,options:I}))}function at(e){let{uid:t,configuration:r,source:n}=e;const{i18n:o}=(0,a.useContext)(m.gJ),{dataProviders:i,onBlockRender:s}=(0,c.F)(),u=n?i[n]:void 0,{parameters:d,styles:g}=r,h=(0,a.useCallback)((e=>{const t=(0,f.sN)(e);return(0,f.UF)(t,d?.queryLeft)}),[d]),b=(0,a.useCallback)((e=>{const t=(0,f.sN)(e);return(0,f.UF)(t,d?.queryRight)}),[d]),{data:v,queries:C}=E(u,h,Ke),{data:_,queries:x}=E(u,b,Ke),k={loading:v.loading||_.loading,error:[v?.error,_?.error]},w=(0,a.useMemo)((()=>[...C??[],...x??[]]),[C,x]);Ae(t,k,w,s);const{direction:D}=d||{},A=(0,a.useMemo)((()=>{let e;return ze(v.value)&&ze(_.value)&&D&&(D===F.l1.Normal?e=v.value/_.value:D===F.l1.Reversed&&(e=_.value/v.value)),Qe({loading:v.loading||_.loading,error:v.error||_.error,value:e})}),[v,_,D]),L=(0,a.useMemo)((()=>M(g?.displayFormat)),[g?.displayFormat]),N=S((0,a.useMemo)((()=>M(et(g?.displayFormat))),[g?.displayFormat])),P=S(L),T=y(u),R=(0,a.useMemo)((()=>Ge(o,r,T,N.format,P.format)),[o,r,T,N.format,P.format]);return A.error?a.createElement(V,{error:A.error}):a.createElement("div",{className:l()(He,{[je]:Ze(g?.layout)})},a.createElement(p.nO,{data:A,options:R}))}var ot=function(e){let{block:t}=e;const{configuration:r,source:n,uid:o}=t;return a.createElement(a.Fragment,null,r.kpiType===F.Vj.Simple&&a.createElement(tt,{uid:o,source:n,configuration:r}),r.kpiType===F.Vj.Comparison&&a.createElement(nt,{uid:o,source:n,configuration:r}),r.kpiType===F.Vj.Ratio&&a.createElement(at,{uid:o,source:n,configuration:r}))},lt=r(76806),it=r(44310),st=r(15785),ct=r(1614),ut=r(16766),dt=r.n(ut);function mt(e){const[,t,r]=dt()(e).lab();return e=>dt().lab(e,t,r).hex()}function pt(e,t){const r=(0,W.V$)(e,8,t,mt);return{start:r[0],end:r[7]}}var ft=r(79259);const yt={layout_tt_ll:{[O.Xn]:!0,[O.wT]:!0},layout_tt_lr:{[O.Xn]:!0,[O.Hp]:!0},layout_tt_su_ll:{[O.Xn]:!0,[O.r3]:!0,[O.wT]:!0},layout_tt_su_lr:{[O.Xn]:!0,[O.r3]:!0,[O.Hp]:!0},layout_ll:{[O.wT]:!0},layout_lr:{[O.Hp]:!0}},gt=O.gl.SixteenToNine;var ht=r(84125),bt=r(79028),vt=r.n(bt),Ct=r(15229),Et=r(22392);(0,m.y$)("Add a chart title"),(0,m.y$)("Add a chart subtitle"),(0,m.y$)("Add an horizontal axis label"),(0,m.y$)("Add a vertical axis label"),(0,m.y$)("Add a KPI title"),(0,m.y$)("Give context to your KPI"),(0,m.y$)("This text should describe the visualization to make it\naccessible to visually impaired persons.");const _t={minute:{label:(0,m.y$)("Minute"),format:"LLL"},hour:{label:(0,m.y$)("Hour"),format:"LLL"},day:{label:(0,m.y$)("Day"),format:"LL"},month:{label:(0,m.y$)("Month"),format:"MMMM YYYY"},year:{label:(0,m.y$)("Year"),format:"YYYY"}};let Ft=function(e){return e.TitleOnly="layout_title_only",e.ContextOnly="layout_context_only",e.TitleContext="layout_title_context",e.TitleImage="layout_title_image",e.TitleContextImage="layout_title_context_image",e}({});const xt="title",St="context",kt="image",Mt={[Ft.TitleOnly]:{[xt]:!0},[Ft.ContextOnly]:{[St]:!0},[Ft.TitleContext]:{[xt]:!0,[St]:!0},[Ft.TitleImage]:{[xt]:!0,[kt]:!0},[Ft.TitleContextImage]:{[xt]:!0,[St]:!0,[kt]:!0}},wt="mapLayer_001",Dt=(0,m.y$)("Undefined label"),At="recordId",Lt="geoPoint",Nt="categoriesField";function Pt(e){let{label:t="",value:r=0}=e;return a.createElement("div",{className:"rods-page-renderer__choropleth-map__tooltip__inner"},a.createElement("span",{className:"shape-name"},t),a.createElement("span",{className:"value"},r))}function Tt(e){let{children:t}=e;return a.createElement("div",{className:"rods-page-renderer__poi-map__tooltip__inner"},t)}function Rt(e){let{title:t,marginTop:r}=e;return t?a.createElement("div",{className:"title "+(r?"margin-top":"")},t):null}function It(e){let{contextFields:t,marginTop:r}=e;return t&&t.length?a.createElement("div",{className:"context-fields "+(r?"margin-top":"")},t.filter((e=>!!e.value&&!!e.label)).map((e=>a.createElement("div",{key:`${e.label}-${e.value}`,className:"context-field"},a.createElement("div",{className:"label"},e.label," :"),a.createElement("div",{className:"value"},(e=>{if("string"!=typeof e)return!1;let t;try{t=new URL(e)}catch(e){return!1}return"http:"===t.protocol||"https:"===t.protocol})(e.value)?a.createElement("a",{href:e.value,target:"_blank",rel:"noopener noreferrer"},e.value):e.value))))):null}function $t(e){let{imageUrl:t}=e;return t?a.createElement("div",{className:"image"},a.createElement("img",{src:t,alt:""})):null}function Ot(e,t){if("string"==typeof t){const r=vt()(t,["YYYY-MM-DD",vt().ISO_8601]),n=(0,Et.le)(e);if(n&&r.isValid()&&vt()(t,vt().ISO_8601,!0).isValid())return r.format(_t[n].format)}return String(t)}const Ut={},Yt=e=>e;var Xt=e=>{let{uid:t,source:r,configuration:n,shapes:o}=e;const{i18n:l}=(0,a.useContext)(m.gJ),i=(0,d.d4)((e=>e.entities.domain.theme_colors)),{dataProviders:s,verticalLayout:u,onBlockRender:p}=(0,c.F)(),h=r?s[r]:void 0,{parameters:b,styles:v,interactive:C}=n,_=y(h),x=(0,a.useCallback)((e=>((e,t,r)=>{if(!t||!r)return;const{yField:n,yFunction:a,customFunction:o,conditions:l=[]}=t;let i=(0,f.ZF)(e,"json"),s=null;return"custom"===a?o&&(s=o):"count"===a?s="count(*)":"count_distinct"===a&&n?s=`count(distinct ${(0,g.ZZ)(n)})`:a&&n&&(s=`${a}(${(0,g.ZZ)(n)})`),s&&(i=i.select(`${s} as y`)),i=i.groupBy(`${(0,g.ZZ)(r)} as x`),i=i.where(l&&l.length&&(0,ft.A)(l)||""),i})(e,b?.query,b?.dataKey)),[b?.query,b?.dataKey]),{data:M,queries:w}=E(h,x,Yt);Ae(t,M,w,p);const D=(0,a.useMemo)((()=>((e,t)=>e?.type===q.tf.Gradient?{type:q.tf.Gradient,colors:pt(e.color,t)}:e?.type===q.tf.Palette?{type:q.tf.Palette,colors:(0,W.V$)(e.color,parseInt(e.steps,10)||5,t)}:void 0)(v?.colorsScale,i)),[v?.colorsScale,i]),A=(0,a.useMemo)((()=>(0,O.bJ)(v?.aspectRatio||gt,u)),[v?.aspectRatio,u]),L=(0,a.useMemo)((()=>"count"===b?.query?.yFunction||"custom"===b?.query?.yFunction&&b?.query?.customFunction||b?.query?.yField&&b?.query?.yFunction?{title:v?.legendLabel||l.translate(F.iv),position:v?.layout&&yt[v?.layout][O.Hp]?"right":"left"}:void 0),[v?.legendLabel,b?.query?.yField,b?.query?.yFunction,b?.query?.customFunction,v?.layout,l]),N=(0,a.useMemo)((()=>v?.layout&&yt[v?.layout][O.Xn]?v?.title||l.translate(F.FE):void 0),[v?.layout,v?.title,l]),P=(0,a.useMemo)((()=>v?.layout&&yt[v?.layout][O.r3]?v?.subtitle||l.translate(F.LI):void 0),[v?.layout,v?.subtitle,l]),T=v?.description,R=S((0,a.useMemo)((()=>k(v?.displayFormat)),[v?.displayFormat])).format,I=(0,a.useCallback)((e=>{let{label:t="",value:r=0}=e;return(e=>{let{label:t="",value:r=0}=e;return(0,ht.renderToStaticMarkup)(a.createElement(Pt,{label:t,value:r}))})({label:t,value:R(r)})}),[R]),$=(0,ct.Jj)();return{data:M,options:(0,a.useMemo)((()=>o&&{colorScale:D,aspectRatio:A,interactive:C,legend:L,tooltip:{formatter:I},title:N,subtitle:P,description:T,sourceLink:_,cooperativeGestures:$}),[o,D,A,C,L,I,N,P,T,_,$])}},Vt=function(e){let{uid:t,source:r,configuration:n}=e;const{i18n:o}=(0,a.useContext)(m.gJ),{shapeSource:l,shapeKey:i,shapeName:s}=n.parameters,{shapes:c,isShapesLoading:u}=(0,ct.HB)({datasetId:l?.dataset?.datasetId,shapeKey:i,shapeName:s}),{data:d,options:f}=Xt({uid:t,source:r,configuration:n,shapes:c}),y=(0,a.useMemo)((()=>({...f,shapes:c})),[f,c]),g=(0,a.useMemo)((()=>!!c&&!c.features.some((e=>["Polygon","MultiPolygon"].includes(e.geometry?.type)))),[c]),h=d.loading||u,b=(0,st.A)((()=>y&&a.createElement(p.ef,{options:y,data:d.value?{value:d.value}:{value:[{x:"0",y:0}]}})),h);return d.error?a.createElement(V,{error:d.error}):g&&!h?a.createElement("div",{style:{aspectRatio:y?.aspectRatio?.toString()}},a.createElement(lt.A,{withIcon:!0,variant:"critical"},o.translate("Choropleth maps only support polygons, but the current data doesn't contain any."))):a.createElement(it.A,{isLoading:h,spinAfter:1e3,spinAtLeast:500,graceTimePlaceholder:b,aspectRatio:y?.aspectRatio},b)},qt=r(1027),Wt=r(74983);const Bt=[-160.829773,18.309918,-153.776551,22.904996],Jt={world:[-170,-75,180,85],world_us:[-130.078125,23.5639871285,-59.0625,50.8475729537],us_40_02:[-181.989652,50.624814,-125.915433,71.856102],world_pt:[-10.671367,36.722499,-5.793437,42.254049]};function Zt(e,t){return Jt[`${e}__${t}`]||Jt[e]||null}const Gt={fr_60_986:e=>(0,Wt.n1)(e),fr_60_987:e=>(0,Wt.n1)(e),us_40_02:e=>(0,Wt.n1)(e),us_40_60:e=>(0,Wt.n1)(e),us_40_69:e=>(0,Wt.n1)(e),us_40_15:e=>(0,Wt.f1)(e,Bt),pt_40_30:e=>(0,Wt.n1)(e),pt_40_20:e=>(0,Wt.n1)(e)};var jt=function(e){let{uid:t,source:r,configuration:n}=e;const{shapesTiles:o,shapesAttribution:l,isShapesLoading:i}=(0,ct.L7)(n.parameters.shapeSource),{data:s,options:c}=Xt({uid:t,source:r,configuration:n,shapes:o}),u=(0,ct.Xj)(n.parameters.shapeSource),d=(0,ct.Hq)(n.parameters.shapeSource),m=((e,t)=>{const r=(0,h.m)(),{geoEntities:n}=r.useGeoEntities(e),o=(0,a.useCallback)((e=>{const{code:r,level:n}=(0,Wt.E)(e.uid);return t?t===n?{key:r}:t<n?{key:(0,Wt.E)(e.parents[0][t].uid).code}:{}:{}}),[t]);return(0,a.useMemo)((()=>{if(e&&e.length)return e.map((e=>{const t=n[e],r=Gt[t?.uid];return t?{shapes:{type:"FeatureCollection",features:[{type:"Feature",geometry:r?r(t?.geom):t?.geom,properties:o(t)}]},label:t.name,bbox:Zt(t.uid)||(0,qt.A)(t.viewport)}:null})).filter((e=>Boolean(e)))}),[e,n,o])})(n.parameters.navigationMaps,n.parameters.shapeSource?.breakdown),{layer:f}=n.parameters?.shapeSource||{},y="world"===f?n.parameters?.bbox:null,g=(0,a.useMemo)((()=>c&&o?{...c,shapesTiles:o,bbox:n.parameters?.bbox,filter:u,attribution:l,tooltip:{...c.tooltip,labelMatcher:d},navigationMaps:m,fixedMaxBounds:y}:c),[o,u,l,c,d,m,y,n.parameters?.bbox]),b=s.loading||i,v=(0,st.A)((()=>g?a.createElement(p.jv,{options:g,data:s.value?{value:s.value}:{value:[{x:"0",y:0}]}}):null),b);return s.error?a.createElement(V,{error:s.error}):a.createElement(it.A,{isLoading:b,spinAfter:1e3,spinAtLeast:500,graceTimePlaceholder:v,aspectRatio:g?.aspectRatio},v)},Ht=r(5525);function Qt(e){if(!e||"string"!=typeof e)return{center:void 0,zoom:void 0};const t=e.split(",");return{zoom:parseFloat(t[0]),center:{lat:parseFloat(t[1]),lng:parseFloat(t[2])}}}var zt=r(77430),Kt=r(74837),er=r(58899);function tr(e){return Object.values(e.parameters?.layers||{}).some((e=>e.source&&e.popup&&e.query.field))}function rr(e){return e.length>1||!!e[0].value}function nr(e,t){const r=(0,W.V$)(e,5,t);return{color:r[1],accentColor:r[4]}}function ar(e,t,r){return`color:${e}--accent_color:${t}${r?`--icon:${r}`:""}`}const or=()=>window.devicePixelRatio>=2?2:1,lr={plainCircle:16,withIcon:24,forLegend:16},ir=e=>lr[e]*or(),sr=(e,t)=>({key:Nt,...e.reduce(((e,r)=>{const{value:n,color:a}=r,{color:o,accentColor:l}=nr(a,t);return e.colors[n]=o,e.borderColors[n]=l,e}),{colors:{},borderColors:{}})}),cr=(e,t)=>e.reduce(((e,r)=>{const{icon:n,value:a,color:o}=r,{color:l,accentColor:i}=nr(o,t);return e[a]=ar(l,i,n),e}),{}),ur=(e,t)=>({key:Nt,imageIds:cr(e,t)});var dr=r(58848);function mr(e){let{i18n:t,datasetId:r,datasetFields:n,layerId:o,popup:l,mapWidth:i,axios:s}=e;return{id:o,source:r,popup:{display:i>600?l?.type:q.on.modal,getContent:(e,o)=>(async(e,t,r,n,o,l)=>{const i=l?.[At],s=`${Ct.YU}/catalog/datasets/${n}/records/${i}`;let c;Ut[s]?c=Ut[s]:(({data:c}=await t.get(s)),Ut[s]=c);let u=null,d=null,m=null;if(r?.layout&&Mt[r.layout][xt]&&r?.titleField&&c?.[r?.titleField]&&(u=c?.[r?.titleField]),r?.layout&&Mt[r.layout][kt]&&r?.imageField&&c?.[r?.imageField])if("string"==typeof c?.[r?.imageField])try{const e=new URL(c?.[r?.imageField]);d=e.href}catch(e){console.warn(`Invalid URL for image field "${r?.imageField}": "${c?.[r?.imageField]}"`)}else["JPEG","GIF","PNG"].includes(c?.[r?.imageField].format)&&c?.[r?.imageField].url&&(d=c?.[r?.imageField].url);function p(){switch(r?.layout){case Ft.TitleOnly:return a.createElement(Rt,{title:u,marginTop:!1});case Ft.ContextOnly:return a.createElement(It,{contextFields:m,marginTop:!1});case Ft.TitleContext:return a.createElement(a.Fragment,null,a.createElement(Rt,{title:u,marginTop:!1}),a.createElement(It,{contextFields:m,marginTop:!0}));case Ft.TitleImage:return a.createElement(a.Fragment,null,a.createElement($t,{imageUrl:d}),a.createElement(Rt,{title:u,marginTop:!0}));case Ft.TitleContextImage:return a.createElement(a.Fragment,null,a.createElement($t,{imageUrl:d}),a.createElement(Rt,{title:u,marginTop:!0}),a.createElement(It,{contextFields:m,marginTop:!0}));default:return(0,_.d)(r?.layout)}}return r?.layout&&Mt[r.layout][St]&&r?.contextFields&&(m=r?.contextFields?.filter((e=>!!c?.[e.field])).map((e=>{const t=o?.find((t=>t.name===e.field));return{label:t?.label||e.field,value:t?Ot(t,c?.[e.field]):""}}))||null),u||d||m&&m.length?(0,ht.renderToStaticMarkup)(a.createElement(Tt,null,a.createElement(p,null))):(0,ht.renderToStaticMarkup)(a.createElement(Tt,null,a.createElement(Rt,{title:e.translate("No data"),marginTop:!1})))})(t,s,l,r,n,o),getLoadingContent:()=>function(e){return(0,ht.renderToStaticMarkup)(a.createElement(Tt,null,a.createElement(Rt,{title:e.translate("Loading..."),marginTop:!1})))}(t)}}}function pr(e,t){return e.categories.some((e=>!!e.icon))?function(e,t){const{categories:r}=e,n=r[0],{color:a,accentColor:o}=nr(n.color,t);return{...mr(e),type:"symbol",iconImageId:ar(a,o,n.icon),...rr(r)?{iconImageMatch:ur(r,t)}:null}}(e,t):function(e,t){const{categories:r}=e,n=r[0],{color:a,accentColor:o}=nr(n.color,t);return{...mr(e),type:"circle",color:a,borderColor:o,...rr(r)?{colorMatch:sr(r,t)}:null}}(e,t)}function fr(e,t){let{i18n:r,datasetId:n,datasetFields:a,categories:o,layerId:l,popup:i,axios:s,mapWidth:c}=e;return n?[pr({i18n:r,datasetId:n,datasetFields:a,categories:o,layerId:l,popup:i,axios:s,mapWidth:c},t)]:[]}const yr=e=>({type:"FeatureCollection",features:e.reduce(((e,t)=>{const{lon:r,lat:n}=t[Lt];if(void 0!==r&&void 0!==n){const a={type:"Point",coordinates:[r,n]},o=(0,dr.F)(t[Nt]);e.push({type:"Feature",geometry:a,properties:{[At]:t[At],...o&&{[Nt]:o}}})}return e}),[])});var gr=()=>{const{defaults:{baseURL:e=window.location.origin}}=(0,er.D)();return(0,a.useMemo)((()=>({getMarkerURL:t=>function(e){let{accentColor:t,color:r,origin:n,size:a,icon:o}=e;const l=encodeURI(r),i=encodeURI(t),s=new URL(o?`${n}/marker/${a}/circle/${o}.png`:`${n}/marker/${a}/circle.png`),c=new URLSearchParams(o?{icon_color:i,border_color:i,color:l}:{border_color:i,color:l});return s.search=c.toString(),s.href}({origin:e,...t})})),[e])},hr=function(e){const t=(0,d.d4)((e=>e.entities.domain.theme_colors)),{getMarkerURL:r}=gr(),{style:{categories:n}}=e?.[wt]||{};return(0,a.useMemo)((()=>{const e={};if(!n.some((e=>!!e.icon)))return{};const a={pixelRatio:or()};return n.forEach((n=>{const{icon:o,color:l}=n,{color:i,accentColor:s}=nr(l,t),c=ar(i,s,o),u=r({color:i,accentColor:s,icon:o,size:ir(o?"withIcon":"plainCircle")});e[c]={id:c,url:u,options:a}})),e}),[n,t,r])},br=e=>{let{uid:t,source:r,configuration:n,mapWidth:o}=e;const{i18n:l}=(0,a.useContext)(m.gJ),{dataProviders:i,verticalLayout:u,options:p,onBlockRender:b}=(0,c.F)(),v=r?i[r]:void 0,{styles:C,parameters:_,interactive:x}=n,{layers:S}=_,{basemap:k}=C,M=y(v),w=p?.enableImageExport,{zoom:D,center:A}=function(){const{"ui#cartograph#default_location":e}=(0,d.d4)((e=>e.entities.domain.properties));return{...Qt(e)}}(),{bbox:L,data:N,queries:P,loading:T,noSupportedShapes:R}=function(e){let{dataProvider:t,layers:r,mapWidth:n,isConfigurationValid:o}=e;const{i18n:l}=(0,a.useContext)(m.gJ),i=(0,d.d4)((e=>e.entities.domain.theme_colors)),c=(0,h.m)(),u=(0,er.D)(),{dataset:p}=c.useCatalogDataset2(t?.datasetId,l.shortLanguageCode),{query:y,popup:b,style:{categories:v}}=r?.[wt]||{},C=r?.[wt].uid,{getFilterValuesForDataProvider:_}=(0,s.$0)(),F=(0,a.useMemo)((()=>y?.conditions&&y.conditions.length>0?(0,ft.A)(y.conditions):""),[y]),x=(0,a.useCallback)((e=>{const{categoriesField:t}=y,r=(0,g.p_)(`recordid as ${At}`,`${y?.field} as ${Lt}`,t?`${t} as ${Nt}`:null),n=y?.field?`${y.field} is not null`:null,a=t?(0,g.xH)(...v.map((e=>e.value?(0,g.Fe)(t,e.value):null)).sort(((e,t)=>(e||"").localeCompare(t||"")))):null;return(0,f.ZF)(e,"json").select(r).where((0,g.Q7)(n,a,F))}),[v,y,F]),{data:S,queries:k}=E(t,y?.field?x:void 0,yr),M=_(t?.uid),{bbox:w,isLoading:D}=(0,Kt.F7)({datasetId:t?.datasetId,field:r[wt]?.query?.field,...M,where:(0,g.Q7)(M.where,F)}),{loading:A=!1}=S,L=D||A,N=(0,a.useMemo)((()=>!!(S.value&&S.value.features?.length>0)&&!S.value.features.some((e=>"Point"===e.geometry?.type))),[S]);return{bbox:w,data:(0,a.useMemo)((()=>!o||A?{value:{layers:[],sources:{}},loading:A}:{value:{layers:fr({i18n:l,datasetId:t?.datasetId,datasetFields:p?.fields,categories:v,layerId:C,popup:b,mapWidth:n,axios:u},i),sources:{[t?.datasetId]:{type:"geojson",data:S.value,generateId:!0}}},loading:A,error:S.error}),[o,A,l,t?.datasetId,p?.fields,v,C,b,n,u,i,S.value,S.error]),queries:k,loading:L,noSupportedShapes:N}}({dataProvider:v,layers:S,mapWidth:o,isConfigurationValid:tr(n)});Ae(t,N,P,b);const{style:I,minZoom:$,maxZoom:U,transformRequest:Y}=(0,zt.g2)(k)||{},{legend:X}=function(e){let{layers:t,styles:r}=e;const{i18n:n}=(0,a.useContext)(m.gJ),o=(0,d.d4)((e=>e.entities.domain.theme_colors)),{getMarkerURL:l}=gr(),i=(0,a.useMemo)((()=>r?.legendLabel||n.translate(F.iv)),[n,r?.legendLabel]),s=(0,a.useMemo)((()=>{const{style:{categories:e},source:r}=t?.[wt]||{};return r&&e?e.map((e=>{const{label:t,color:r,icon:a}=e,{color:i,accentColor:s}=nr(r,o);return function(e){let{label:t,color:r,accentColor:n,icon:a,getMarkerURL:o}=e;return a&&n?function(e,t){return{variant:"image",label:e,src:t}}(t,o({accentColor:n,color:r,icon:a,size:ir("forLegend")})):function(e,t,r){return{variant:"circle",label:e,color:t,borderColor:r}}(t,r,n)}({label:t||n.translate(Dt),color:i,accentColor:s,icon:a,getMarkerURL:l})})):null}),[n,t,o,l]);return{legend:(0,a.useMemo)((()=>{if(s)return{type:"category",title:i,items:s,align:"start"}}),[s,i])}}({layers:S,styles:C}),V=hr(S),q=(0,a.useMemo)((()=>(0,O.bJ)(C?.aspectRatio||gt,u)),[C?.aspectRatio,u]),W=(0,a.useMemo)((()=>C?.layout&&yt[C?.layout][O.Xn]?C?.title||l.translate(F.FE):void 0),[C?.layout,C?.title,l]),B=(0,a.useMemo)((()=>C?.layout&&yt[C?.layout][O.r3]?C?.subtitle||l.translate(F.LI):void 0),[C?.layout,C?.subtitle,l]),J=C?.description,Z=(0,ct.Jj)();return{data:N,options:(0,a.useMemo)((()=>({aspectRatio:q,interactive:x,...L?{bbox:L}:{zoom:D,center:A},title:W,subtitle:B,description:J,style:I,minZoom:$,maxZoom:U,transformRequest:Y,legend:X,sourceLink:M,images:V,cooperativeGestures:Z,preserveDrawingBuffer:w})),[q,L,A,Z,w,J,x,X,U,$,M,V,I,B,W,Y,D]),loading:T,noSupportedShapes:R}},vr=function(e){let{uid:t,source:r,configuration:n}=e;const{i18n:o}=(0,a.useContext)(m.gJ),l=(0,a.useRef)(null),{width:i}=(0,Ht.n)(l),{data:s,options:c,loading:u,noSupportedShapes:d}=br({uid:t,source:r,configuration:n,mapWidth:i}),f=(0,st.A)((()=>a.createElement(p.v6,{options:c,data:s})),u);return d&&!u?a.createElement("div",{style:{aspectRatio:c?.aspectRatio?.toString()}},a.createElement(lt.A,{withIcon:!0,variant:"critical"},o.translate("POI maps only support points, but the current data doesn't contain any."))):s.error?a.createElement(V,{error:s.error}):a.createElement("div",{className:"hOZeFQFPJjJ8qXK_PkQV",ref:l},a.createElement(it.A,{isLoading:u,spinAfter:1e3,spinAtLeast:500,graceTimePlaceholder:f,aspectRatio:c?.aspectRatio},f))},Cr=function(e){let{block:t}=e;const{configuration:r,source:n,uid:o}=t;switch(r.mapType){case F.BH.Choropleth.Local:return a.createElement(Vt,{uid:o,source:n,configuration:r});case F.BH.Choropleth.Georef:return a.createElement(jt,{uid:o,source:n,configuration:r});case F.BH.Poi:return a.createElement(vr,{uid:o,source:n,configuration:r});default:return null}},Er=function(e){let{block:t}=e;const{url:r,alt:n,fit:o}=t.configuration,i=l()("rods-studio__media",`rods-studio__media__fit--${o}`);return r?a.createElement("img",{className:i,src:r,alt:n}):null},_r=function(e){let{block:t}=e;const r=(0,a.useMemo)((()=>({align:t.configuration.align})),[t.configuration.align]),n=(0,a.useMemo)((()=>({value:t.configuration.content||""})),[t.configuration.content]);return a.createElement(p.Rb,{data:n,options:r})},Fr=r(12349),xr=r(9840),Sr=r(74711);const kr={text:"short-text",int:"number",double:"number",boolean:"boolean",datetime:"date",date:"date",geo_point_2d:"geo",geo_shape:"geo"},Mr=Object.keys(kr),wr={g:"gram",kg:"kilogram",oz:"ounce",lb:"pound",mm:"millimeter",cm:"centimeter",m:"meter",km:"kilometer",in:"inch",ft:"foot",mi:"mile",acre:"acre",ha:"hectare","°F":"fahrenheit","°C":"celsius",L:"liter","L/s":"liter-per-second","L/h":"liter-per-hour","g/L":"gram-per-liter",B:"byte",kB:"kilobyte",MB:"megabyte",GB:"gigabyte",TB:"terabyte",PB:"petabyte","m/s":"meter-per-second","km/s":"kilometer-per-second","km/h":"kilometer-per-hour",mph:"mile-per-hour","%":"percent","°":"degree"},Dr={"€":"EUR",$:"USD","£":"GBP",CAD:"CAD",CHF:"CHF",MXN:"MXN",SAR:"SAR",XPF:"XPF"},Ar=[{minute:"numeric"},{hour:"numeric"},{weekday:"short"},{day:"numeric"},{month:"long"},{year:"numeric"}],Lr=[5,10,15,20,25],Nr=e=>({totalCount:e.total_count||0,data:e.results??[]});var Pr=r(8904);const Tr=e=>{const t=e?.type;return!!t&&Mr.includes(t)},Rr={[Et.y7.Minute]:0,[Et.y7.Hour]:1,[Et.y7.Day]:2,[Et.y7.Month]:4,[Et.y7.Year]:5},Ir=e=>{const t=(0,Et.le)(e);if(t)return{intl:Ar.slice(Rr[t]).reduce(((e,t)=>({...e,...t})),{})}},$r=e=>{const t=e.annotations?.unit;if(t)return wr[t]?{intl:{style:"unit",unitDisplay:"short",unit:wr[t]}}:Dr[t]?{intl:{style:"currency",currencyDisplay:"symbol",currency:Dr[t]}}:{display:e=>`${e} ${t}`}},Or=e=>{let{field:t,basemapStyle:r,geoFeatureColor:n,bbox:a}=e;const o={...r,interactive:!1,...a?{bbox:a}:null};switch(t?.type){case"geo_point_2d":return{mapOptions:o,display:e=>`${e.lat},${e.lon}`,layers:()=>[{id:"table-layer",source:"table-source",type:"circle",color:n,borderColor:"white"}],sources:e=>({"table-source":{type:"geojson",data:{type:"FeatureCollection",features:[{id:1,type:"Feature",geometry:{type:"Point",coordinates:[e.lon,e.lat]}}]}}})};case"geo_shape":return{mapOptions:o,display:e=>`${JSON.stringify(e.geometry).substring(0,30)}...`,layers:()=>[{id:"table-layer",source:"table-source",type:"fill",color:n,borderColor:"white",opacity:.6}],sources:e=>({"table-source":{type:"geojson",data:{type:"FeatureCollection",features:[e]}}})};default:return}};const Ur="UPDATE_PAGE",Yr="UPDATE_SORT",Xr="UPDATE_SEARCH_QUERY",Vr="UPDATE_RECORDS_PER_PAGE",qr="RESET",Wr={page:1,recordsPerPage:Lr[0],sorted:{key:"",dir:q.zU.asc},searchQuery:"",dataProviderUid:void 0},Br=(e,t)=>{let{key:r,dir:n}=t;return{dir:n||(e.key===r&&e.dir===q.zU.asc?q.zU.desc:q.zU.asc),key:r}},Jr=(e,t)=>{switch(t.type){case Ur:return{...e,page:t.payload};case Yr:return{...e,page:1,sorted:Br(e.sorted,t.payload)};case Xr:return{...e,page:1,searchQuery:t.payload};case Vr:return{...e,page:1,recordsPerPage:t.payload};case"UPDATE_SEARCH":return{...e,searchQuery:t.payload};case qr:return{...Wr,dataProviderUid:t.payload};default:return e}};var Zr=e=>{let{dataProvider:t,configuration:r,blockUID:n}=e;const[o,l]=(0,a.useState)(null),{i18n:i}=(0,a.useContext)(m.gJ),{state:{page:c,sorted:u,recordsPerPage:d,searchQuery:p},actions:{updatePage:h,updateRecordsPerPage:b,updateSort:v,updateSearch:C}}=(e=>{let{configuration:t,dataProviderUid:r}=e;const{parameters:{perPage:n,defaultSort:o}}=t,[l,i]=(0,a.useReducer)(Jr,{...Wr,recordsPerPage:n,dataProviderUid:r});l.dataProviderUid&&l.dataProviderUid!==r&&i({type:qr,payload:r});const s=e=>{i({type:Vr,payload:e})};return(0,a.useEffect)((()=>{i({type:Yr,payload:o||Wr.sorted})}),[o]),(0,a.useEffect)((()=>{s(n)}),[n]),{state:l,actions:{updatePage:e=>{i({type:Ur,payload:e})},updateRecordsPerPage:s,updateSort:e=>{e&&i({type:Yr,payload:{key:e}})},updateSearch:e=>{i({type:Xr,payload:e})}}}})({configuration:r,dataProviderUid:t?.uid}),{getFilterValuesForDataProvider:_}=(0,s.$0)(),F=(0,a.useMemo)((()=>_(t?.uid)),[t?.uid,_]),x=(0,Fr.A)(F);(0,a.useEffect)((()=>{x&&x!==F&&h(1)}),[F,x,h]);const{data:S,queries:k,options:{totalCount:M}}=function(e){let{dataProvider:t,configuration:r,page:n,recordsPerPage:o,sorted:l,searchQuery:i}=e;const s=(0,a.useCallback)((e=>{const{parameters:{conditions:t=[],columns:a}}=r;let s=(0,f.sN)(e).where((e=>(0,g.Q7)(e,t?.length?(0,ft.A)(t):""))).limit(o).offset((n-1)*o);if(a){const e=a.filter((e=>""!==e.field)).map((e=>(0,g.ZZ)(e.field))).join(",");s=s.select(e)}return l.key&&(s=s.orderBy(`${l.key} ${l.dir}`)),i&&(s=s.where((e=>(0,g.Q7)(e,(0,g.Yj)(i))))),s}),[r,o,n,l.key,l.dir,i]),{data:c,queries:u}=E(t,s,Nr),{loading:d,value:m,error:p}=c;return{data:(0,a.useMemo)((()=>({value:m?.data,loading:d,error:p})),[p,d,m?.data]),queries:u,options:{totalCount:m?.totalCount}}}({dataProvider:t,configuration:r,page:c,recordsPerPage:d,sorted:u,searchQuery:p}),w=(e=>{let{datasetId:t,colParams:r,sort:n}=e;const{i18n:o}=(0,a.useContext)(m.gJ),l=(0,zt._x)(),i=(0,zt.g2)(l[0].id),{dataset:s}=(0,Kt.d5)({datasetId:t,language:o.shortLanguageCode}),c=(0,a.useMemo)((()=>s&&s.metas.default.bbox?(0,qt.A)(s?.metas.default.bbox):null),[s]),u=((e,t)=>{if(!t)return[];const r=[];return e?.length?(e.forEach((e=>{const n=t?.fields?.find((t=>e.field===t.name));n&&r.push(n)})),r):t.fields})(r,s),{"--front-office__domain-theme-color__identity-palette-3":d}=(0,Pr.N)(),p=u.filter(Tr).map((e=>{let{sort:t,i18n:r,basemapStyle:n,bbox:a,geoFeatureColor:o}=e;return e=>{const l=Tr(e)?kr[e.type]:kr.text,i={key:e?.name||"",title:e?.label||"",dataFormat:l};switch((e=>"text"===e?.type||"int"===e?.type||"double"===e?.type||"date"===e?.type||"datetime"===e?.type)(e)&&(i.onClick=()=>t.onClick(e?.name),i.sortLabels={asc:r.translate("Sort ascending"),desc:r.translate("Sort descending")}),e?.name===t.key&&(i.sorted=t.dir),l){case"date":return{...i,dataFormat:l,options:Ir(e)};case"number":return{...i,dataFormat:l,options:$r(e)};case"geo":return{...i,dataFormat:l,options:Or({field:e,basemapStyle:n,geoFeatureColor:o,bbox:a})};default:return i}}})({sort:n,i18n:o,basemapStyle:i,bbox:c,geoFeatureColor:d}));return p})({datasetId:t?.datasetId||"",colParams:r.parameters?.columns,sort:{...u,onClick:v}}),D=y(t),A=Lr.map((e=>({value:e,label:i.translate("{records} / page",{records:e.toString()})}))),L=1e4-1e4%d;(0,a.useEffect)((()=>{!S.loading&&S.value&&(0,xr.QH)(xr.$0.STUDIO_TABLE_BLOCK_INTERACTION,{blockUID:n,datasetId:t?.datasetId,datasetTotalRecords:M,recordsPerPage:d,currentPage:c})}),[S]),"number"==typeof M&&M!==o&&l(M);const N=r?.styles?.layout&&(0,Sr.$$)(r?.styles?.layout)?r.styles.layout:Sr.Ay.TitleAndSearch,P=(0,Sr.P)(N),T=(0,a.useMemo)((()=>({locale:i.languageCode,emptyStateLabel:i.translate("No records"),columns:w,source:D,...r.styles,pagination:o?{current:c,totalRecords:Math.min(o,L),recordsPerPage:d,onPageChange:h,labels:{previousPage:i.translate("Go to previous page"),nextPage:i.translate("Go to next page"),firstPage:i.translate("Go to first page"),lastPage:i.translate("Go to last page"),records:o>L?i.translate("records displayed"):i.translate("records")},pageSizeSelect:{onChange:b,options:A}}:void 0})),[i,w,D,r.styles,o,c,d,h,b,A,L]);return{data:S,queries:k,options:T,updateSearch:C,hasSearch:P}},Gr=r(19692),jr=r(75132),Hr=r.n(jr),Qr=function(e){let{updateSearch:t}=e;const{i18n:r}=(0,a.useContext)(m.gJ),{value:n,handleChange:o,handleClear:l}=function(e){let{onChange:t,delay:r=500,nullValue:n}=e;const[o,l]=(0,a.useState)(n),i=(0,a.useMemo)((()=>Hr()(t,r)),[t,r]),s=(0,a.useCallback)((e=>{l(e),i(e)}),[i,l]),c=(0,a.useCallback)((()=>{l(n),t(n)}),[l,t,n]);return(0,a.useMemo)((()=>({value:o,handleChange:s,handleClear:c})),[o,s,c])}({onChange:t,delay:500,nullValue:""});return a.createElement(Gr.A,{className:"DtaQ3k7hae0q7iGgQgBk",label:r.translate("Search records"),value:n,onChange:o,onClear:l})},zr=function(e){let{block:t}=e;const r=(0,c.F)(),n=r.dataProviders[t.source],{data:o,queries:i,options:{title:s,subtitle:u,...d},updateSearch:m,hasSearch:f}=Zr({dataProvider:n,configuration:t.configuration,blockUID:t.uid});return Ae(t.uid,o,i,r.onBlockRender),a.createElement("div",{className:l()("rEYitSDnPEY6Gfd9Sjxg",{aSmiGWCA2ToauQwrEbNS:f})},!!s&&a.createElement("div",{className:"bms9yxNx1uN16qGjnrxg"},a.createElement("h3",null,s),!!u&&a.createElement("p",null,u)),f&&a.createElement(Qr,{updateSearch:m}),a.createElement(p.XI,{data:o,options:d}))},Kr=r(38094);function en(e){let{className:t,children:r}=e;return a.createElement("div",{className:t},r)}var tn=function(e){let{block:t,width:r}=e;const{blockWrapper:n}=(0,c.F)(),o=l()("rods-page-renderer__block",`rods-page-renderer__block--width-${r}`,{[`rods-page-renderer__block--type-${t.type}`]:!!t.type}),i=n||en,s=function(e,t){switch(e.type){case u._.Chart:return a.createElement(Ne,{block:e,width:t});case u._.Kpi:return a.createElement(ot,{block:e});case u._.Text:return a.createElement(_r,{block:e});case u._.Media:return a.createElement(Er,{block:e});case u._.Map:return a.createElement(Cr,{block:e});case u._.Table:return a.createElement(zr,{block:e});default:return null}}(t,r);return a.createElement(Kr.A,{name:`${t.type} : ${t.uid}`},a.createElement(i,{className:o,block:t,width:r},s))},rn=function(e){let{blocks:t}=e;const r=(0,c.F)();return a.createElement(a.Fragment,null,t.map((e=>{let{uid:n}=e;const o=r.blocks[n];return o&&a.createElement(tn,{key:n,block:o,width:12/t.length})})))},nn=r(95851);function an(e){let{className:t,children:r,section:n}=e;const{filters:o,verticalLayout:l}=(0,c.F)();return n.type!==u.g.Filters||0!==o.layout.length&&!l?a.createElement("div",{className:t},r):null}var on=function(e){let{...t}=e;const{sectionWrapper:r}=(0,c.F)(),n=l()("rods-page-renderer__section",t.type===u.g.Content&&`rods-page-renderer__section--blocks-${t.blocks.length}`,t.type===u.g.Filters&&"rods-page-renderer__section--filters"),o=r||an;switch(t.type){case u.g.Content:return a.createElement(o,{className:n,section:t},a.createElement(rn,t));case u.g.Filters:return a.createElement(o,{className:n,section:t},a.createElement(nn.A,null));default:return null}},ln=r(24817),sn=r(93360),cn=r(46073),un=r(63451),dn=r(39040),mn=r(80790),pn=r.n(mn),fn=r(43624),yn=r(81713),gn=r.n(yn),hn=r(6053);const bn=parseInt("300",10);function vn(e){let{children:t,in:r,useVisibility:o,...i}=e;return a.createElement(dn.A,(0,n.A)({in:r,timeout:bn,appear:!0,classNames:"rods-fade"},i),((e,n)=>{const i="exited"===e&&!r,s=o?{visibility:i?"hidden":void 0}:{display:i?"none":void 0};return a.cloneElement(a.Children.only(t),{...n,style:{...t.props.style,...n.style,...s},className:l()("rods-fade",n.className,t.props.className)})}))}vn.propTypes={children:gn().element.isRequired,in:gn().bool,useVisibility:gn().bool},vn.defaultProps={in:!1,useVisibility:!1};var Cn=vn,En=r(68246);function _n(e){let{isOpen:t,children:r,overlayId:o,selectPortalParent:i,onClick:s,usePortal:c,className:u,ariaDisabledSelectors:d,...m}=e;const p=(0,a.useCallback)((e=>{e&&e.target.className&&pn()(e.target.className)&&e.target.className.includes("rods-backdrop")&&(e.stopPropagation(),s&&s())}),[s]),f=(0,En.Sw)();(0,a.useEffect)((()=>{if(!f||!d)return;const e=Array.isArray(d)?d:[d];return e.forEach((e=>{document.querySelectorAll(e).forEach((e=>{e.setAttribute("aria-disabled",t),e.setAttribute("aria-hidden",t)}))})),()=>{e.forEach((e=>{document.querySelectorAll(e).forEach((e=>{e.removeAttribute("aria-disabled"),e.removeAttribute("aria-hidden")}))}))}}),[f,d,t]);const y=a.createElement(Cn,(0,n.A)({in:t},m),a.createElement("div",{"data-testid":"backdrop",className:l()("rods-backdrop",u),onClick:p,onKeyDown:p},r));if(c){const e=(0,hn.A)(o,i);return(0,fn.createPortal)(y,e)}return y}_n.propTypes={children:gn().node,overlayId:gn().string,isOpen:gn().bool,usePortal:gn().bool,selectPortalParent:gn().func,className:gn().string,onClick:gn().func,ariaDisabledSelectors:gn().oneOfType([gn().string,gn().arrayOf(gn().string)])},_n.defaultProps={usePortal:!1,className:null,isOpen:!1,children:null,selectPortalParent:()=>(0,En.Sw)()&&document.body||null,onClick:null,overlayId:"rods-overlay",ariaDisabledSelectors:null};const Fn=_n;function xn(){document.body.style.overflow="unset"}var Sn=function(e){let{isOpen:t,children:r,onRequestClose:n}=e;const o=(0,a.useRef)(null);return(0,a.useEffect)((()=>(t?document.body.style.overflow="hidden":xn(),xn)),[t]),a.createElement(Fn,{onClick:n,isOpen:t,className:"ZJlMmcqjywKy6LEFiiN7",ariaDisabledSelectors:["main","header"]},a.createElement(dn.A,{nodeRef:o,in:t,timeout:200,classNames:"rods-studio__mobile-filters"},a.createElement("div",{ref:o,className:"VIsK1dmkJu9SNJEiJf1C"},r)))};const kn="down";var Mn=function(e){let{children:t,className:r}=e;const{scrollDirection:n}=function(e,t){const[r,n]=(0,a.useState)(0),[o,l]=(0,a.useState)(null),i=t?.current||document,s=t?.current||document.documentElement;return(0,a.useEffect)((()=>{const t=()=>{const{scrollTop:t}=s;Math.abs(r-t)>e&&(l(r<t?kn:"up"),n(t))};return i.addEventListener("scroll",t),()=>i.removeEventListener("scroll",t)}),[r,i,s,e]),{scrollDirection:o}}(10),[o,i]=(0,a.useState)(!1);(0,a.useEffect)((()=>{"up"===n&&i(!1),n===kn&&i(!0)}),[n,i]);const s=l()(r,{nQvaI9nFU_fUCUEnPY_e:o});return a.createElement("div",{className:s},t)},wn=r(89666),Dn=r(19645),An=r(63188),Ln=r(34142),Nn={fontSizeBase:"16px",identity100:"#00c7b1",identity200:"#142e7b",identity201:"#f2f3f8",identity203:"#c6cbde",identity204:"#6c7aaa",identity300:"#0f79d0",light100:"#fff",light200:"#f6f8fb",light300:"#dee5ef",light400:"#cbd2db",light500:"#898d92",light600:"#565656",light700:"#000",extra710:"#94153c",colorCritical:"#ce0037",borderRadius4:"4px",spacing50:"6px",spacing100:"13px",breakpointXL:"1200px",container:"np5rpQRg4yAUAANjEFNV",menu:"gJb2y3gW3o1dJ_VToJHQ",menuList:"xxp24aGDxm8QSchu_ek_",innerMenu:"VaCmShUE7VjhgY3HUWUE",footer:"VVXERYDiZvPBC4ljopMY",searchPlaceHolder:"veEOtl_If__szDazALHX",actions:"IpljvcdpPwOEXhhfpWyQ",input:"_78MKjSDMll8T4BjGZIvA",mobileSearch:"N0Qw0ukA6_S_f9MD209w",inactive:"e0bxsNeT2NIlN6PZHEtY",isClosed:"vp5dCcnvQiW_pOdHrEIH",fitHeight:"wIsVO7CWe7uWPFAXmcV9",highlight:"PzKCUtyv4cTLRqJEA2xB",hidden:"kYPkAhmZ5Z6efME8YsIz",noLabel:"qgPEBN_ohMoE_hDZkOfl",noShadow:"E3uor7QcTA02rCX_Wz5E",showClear:"OgJcYAzuLuaHSLUmmYrb",indicator:"p8gk2MvLkdG5t4WGLW0l"};const Pn=e=>{const{selectProps:{menuIsOpen:t,inputValue:r}}=e;return t&&Boolean(!r)};var Tn={container:()=>l()(Nn.container),control:e=>l()({[Nn.noShadow]:e.menuIsOpen&&!e.isFocused||!e.menuIsOpen,[Nn.mobileSearch]:e.menuIsOpen,[Nn.hidden]:e.menuIsOpen&&!e.selectProps.isSearchable,[Nn.highlight]:e.isFocused,[Nn.noLabel]:e.menuIsOpen,[Nn.inactive]:!e.isFocused,[Nn.isClosed]:!e.selectProps.menuIsOpen,"rods-advanced-select__control--focus":e.hasValue||Pn(e),"rods-select-filter-mobile":!0}),valueContainer:e=>l()({[Nn.fitHeight]:e.selectProps.menuIsOpen}),indicatorsContainer:e=>l()({[Nn.fitHeight]:e.selectProps.menuIsOpen}),clearIndicator:e=>l()({[Nn.showClear]:e.hasValue,[Nn.hidden]:e.selectProps.menuIsOpen}),dropdownIndicator:e=>l()({[Nn.hidden]:e.hasValue||Pn(e)}),menu:()=>l()(Nn.menu,Nn.noShadow),menuList:()=>l()(Nn.menuList),option:()=>l()(Nn.noShadow),input:e=>l()({[Nn.hidden]:!e.selectProps.menuIsOpen})},Rn=r(90520);function In(e){let{children:t,...r}=e;const{selectProps:{menuIsOpen:n,value:o,isMulti:l}}=r,i=(0,Ln.JM)(o),[,s]=t,c=l?n?s:i:t;return a.createElement(Rn.c.ValueContainer,r,c)}function $n(e){const{i18n:t}=(0,a.useContext)(m.gJ),{children:r,isFocused:n}=e;return a.createElement(Rn.c.Control,e,!n&&a.createElement("div",{className:Nn.searchPlaceHolder},t.translate("Search a value")),r)}const{Control:On}=Ln.components;function Un(e){const{menuIsOpen:t}=e;return t?a.createElement($n,e):a.createElement(On,e)}var Yn="ZMBe3RMMNZdEvBtTmyGQ";const{Header:Xn,ResetButton:Vn,ViewOnlySelectedButton:qn,useFooter:Wn}=Ln.Menu;function Bn(e){let{onValidate:t,onCancel:r,...n}=e;const{resetButtonProps:o,viewOnlySelectedButtonProps:l}=Wn(n);return a.createElement("div",{className:Nn.footer},a.createElement("div",{className:Nn.actions},a.createElement(Vn,o),a.createElement(qn,l)),a.createElement(sn.Ay,{className:Yn,variant:"primary",onClick:t},a.createElement(U.A,{translationKey:"Validate"})))}var Jn=function(e){const{children:t,selectProps:{isMulti:r,onValidate:o,onCancel:l}}=e;return a.createElement(Rn.c.Menu,e,a.createElement(Xn,e),a.createElement("div",{className:Nn.options},t),r&&o&&l?a.createElement(Bn,(0,n.A)({},e,{onValidate:o,onCancel:l})):null)};function Zn(e){let{isOpen:t=!1,closeFilter:r,...o}=e;const{value:i}=o,[s,c]=(0,a.useState)(i||null),{onChange:u,placeholder:d,...m}=(0,Ln.WM)(o),{isMulti:p,isSearchable:f}=o,y=p?e=>{c(e),t||u(e)}:e=>{u(e),r()},g={...Ln.components,Menu:Jn,ValueContainer:In,Control:Un},h={...m,menuIsOpen:t,interactive:t,isClearable:!0,onChange:y,blurInputOnSelect:!0,onValidate:()=>{u(s),r()},onCancel:r};return a.createElement(An.Ay,(0,n.A)({},h,{value:s,components:g,placeholder:f?null:d,classNames:Tn,className:l()("rods-advanced-select","rods-advanced-select-input-filter")}))}var Gn=r(97006);function jn(e){let{closeFilter:t,onClear:r,onValidate:n}=e;return a.createElement("div",{className:"ge4KlGnYXp5c9DQmnIe6"},a.createElement(sn.Ay,{variant:"tertiary",onClick:r},a.createElement(U.A,{translationKey:"Clear"})),a.createElement("div",null,a.createElement(sn.Ay,{variant:"tertiary",onClick:t},a.createElement(U.A,{translationKey:"Cancel"})),a.createElement(sn.Ay,{variant:"primary",onClick:n},a.createElement(U.A,{translationKey:"Apply"}))))}function Hn(e){let{filter:t,isOpen:r,closeFilter:o,handleFilter:l,value:i}=e;const s=function(e){let{isOpen:t,closeFilter:r=(()=>{})}=e;return function(e){return a.createElement(Zn,(0,n.A)({},e,{closeFilter:r,isOpen:t,className:"rods-advanced-select-input-filter"}))}}({isOpen:r,closeFilter:o});return a.createElement(wn.Ay,{filter:t,handleFilter:l,value:i,as:s})}function Qn(e){let{filter:t,isOpen:r,closeFilter:o,handleFilter:l,value:i}=e;const s=function(e){let{isOpen:t,value:r,handleFilter:o,closeFilter:l=(()=>{}),clearValue:i=(()=>{})}=e;return function(e){const[s,c]=(0,a.useState)(r),{inputValue:u,onChange:d}=(0,Dn.v5)({value:s,handleChange:c});return a.createElement(a.Fragment,null,a.createElement(Gn.A,(0,n.A)({},e,{value:u,onChange:e=>{null===e?.from&&null===e?.to&&i(),d(e)},alwaysShowClearButton:!t,inline:t,className:t?"i_oeV3NlTux5pprBS9DW":"tcWcrosEwZlm2xSxDthW",readonly:!0})),t?a.createElement(jn,{onValidate:()=>{o(s),l()},closeFilter:l,onClear:()=>{d({from:null,to:null})}}):null)}}({isOpen:r,closeFilter:o,clearValue:()=>l(null),value:i,handleFilter:l});return a.createElement(Dn.Ay,{filter:t,handleFilter:l,value:i,as:s})}function zn(e){let{filter:t,isOpen:r,closeFilter:n}=e;const{uid:o,type:l}=t,{filterValues:i,setFilterValue:c}=(0,un.$0)(),u=(0,a.useCallback)((e=>{c(o,e)}),[c,o]),d=i[o];switch(l){case s.RJ.Select:return a.createElement(Hn,{filter:t,value:d,handleFilter:u,closeFilter:n,isOpen:r});case s.RJ.Date:return a.createElement(Qn,{filter:t,value:d,handleFilter:u,closeFilter:n,isOpen:r});default:return(0,_.d)(l)}}const Kn=sn.Ay;var ea=function(){const{clearAllValues:e,isFiltered:t}=(0,un.$0)(),r=l()("qz2Si0KiwzJ7TsZcQyXY",{OU1hgGmeUnVLZyryIWqU:!t});return a.createElement(Kn,{className:r,variant:null,onClick:e,disabled:!t},a.createElement(U.A,{translationKey:"Clear all"}))},ta=r(46601);const ra=sn.V3;function na(e){let{filter:t,openFilter:r}=e;const n=(0,ta.A)(t);return a.createElement("div",{className:"jDqA5ncswJoBMEwnrmzk",onClick:()=>r(t.uid),role:"button","aria-label":n},a.createElement(zn,{filter:t,isOpen:!1}))}var aa=function(e){let{onRequestClose:t,openFilter:r,filterList:n}=e;return a.createElement(a.Fragment,null,a.createElement("div",{className:"c3WCOw9QayEQbOs612wS"},n.map((e=>a.createElement(na,{key:e.uid,filter:e,openFilter:r})))),a.createElement("div",{className:"dyLxcowaLjWVQtw1Mltp"},a.createElement("div",null,a.createElement(ea,null)),a.createElement("div",null,a.createElement(ra,{icon:a.createElement(ln.USm,null),iconSide:"left",className:Yn,variant:"primary",onClick:t},a.createElement(U.A,{translationKey:"Close"}))),a.createElement("div",null)))},oa=function(e){let{onRequestClose:t=(()=>{}),filter:r}=e;const n=(0,ta.A)(r);return a.createElement(a.Fragment,null,a.createElement("div",{className:"ECrrMi3XzaHr8ugfcux2"},a.createElement("h3",null,n),a.createElement(sn.K0,{onClick:t,size:"100"},a.createElement(ln.USm,null))),a.createElement(zn,{filter:r,closeFilter:t,isOpen:!0}))};const la=sn.V3;function ia(e){let{onClick:t}=e;const{i18n:r}=(0,a.useContext)(m.gJ),{activeFiltersNumber:n}=(0,un.$0)(),o=n>0?r.translate("Filters ({activeFiltersNumber})",{activeFiltersNumber:n}):"Filters";return a.createElement(la,{icon:a.createElement(ln.ImQ,null),iconSide:"left",className:Yn,variant:"primary",onClick:t},o)}function sa(e){let{activeFilter:t,filterList:r,closeFilter:n,openFilter:o,onRequestClose:l}=e;return t?a.createElement(oa,{filter:t,onRequestClose:n}):a.createElement(aa,{onRequestClose:l,openFilter:o,filterList:r})}var ca=function(){const{filters:e}=(0,c.F)(),[t,,r,n]=(0,cn.A)(!1),{activeFilter:o,openFilter:l,closeFilter:i}=function(){const{filters:e}=(0,c.F)(),[t,r]=(0,a.useState)();return{activeFilter:t,openFilter:(0,a.useCallback)((t=>{const n=e.layout.find((e=>t=>t.uid===e)(t));n&&r(n)}),[e.layout]),closeFilter:()=>{r(void 0)}}}();return a.createElement(a.Fragment,null,a.createElement(Mn,{className:"aWnDVZXcjSHmUHWRQDJK"},a.createElement(ia,{onClick:r})),a.createElement(Sn,{isOpen:t,onRequestClose:()=>{n(),i()}},a.createElement("div",{className:"nPaafJxICXLxf7L2fZqt"},a.createElement(sa,{activeFilter:o,filterList:e.layout,openFilter:l,closeFilter:i,onRequestClose:n}))))},ua=function(e){let{blocks:t,filters:r,layout:o,dataProviders:u,sectionWrapper:d,blockWrapper:m,filterWrapper:p,options:f,className:y="",onBlockRender:g}=e;const h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{hideSourceLink:!1,hideMobileFilters:!1,enableImageExport:!1,...e}}(f),b=(0,s.G_)(r),v=(0,i.A)(parseInt("992px",10)),C=!h.hideMobileFilters&&v&&r.layout.length>0,E=(0,a.useMemo)((()=>({blocks:t,filters:r,layout:o,dataProviders:u,sectionWrapper:d,blockWrapper:m,filterWrapper:p,verticalLayout:v,options:h,onBlockRender:g})),[t,r,o,u,d,m,p,v,h,g]);return a.createElement(c.Z,{value:E},a.createElement(s.$D,{value:b},a.createElement("div",{className:l()("rods-page-renderer__container",y)},o.map((e=>a.createElement(on,(0,n.A)({key:e.uid},e)))),C&&a.createElement(ca,null))))}},1614:function(e,t,r){r.d(t,{HB:function(){return m},Hq:function(){return y},Jj:function(){return g},L7:function(){return p},Xj:function(){return f}});var n=r(41481),a=r(77981),o=r(60546),l=r(87419),i=r(23706),s=r(96136),c=r(58848),u=r(74983);const d=e=>{const{properties:t}=e,r=(0,c.F)(e?.properties?.key),n=(0,c.F)(e?.properties?.label)||r;return{...e,properties:{...t,label:n,key:r}}},m=e=>{let{datasetId:t,shapeKey:r,shapeName:a}=e;const{i18n:l}=(0,n.useContext)(i.gJ),{featureCollection:c,isShapesLoading:u}=(e=>{let{datasetId:t,shapeKey:r,shapeName:n}=e;const a=(0,s.m)();let l=t?(0,o.GC)().dataset(t).export(o.A4.GEOJSON).select("exclude(*)"):void 0;r&&l&&(l=l.select(`${(0,o.ZZ)(r)} as key`)),r&&n&&l&&(l=l.select((e=>n&&n!==r?`${e}, ${(0,o.ZZ)(n)} as label`:e)));const{data:i,isValidating:c,error:u}=a.useExploreApi(l);return{featureCollection:i,isShapesLoading:Boolean(l&&(!i&&!u||c))}})({datasetId:t,shapeKey:r,shapeName:a}),m=(0,n.useMemo)((()=>{const e=(e=>{if(e)return{...e,features:e.features.map(d)}})(c);return a?e:(e=>{let{shapes:t,property:r,value:n}=e;if(t?.features){const{features:e}=t;return{type:"FeatureCollection",features:e.map((e=>({...e,properties:{...e.properties,[r]:n}})))}}return t})({shapes:e,property:"label",value:l.translate("Shape name")})}),[a,c,l]);return(0,n.useMemo)((()=>({shapes:m,isShapesLoading:u})),[m,u])},p=e=>{const t=(0,a.d4)((e=>e.entities.vectorTilesReference)),{shapesAttribution:r,shapesTiles:o}=(0,n.useMemo)((()=>{const{layer:r,breakdown:n}=e||{};if(r&&n){const e=(0,u.LF)(t,r,n),{url:a,layer:o,key:l,attribution:i}=e;return{shapesTiles:{url:a,layer:o,key:l,minZoom:0,maxZoom:9},shapesAttribution:i}}return{}}),[e,t]);return{shapesTiles:o,shapesAttribution:r,isShapesLoading:!e?.breakdown||!e?.layer}},f=e=>{const t=(0,a.d4)((e=>e.entities.vectorTilesReference));if(e?.layer){const{level:r,code:n}=(0,u.E)(e.layer),{key:a}=(0,u.LF)(t,e?.layer,r)||{};return a&&n?{key:a,value:[n]}:void 0}},y=e=>{const t=(0,a.d4)((e=>e.entities.vectorTilesReference));return(0,n.useMemo)((()=>{if(!e?.layer||!e?.breakdown)return;const{country:r}=(0,u.E)(e.layer),{countries:n}=t;return n?.[r]?.[e.breakdown]?.label?{type:l.DT.KeyProperty,key:n[r][e.breakdown].label}:void 0}),[t,e])},g=()=>{const{i18n:e}=(0,n.useContext)(i.gJ);return(0,n.useMemo)((()=>({windowsHelpText:e.translate("Use Ctrl + scroll to zoom the map"),macHelpText:e.translate("Use ⌘ + scroll to zoom the map"),mobileHelpText:e.translate("Use 2 fingers to move the map")})),[e])}},58848:function(e,t,r){function n(e){return Array.isArray(e)?e[0]:e}r.d(t,{F:function(){return n}})},29193:function(e,t,r){r.d(t,{G6:function(){return c},Hp:function(){return s},Ih:function(){return y},Ix:function(){return l},Qe:function(){return C},Ro:function(){return h},WC:function(){return m},Wk:function(){return b},XF:function(){return _},Xn:function(){return a},an:function(){return u},bJ:function(){return F},gl:function(){return E},j5:function(){return v},nU:function(){return g},r$:function(){return p},r3:function(){return o},rp:function(){return d},wT:function(){return i},yy:function(){return f}});var n=r(88151);const a="title_top",o="subtitle",l="legend",i="legend_left",s="legend_right",c="legend_with_values",u="axis_x_title",d="axis_y_title",m="axis_y",p="grid_y",f="grid_r",y="ticks_r",g="no_dots",h="data_labels",b="data_labels_with_xy",v="data_labels_with_x",C="search_input";let E=function(e){return e.Original="original",e.OneToOne="1-1",e.SixteenToNine="16-9",e.TwentyOneToNine="21-9",e.NineToSixteen="9-16",e}({});function _(e,t){if(t)return 1;switch(e){case 3:return 1;case 4:return 4/3;case 6:return 16/9;case 12:return 2.5;default:return 2}}function F(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E.Original,t=arguments.length>1?arguments[1]:void 0;if(t)return 1;switch(e){case E.Original:case E.OneToOne:return 1;case E.SixteenToNine:return 16/9;case E.TwentyOneToNine:return 21/9;case E.NineToSixteen:return 9/16;default:return(0,n.d)(e)}}E.Original,E.OneToOne,E.SixteenToNine,E.TwentyOneToNine,E.NineToSixteen},76997:function(e,t,r){r.d(t,{UF:function(){return m},ZF:function(){return d},sN:function(){return u},ze:function(){return p}});var n=r(60546),a=r(79259),o=r(45497),l=r(22392);function i(e,t){switch(e){case l.y7.Year:return`date_format(${t}, 'YYYY')`;case l.y7.Month:return`date_format(${t}, 'YYYY-MM')`;case l.y7.Day:return`date_format(${t}, 'YYYY-MM-dd')`;case l.y7.Hour:return`date_format(${t}, "YYYY-MM-dd'T'HH:'00'")`;case l.y7.Minute:return`date_format(${t}, "YYYY-MM-dd'T'HH:mm")`;default:throw new Error(`Unknown timescale ${e}`)}}function s(e,t,r){return"custom"===e?r||null:"count"===e?"count(*)":"count_distinct"===e&&t?`count(distinct ${(0,n.ZZ)(t)})`:e&&t?`${e}(${(0,n.ZZ)(t)})`:null}function c(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"y";const{xField:l,xTimescale:c,limit:u,order:d}=t;let m=l&&(0,n.ZZ)(l);c&&(m=i(c,m));let p=e.groupBy(m&&`${m} as x`).limit(!!u&&parseFloat(u));l&&m&&(p=p.where(`${(0,n.ZZ)(l)} IS NOT NULL`));let f=!0;if("series"in t&&t.series)Object.entries(t.series).forEach(((e,t)=>{let[r,o]=e;const{yField:l,yFunction:i,customFunction:c,conditions:u=[]}=o,d=s(i,l,c);d?p=p.select((e=>e?`${e}, ${d} as ${r}`:`${d} as ${r}`)):f=!1,p=p.where((e=>(0,n.Q7)(e,!t&&u.length?(0,a.A)(u):"")))}));else if("yField"in t||"yFunction"in t||"conditions"in t){const{yField:e,yFunction:o,customFunction:l,conditions:i=[]}=t,c=s(o,e,l);c?p=p.select(`${c} as ${r}`):f=!1,p=p.where((e=>(0,n.Q7)(e,i?.length?(0,a.A)(i):"")))}else f=!1;if(f){const{by:e,direction:t}=d||{};if(e){const n="x"===e?"x":r;switch(t){case o.bz.ASC:p=p.orderBy(`${n} ASC`);break;case o.bz.DESC:p=p.orderBy(`${n} DESC`)}}}return p}function u(e){return(0,n.GC)().dataset(e).records()}function d(e,t){return(0,n.GC)().dataset(e).export(t)}function m(e,t){if(t)return c(e,t)}function p(e,t){if(!(t&&"series"in t&&t?.series&&Object.keys(t.series).length))return;const r=Object.entries(t.series).reduce(((e,t)=>{let[r,n]=t;const{conditions:a}=n,o=JSON.stringify(a?.length?a:"EMPTY_CONDITIONS");return{...e,[o]:{...e[o],[r]:n}}}),{});return Object.values(r).map((r=>c(e,{...t,series:r},t?.order?.by)))}},50173:function(e,t,r){r.d(t,{_:function(){return n},g:function(){return a}});let n=function(e){return e.Chart="chart",e.Kpi="kpi",e.Text="text",e.Media="media",e.Map="map",e.Table="table",e}({}),a=function(e){return e.Content="content",e.Filters="filters",e}({})},97006:function(e,t,r){r.d(t,{A:function(){return s}});var n=r(29894),a=r(41481),o=r(64516),l=r.n(o),i=r(47827),s=function(e){let{label:t="",className:r="",onChange:o,...s}=e;const{inline:c}=s,u=l()({"rods-filter__container--read-only":s.readonly,"rods-filter__container":!c},"rods-date-filter",r);return a.createElement(i.A,(0,n.A)({prepend:a.createElement("label",{className:"rods-filter__label rods-date-filter__label"},t),onChange:e=>{o&&o(e)},className:u},s))}},15785:function(e,t,r){var n=r(41481);t.A=(e,t)=>{const r=(0,n.useRef)(null);return t||(r.current=e()),r.current}},6031:function(e,t,r){var n=r(49098),a=r.n(n),o=r(48818);a().workerUrl=o,t.A=a()}}]);