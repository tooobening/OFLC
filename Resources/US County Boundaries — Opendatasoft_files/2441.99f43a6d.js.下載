/*! For license information please see 2441.99f43a6d.js.LICENSE.txt */
(self.webpackChunkreactjs=self.webpackChunkreactjs||[]).push([[2441],{48818:function(t,e,i){"use strict";t.exports=i.p+"70735615f20715daec92.js?maplibreWorker"},8240:function(t,e,i){"use strict";function n(t){var e=Array.prototype.slice.call(arguments,1);return e.forEach((function(e){e&&Object.keys(e).forEach((function(i){t[i]=e[i]}))})),t}function r(t){return Object.prototype.toString.call(t)}function s(t){return"[object Function]"===r(t)}function o(t){return t.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var a={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1},l={"http:":{validate:function(t,e,i){var n=t.slice(e);return i.re.http||(i.re.http=new RegExp("^\\/\\/"+i.re.src_auth+i.re.src_host_port_strict+i.re.src_path,"i")),i.re.http.test(n)?n.match(i.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(t,e,i){var n=t.slice(e);return i.re.no_http||(i.re.no_http=new RegExp("^"+i.re.src_auth+"(?:localhost|(?:(?:"+i.re.src_domain+")\\.)+"+i.re.src_domain_root+")"+i.re.src_port+i.re.src_host_terminator+i.re.src_path,"i")),i.re.no_http.test(n)?e>=3&&":"===t[e-3]||e>=3&&"/"===t[e-3]?0:n.match(i.re.no_http)[0].length:0}},"mailto:":{validate:function(t,e,i){var n=t.slice(e);return i.re.mailto||(i.re.mailto=new RegExp("^"+i.re.src_email_name+"@"+i.re.src_host_strict,"i")),i.re.mailto.test(n)?n.match(i.re.mailto)[0].length:0}}},c="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф".split("|");function u(t){var e=t.re=i(55361)(t.__opts__),n=t.__tlds__.slice();function a(t){return t.replace("%TLDS%",e.src_tlds)}t.onCompile(),t.__tlds_replaced__||n.push("a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]"),n.push(e.src_xn),e.src_tlds=n.join("|"),e.email_fuzzy=RegExp(a(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(a(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(a(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(a(e.tpl_host_fuzzy_test),"i");var l=[];function c(t,e){throw new Error('(LinkifyIt) Invalid schema "'+t+'": '+e)}t.__compiled__={},Object.keys(t.__schemas__).forEach((function(e){var i=t.__schemas__[e];if(null!==i){var n={validate:null,link:null};if(t.__compiled__[e]=n,"[object Object]"===r(i))return"[object RegExp]"!==r(i.validate)?s(i.validate)?n.validate=i.validate:c(e,i):n.validate=function(t){return function(e,i){var n=e.slice(i);return t.test(n)?n.match(t)[0].length:0}}(i.validate),void(s(i.normalize)?n.normalize=i.normalize:i.normalize?c(e,i):n.normalize=function(t,e){e.normalize(t)});!function(t){return"[object String]"===r(t)}(i)?c(e,i):l.push(e)}})),l.forEach((function(e){t.__compiled__[t.__schemas__[e]]&&(t.__compiled__[e].validate=t.__compiled__[t.__schemas__[e]].validate,t.__compiled__[e].normalize=t.__compiled__[t.__schemas__[e]].normalize)})),t.__compiled__[""]={validate:null,normalize:function(t,e){e.normalize(t)}};var u=Object.keys(t.__compiled__).filter((function(e){return e.length>0&&t.__compiled__[e]})).map(o).join("|");t.re.schema_test=RegExp("(^|(?!_)(?:[><｜]|"+e.src_ZPCc+"))("+u+")","i"),t.re.schema_search=RegExp("(^|(?!_)(?:[><｜]|"+e.src_ZPCc+"))("+u+")","ig"),t.re.pretest=RegExp("("+t.re.schema_test.source+")|("+t.re.host_fuzzy_test.source+")|@","i"),function(t){t.__index__=-1,t.__text_cache__=""}(t)}function h(t,e){var i=t.__index__,n=t.__last_index__,r=t.__text_cache__.slice(i,n);this.schema=t.__schema__.toLowerCase(),this.index=i+e,this.lastIndex=n+e,this.raw=r,this.text=r,this.url=r}function d(t,e){var i=new h(t,e);return t.__compiled__[i.schema].normalize(i,t),i}function p(t,e){if(!(this instanceof p))return new p(t,e);var i;e||(i=t,Object.keys(i||{}).reduce((function(t,e){return t||a.hasOwnProperty(e)}),!1)&&(e=t,t={})),this.__opts__=n({},a,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=n({},l,t),this.__compiled__={},this.__tlds__=c,this.__tlds_replaced__=!1,this.re={},u(this)}p.prototype.add=function(t,e){return this.__schemas__[t]=e,u(this),this},p.prototype.set=function(t){return this.__opts__=n(this.__opts__,t),this},p.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;var e,i,n,r,s,o,a,l;if(this.re.schema_test.test(t))for((a=this.re.schema_search).lastIndex=0;null!==(e=a.exec(t));)if(r=this.testSchemaAt(t,e[2],a.lastIndex)){this.__schema__=e[2],this.__index__=e.index+e[1].length,this.__last_index__=e.index+e[0].length+r;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=t.search(this.re.host_fuzzy_test))>=0&&(this.__index__<0||l<this.__index__)&&null!==(i=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(s=i.index+i[1].length,(this.__index__<0||s<this.__index__)&&(this.__schema__="",this.__index__=s,this.__last_index__=i.index+i[0].length)),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&t.indexOf("@")>=0&&null!==(n=t.match(this.re.email_fuzzy))&&(s=n.index+n[1].length,o=n.index+n[0].length,(this.__index__<0||s<this.__index__||s===this.__index__&&o>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=s,this.__last_index__=o)),this.__index__>=0},p.prototype.pretest=function(t){return this.re.pretest.test(t)},p.prototype.testSchemaAt=function(t,e,i){return this.__compiled__[e.toLowerCase()]?this.__compiled__[e.toLowerCase()].validate(t,i,this):0},p.prototype.match=function(t){var e=0,i=[];this.__index__>=0&&this.__text_cache__===t&&(i.push(d(this,e)),e=this.__last_index__);for(var n=e?t.slice(e):t;this.test(n);)i.push(d(this,e)),n=n.slice(this.__last_index__),e+=this.__last_index__;return i.length?i:null},p.prototype.tlds=function(t,e){return t=Array.isArray(t)?t:[t],e?(this.__tlds__=this.__tlds__.concat(t).sort().filter((function(t,e,i){return t!==i[e-1]})).reverse(),u(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,u(this),this)},p.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),"mailto:"!==t.schema||/^mailto:/i.test(t.url)||(t.url="mailto:"+t.url)},p.prototype.onCompile=function(){},t.exports=p},55361:function(t,e,i){"use strict";t.exports=function(t){var e={};e.src_Any=i(97250).source,e.src_Cc=i(5621).source,e.src_Z=i(64807).source,e.src_P=i(85273).source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");return e.src_pseudo_letter="(?:(?![><｜]|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|[><｜]|"+e.src_ZPCc+")(?!-|_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|[><｜]|[()[\\]{}.,\"'?!\\-;]).|\\[(?:(?!"+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-]).|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]).|"+(t&&t["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+").|;(?!"+e.src_ZCc+").|\\!+(?!"+e.src_ZCc+"|[!]).|\\?(?!"+e.src_ZCc+"|[?]).)+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy='(^|[><｜]|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+e.src_ZPCc+"))((?![$+<=>^`|｜])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+e.src_ZPCc+"))((?![$+<=>^`|｜])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}},94735:function(t,e,i){"use strict";t.exports=i(40747)},67998:function(t,e,i){"use strict";t.exports=i(9752)},72875:function(t){"use strict";t.exports=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]},36340:function(t){"use strict";var e="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\x00-\\x20]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",i="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",n=new RegExp("^(?:"+e+"|"+i+"|\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e|<[?][\\s\\S]*?[?]>|<![A-Z]+\\s+[^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)"),r=new RegExp("^(?:"+e+"|"+i+")");t.exports.l=n,t.exports.p=r},35114:function(t,e,i){"use strict";var n=Object.prototype.hasOwnProperty;function r(t,e){return n.call(t,e)}function s(t){return!(t>=55296&&t<=57343||t>=64976&&t<=65007||65535==(65535&t)||65534==(65535&t)||t>=0&&t<=8||11===t||t>=14&&t<=31||t>=127&&t<=159||t>1114111)}function o(t){if(t>65535){var e=55296+((t-=65536)>>10),i=56320+(1023&t);return String.fromCharCode(e,i)}return String.fromCharCode(t)}var a=/\\([!"#$%&'()*+,\-.\/:;<=>?@[\\\]^_`{|}~])/g,l=new RegExp(a.source+"|"+/&([a-z#][a-z0-9]{1,31});/gi.source,"gi"),c=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i,u=i(67998),h=/[&<>"]/,d=/[&<>"]/g,p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function f(t){return p[t]}var m=/[.?*+^$[\]\\(){}|-]/g,g=i(85273);e.lib={},e.lib.mdurl=i(75692),e.lib.ucmicro=i(30606),e.assign=function(t){var e=Array.prototype.slice.call(arguments,1);return e.forEach((function(e){if(e){if("object"!=typeof e)throw new TypeError(e+"must be object");Object.keys(e).forEach((function(i){t[i]=e[i]}))}})),t},e.isString=function(t){return"[object String]"===function(t){return Object.prototype.toString.call(t)}(t)},e.has=r,e.unescapeMd=function(t){return t.indexOf("\\")<0?t:t.replace(a,"$1")},e.unescapeAll=function(t){return t.indexOf("\\")<0&&t.indexOf("&")<0?t:t.replace(l,(function(t,e,i){return e||function(t,e){var i=0;return r(u,e)?u[e]:35===e.charCodeAt(0)&&c.test(e)&&s(i="x"===e[1].toLowerCase()?parseInt(e.slice(2),16):parseInt(e.slice(1),10))?o(i):t}(t,i)}))},e.isValidEntityCode=s,e.fromCodePoint=o,e.escapeHtml=function(t){return h.test(t)?t.replace(d,f):t},e.arrayReplaceAt=function(t,e,i){return[].concat(t.slice(0,e),i,t.slice(e+1))},e.isSpace=function(t){switch(t){case 9:case 32:return!0}return!1},e.isWhiteSpace=function(t){if(t>=8192&&t<=8202)return!0;switch(t){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1},e.isMdAsciiPunct=function(t){switch(t){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}},e.isPunctChar=function(t){return g.test(t)},e.escapeRE=function(t){return t.replace(m,"\\$&")},e.normalizeReference=function(t){return t=t.trim().replace(/\s+/g," "),"Ṿ"==="ẞ".toLowerCase()&&(t=t.replace(/ẞ/g,"ß")),t.toLowerCase().toUpperCase()}},94165:function(t,e,i){"use strict";e.parseLinkLabel=i(65914),e.parseLinkDestination=i(11964),e.parseLinkTitle=i(29638)},11964:function(t,e,i){"use strict";var n=i(35114).unescapeAll;t.exports=function(t,e,i){var r,s,o=e,a={ok:!1,pos:0,lines:0,str:""};if(60===t.charCodeAt(e)){for(e++;e<i;){if(10===(r=t.charCodeAt(e)))return a;if(60===r)return a;if(62===r)return a.pos=e+1,a.str=n(t.slice(o+1,e)),a.ok=!0,a;92===r&&e+1<i?e+=2:e++}return a}for(s=0;e<i&&32!==(r=t.charCodeAt(e))&&!(r<32||127===r);)if(92===r&&e+1<i){if(32===t.charCodeAt(e+1))break;e+=2}else{if(40===r&&++s>32)return a;if(41===r){if(0===s)break;s--}e++}return o===e||0!==s||(a.str=n(t.slice(o,e)),a.lines=0,a.pos=e,a.ok=!0),a}},65914:function(t){"use strict";t.exports=function(t,e,i){var n,r,s,o,a=-1,l=t.posMax,c=t.pos;for(t.pos=e+1,n=1;t.pos<l;){if(93===(s=t.src.charCodeAt(t.pos))&&0==--n){r=!0;break}if(o=t.pos,t.md.inline.skipToken(t),91===s)if(o===t.pos-1)n++;else if(i)return t.pos=c,-1}return r&&(a=t.pos),t.pos=c,a}},29638:function(t,e,i){"use strict";var n=i(35114).unescapeAll;t.exports=function(t,e,i){var r,s,o=0,a=e,l={ok:!1,pos:0,lines:0,str:""};if(e>=i)return l;if(34!==(s=t.charCodeAt(e))&&39!==s&&40!==s)return l;for(e++,40===s&&(s=41);e<i;){if((r=t.charCodeAt(e))===s)return l.pos=e+1,l.lines=o,l.str=n(t.slice(a+1,e)),l.ok=!0,l;if(40===r&&41===s)return l;10===r?o++:92===r&&e+1<i&&(e++,10===t.charCodeAt(e)&&o++),e++}return l}},40747:function(t,e,i){"use strict";var n=i(35114),r=i(94165),s=i(534),o=i(24896),a=i(68764),l=i(57074),c=i(8240),u=i(75692),h=i(37378),d={default:i(50473),zero:i(95110),commonmark:i(8616)},p=/^(vbscript|javascript|file|data):/,f=/^data:image\/(gif|png|jpeg|webp);/;function m(t){var e=t.trim().toLowerCase();return!p.test(e)||!!f.test(e)}var g=["http:","https:","mailto:"];function _(t){var e=u.parse(t,!0);if(e.hostname&&(!e.protocol||g.indexOf(e.protocol)>=0))try{e.hostname=h.toASCII(e.hostname)}catch(t){}return u.encode(u.format(e))}function y(t){var e=u.parse(t,!0);if(e.hostname&&(!e.protocol||g.indexOf(e.protocol)>=0))try{e.hostname=h.toUnicode(e.hostname)}catch(t){}return u.decode(u.format(e),u.decode.defaultChars+"%")}function x(t,e){if(!(this instanceof x))return new x(t,e);e||n.isString(t)||(e=t||{},t="default"),this.inline=new l,this.block=new a,this.core=new o,this.renderer=new s,this.linkify=new c,this.validateLink=m,this.normalizeLink=_,this.normalizeLinkText=y,this.utils=n,this.helpers=n.assign({},r),this.options={},this.configure(t),e&&this.set(e)}x.prototype.set=function(t){return n.assign(this.options,t),this},x.prototype.configure=function(t){var e,i=this;if(n.isString(t)&&!(t=d[e=t]))throw new Error('Wrong `markdown-it` preset "'+e+'", check name');if(!t)throw new Error("Wrong `markdown-it` preset, can't be empty");return t.options&&i.set(t.options),t.components&&Object.keys(t.components).forEach((function(e){t.components[e].rules&&i[e].ruler.enableOnly(t.components[e].rules),t.components[e].rules2&&i[e].ruler2.enableOnly(t.components[e].rules2)})),this},x.prototype.enable=function(t,e){var i=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach((function(e){i=i.concat(this[e].ruler.enable(t,!0))}),this),i=i.concat(this.inline.ruler2.enable(t,!0));var n=t.filter((function(t){return i.indexOf(t)<0}));if(n.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+n);return this},x.prototype.disable=function(t,e){var i=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach((function(e){i=i.concat(this[e].ruler.disable(t,!0))}),this),i=i.concat(this.inline.ruler2.disable(t,!0));var n=t.filter((function(t){return i.indexOf(t)<0}));if(n.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+n);return this},x.prototype.use=function(t){var e=[this].concat(Array.prototype.slice.call(arguments,1));return t.apply(t,e),this},x.prototype.parse=function(t,e){if("string"!=typeof t)throw new Error("Input data should be a String");var i=new this.core.State(t,this,e);return this.core.process(i),i.tokens},x.prototype.render=function(t,e){return e=e||{},this.renderer.render(this.parse(t,e),this.options,e)},x.prototype.parseInline=function(t,e){var i=new this.core.State(t,this,e);return i.inlineMode=!0,this.core.process(i),i.tokens},x.prototype.renderInline=function(t,e){return e=e||{},this.renderer.render(this.parseInline(t,e),this.options,e)},t.exports=x},68764:function(t,e,i){"use strict";var n=i(59695),r=[["table",i(13309),["paragraph","reference"]],["code",i(81398)],["fence",i(70700),["paragraph","reference","blockquote","list"]],["blockquote",i(548),["paragraph","reference","blockquote","list"]],["hr",i(95453),["paragraph","reference","blockquote","list"]],["list",i(53323),["paragraph","reference","blockquote"]],["reference",i(68688)],["html_block",i(17328),["paragraph","reference","blockquote"]],["heading",i(94079),["paragraph","reference","blockquote"]],["lheading",i(82733)],["paragraph",i(94195)]];function s(){this.ruler=new n;for(var t=0;t<r.length;t++)this.ruler.push(r[t][0],r[t][1],{alt:(r[t][2]||[]).slice()})}s.prototype.tokenize=function(t,e,i){for(var n,r=this.ruler.getRules(""),s=r.length,o=e,a=!1,l=t.md.options.maxNesting;o<i&&(t.line=o=t.skipEmptyLines(o),!(o>=i))&&!(t.sCount[o]<t.blkIndent);){if(t.level>=l){t.line=i;break}for(n=0;n<s&&!r[n](t,o,i,!1);n++);t.tight=!a,t.isEmpty(t.line-1)&&(a=!0),(o=t.line)<i&&t.isEmpty(o)&&(a=!0,o++,t.line=o)}},s.prototype.parse=function(t,e,i,n){var r;t&&(r=new this.State(t,e,i,n),this.tokenize(r,r.line,r.lineMax))},s.prototype.State=i(48998),t.exports=s},24896:function(t,e,i){"use strict";var n=i(59695),r=[["normalize",i(27442)],["block",i(44148)],["inline",i(94650)],["linkify",i(20271)],["replacements",i(56794)],["smartquotes",i(26353)]];function s(){this.ruler=new n;for(var t=0;t<r.length;t++)this.ruler.push(r[t][0],r[t][1])}s.prototype.process=function(t){var e,i,n;for(e=0,i=(n=this.ruler.getRules("")).length;e<i;e++)n[e](t)},s.prototype.State=i(14214),t.exports=s},57074:function(t,e,i){"use strict";var n=i(59695),r=[["text",i(8262)],["newline",i(30899)],["escape",i(23142)],["backticks",i(99788)],["strikethrough",i(3228).q],["emphasis",i(43519).q],["link",i(10677)],["image",i(38746)],["autolink",i(89930)],["html_inline",i(55360)],["entity",i(97742)]],s=[["balance_pairs",i(16457)],["strikethrough",i(3228).g],["emphasis",i(43519).g],["text_collapse",i(61136)]];function o(){var t;for(this.ruler=new n,t=0;t<r.length;t++)this.ruler.push(r[t][0],r[t][1]);for(this.ruler2=new n,t=0;t<s.length;t++)this.ruler2.push(s[t][0],s[t][1])}o.prototype.skipToken=function(t){var e,i,n=t.pos,r=this.ruler.getRules(""),s=r.length,o=t.md.options.maxNesting,a=t.cache;if(void 0===a[n]){if(t.level<o)for(i=0;i<s&&(t.level++,e=r[i](t,!0),t.level--,!e);i++);else t.pos=t.posMax;e||t.pos++,a[n]=t.pos}else t.pos=a[n]},o.prototype.tokenize=function(t){for(var e,i,n=this.ruler.getRules(""),r=n.length,s=t.posMax,o=t.md.options.maxNesting;t.pos<s;){if(t.level<o)for(i=0;i<r&&!(e=n[i](t,!1));i++);if(e){if(t.pos>=s)break}else t.pending+=t.src[t.pos++]}t.pending&&t.pushPending()},o.prototype.parse=function(t,e,i,n){var r,s,o,a=new this.State(t,e,i,n);for(this.tokenize(a),o=(s=this.ruler2.getRules("")).length,r=0;r<o;r++)s[r](a)},o.prototype.State=i(93394),t.exports=o},8616:function(t){"use strict";t.exports={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","text_collapse"]}}}},50473:function(t){"use strict";t.exports={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}}},95110:function(t){"use strict";t.exports={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","text_collapse"]}}}},534:function(t,e,i){"use strict";var n=i(35114).assign,r=i(35114).unescapeAll,s=i(35114).escapeHtml,o={};function a(){this.rules=n({},o)}o.code_inline=function(t,e,i,n,r){var o=t[e];return"<code"+r.renderAttrs(o)+">"+s(t[e].content)+"</code>"},o.code_block=function(t,e,i,n,r){var o=t[e];return"<pre"+r.renderAttrs(o)+"><code>"+s(t[e].content)+"</code></pre>\n"},o.fence=function(t,e,i,n,o){var a,l,c,u,h,d=t[e],p=d.info?r(d.info).trim():"",f="",m="";return p&&(f=(c=p.split(/(\s+)/g))[0],m=c.slice(2).join("")),0===(a=i.highlight&&i.highlight(d.content,f,m)||s(d.content)).indexOf("<pre")?a+"\n":p?(l=d.attrIndex("class"),u=d.attrs?d.attrs.slice():[],l<0?u.push(["class",i.langPrefix+f]):(u[l]=u[l].slice(),u[l][1]+=" "+i.langPrefix+f),h={attrs:u},"<pre><code"+o.renderAttrs(h)+">"+a+"</code></pre>\n"):"<pre><code"+o.renderAttrs(d)+">"+a+"</code></pre>\n"},o.image=function(t,e,i,n,r){var s=t[e];return s.attrs[s.attrIndex("alt")][1]=r.renderInlineAsText(s.children,i,n),r.renderToken(t,e,i)},o.hardbreak=function(t,e,i){return i.xhtmlOut?"<br />\n":"<br>\n"},o.softbreak=function(t,e,i){return i.breaks?i.xhtmlOut?"<br />\n":"<br>\n":"\n"},o.text=function(t,e){return s(t[e].content)},o.html_block=function(t,e){return t[e].content},o.html_inline=function(t,e){return t[e].content},a.prototype.renderAttrs=function(t){var e,i,n;if(!t.attrs)return"";for(n="",e=0,i=t.attrs.length;e<i;e++)n+=" "+s(t.attrs[e][0])+'="'+s(t.attrs[e][1])+'"';return n},a.prototype.renderToken=function(t,e,i){var n,r="",s=!1,o=t[e];return o.hidden?"":(o.block&&-1!==o.nesting&&e&&t[e-1].hidden&&(r+="\n"),r+=(-1===o.nesting?"</":"<")+o.tag,r+=this.renderAttrs(o),0===o.nesting&&i.xhtmlOut&&(r+=" /"),o.block&&(s=!0,1===o.nesting&&e+1<t.length&&("inline"===(n=t[e+1]).type||n.hidden||-1===n.nesting&&n.tag===o.tag)&&(s=!1)),r+=s?">\n":">")},a.prototype.renderInline=function(t,e,i){for(var n,r="",s=this.rules,o=0,a=t.length;o<a;o++)void 0!==s[n=t[o].type]?r+=s[n](t,o,e,i,this):r+=this.renderToken(t,o,e);return r},a.prototype.renderInlineAsText=function(t,e,i){for(var n="",r=0,s=t.length;r<s;r++)"text"===t[r].type?n+=t[r].content:"image"===t[r].type?n+=this.renderInlineAsText(t[r].children,e,i):"softbreak"===t[r].type&&(n+="\n");return n},a.prototype.render=function(t,e,i){var n,r,s,o="",a=this.rules;for(n=0,r=t.length;n<r;n++)"inline"===(s=t[n].type)?o+=this.renderInline(t[n].children,e,i):void 0!==a[s]?o+=a[t[n].type](t,n,e,i,this):o+=this.renderToken(t,n,e,i);return o},t.exports=a},59695:function(t){"use strict";function e(){this.__rules__=[],this.__cache__=null}e.prototype.__find__=function(t){for(var e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===t)return e;return-1},e.prototype.__compile__=function(){var t=this,e=[""];t.__rules__.forEach((function(t){t.enabled&&t.alt.forEach((function(t){e.indexOf(t)<0&&e.push(t)}))})),t.__cache__={},e.forEach((function(e){t.__cache__[e]=[],t.__rules__.forEach((function(i){i.enabled&&(e&&i.alt.indexOf(e)<0||t.__cache__[e].push(i.fn))}))}))},e.prototype.at=function(t,e,i){var n=this.__find__(t),r=i||{};if(-1===n)throw new Error("Parser rule not found: "+t);this.__rules__[n].fn=e,this.__rules__[n].alt=r.alt||[],this.__cache__=null},e.prototype.before=function(t,e,i,n){var r=this.__find__(t),s=n||{};if(-1===r)throw new Error("Parser rule not found: "+t);this.__rules__.splice(r,0,{name:e,enabled:!0,fn:i,alt:s.alt||[]}),this.__cache__=null},e.prototype.after=function(t,e,i,n){var r=this.__find__(t),s=n||{};if(-1===r)throw new Error("Parser rule not found: "+t);this.__rules__.splice(r+1,0,{name:e,enabled:!0,fn:i,alt:s.alt||[]}),this.__cache__=null},e.prototype.push=function(t,e,i){var n=i||{};this.__rules__.push({name:t,enabled:!0,fn:e,alt:n.alt||[]}),this.__cache__=null},e.prototype.enable=function(t,e){Array.isArray(t)||(t=[t]);var i=[];return t.forEach((function(t){var n=this.__find__(t);if(n<0){if(e)return;throw new Error("Rules manager: invalid rule name "+t)}this.__rules__[n].enabled=!0,i.push(t)}),this),this.__cache__=null,i},e.prototype.enableOnly=function(t,e){Array.isArray(t)||(t=[t]),this.__rules__.forEach((function(t){t.enabled=!1})),this.enable(t,e)},e.prototype.disable=function(t,e){Array.isArray(t)||(t=[t]);var i=[];return t.forEach((function(t){var n=this.__find__(t);if(n<0){if(e)return;throw new Error("Rules manager: invalid rule name "+t)}this.__rules__[n].enabled=!1,i.push(t)}),this),this.__cache__=null,i},e.prototype.getRules=function(t){return null===this.__cache__&&this.__compile__(),this.__cache__[t]||[]},t.exports=e},548:function(t,e,i){"use strict";var n=i(35114).isSpace;t.exports=function(t,e,i,r){var s,o,a,l,c,u,h,d,p,f,m,g,_,y,x,v,b,w,k,S,T=t.lineMax,A=t.bMarks[e]+t.tShift[e],M=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;if(62!==t.src.charCodeAt(A++))return!1;if(r)return!0;for(l=p=t.sCount[e]+1,32===t.src.charCodeAt(A)?(A++,l++,p++,s=!1,v=!0):9===t.src.charCodeAt(A)?(v=!0,(t.bsCount[e]+p)%4==3?(A++,l++,p++,s=!1):s=!0):v=!1,f=[t.bMarks[e]],t.bMarks[e]=A;A<M&&(o=t.src.charCodeAt(A),n(o));)9===o?p+=4-(p+t.bsCount[e]+(s?1:0))%4:p++,A++;for(m=[t.bsCount[e]],t.bsCount[e]=t.sCount[e]+1+(v?1:0),u=A>=M,y=[t.sCount[e]],t.sCount[e]=p-l,x=[t.tShift[e]],t.tShift[e]=A-t.bMarks[e],w=t.md.block.ruler.getRules("blockquote"),_=t.parentType,t.parentType="blockquote",d=e+1;d<i&&(S=t.sCount[d]<t.blkIndent,!((A=t.bMarks[d]+t.tShift[d])>=(M=t.eMarks[d])));d++)if(62!==t.src.charCodeAt(A++)||S){if(u)break;for(b=!1,a=0,c=w.length;a<c;a++)if(w[a](t,d,i,!0)){b=!0;break}if(b){t.lineMax=d,0!==t.blkIndent&&(f.push(t.bMarks[d]),m.push(t.bsCount[d]),x.push(t.tShift[d]),y.push(t.sCount[d]),t.sCount[d]-=t.blkIndent);break}f.push(t.bMarks[d]),m.push(t.bsCount[d]),x.push(t.tShift[d]),y.push(t.sCount[d]),t.sCount[d]=-1}else{for(l=p=t.sCount[d]+1,32===t.src.charCodeAt(A)?(A++,l++,p++,s=!1,v=!0):9===t.src.charCodeAt(A)?(v=!0,(t.bsCount[d]+p)%4==3?(A++,l++,p++,s=!1):s=!0):v=!1,f.push(t.bMarks[d]),t.bMarks[d]=A;A<M&&(o=t.src.charCodeAt(A),n(o));)9===o?p+=4-(p+t.bsCount[d]+(s?1:0))%4:p++,A++;u=A>=M,m.push(t.bsCount[d]),t.bsCount[d]=t.sCount[d]+1+(v?1:0),y.push(t.sCount[d]),t.sCount[d]=p-l,x.push(t.tShift[d]),t.tShift[d]=A-t.bMarks[d]}for(g=t.blkIndent,t.blkIndent=0,(k=t.push("blockquote_open","blockquote",1)).markup=">",k.map=h=[e,0],t.md.block.tokenize(t,e,d),(k=t.push("blockquote_close","blockquote",-1)).markup=">",t.lineMax=T,t.parentType=_,h[1]=t.line,a=0;a<x.length;a++)t.bMarks[a+e]=f[a],t.tShift[a+e]=x[a],t.sCount[a+e]=y[a],t.bsCount[a+e]=m[a];return t.blkIndent=g,!0}},81398:function(t){"use strict";t.exports=function(t,e,i){var n,r,s;if(t.sCount[e]-t.blkIndent<4)return!1;for(r=n=e+1;n<i;)if(t.isEmpty(n))n++;else{if(!(t.sCount[n]-t.blkIndent>=4))break;r=++n}return t.line=r,(s=t.push("code_block","code",0)).content=t.getLines(e,r,4+t.blkIndent,!1)+"\n",s.map=[e,t.line],!0}},70700:function(t){"use strict";t.exports=function(t,e,i,n){var r,s,o,a,l,c,u,h=!1,d=t.bMarks[e]+t.tShift[e],p=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;if(d+3>p)return!1;if(126!==(r=t.src.charCodeAt(d))&&96!==r)return!1;if(l=d,(s=(d=t.skipChars(d,r))-l)<3)return!1;if(u=t.src.slice(l,d),o=t.src.slice(d,p),96===r&&o.indexOf(String.fromCharCode(r))>=0)return!1;if(n)return!0;for(a=e;!(++a>=i||(d=l=t.bMarks[a]+t.tShift[a])<(p=t.eMarks[a])&&t.sCount[a]<t.blkIndent);)if(t.src.charCodeAt(d)===r&&!(t.sCount[a]-t.blkIndent>=4||(d=t.skipChars(d,r))-l<s||(d=t.skipSpaces(d))<p)){h=!0;break}return s=t.sCount[e],t.line=a+(h?1:0),(c=t.push("fence","code",0)).info=o,c.content=t.getLines(e+1,a,s,!0),c.markup=u,c.map=[e,t.line],!0}},94079:function(t,e,i){"use strict";var n=i(35114).isSpace;t.exports=function(t,e,i,r){var s,o,a,l,c=t.bMarks[e]+t.tShift[e],u=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;if(35!==(s=t.src.charCodeAt(c))||c>=u)return!1;for(o=1,s=t.src.charCodeAt(++c);35===s&&c<u&&o<=6;)o++,s=t.src.charCodeAt(++c);return!(o>6||c<u&&!n(s)||(r||(u=t.skipSpacesBack(u,c),(a=t.skipCharsBack(u,35,c))>c&&n(t.src.charCodeAt(a-1))&&(u=a),t.line=e+1,(l=t.push("heading_open","h"+String(o),1)).markup="########".slice(0,o),l.map=[e,t.line],(l=t.push("inline","",0)).content=t.src.slice(c,u).trim(),l.map=[e,t.line],l.children=[],(l=t.push("heading_close","h"+String(o),-1)).markup="########".slice(0,o)),0))}},95453:function(t,e,i){"use strict";var n=i(35114).isSpace;t.exports=function(t,e,i,r){var s,o,a,l,c=t.bMarks[e]+t.tShift[e],u=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;if(42!==(s=t.src.charCodeAt(c++))&&45!==s&&95!==s)return!1;for(o=1;c<u;){if((a=t.src.charCodeAt(c++))!==s&&!n(a))return!1;a===s&&o++}return!(o<3||(r||(t.line=e+1,(l=t.push("hr","hr",0)).map=[e,t.line],l.markup=Array(o+1).join(String.fromCharCode(s))),0))}},17328:function(t,e,i){"use strict";var n=i(72875),r=i(36340).p,s=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+n.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(r.source+"\\s*$"),/^$/,!1]];t.exports=function(t,e,i,n){var r,o,a,l,c=t.bMarks[e]+t.tShift[e],u=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;if(!t.md.options.html)return!1;if(60!==t.src.charCodeAt(c))return!1;for(l=t.src.slice(c,u),r=0;r<s.length&&!s[r][0].test(l);r++);if(r===s.length)return!1;if(n)return s[r][2];if(o=e+1,!s[r][1].test(l))for(;o<i&&!(t.sCount[o]<t.blkIndent);o++)if(c=t.bMarks[o]+t.tShift[o],u=t.eMarks[o],l=t.src.slice(c,u),s[r][1].test(l)){0!==l.length&&o++;break}return t.line=o,(a=t.push("html_block","",0)).map=[e,o],a.content=t.getLines(e,o,t.blkIndent,!0),!0}},82733:function(t){"use strict";t.exports=function(t,e,i){var n,r,s,o,a,l,c,u,h,d,p=e+1,f=t.md.block.ruler.getRules("paragraph");if(t.sCount[e]-t.blkIndent>=4)return!1;for(d=t.parentType,t.parentType="paragraph";p<i&&!t.isEmpty(p);p++)if(!(t.sCount[p]-t.blkIndent>3)){if(t.sCount[p]>=t.blkIndent&&(l=t.bMarks[p]+t.tShift[p])<(c=t.eMarks[p])&&(45===(h=t.src.charCodeAt(l))||61===h)&&(l=t.skipChars(l,h),(l=t.skipSpaces(l))>=c)){u=61===h?1:2;break}if(!(t.sCount[p]<0)){for(r=!1,s=0,o=f.length;s<o;s++)if(f[s](t,p,i,!0)){r=!0;break}if(r)break}}return!!u&&(n=t.getLines(e,p,t.blkIndent,!1).trim(),t.line=p+1,(a=t.push("heading_open","h"+String(u),1)).markup=String.fromCharCode(h),a.map=[e,t.line],(a=t.push("inline","",0)).content=n,a.map=[e,t.line-1],a.children=[],(a=t.push("heading_close","h"+String(u),-1)).markup=String.fromCharCode(h),t.parentType=d,!0)}},53323:function(t,e,i){"use strict";var n=i(35114).isSpace;function r(t,e){var i,r,s,o;return r=t.bMarks[e]+t.tShift[e],s=t.eMarks[e],42!==(i=t.src.charCodeAt(r++))&&45!==i&&43!==i||r<s&&(o=t.src.charCodeAt(r),!n(o))?-1:r}function s(t,e){var i,r=t.bMarks[e]+t.tShift[e],s=r,o=t.eMarks[e];if(s+1>=o)return-1;if((i=t.src.charCodeAt(s++))<48||i>57)return-1;for(;;){if(s>=o)return-1;if(!((i=t.src.charCodeAt(s++))>=48&&i<=57)){if(41===i||46===i)break;return-1}if(s-r>=10)return-1}return s<o&&(i=t.src.charCodeAt(s),!n(i))?-1:s}t.exports=function(t,e,i,n){var o,a,l,c,u,h,d,p,f,m,g,_,y,x,v,b,w,k,S,T,A,M,C,E,I,D,z,P,L=!1,F=!0;if(t.sCount[e]-t.blkIndent>=4)return!1;if(t.listIndent>=0&&t.sCount[e]-t.listIndent>=4&&t.sCount[e]<t.blkIndent)return!1;if(n&&"paragraph"===t.parentType&&t.tShift[e]>=t.blkIndent&&(L=!0),(C=s(t,e))>=0){if(d=!0,I=t.bMarks[e]+t.tShift[e],y=Number(t.src.slice(I,C-1)),L&&1!==y)return!1}else{if(!((C=r(t,e))>=0))return!1;d=!1}if(L&&t.skipSpaces(C)>=t.eMarks[e])return!1;if(_=t.src.charCodeAt(C-1),n)return!0;for(g=t.tokens.length,d?(P=t.push("ordered_list_open","ol",1),1!==y&&(P.attrs=[["start",y]])):P=t.push("bullet_list_open","ul",1),P.map=m=[e,0],P.markup=String.fromCharCode(_),v=e,E=!1,z=t.md.block.ruler.getRules("list"),k=t.parentType,t.parentType="list";v<i;){for(M=C,x=t.eMarks[v],h=b=t.sCount[v]+C-(t.bMarks[e]+t.tShift[e]);M<x;){if(9===(o=t.src.charCodeAt(M)))b+=4-(b+t.bsCount[v])%4;else{if(32!==o)break;b++}M++}if((u=(a=M)>=x?1:b-h)>4&&(u=1),c=h+u,(P=t.push("list_item_open","li",1)).markup=String.fromCharCode(_),P.map=p=[e,0],d&&(P.info=t.src.slice(I,C-1)),A=t.tight,T=t.tShift[e],S=t.sCount[e],w=t.listIndent,t.listIndent=t.blkIndent,t.blkIndent=c,t.tight=!0,t.tShift[e]=a-t.bMarks[e],t.sCount[e]=b,a>=x&&t.isEmpty(e+1)?t.line=Math.min(t.line+2,i):t.md.block.tokenize(t,e,i,!0),t.tight&&!E||(F=!1),E=t.line-e>1&&t.isEmpty(t.line-1),t.blkIndent=t.listIndent,t.listIndent=w,t.tShift[e]=T,t.sCount[e]=S,t.tight=A,(P=t.push("list_item_close","li",-1)).markup=String.fromCharCode(_),v=e=t.line,p[1]=v,a=t.bMarks[e],v>=i)break;if(t.sCount[v]<t.blkIndent)break;if(t.sCount[e]-t.blkIndent>=4)break;for(D=!1,l=0,f=z.length;l<f;l++)if(z[l](t,v,i,!0)){D=!0;break}if(D)break;if(d){if((C=s(t,v))<0)break;I=t.bMarks[v]+t.tShift[v]}else if((C=r(t,v))<0)break;if(_!==t.src.charCodeAt(C-1))break}return(P=d?t.push("ordered_list_close","ol",-1):t.push("bullet_list_close","ul",-1)).markup=String.fromCharCode(_),m[1]=v,t.line=v,t.parentType=k,F&&function(t,e){var i,n,r=t.level+2;for(i=e+2,n=t.tokens.length-2;i<n;i++)t.tokens[i].level===r&&"paragraph_open"===t.tokens[i].type&&(t.tokens[i+2].hidden=!0,t.tokens[i].hidden=!0,i+=2)}(t,g),!0}},94195:function(t){"use strict";t.exports=function(t,e){var i,n,r,s,o,a,l=e+1,c=t.md.block.ruler.getRules("paragraph"),u=t.lineMax;for(a=t.parentType,t.parentType="paragraph";l<u&&!t.isEmpty(l);l++)if(!(t.sCount[l]-t.blkIndent>3||t.sCount[l]<0)){for(n=!1,r=0,s=c.length;r<s;r++)if(c[r](t,l,u,!0)){n=!0;break}if(n)break}return i=t.getLines(e,l,t.blkIndent,!1).trim(),t.line=l,(o=t.push("paragraph_open","p",1)).map=[e,t.line],(o=t.push("inline","",0)).content=i,o.map=[e,t.line],o.children=[],o=t.push("paragraph_close","p",-1),t.parentType=a,!0}},68688:function(t,e,i){"use strict";var n=i(35114).normalizeReference,r=i(35114).isSpace;t.exports=function(t,e,i,s){var o,a,l,c,u,h,d,p,f,m,g,_,y,x,v,b,w=0,k=t.bMarks[e]+t.tShift[e],S=t.eMarks[e],T=e+1;if(t.sCount[e]-t.blkIndent>=4)return!1;if(91!==t.src.charCodeAt(k))return!1;for(;++k<S;)if(93===t.src.charCodeAt(k)&&92!==t.src.charCodeAt(k-1)){if(k+1===S)return!1;if(58!==t.src.charCodeAt(k+1))return!1;break}for(c=t.lineMax,v=t.md.block.ruler.getRules("reference"),m=t.parentType,t.parentType="reference";T<c&&!t.isEmpty(T);T++)if(!(t.sCount[T]-t.blkIndent>3||t.sCount[T]<0)){for(x=!1,h=0,d=v.length;h<d;h++)if(v[h](t,T,c,!0)){x=!0;break}if(x)break}for(S=(y=t.getLines(e,T,t.blkIndent,!1).trim()).length,k=1;k<S;k++){if(91===(o=y.charCodeAt(k)))return!1;if(93===o){f=k;break}(10===o||92===o&&++k<S&&10===y.charCodeAt(k))&&w++}if(f<0||58!==y.charCodeAt(f+1))return!1;for(k=f+2;k<S;k++)if(10===(o=y.charCodeAt(k)))w++;else if(!r(o))break;if(!(g=t.md.helpers.parseLinkDestination(y,k,S)).ok)return!1;if(u=t.md.normalizeLink(g.str),!t.md.validateLink(u))return!1;for(a=k=g.pos,l=w+=g.lines,_=k;k<S;k++)if(10===(o=y.charCodeAt(k)))w++;else if(!r(o))break;for(g=t.md.helpers.parseLinkTitle(y,k,S),k<S&&_!==k&&g.ok?(b=g.str,k=g.pos,w+=g.lines):(b="",k=a,w=l);k<S&&(o=y.charCodeAt(k),r(o));)k++;if(k<S&&10!==y.charCodeAt(k)&&b)for(b="",k=a,w=l;k<S&&(o=y.charCodeAt(k),r(o));)k++;return!(k<S&&10!==y.charCodeAt(k)||!(p=n(y.slice(1,f)))||(s||(void 0===t.env.references&&(t.env.references={}),void 0===t.env.references[p]&&(t.env.references[p]={title:b,href:u}),t.parentType=m,t.line=e+w+1),0))}},48998:function(t,e,i){"use strict";var n=i(92266),r=i(35114).isSpace;function s(t,e,i,n){var s,o,a,l,c,u,h,d;for(this.src=t,this.md=e,this.env=i,this.tokens=n,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0,this.result="",d=!1,a=l=u=h=0,c=(o=this.src).length;l<c;l++){if(s=o.charCodeAt(l),!d){if(r(s)){u++,9===s?h+=4-h%4:h++;continue}d=!0}10!==s&&l!==c-1||(10!==s&&l++,this.bMarks.push(a),this.eMarks.push(l),this.tShift.push(u),this.sCount.push(h),this.bsCount.push(0),d=!1,u=0,h=0,a=l+1)}this.bMarks.push(o.length),this.eMarks.push(o.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}s.prototype.push=function(t,e,i){var r=new n(t,e,i);return r.block=!0,i<0&&this.level--,r.level=this.level,i>0&&this.level++,this.tokens.push(r),r},s.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]},s.prototype.skipEmptyLines=function(t){for(var e=this.lineMax;t<e&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t},s.prototype.skipSpaces=function(t){for(var e,i=this.src.length;t<i&&(e=this.src.charCodeAt(t),r(e));t++);return t},s.prototype.skipSpacesBack=function(t,e){if(t<=e)return t;for(;t>e;)if(!r(this.src.charCodeAt(--t)))return t+1;return t},s.prototype.skipChars=function(t,e){for(var i=this.src.length;t<i&&this.src.charCodeAt(t)===e;t++);return t},s.prototype.skipCharsBack=function(t,e,i){if(t<=i)return t;for(;t>i;)if(e!==this.src.charCodeAt(--t))return t+1;return t},s.prototype.getLines=function(t,e,i,n){var s,o,a,l,c,u,h,d=t;if(t>=e)return"";for(u=new Array(e-t),s=0;d<e;d++,s++){for(o=0,h=l=this.bMarks[d],c=d+1<e||n?this.eMarks[d]+1:this.eMarks[d];l<c&&o<i;){if(a=this.src.charCodeAt(l),r(a))9===a?o+=4-(o+this.bsCount[d])%4:o++;else{if(!(l-h<this.tShift[d]))break;o++}l++}u[s]=o>i?new Array(o-i+1).join(" ")+this.src.slice(l,c):this.src.slice(l,c)}return u.join("")},s.prototype.Token=n,t.exports=s},13309:function(t,e,i){"use strict";var n=i(35114).isSpace;function r(t,e){var i=t.bMarks[e]+t.tShift[e],n=t.eMarks[e];return t.src.substr(i,n-i)}function s(t){var e,i=[],n=0,r=t.length,s=!1,o=0,a="";for(e=t.charCodeAt(n);n<r;)124===e&&(s?(a+=t.substring(o,n-1),o=n):(i.push(a+t.substring(o,n)),a="",o=n+1)),s=92===e,n++,e=t.charCodeAt(n);return i.push(a+t.substring(o)),i}t.exports=function(t,e,i,o){var a,l,c,u,h,d,p,f,m,g,_,y,x,v,b,w,k,S;if(e+2>i)return!1;if(d=e+1,t.sCount[d]<t.blkIndent)return!1;if(t.sCount[d]-t.blkIndent>=4)return!1;if((c=t.bMarks[d]+t.tShift[d])>=t.eMarks[d])return!1;if(124!==(k=t.src.charCodeAt(c++))&&45!==k&&58!==k)return!1;if(c>=t.eMarks[d])return!1;if(124!==(S=t.src.charCodeAt(c++))&&45!==S&&58!==S&&!n(S))return!1;if(45===k&&n(S))return!1;for(;c<t.eMarks[d];){if(124!==(a=t.src.charCodeAt(c))&&45!==a&&58!==a&&!n(a))return!1;c++}for(p=(l=r(t,e+1)).split("|"),g=[],u=0;u<p.length;u++){if(!(_=p[u].trim())){if(0===u||u===p.length-1)continue;return!1}if(!/^:?-+:?$/.test(_))return!1;58===_.charCodeAt(_.length-1)?g.push(58===_.charCodeAt(0)?"center":"right"):58===_.charCodeAt(0)?g.push("left"):g.push("")}if(-1===(l=r(t,e).trim()).indexOf("|"))return!1;if(t.sCount[e]-t.blkIndent>=4)return!1;if((p=s(l)).length&&""===p[0]&&p.shift(),p.length&&""===p[p.length-1]&&p.pop(),0===(f=p.length)||f!==g.length)return!1;if(o)return!0;for(v=t.parentType,t.parentType="table",w=t.md.block.ruler.getRules("blockquote"),(m=t.push("table_open","table",1)).map=y=[e,0],(m=t.push("thead_open","thead",1)).map=[e,e+1],(m=t.push("tr_open","tr",1)).map=[e,e+1],u=0;u<p.length;u++)m=t.push("th_open","th",1),g[u]&&(m.attrs=[["style","text-align:"+g[u]]]),(m=t.push("inline","",0)).content=p[u].trim(),m.children=[],m=t.push("th_close","th",-1);for(m=t.push("tr_close","tr",-1),m=t.push("thead_close","thead",-1),d=e+2;d<i&&!(t.sCount[d]<t.blkIndent);d++){for(b=!1,u=0,h=w.length;u<h;u++)if(w[u](t,d,i,!0)){b=!0;break}if(b)break;if(!(l=r(t,d).trim()))break;if(t.sCount[d]-t.blkIndent>=4)break;for((p=s(l)).length&&""===p[0]&&p.shift(),p.length&&""===p[p.length-1]&&p.pop(),d===e+2&&((m=t.push("tbody_open","tbody",1)).map=x=[e+2,0]),(m=t.push("tr_open","tr",1)).map=[d,d+1],u=0;u<f;u++)m=t.push("td_open","td",1),g[u]&&(m.attrs=[["style","text-align:"+g[u]]]),(m=t.push("inline","",0)).content=p[u]?p[u].trim():"",m.children=[],m=t.push("td_close","td",-1);m=t.push("tr_close","tr",-1)}return x&&(m=t.push("tbody_close","tbody",-1),x[1]=d),m=t.push("table_close","table",-1),y[1]=d,t.parentType=v,t.line=d,!0}},44148:function(t){"use strict";t.exports=function(t){var e;t.inlineMode?((e=new t.Token("inline","",0)).content=t.src,e.map=[0,1],e.children=[],t.tokens.push(e)):t.md.block.parse(t.src,t.md,t.env,t.tokens)}},94650:function(t){"use strict";t.exports=function(t){var e,i,n,r=t.tokens;for(i=0,n=r.length;i<n;i++)"inline"===(e=r[i]).type&&t.md.inline.parse(e.content,t.md,t.env,e.children)}},20271:function(t,e,i){"use strict";var n=i(35114).arrayReplaceAt;function r(t){return/^<\/a\s*>/i.test(t)}t.exports=function(t){var e,i,s,o,a,l,c,u,h,d,p,f,m,g,_,y,x,v,b=t.tokens;if(t.md.options.linkify)for(i=0,s=b.length;i<s;i++)if("inline"===b[i].type&&t.md.linkify.pretest(b[i].content))for(m=0,e=(o=b[i].children).length-1;e>=0;e--)if("link_close"!==(l=o[e]).type){if("html_inline"===l.type&&(v=l.content,/^<a[>\s]/i.test(v)&&m>0&&m--,r(l.content)&&m++),!(m>0)&&"text"===l.type&&t.md.linkify.test(l.content)){for(h=l.content,x=t.md.linkify.match(h),c=[],f=l.level,p=0,u=0;u<x.length;u++)g=x[u].url,_=t.md.normalizeLink(g),t.md.validateLink(_)&&(y=x[u].text,y=x[u].schema?"mailto:"!==x[u].schema||/^mailto:/i.test(y)?t.md.normalizeLinkText(y):t.md.normalizeLinkText("mailto:"+y).replace(/^mailto:/,""):t.md.normalizeLinkText("http://"+y).replace(/^http:\/\//,""),(d=x[u].index)>p&&((a=new t.Token("text","",0)).content=h.slice(p,d),a.level=f,c.push(a)),(a=new t.Token("link_open","a",1)).attrs=[["href",_]],a.level=f++,a.markup="linkify",a.info="auto",c.push(a),(a=new t.Token("text","",0)).content=y,a.level=f,c.push(a),(a=new t.Token("link_close","a",-1)).level=--f,a.markup="linkify",a.info="auto",c.push(a),p=x[u].lastIndex);p<h.length&&((a=new t.Token("text","",0)).content=h.slice(p),a.level=f,c.push(a)),b[i].children=o=n(o,e,c)}}else for(e--;o[e].level!==l.level&&"link_open"!==o[e].type;)e--}},27442:function(t){"use strict";var e=/\r\n?|\n/g,i=/\0/g;t.exports=function(t){var n;n=(n=t.src.replace(e,"\n")).replace(i,"�"),t.src=n}},56794:function(t){"use strict";var e=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,i=/\((c|tm|r|p)\)/i,n=/\((c|tm|r|p)\)/gi,r={c:"©",r:"®",p:"§",tm:"™"};function s(t,e){return r[e.toLowerCase()]}function o(t){var e,i,r=0;for(e=t.length-1;e>=0;e--)"text"!==(i=t[e]).type||r||(i.content=i.content.replace(n,s)),"link_open"===i.type&&"auto"===i.info&&r--,"link_close"===i.type&&"auto"===i.info&&r++}function a(t){var i,n,r=0;for(i=t.length-1;i>=0;i--)"text"!==(n=t[i]).type||r||e.test(n.content)&&(n.content=n.content.replace(/\+-/g,"±").replace(/\.{2,}/g,"…").replace(/([?!])…/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/gm,"$1—").replace(/(^|\s)--(?=\s|$)/gm,"$1–").replace(/(^|[^-\s])--(?=[^-\s]|$)/gm,"$1–")),"link_open"===n.type&&"auto"===n.info&&r--,"link_close"===n.type&&"auto"===n.info&&r++}t.exports=function(t){var n;if(t.md.options.typographer)for(n=t.tokens.length-1;n>=0;n--)"inline"===t.tokens[n].type&&(i.test(t.tokens[n].content)&&o(t.tokens[n].children),e.test(t.tokens[n].content)&&a(t.tokens[n].children))}},26353:function(t,e,i){"use strict";var n=i(35114).isWhiteSpace,r=i(35114).isPunctChar,s=i(35114).isMdAsciiPunct,o=/['"]/,a=/['"]/g;function l(t,e,i){return t.substr(0,e)+i+t.substr(e+1)}function c(t,e){var i,o,c,u,h,d,p,f,m,g,_,y,x,v,b,w,k,S,T,A,M;for(T=[],i=0;i<t.length;i++){for(o=t[i],p=t[i].level,k=T.length-1;k>=0&&!(T[k].level<=p);k--);if(T.length=k+1,"text"===o.type){h=0,d=(c=o.content).length;t:for(;h<d&&(a.lastIndex=h,u=a.exec(c));){if(b=w=!0,h=u.index+1,S="'"===u[0],m=32,u.index-1>=0)m=c.charCodeAt(u.index-1);else for(k=i-1;k>=0&&"softbreak"!==t[k].type&&"hardbreak"!==t[k].type;k--)if(t[k].content){m=t[k].content.charCodeAt(t[k].content.length-1);break}if(g=32,h<d)g=c.charCodeAt(h);else for(k=i+1;k<t.length&&"softbreak"!==t[k].type&&"hardbreak"!==t[k].type;k++)if(t[k].content){g=t[k].content.charCodeAt(0);break}if(_=s(m)||r(String.fromCharCode(m)),y=s(g)||r(String.fromCharCode(g)),x=n(m),(v=n(g))?b=!1:y&&(x||_||(b=!1)),x?w=!1:_&&(v||y||(w=!1)),34===g&&'"'===u[0]&&m>=48&&m<=57&&(w=b=!1),b&&w&&(b=_,w=y),b||w){if(w)for(k=T.length-1;k>=0&&(f=T[k],!(T[k].level<p));k--)if(f.single===S&&T[k].level===p){f=T[k],S?(A=e.md.options.quotes[2],M=e.md.options.quotes[3]):(A=e.md.options.quotes[0],M=e.md.options.quotes[1]),o.content=l(o.content,u.index,M),t[f.token].content=l(t[f.token].content,f.pos,A),h+=M.length-1,f.token===i&&(h+=A.length-1),d=(c=o.content).length,T.length=k;continue t}b?T.push({token:i,pos:u.index,single:S,level:p}):w&&S&&(o.content=l(o.content,u.index,"’"))}else S&&(o.content=l(o.content,u.index,"’"))}}}}t.exports=function(t){var e;if(t.md.options.typographer)for(e=t.tokens.length-1;e>=0;e--)"inline"===t.tokens[e].type&&o.test(t.tokens[e].content)&&c(t.tokens[e].children,t)}},14214:function(t,e,i){"use strict";var n=i(92266);function r(t,e,i){this.src=t,this.env=i,this.tokens=[],this.inlineMode=!1,this.md=e}r.prototype.Token=n,t.exports=r},89930:function(t){"use strict";var e=/^([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,i=/^([a-zA-Z][a-zA-Z0-9+.\-]{1,31}):([^<>\x00-\x20]*)$/;t.exports=function(t,n){var r,s,o,a,l,c,u=t.pos;if(60!==t.src.charCodeAt(u))return!1;for(l=t.pos,c=t.posMax;;){if(++u>=c)return!1;if(60===(a=t.src.charCodeAt(u)))return!1;if(62===a)break}return r=t.src.slice(l+1,u),i.test(r)?(s=t.md.normalizeLink(r),!!t.md.validateLink(s)&&(n||((o=t.push("link_open","a",1)).attrs=[["href",s]],o.markup="autolink",o.info="auto",(o=t.push("text","",0)).content=t.md.normalizeLinkText(r),(o=t.push("link_close","a",-1)).markup="autolink",o.info="auto"),t.pos+=r.length+2,!0)):!!e.test(r)&&(s=t.md.normalizeLink("mailto:"+r),!!t.md.validateLink(s)&&(n||((o=t.push("link_open","a",1)).attrs=[["href",s]],o.markup="autolink",o.info="auto",(o=t.push("text","",0)).content=t.md.normalizeLinkText(r),(o=t.push("link_close","a",-1)).markup="autolink",o.info="auto"),t.pos+=r.length+2,!0))}},99788:function(t){"use strict";t.exports=function(t,e){var i,n,r,s,o,a,l,c,u=t.pos;if(96!==t.src.charCodeAt(u))return!1;for(i=u,u++,n=t.posMax;u<n&&96===t.src.charCodeAt(u);)u++;if(l=(r=t.src.slice(i,u)).length,t.backticksScanned&&(t.backticks[l]||0)<=i)return e||(t.pending+=r),t.pos+=l,!0;for(o=a=u;-1!==(o=t.src.indexOf("`",a));){for(a=o+1;a<n&&96===t.src.charCodeAt(a);)a++;if((c=a-o)===l)return e||((s=t.push("code_inline","code",0)).markup=r,s.content=t.src.slice(u,o).replace(/\n/g," ").replace(/^ (.+) $/,"$1")),t.pos=a,!0;t.backticks[c]=o}return t.backticksScanned=!0,e||(t.pending+=r),t.pos+=l,!0}},16457:function(t){"use strict";function e(t,e){var i,n,r,s,o,a,l,c,u={},h=e.length;for(i=0;i<h;i++)if((r=e[i]).length=r.length||0,r.close){for(u.hasOwnProperty(r.marker)||(u[r.marker]=[-1,-1,-1,-1,-1,-1]),o=u[r.marker][(r.open?3:0)+r.length%3],(n=i-r.jump-1)<-1&&(n=-1),a=n;n>o;n-=s.jump+1)if((s=e[n]).marker===r.marker&&s.open&&s.end<0&&(l=!1,(s.close||r.open)&&(s.length+r.length)%3==0&&(s.length%3==0&&r.length%3==0||(l=!0)),!l)){c=n>0&&!e[n-1].open?e[n-1].jump+1:0,r.jump=i-n+c,r.open=!1,s.end=i,s.jump=c,s.close=!1,a=-1;break}-1!==a&&(u[r.marker][(r.open?3:0)+(r.length||0)%3]=a)}}t.exports=function(t){var i,n=t.tokens_meta,r=t.tokens_meta.length;for(e(0,t.delimiters),i=0;i<r;i++)n[i]&&n[i].delimiters&&e(0,n[i].delimiters)}},43519:function(t){"use strict";function e(t,e){var i,n,r,s,o,a;for(i=e.length-1;i>=0;i--)95!==(n=e[i]).marker&&42!==n.marker||-1!==n.end&&(r=e[n.end],a=i>0&&e[i-1].end===n.end+1&&e[i-1].token===n.token-1&&e[n.end+1].token===r.token+1&&e[i-1].marker===n.marker,o=String.fromCharCode(n.marker),(s=t.tokens[n.token]).type=a?"strong_open":"em_open",s.tag=a?"strong":"em",s.nesting=1,s.markup=a?o+o:o,s.content="",(s=t.tokens[r.token]).type=a?"strong_close":"em_close",s.tag=a?"strong":"em",s.nesting=-1,s.markup=a?o+o:o,s.content="",a&&(t.tokens[e[i-1].token].content="",t.tokens[e[n.end+1].token].content="",i--))}t.exports.q=function(t,e){var i,n,r=t.pos,s=t.src.charCodeAt(r);if(e)return!1;if(95!==s&&42!==s)return!1;for(n=t.scanDelims(t.pos,42===s),i=0;i<n.length;i++)t.push("text","",0).content=String.fromCharCode(s),t.delimiters.push({marker:s,length:n.length,jump:i,token:t.tokens.length-1,end:-1,open:n.can_open,close:n.can_close});return t.pos+=n.length,!0},t.exports.g=function(t){var i,n=t.tokens_meta,r=t.tokens_meta.length;for(e(t,t.delimiters),i=0;i<r;i++)n[i]&&n[i].delimiters&&e(t,n[i].delimiters)}},97742:function(t,e,i){"use strict";var n=i(67998),r=i(35114).has,s=i(35114).isValidEntityCode,o=i(35114).fromCodePoint,a=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,l=/^&([a-z][a-z0-9]{1,31});/i;t.exports=function(t,e){var i,c,u=t.pos,h=t.posMax;if(38!==t.src.charCodeAt(u))return!1;if(u+1<h)if(35===t.src.charCodeAt(u+1)){if(c=t.src.slice(u).match(a))return e||(i="x"===c[1][0].toLowerCase()?parseInt(c[1].slice(1),16):parseInt(c[1],10),t.pending+=s(i)?o(i):o(65533)),t.pos+=c[0].length,!0}else if((c=t.src.slice(u).match(l))&&r(n,c[1]))return e||(t.pending+=n[c[1]]),t.pos+=c[0].length,!0;return e||(t.pending+="&"),t.pos++,!0}},23142:function(t,e,i){"use strict";for(var n=i(35114).isSpace,r=[],s=0;s<256;s++)r.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach((function(t){r[t.charCodeAt(0)]=1})),t.exports=function(t,e){var i,s=t.pos,o=t.posMax;if(92!==t.src.charCodeAt(s))return!1;if(++s<o){if((i=t.src.charCodeAt(s))<256&&0!==r[i])return e||(t.pending+=t.src[s]),t.pos+=2,!0;if(10===i){for(e||t.push("hardbreak","br",0),s++;s<o&&(i=t.src.charCodeAt(s),n(i));)s++;return t.pos=s,!0}}return e||(t.pending+="\\"),t.pos++,!0}},55360:function(t,e,i){"use strict";var n=i(36340).l;t.exports=function(t,e){var i,r,s,o=t.pos;return!(!t.md.options.html||(s=t.posMax,60!==t.src.charCodeAt(o)||o+2>=s||33!==(i=t.src.charCodeAt(o+1))&&63!==i&&47!==i&&!function(t){var e=32|t;return e>=97&&e<=122}(i)||!(r=t.src.slice(o).match(n))||(e||(t.push("html_inline","",0).content=t.src.slice(o,o+r[0].length)),t.pos+=r[0].length,0)))}},38746:function(t,e,i){"use strict";var n=i(35114).normalizeReference,r=i(35114).isSpace;t.exports=function(t,e){var i,s,o,a,l,c,u,h,d,p,f,m,g,_="",y=t.pos,x=t.posMax;if(33!==t.src.charCodeAt(t.pos))return!1;if(91!==t.src.charCodeAt(t.pos+1))return!1;if(c=t.pos+2,(l=t.md.helpers.parseLinkLabel(t,t.pos+1,!1))<0)return!1;if((u=l+1)<x&&40===t.src.charCodeAt(u)){for(u++;u<x&&(s=t.src.charCodeAt(u),r(s)||10===s);u++);if(u>=x)return!1;for(g=u,(d=t.md.helpers.parseLinkDestination(t.src,u,t.posMax)).ok&&(_=t.md.normalizeLink(d.str),t.md.validateLink(_)?u=d.pos:_=""),g=u;u<x&&(s=t.src.charCodeAt(u),r(s)||10===s);u++);if(d=t.md.helpers.parseLinkTitle(t.src,u,t.posMax),u<x&&g!==u&&d.ok)for(p=d.str,u=d.pos;u<x&&(s=t.src.charCodeAt(u),r(s)||10===s);u++);else p="";if(u>=x||41!==t.src.charCodeAt(u))return t.pos=y,!1;u++}else{if(void 0===t.env.references)return!1;if(u<x&&91===t.src.charCodeAt(u)?(g=u+1,(u=t.md.helpers.parseLinkLabel(t,u))>=0?a=t.src.slice(g,u++):u=l+1):u=l+1,a||(a=t.src.slice(c,l)),!(h=t.env.references[n(a)]))return t.pos=y,!1;_=h.href,p=h.title}return e||(o=t.src.slice(c,l),t.md.inline.parse(o,t.md,t.env,m=[]),(f=t.push("image","img",0)).attrs=i=[["src",_],["alt",""]],f.children=m,f.content=o,p&&i.push(["title",p])),t.pos=u,t.posMax=x,!0}},10677:function(t,e,i){"use strict";var n=i(35114).normalizeReference,r=i(35114).isSpace;t.exports=function(t,e){var i,s,o,a,l,c,u,h,d="",p="",f=t.pos,m=t.posMax,g=t.pos,_=!0;if(91!==t.src.charCodeAt(t.pos))return!1;if(l=t.pos+1,(a=t.md.helpers.parseLinkLabel(t,t.pos,!0))<0)return!1;if((c=a+1)<m&&40===t.src.charCodeAt(c)){for(_=!1,c++;c<m&&(s=t.src.charCodeAt(c),r(s)||10===s);c++);if(c>=m)return!1;if(g=c,(u=t.md.helpers.parseLinkDestination(t.src,c,t.posMax)).ok){for(d=t.md.normalizeLink(u.str),t.md.validateLink(d)?c=u.pos:d="",g=c;c<m&&(s=t.src.charCodeAt(c),r(s)||10===s);c++);if(u=t.md.helpers.parseLinkTitle(t.src,c,t.posMax),c<m&&g!==c&&u.ok)for(p=u.str,c=u.pos;c<m&&(s=t.src.charCodeAt(c),r(s)||10===s);c++);}(c>=m||41!==t.src.charCodeAt(c))&&(_=!0),c++}if(_){if(void 0===t.env.references)return!1;if(c<m&&91===t.src.charCodeAt(c)?(g=c+1,(c=t.md.helpers.parseLinkLabel(t,c))>=0?o=t.src.slice(g,c++):c=a+1):c=a+1,o||(o=t.src.slice(l,a)),!(h=t.env.references[n(o)]))return t.pos=f,!1;d=h.href,p=h.title}return e||(t.pos=l,t.posMax=a,t.push("link_open","a",1).attrs=i=[["href",d]],p&&i.push(["title",p]),t.md.inline.tokenize(t),t.push("link_close","a",-1)),t.pos=c,t.posMax=m,!0}},30899:function(t,e,i){"use strict";var n=i(35114).isSpace;t.exports=function(t,e){var i,r,s=t.pos;if(10!==t.src.charCodeAt(s))return!1;for(i=t.pending.length-1,r=t.posMax,e||(i>=0&&32===t.pending.charCodeAt(i)?i>=1&&32===t.pending.charCodeAt(i-1)?(t.pending=t.pending.replace(/ +$/,""),t.push("hardbreak","br",0)):(t.pending=t.pending.slice(0,-1),t.push("softbreak","br",0)):t.push("softbreak","br",0)),s++;s<r&&n(t.src.charCodeAt(s));)s++;return t.pos=s,!0}},93394:function(t,e,i){"use strict";var n=i(92266),r=i(35114).isWhiteSpace,s=i(35114).isPunctChar,o=i(35114).isMdAsciiPunct;function a(t,e,i,n){this.src=t,this.env=i,this.md=e,this.tokens=n,this.tokens_meta=Array(n.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1}a.prototype.pushPending=function(){var t=new n("text","",0);return t.content=this.pending,t.level=this.pendingLevel,this.tokens.push(t),this.pending="",t},a.prototype.push=function(t,e,i){this.pending&&this.pushPending();var r=new n(t,e,i),s=null;return i<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,i>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],s={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(s),r},a.prototype.scanDelims=function(t,e){var i,n,a,l,c,u,h,d,p,f=t,m=!0,g=!0,_=this.posMax,y=this.src.charCodeAt(t);for(i=t>0?this.src.charCodeAt(t-1):32;f<_&&this.src.charCodeAt(f)===y;)f++;return a=f-t,n=f<_?this.src.charCodeAt(f):32,h=o(i)||s(String.fromCharCode(i)),p=o(n)||s(String.fromCharCode(n)),u=r(i),(d=r(n))?m=!1:p&&(u||h||(m=!1)),u?g=!1:h&&(d||p||(g=!1)),e?(l=m,c=g):(l=m&&(!g||h),c=g&&(!m||p)),{can_open:l,can_close:c,length:a}},a.prototype.Token=n,t.exports=a},3228:function(t){"use strict";function e(t,e){var i,n,r,s,o,a=[],l=e.length;for(i=0;i<l;i++)126===(r=e[i]).marker&&-1!==r.end&&(s=e[r.end],(o=t.tokens[r.token]).type="s_open",o.tag="s",o.nesting=1,o.markup="~~",o.content="",(o=t.tokens[s.token]).type="s_close",o.tag="s",o.nesting=-1,o.markup="~~",o.content="","text"===t.tokens[s.token-1].type&&"~"===t.tokens[s.token-1].content&&a.push(s.token-1));for(;a.length;){for(n=(i=a.pop())+1;n<t.tokens.length&&"s_close"===t.tokens[n].type;)n++;i!==--n&&(o=t.tokens[n],t.tokens[n]=t.tokens[i],t.tokens[i]=o)}}t.exports.q=function(t,e){var i,n,r,s,o=t.pos,a=t.src.charCodeAt(o);if(e)return!1;if(126!==a)return!1;if(r=(n=t.scanDelims(t.pos,!0)).length,s=String.fromCharCode(a),r<2)return!1;for(r%2&&(t.push("text","",0).content=s,r--),i=0;i<r;i+=2)t.push("text","",0).content=s+s,t.delimiters.push({marker:a,length:0,jump:i/2,token:t.tokens.length-1,end:-1,open:n.can_open,close:n.can_close});return t.pos+=n.length,!0},t.exports.g=function(t){var i,n=t.tokens_meta,r=t.tokens_meta.length;for(e(t,t.delimiters),i=0;i<r;i++)n[i]&&n[i].delimiters&&e(t,n[i].delimiters)}},8262:function(t){"use strict";function e(t){switch(t){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}t.exports=function(t,i){for(var n=t.pos;n<t.posMax&&!e(t.src.charCodeAt(n));)n++;return n!==t.pos&&(i||(t.pending+=t.src.slice(t.pos,n)),t.pos=n,!0)}},61136:function(t){"use strict";t.exports=function(t){var e,i,n=0,r=t.tokens,s=t.tokens.length;for(e=i=0;e<s;e++)r[e].nesting<0&&n--,r[e].level=n,r[e].nesting>0&&n++,"text"===r[e].type&&e+1<s&&"text"===r[e+1].type?r[e+1].content=r[e].content+r[e+1].content:(e!==i&&(r[i]=r[e]),i++);e!==i&&(r.length=i)}},92266:function(t){"use strict";function e(t,e,i){this.type=t,this.tag=e,this.attrs=null,this.map=null,this.nesting=i,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}e.prototype.attrIndex=function(t){var e,i,n;if(!this.attrs)return-1;for(i=0,n=(e=this.attrs).length;i<n;i++)if(e[i][0]===t)return i;return-1},e.prototype.attrPush=function(t){this.attrs?this.attrs.push(t):this.attrs=[t]},e.prototype.attrSet=function(t,e){var i=this.attrIndex(t),n=[t,e];i<0?this.attrPush(n):this.attrs[i]=n},e.prototype.attrGet=function(t){var e=this.attrIndex(t),i=null;return e>=0&&(i=this.attrs[e][1]),i},e.prototype.attrJoin=function(t,e){var i=this.attrIndex(t);i<0?this.attrPush([t,e]):this.attrs[i][1]=this.attrs[i][1]+" "+e},t.exports=e},39060:function(t,e,i){"use strict";var n=i(68518),r=i(41042);const s={datetime:r.c9.DATETIME_MED_WITH_SECONDS,millisecond:"h:mm:ss.SSS a",second:r.c9.TIME_WITH_SECONDS,minute:r.c9.TIME_SIMPLE,hour:{hour:"numeric"},day:{day:"numeric",month:"short"},week:"DD",month:{month:"short",year:"numeric"},quarter:"'Q'q - yyyy",year:{year:"numeric"}};n.ij._date.override({_id:"luxon",_create:function(t){return r.c9.fromMillis(t,this.options)},formats:function(){return s},parse:function(t,e){const i=this.options;if(null==t)return null;const n=typeof t;return"number"===n?t=this._create(t):"string"===n?t="string"==typeof e?r.c9.fromFormat(t,e,i):r.c9.fromISO(t,i):t instanceof Date?t=r.c9.fromJSDate(t,i):"object"!==n||t instanceof r.c9||(t=r.c9.fromObject(t)),t.isValid?t.valueOf():null},format:function(t,e){const i=this._create(t);return"string"==typeof e?i.toFormat(e,this.options):i.toLocaleString(e)},add:function(t,e,i){const n={};return n[i]=e,this._create(t).plus(n).valueOf()},diff:function(t,e,i){return this._create(t).diff(this._create(e)).as(i).valueOf()},startOf:function(t,e,i){if("isoWeek"===e){i=Math.trunc(Math.min(Math.max(0,i),6));const e=this._create(t);return e.minus({days:(e.weekday-i+7)%7}).startOf("day").valueOf()}return e?this._create(t).startOf(e).valueOf():t},endOf:function(t,e){return this._create(t).endOf(e).valueOf()}})},16378:function(t,e,i){"use strict";i.d(e,{A:function(){return E}});var n=i(9006),r=i(68518),s=function(){if("undefined"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t)return(t.deviceXDPI||1)/(t.logicalXDPI||1)}return 1}(),o=function(t,e,i){var n,r=[].concat(e),s=r.length,o=t.font,a=0;for(t.font=i.string,n=0;n<s;++n)a=Math.max(t.measureText(r[n]).width,a);return t.font=o,{height:s*i.lineHeight,width:a}};function a(t,e){var i=e.x,n=e.y;if(null===i)return{x:0,y:-1};if(null===n)return{x:1,y:0};var r=t.x-i,s=t.y-n,o=Math.sqrt(r*r+s*s);return{x:o?r/o:0,y:o?s/o:-1}}function l(t,e,i){var n=0;return t<i.left?n|=1:t>i.right&&(n|=2),e<i.top?n|=8:e>i.bottom&&(n|=4),n}function c(t,e){var i,n,r=e.anchor,s=t;return e.clamp&&(s=function(t,e){for(var i,n,r,s=t.x0,o=t.y0,a=t.x1,c=t.y1,u=l(s,o,e),h=l(a,c,e);u|h&&!(u&h);)8&(i=u||h)?(n=s+(a-s)*(e.top-o)/(c-o),r=e.top):4&i?(n=s+(a-s)*(e.bottom-o)/(c-o),r=e.bottom):2&i?(r=o+(c-o)*(e.right-s)/(a-s),n=e.right):1&i&&(r=o+(c-o)*(e.left-s)/(a-s),n=e.left),i===u?u=l(s=n,o=r,e):h=l(a=n,c=r,e);return{x0:s,x1:a,y0:o,y1:c}}(s,e.area)),"start"===r?(i=s.x0,n=s.y0):"end"===r?(i=s.x1,n=s.y1):(i=(s.x0+s.x1)/2,n=(s.y0+s.y1)/2),function(t,e,i,n,r){switch(r){case"center":i=n=0;break;case"bottom":i=0,n=1;break;case"right":i=1,n=0;break;case"left":i=-1,n=0;break;case"top":i=0,n=-1;break;case"start":i=-i,n=-n;break;case"end":break;default:r*=Math.PI/180,i=Math.cos(r),n=Math.sin(r)}return{x:t,y:e,vx:i,vy:n}}(i,n,t.vx,t.vy,e.align)}var u=function(t,e){var i=(t.startAngle+t.endAngle)/2,n=Math.cos(i),r=Math.sin(i),s=t.innerRadius,o=t.outerRadius;return c({x0:t.x+n*s,y0:t.y+r*s,x1:t.x+n*o,y1:t.y+r*o,vx:n,vy:r},e)},h=function(t,e){var i=a(t,e.origin),n=i.x*t.options.radius,r=i.y*t.options.radius;return c({x0:t.x-n,y0:t.y-r,x1:t.x+n,y1:t.y+r,vx:i.x,vy:i.y},e)},d=function(t,e){var i=a(t,e.origin),n=t.x,r=t.y,s=0,o=0;return t.horizontal?(n=Math.min(t.x,t.base),s=Math.abs(t.base-t.x)):(r=Math.min(t.y,t.base),o=Math.abs(t.base-t.y)),c({x0:n,y0:r+o,x1:n+s,y1:r,vx:i.x,vy:i.y},e)},p=function(t,e){var i=a(t,e.origin);return c({x0:t.x,y0:t.y,x1:t.x+(t.width||0),y1:t.y+(t.height||0),vx:i.x,vy:i.y},e)},f=function(t){return Math.round(t*s)/s};function m(t,e){var i=e.chart.getDatasetMeta(e.datasetIndex).vScale;if(!i)return null;if(void 0!==i.xCenter&&void 0!==i.yCenter)return{x:i.xCenter,y:i.yCenter};var n=i.getBasePixel();return t.horizontal?{x:n,y:null}:{x:null,y:n}}function g(t,e,i){var n=t.shadowBlur,r=i.stroked,s=f(i.x),o=f(i.y),a=f(i.w);r&&t.strokeText(e,s,o,a),i.filled&&(n&&r&&(t.shadowBlur=0),t.fillText(e,s,o,a),n&&r&&(t.shadowBlur=n))}var _=function(t,e,i,n){var r=this;r._config=t,r._index=n,r._model=null,r._rects=null,r._ctx=e,r._el=i};(0,n.a4)(_.prototype,{_modelize:function(t,e,i,s){var a,l=this,c=l._index,f=(0,n.a0)((0,n.a)([i.font,{}],s,c)),g=(0,n.a)([i.color,n.d.color],s,c);return{align:(0,n.a)([i.align,"center"],s,c),anchor:(0,n.a)([i.anchor,"center"],s,c),area:s.chart.chartArea,backgroundColor:(0,n.a)([i.backgroundColor,null],s,c),borderColor:(0,n.a)([i.borderColor,null],s,c),borderRadius:(0,n.a)([i.borderRadius,0],s,c),borderWidth:(0,n.a)([i.borderWidth,0],s,c),clamp:(0,n.a)([i.clamp,!1],s,c),clip:(0,n.a)([i.clip,!1],s,c),color:g,display:t,font:f,lines:e,offset:(0,n.a)([i.offset,4],s,c),opacity:(0,n.a)([i.opacity,1],s,c),origin:m(l._el,s),padding:(0,n.E)((0,n.a)([i.padding,4],s,c)),positioner:(a=l._el,a instanceof r.Bs?u:a instanceof r.FN?h:a instanceof r.E8?d:p),rotation:(0,n.a)([i.rotation,0],s,c)*(Math.PI/180),size:o(l._ctx,e,f),textAlign:(0,n.a)([i.textAlign,"start"],s,c),textShadowBlur:(0,n.a)([i.textShadowBlur,0],s,c),textShadowColor:(0,n.a)([i.textShadowColor,g],s,c),textStrokeColor:(0,n.a)([i.textStrokeColor,g],s,c),textStrokeWidth:(0,n.a)([i.textStrokeWidth,0],s,c)}},update:function(t){var e,i,r,s=this,o=null,a=null,l=s._index,c=s._config,u=(0,n.a)([c.display,!0],t,l);u&&(e=t.dataset.data[l],i=(0,n.v)((0,n.Q)(c.formatter,[e,t]),e),(r=(0,n.k)(i)?[]:function(t){var e,i=[];for(t=[].concat(t);t.length;)"string"==typeof(e=t.pop())?i.unshift.apply(i,e.split("\n")):Array.isArray(e)?t.push.apply(t,e):(0,n.k)(t)||i.unshift(""+e);return i}(i)).length&&(a=function(t){var e=t.borderWidth||0,i=t.padding,n=t.size.height,r=t.size.width,s=-r/2,o=-n/2;return{frame:{x:s-i.left-e,y:o-i.top-e,w:r+i.width+2*e,h:n+i.height+2*e},text:{x:s,y:o,w:r,h:n}}}(o=s._modelize(u,r,c,t)))),s._model=o,s._rects=a},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(t,e){var i,n,r,s,o=t.ctx,a=this._model,l=this._rects;this.visible()&&(o.save(),a.clip&&(i=a.area,o.beginPath(),o.rect(i.left,i.top,i.right-i.left,i.bottom-i.top),o.clip()),o.globalAlpha=(n=0,r=a.opacity,s=1,Math.max(n,Math.min(r,s))),o.translate(f(e.x),f(e.y)),o.rotate(a.rotation),function(t,e,i){var n=i.backgroundColor,r=i.borderColor,s=i.borderWidth;(n||r&&s)&&(t.beginPath(),function(t,e,i,n,r,s){var o=Math.PI/2;if(s){var a=Math.min(s,r/2,n/2),l=e+a,c=i+a,u=e+n-a,h=i+r-a;t.moveTo(e,c),l<u&&c<h?(t.arc(l,c,a,-Math.PI,-o),t.arc(u,c,a,-o,0),t.arc(u,h,a,0,o),t.arc(l,h,a,o,Math.PI)):l<u?(t.moveTo(l,i),t.arc(u,c,a,-o,o),t.arc(l,c,a,o,Math.PI+o)):c<h?(t.arc(l,c,a,-Math.PI,0),t.arc(l,h,a,0,Math.PI)):t.arc(l,c,a,-Math.PI,Math.PI),t.closePath(),t.moveTo(e,i)}else t.rect(e,i,n,r)}(t,f(e.x)+s/2,f(e.y)+s/2,f(e.w)-s,f(e.h)-s,i.borderRadius),t.closePath(),n&&(t.fillStyle=n,t.fill()),r&&s&&(t.strokeStyle=r,t.lineWidth=s,t.lineJoin="miter",t.stroke()))}(o,l.frame,a),function(t,e,i,n){var r,s=n.textAlign,o=n.color,a=!!o,l=n.font,c=e.length,u=n.textStrokeColor,h=n.textStrokeWidth,d=u&&h;if(c&&(a||d))for(i=function(t,e,i){var n=i.lineHeight,r=t.w,s=t.x;return"center"===e?s+=r/2:"end"!==e&&"right"!==e||(s+=r),{h:n,w:r,x:s,y:t.y+n/2}}(i,s,l),t.font=l.string,t.textAlign=s,t.textBaseline="middle",t.shadowBlur=n.textShadowBlur,t.shadowColor=n.textShadowColor,a&&(t.fillStyle=o),d&&(t.lineJoin="round",t.lineWidth=h,t.strokeStyle=u),r=0,c=e.length;r<c;++r)g(t,e[r],{stroked:d,filled:a,w:i.w,x:i.x,y:i.y+i.h*r})}(o,a.lines,l.text,a),o.restore())}});var y=Number.MIN_SAFE_INTEGER||-9007199254740991,x=Number.MAX_SAFE_INTEGER||9007199254740991;function v(t,e,i){var n=Math.cos(i),r=Math.sin(i),s=e.x,o=e.y;return{x:s+n*(t.x-s)-r*(t.y-o),y:o+r*(t.x-s)+n*(t.y-o)}}function b(t,e){var i,n,r,s,o,a=x,l=y,c=e.origin;for(i=0;i<t.length;++i)r=(n=t[i]).x-c.x,s=n.y-c.y,o=e.vx*r+e.vy*s,a=Math.min(a,o),l=Math.max(l,o);return{min:a,max:l}}function w(t,e){var i=e.x-t.x,n=e.y-t.y,r=Math.sqrt(i*i+n*n);return{vx:(e.x-t.x)/r,vy:(e.y-t.y)/r,origin:t,ln:r}}var k=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};function S(t,e,i){var n=e.positioner(t,e),r=n.vx,s=n.vy;if(!r&&!s)return{x:n.x,y:n.y};var o=i.w,a=i.h,l=e.rotation,c=Math.abs(o/2*Math.cos(l))+Math.abs(a/2*Math.sin(l)),u=Math.abs(o/2*Math.sin(l))+Math.abs(a/2*Math.cos(l)),h=1/Math.max(Math.abs(r),Math.abs(s));return c*=r*h,u*=s*h,c+=e.offset*r,u+=e.offset*s,{x:n.x+c,y:n.y+u}}(0,n.a4)(k.prototype,{center:function(){var t=this._rect;return{x:t.x+t.w/2,y:t.y+t.h/2}},update:function(t,e,i){this._rotation=i,this._rect={x:e.x+t.x,y:e.y+t.y,w:e.w,h:e.h}},contains:function(t){var e=this,i=e._rect;return!((t=v(t,e.center(),-e._rotation)).x<i.x-1||t.y<i.y-1||t.x>i.x+i.w+2||t.y>i.y+i.h+2)},intersects:function(t){var e,i,n,r=this._points(),s=t._points(),o=[w(r[0],r[1]),w(r[0],r[3])];for(this._rotation!==t._rotation&&o.push(w(s[0],s[1]),w(s[0],s[3])),e=0;e<o.length;++e)if(i=b(r,o[e]),n=b(s,o[e]),i.max<n.min||n.max<i.min)return!1;return!0},_points:function(){var t=this,e=t._rect,i=t._rotation,n=t.center();return[v({x:e.x,y:e.y},n,i),v({x:e.x+e.w,y:e.y},n,i),v({x:e.x+e.w,y:e.y+e.h},n,i),v({x:e.x,y:e.y+e.h},n,i)]}});var T={prepare:function(t){var e,i,n,r,s,o=[];for(e=0,n=t.length;e<n;++e)for(i=0,r=t[e].length;i<r;++i)s=t[e][i],o.push(s),s.$layout={_box:new k,_hidable:!1,_visible:!0,_set:e,_idx:s._index};return o.sort((function(t,e){var i=t.$layout,n=e.$layout;return i._idx===n._idx?n._set-i._set:n._idx-i._idx})),this.update(o),o},update:function(t){var e,i,n,r,s,o=!1;for(e=0,i=t.length;e<i;++e)r=(n=t[e]).model(),(s=n.$layout)._hidable=r&&"auto"===r.display,s._visible=n.visible(),o|=s._hidable;o&&function(t){var e,i,n,r,s,o,a;for(e=0,i=t.length;e<i;++e)(r=(n=t[e]).$layout)._visible&&(a=new Proxy(n._el,{get:(t,e)=>t.getProps([e],!0)[e]}),s=n.geometry(),o=S(a,n.model(),s),r._box.update(o,s,n.rotation()));!function(t,e){var i,n,r,s;for(i=t.length-1;i>=0;--i)for(r=t[i].$layout,n=i-1;n>=0&&r._visible;--n)(s=t[n].$layout)._visible&&r._box.intersects(s._box)&&e(r,s)}(t,(function(t,e){var i=t._hidable,n=e._hidable;i&&n||n?e._visible=!1:i&&(t._visible=!1)}))}(t)},lookup:function(t,e){var i,n;for(i=t.length-1;i>=0;--i)if((n=t[i].$layout)&&n._visible&&n._box.contains(e))return t[i];return null},draw:function(t,e){var i,n,r,s,o,a;for(i=0,n=e.length;i<n;++i)(s=(r=e[i]).$layout)._visible&&(o=r.geometry(),a=S(r._el,r.model(),o),s._box.update(a,o,r.rotation()),r.draw(t,a))}},A="$datalabels",M="$default";function C(t,e,i,r){if(e){var s,o=i.$context,a=i.$groups;e[a._set]&&(s=e[a._set][a._key])&&!0===(0,n.Q)(s,[o,r])&&(t[A]._dirty=!0,i.update(o))}}var E={id:"datalabels",defaults:{align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:function(t){if((0,n.k)(t))return null;var e,i,r,s=t;if((0,n.i)(t))if((0,n.k)(t.label))if((0,n.k)(t.r))for(s="",r=0,i=(e=Object.keys(t)).length;r<i;++r)s+=(0!==r?", ":"")+e[r]+": "+t[e[r]];else s=t.r;else s=t.label;return""+s},labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},beforeInit:function(t){t[A]={_actives:[]}},beforeUpdate:function(t){var e=t[A];e._listened=!1,e._listeners={},e._datasets=[],e._labels=[]},afterDatasetUpdate:function(t,e,i){var r,s,o,a,l,c,u,h,d=e.index,p=t[A],f=p._datasets[d]=[],m=t.isDatasetVisible(d),g=t.data.datasets[d],y=function(t,e){var i,r,s,o=t.datalabels,a=[];return!1===o?null:(!0===o&&(o={}),e=(0,n.a4)({},[e,o]),r=e.labels||{},s=Object.keys(r),delete e.labels,s.length?s.forEach((function(t){r[t]&&a.push((0,n.a4)({},[e,r[t],{_key:t}]))})):a.push(e),i=a.reduce((function(t,e){return(0,n.F)(e.listeners||{},(function(i,n){t[n]=t[n]||{},t[n][e._key||M]=i})),delete e.listeners,t}),{}),{labels:a,listeners:i})}(g,i),x=e.meta.data||[],v=t.ctx;for(v.save(),r=0,o=x.length;r<o;++r)if((u=x[r])[A]=[],m&&u&&t.getDataVisibility(r)&&!u.skip)for(s=0,a=y.labels.length;s<a;++s)c=(l=y.labels[s])._key,(h=new _(l,v,u,r)).$groups={_set:d,_key:c||M},h.$context={active:!1,chart:t,dataIndex:r,dataset:g,datasetIndex:d},h.update(h.$context),u[A].push(h),f.push(h);v.restore(),(0,n.a4)(p._listeners,y.listeners,{merger:function(t,i,n){i[t]=i[t]||{},i[t][e.index]=n[t],p._listened=!0}})},afterUpdate:function(t){t[A]._labels=T.prepare(t[A]._datasets)},afterDatasetsDraw:function(t){T.draw(t,t[A]._labels)},beforeEvent:function(t,e){if(t[A]._listened){var i=e.event;switch(i.type){case"mousemove":case"mouseout":!function(t,e){var i,n,r=t[A],s=r._listeners;if(s.enter||s.leave){if("mousemove"===e.type)n=T.lookup(r._labels,e);else if("mouseout"!==e.type)return;i=r._hovered,r._hovered=n,function(t,e,i,n,r){var s,o;(i||n)&&(i?n?i!==n&&(o=s=!0):o=!0:s=!0,o&&C(t,e.leave,i,r),s&&C(t,e.enter,n,r))}(t,s,i,n,e)}}(t,i);break;case"click":!function(t,e){var i=t[A],n=i._listeners.click,r=n&&T.lookup(i._labels,e);r&&C(t,n,r,e)}(t,i)}}},afterEvent:function(t){var e,i,n,r,s,o,a,l=t[A],c=function(t,e){var i,n,r,s,o=t.slice(),a=[];for(i=0,r=e.length;i<r;++i)s=e[i],-1===(n=o.indexOf(s))?a.push([s,1]):o.splice(n,1);for(i=0,r=o.length;i<r;++i)a.push([o[i],-1]);return a}(l._actives,l._actives=t.getActiveElements());for(e=0,i=c.length;e<i;++e)if((s=c[e])[1])for(n=0,r=(a=s[0].element[A]||[]).length;n<r;++n)(o=a[n]).$context.active=1===s[1],o.update(o.$context);(l._dirty||c.length)&&(T.update(l._labels),t.render()),delete l._dirty}}},5565:function(t){self,t.exports=(()=>{"use strict";var t={d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{default:()=>c});var i=function(t,e){return"object"==typeof(i=t)&&i?e?t.x:t.y:t;var i},n=function(t){t.originalData=t.datasets.map((function(t){return function(t,e,i){if(i||2===arguments.length)for(var n,r=0,s=e.length;r<s;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return t.concat(n||Array.prototype.slice.call(e))}([],t.data,!0)}))},r=function(){return(r=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},s=Symbol(),o=function(t,e,n,r,o){var a,l=(null===(a=null==t?void 0:t.datasets)||void 0===a?void 0:a.reduce((function(t,e){var i,n=(null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.length)||0;return n>t?n:t}),0))||0,c=function(t,e,i){if(i||2===arguments.length)for(var n,r=0,s=e.length;r<s;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return t.concat(n||Array.prototype.slice.call(e))}([],new Array(l),!0).map((function(r,a){return t.datasets.reduce((function(t,r,l){var c=r.stack||s;t[c]||(t[c]=0);var u=Math.abs(i(r.data[a],n)||0)*e[l];return o?t[c]<u&&(t[c]=u):t[c]+=u,t}),{})}));return t.datasets.map((function(t){return t.data.map((function(e,o){var a=c[o][t.stack||s],l=i(e,n);return l&&a?function(t,e){var i=Math.pow(10,e);return Math.round(100*t*i)/i}(l/a,r):0}))}))},a=function(t,e){t&&t.forEach((function(t,i){e[i].data=t}))},l=function(t){return"y"===t.options.indexAxis};const c={id:"stacked100",beforeInit:function(t,e,n){if(n.enable){var s=n.replaceTooltipLabel,o=void 0===s||s,a=n.fixNegativeScale,c=void 0===a||a,u=n.individual,h=void 0!==u&&u,d=l(t),p=d?"x":"y",f=t.data.datasets.some((function(t){return t.data.some((function(t){return(i(t,d)||0)<0}))}));["x","y"].forEach((function(e){var i=e===p?function(t,e){var i={max:100};return t?e?r({min:-100},i):i:r({min:0},i)}(f,c):{},n=r(r({stacked:!h},i),t.options.scales[e]);t.options.scales[e]=n})),o&&(t.options.plugins.tooltip.callbacks.label=function(t){return function(e){var n=e.chart.data,r=e.datasetIndex,s=e.dataIndex,o=n.datasets[r].label||"",a=n.originalData[r][s],l=n.calculatedData[r][s],c=i(a,t);return"".concat(o,": ").concat(l,"% (").concat(c,")")}}(d))}},beforeUpdate:function(t,e,i){if(i.enable){var r=t.data;n(r);var s=r.datasets.map((function(e,i){var n,r;return(null!==(r=null===(n=t.getDatasetMeta(i))||void 0===n?void 0:n.hidden)&&void 0!==r?r:e.hidden)?0:1})),c=function(t){if(!("precision"in t))return 1;if("number"!=typeof t.precision)return 1;var e=Math.floor(t.precision);return e<0||e>16?1:e}(i);r.calculatedData=o(r,s,l(t),c,i.individual),a(r.calculatedData,r.datasets)}},afterUpdate:function(t,e,i){if(i.enable){var n=t.data;a(n.originalData,n.datasets)}}};return e})()},28670:function(t,e,i){var n;t=i.nmd(t),function(){var r,s="Expected a function",o="__lodash_hash_undefined__",a="__lodash_placeholder__",l=32,c=128,u=1/0,h=9007199254740991,d=NaN,p=4294967295,f=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",l],["partialRight",64],["rearg",256]],m="[object Arguments]",g="[object Array]",_="[object Boolean]",y="[object Date]",x="[object Error]",v="[object Function]",b="[object GeneratorFunction]",w="[object Map]",k="[object Number]",S="[object Object]",T="[object Promise]",A="[object RegExp]",M="[object Set]",C="[object String]",E="[object Symbol]",I="[object WeakMap]",D="[object ArrayBuffer]",z="[object DataView]",P="[object Float32Array]",L="[object Float64Array]",F="[object Int8Array]",R="[object Int16Array]",O="[object Int32Array]",B="[object Uint8Array]",V="[object Uint8ClampedArray]",N="[object Uint16Array]",q="[object Uint32Array]",j=/\b__p \+= '';/g,$=/\b(__p \+=) '' \+/g,U=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Z=/&(?:amp|lt|gt|quot|#39);/g,W=/[&<>"']/g,G=RegExp(Z.source),H=RegExp(W.source),X=/<%-([\s\S]+?)%>/g,Y=/<%([\s\S]+?)%>/g,K=/<%=([\s\S]+?)%>/g,J=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q=/^\w*$/,tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/[\\^$.*+?()[\]{}|]/g,it=RegExp(et.source),nt=/^\s+/,rt=/\s/,st=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ot=/\{\n\/\* \[wrapped with (.+)\] \*/,at=/,? & /,lt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ct=/[()=,{}\[\]\/\s]/,ut=/\\(\\)?/g,ht=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,dt=/\w*$/,pt=/^[-+]0x[0-9a-f]+$/i,ft=/^0b[01]+$/i,mt=/^\[object .+?Constructor\]$/,gt=/^0o[0-7]+$/i,_t=/^(?:0|[1-9]\d*)$/,yt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,xt=/($^)/,vt=/['\n\r\u2028\u2029\\]/g,bt="\\ud800-\\udfff",wt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",kt="\\u2700-\\u27bf",St="a-z\\xdf-\\xf6\\xf8-\\xff",Tt="A-Z\\xc0-\\xd6\\xd8-\\xde",At="\\ufe0e\\ufe0f",Mt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ct="["+bt+"]",Et="["+Mt+"]",It="["+wt+"]",Dt="\\d+",zt="["+kt+"]",Pt="["+St+"]",Lt="[^"+bt+Mt+Dt+kt+St+Tt+"]",Ft="\\ud83c[\\udffb-\\udfff]",Rt="[^"+bt+"]",Ot="(?:\\ud83c[\\udde6-\\uddff]){2}",Bt="[\\ud800-\\udbff][\\udc00-\\udfff]",Vt="["+Tt+"]",Nt="\\u200d",qt="(?:"+Pt+"|"+Lt+")",jt="(?:"+Vt+"|"+Lt+")",$t="(?:['’](?:d|ll|m|re|s|t|ve))?",Ut="(?:['’](?:D|LL|M|RE|S|T|VE))?",Zt="(?:"+It+"|"+Ft+")?",Wt="["+At+"]?",Gt=Wt+Zt+"(?:"+Nt+"(?:"+[Rt,Ot,Bt].join("|")+")"+Wt+Zt+")*",Ht="(?:"+[zt,Ot,Bt].join("|")+")"+Gt,Xt="(?:"+[Rt+It+"?",It,Ot,Bt,Ct].join("|")+")",Yt=RegExp("['’]","g"),Kt=RegExp(It,"g"),Jt=RegExp(Ft+"(?="+Ft+")|"+Xt+Gt,"g"),Qt=RegExp([Vt+"?"+Pt+"+"+$t+"(?="+[Et,Vt,"$"].join("|")+")",jt+"+"+Ut+"(?="+[Et,Vt+qt,"$"].join("|")+")",Vt+"?"+qt+"+"+$t,Vt+"+"+Ut,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Dt,Ht].join("|"),"g"),te=RegExp("["+Nt+bt+wt+At+"]"),ee=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ie=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ne=-1,re={};re[P]=re[L]=re[F]=re[R]=re[O]=re[B]=re[V]=re[N]=re[q]=!0,re[m]=re[g]=re[D]=re[_]=re[z]=re[y]=re[x]=re[v]=re[w]=re[k]=re[S]=re[A]=re[M]=re[C]=re[I]=!1;var se={};se[m]=se[g]=se[D]=se[z]=se[_]=se[y]=se[P]=se[L]=se[F]=se[R]=se[O]=se[w]=se[k]=se[S]=se[A]=se[M]=se[C]=se[E]=se[B]=se[V]=se[N]=se[q]=!0,se[x]=se[v]=se[I]=!1;var oe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ae=parseFloat,le=parseInt,ce="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g,ue="object"==typeof self&&self&&self.Object===Object&&self,he=ce||ue||Function("return this")(),de=e&&!e.nodeType&&e,pe=de&&t&&!t.nodeType&&t,fe=pe&&pe.exports===de,me=fe&&ce.process,ge=function(){try{return pe&&pe.require&&pe.require("util").types||me&&me.binding&&me.binding("util")}catch(t){}}(),_e=ge&&ge.isArrayBuffer,ye=ge&&ge.isDate,xe=ge&&ge.isMap,ve=ge&&ge.isRegExp,be=ge&&ge.isSet,we=ge&&ge.isTypedArray;function ke(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}function Se(t,e,i,n){for(var r=-1,s=null==t?0:t.length;++r<s;){var o=t[r];e(n,o,i(o),t)}return n}function Te(t,e){for(var i=-1,n=null==t?0:t.length;++i<n&&!1!==e(t[i],i,t););return t}function Ae(t,e){for(var i=null==t?0:t.length;i--&&!1!==e(t[i],i,t););return t}function Me(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(!e(t[i],i,t))return!1;return!0}function Ce(t,e){for(var i=-1,n=null==t?0:t.length,r=0,s=[];++i<n;){var o=t[i];e(o,i,t)&&(s[r++]=o)}return s}function Ee(t,e){return!(null==t||!t.length)&&Ve(t,e,0)>-1}function Ie(t,e,i){for(var n=-1,r=null==t?0:t.length;++n<r;)if(i(e,t[n]))return!0;return!1}function De(t,e){for(var i=-1,n=null==t?0:t.length,r=Array(n);++i<n;)r[i]=e(t[i],i,t);return r}function ze(t,e){for(var i=-1,n=e.length,r=t.length;++i<n;)t[r+i]=e[i];return t}function Pe(t,e,i,n){var r=-1,s=null==t?0:t.length;for(n&&s&&(i=t[++r]);++r<s;)i=e(i,t[r],r,t);return i}function Le(t,e,i,n){var r=null==t?0:t.length;for(n&&r&&(i=t[--r]);r--;)i=e(i,t[r],r,t);return i}function Fe(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}var Re=$e("length");function Oe(t,e,i){var n;return i(t,(function(t,i,r){if(e(t,i,r))return n=i,!1})),n}function Be(t,e,i,n){for(var r=t.length,s=i+(n?1:-1);n?s--:++s<r;)if(e(t[s],s,t))return s;return-1}function Ve(t,e,i){return e==e?function(t,e,i){for(var n=i-1,r=t.length;++n<r;)if(t[n]===e)return n;return-1}(t,e,i):Be(t,qe,i)}function Ne(t,e,i,n){for(var r=i-1,s=t.length;++r<s;)if(n(t[r],e))return r;return-1}function qe(t){return t!=t}function je(t,e){var i=null==t?0:t.length;return i?We(t,e)/i:d}function $e(t){return function(e){return null==e?r:e[t]}}function Ue(t){return function(e){return null==t?r:t[e]}}function Ze(t,e,i,n,r){return r(t,(function(t,r,s){i=n?(n=!1,t):e(i,t,r,s)})),i}function We(t,e){for(var i,n=-1,s=t.length;++n<s;){var o=e(t[n]);o!==r&&(i=i===r?o:i+o)}return i}function Ge(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}function He(t){return t?t.slice(0,di(t)+1).replace(nt,""):t}function Xe(t){return function(e){return t(e)}}function Ye(t,e){return De(e,(function(e){return t[e]}))}function Ke(t,e){return t.has(e)}function Je(t,e){for(var i=-1,n=t.length;++i<n&&Ve(e,t[i],0)>-1;);return i}function Qe(t,e){for(var i=t.length;i--&&Ve(e,t[i],0)>-1;);return i}function ti(t,e){for(var i=t.length,n=0;i--;)t[i]===e&&++n;return n}var ei=Ue({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),ii=Ue({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function ni(t){return"\\"+oe[t]}function ri(t){return te.test(t)}function si(t){var e=-1,i=Array(t.size);return t.forEach((function(t,n){i[++e]=[n,t]})),i}function oi(t,e){return function(i){return t(e(i))}}function ai(t,e){for(var i=-1,n=t.length,r=0,s=[];++i<n;){var o=t[i];o!==e&&o!==a||(t[i]=a,s[r++]=i)}return s}function li(t){var e=-1,i=Array(t.size);return t.forEach((function(t){i[++e]=t})),i}function ci(t){var e=-1,i=Array(t.size);return t.forEach((function(t){i[++e]=[t,t]})),i}function ui(t){return ri(t)?function(t){for(var e=Jt.lastIndex=0;Jt.test(t);)++e;return e}(t):Re(t)}function hi(t){return ri(t)?function(t){return t.match(Jt)||[]}(t):function(t){return t.split("")}(t)}function di(t){for(var e=t.length;e--&&rt.test(t.charAt(e)););return e}var pi=Ue({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),fi=function t(e){var i,n=(e=null==e?he:fi.defaults(he.Object(),e,fi.pick(he,ie))).Array,rt=e.Date,bt=e.Error,wt=e.Function,kt=e.Math,St=e.Object,Tt=e.RegExp,At=e.String,Mt=e.TypeError,Ct=n.prototype,Et=wt.prototype,It=St.prototype,Dt=e["__core-js_shared__"],zt=Et.toString,Pt=It.hasOwnProperty,Lt=0,Ft=(i=/[^.]+$/.exec(Dt&&Dt.keys&&Dt.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",Rt=It.toString,Ot=zt.call(St),Bt=he._,Vt=Tt("^"+zt.call(Pt).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Nt=fe?e.Buffer:r,qt=e.Symbol,jt=e.Uint8Array,$t=Nt?Nt.allocUnsafe:r,Ut=oi(St.getPrototypeOf,St),Zt=St.create,Wt=It.propertyIsEnumerable,Gt=Ct.splice,Ht=qt?qt.isConcatSpreadable:r,Xt=qt?qt.iterator:r,Jt=qt?qt.toStringTag:r,te=function(){try{var t=cs(St,"defineProperty");return t({},"",{}),t}catch(t){}}(),oe=e.clearTimeout!==he.clearTimeout&&e.clearTimeout,ce=rt&&rt.now!==he.Date.now&&rt.now,ue=e.setTimeout!==he.setTimeout&&e.setTimeout,de=kt.ceil,pe=kt.floor,me=St.getOwnPropertySymbols,ge=Nt?Nt.isBuffer:r,Re=e.isFinite,Ue=Ct.join,mi=oi(St.keys,St),gi=kt.max,_i=kt.min,yi=rt.now,xi=e.parseInt,vi=kt.random,bi=Ct.reverse,wi=cs(e,"DataView"),ki=cs(e,"Map"),Si=cs(e,"Promise"),Ti=cs(e,"Set"),Ai=cs(e,"WeakMap"),Mi=cs(St,"create"),Ci=Ai&&new Ai,Ei={},Ii=Bs(wi),Di=Bs(ki),zi=Bs(Si),Pi=Bs(Ti),Li=Bs(Ai),Fi=qt?qt.prototype:r,Ri=Fi?Fi.valueOf:r,Oi=Fi?Fi.toString:r;function Bi(t){if(ia(t)&&!Zo(t)&&!(t instanceof ji)){if(t instanceof qi)return t;if(Pt.call(t,"__wrapped__"))return Vs(t)}return new qi(t)}var Vi=function(){function t(){}return function(e){if(!ea(e))return{};if(Zt)return Zt(e);t.prototype=e;var i=new t;return t.prototype=r,i}}();function Ni(){}function qi(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=r}function ji(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=p,this.__views__=[]}function $i(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Ui(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Zi(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Wi(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new Zi;++e<i;)this.add(t[e])}function Gi(t){var e=this.__data__=new Ui(t);this.size=e.size}function Hi(t,e){var i=Zo(t),n=!i&&Uo(t),r=!i&&!n&&Xo(t),s=!i&&!n&&!r&&ua(t),o=i||n||r||s,a=o?Ge(t.length,At):[],l=a.length;for(var c in t)!e&&!Pt.call(t,c)||o&&("length"==c||r&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||gs(c,l))||a.push(c);return a}function Xi(t){var e=t.length;return e?t[Wn(0,e-1)]:r}function Yi(t,e){return Ps(Mr(t),on(e,0,t.length))}function Ki(t){return Ps(Mr(t))}function Ji(t,e,i){(i!==r&&!qo(t[e],i)||i===r&&!(e in t))&&rn(t,e,i)}function Qi(t,e,i){var n=t[e];Pt.call(t,e)&&qo(n,i)&&(i!==r||e in t)||rn(t,e,i)}function tn(t,e){for(var i=t.length;i--;)if(qo(t[i][0],e))return i;return-1}function en(t,e,i,n){return hn(t,(function(t,r,s){e(n,t,i(t),s)})),n}function nn(t,e){return t&&Cr(e,za(e),t)}function rn(t,e,i){"__proto__"==e&&te?te(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}function sn(t,e){for(var i=-1,s=e.length,o=n(s),a=null==t;++i<s;)o[i]=a?r:Ma(t,e[i]);return o}function on(t,e,i){return t==t&&(i!==r&&(t=t<=i?t:i),e!==r&&(t=t>=e?t:e)),t}function an(t,e,i,n,s,o){var a,l=1&e,c=2&e,u=4&e;if(i&&(a=s?i(t,n,s,o):i(t)),a!==r)return a;if(!ea(t))return t;var h=Zo(t);if(h){if(a=function(t){var e=t.length,i=new t.constructor(e);return e&&"string"==typeof t[0]&&Pt.call(t,"index")&&(i.index=t.index,i.input=t.input),i}(t),!l)return Mr(t,a)}else{var d=ds(t),p=d==v||d==b;if(Xo(t))return br(t,l);if(d==S||d==m||p&&!s){if(a=c||p?{}:fs(t),!l)return c?function(t,e){return Cr(t,hs(t),e)}(t,function(t,e){return t&&Cr(e,Pa(e),t)}(a,t)):function(t,e){return Cr(t,us(t),e)}(t,nn(a,t))}else{if(!se[d])return s?t:{};a=function(t,e,i){var n,r=t.constructor;switch(e){case D:return wr(t);case _:case y:return new r(+t);case z:return function(t,e){var i=e?wr(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}(t,i);case P:case L:case F:case R:case O:case B:case V:case N:case q:return kr(t,i);case w:return new r;case k:case C:return new r(t);case A:return function(t){var e=new t.constructor(t.source,dt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case M:return new r;case E:return n=t,Ri?St(Ri.call(n)):{}}}(t,d,l)}}o||(o=new Gi);var f=o.get(t);if(f)return f;o.set(t,a),aa(t)?t.forEach((function(n){a.add(an(n,e,i,n,t,o))})):na(t)&&t.forEach((function(n,r){a.set(r,an(n,e,i,r,t,o))}));var g=h?r:(u?c?is:es:c?Pa:za)(t);return Te(g||t,(function(n,r){g&&(n=t[r=n]),Qi(a,r,an(n,e,i,r,t,o))})),a}function ln(t,e,i){var n=i.length;if(null==t)return!n;for(t=St(t);n--;){var s=i[n],o=e[s],a=t[s];if(a===r&&!(s in t)||!o(a))return!1}return!0}function cn(t,e,i){if("function"!=typeof t)throw new Mt(s);return Es((function(){t.apply(r,i)}),e)}function un(t,e,i,n){var r=-1,s=Ee,o=!0,a=t.length,l=[],c=e.length;if(!a)return l;i&&(e=De(e,Xe(i))),n?(s=Ie,o=!1):e.length>=200&&(s=Ke,o=!1,e=new Wi(e));t:for(;++r<a;){var u=t[r],h=null==i?u:i(u);if(u=n||0!==u?u:0,o&&h==h){for(var d=c;d--;)if(e[d]===h)continue t;l.push(u)}else s(e,h,n)||l.push(u)}return l}Bi.templateSettings={escape:X,evaluate:Y,interpolate:K,variable:"",imports:{_:Bi}},Bi.prototype=Ni.prototype,Bi.prototype.constructor=Bi,qi.prototype=Vi(Ni.prototype),qi.prototype.constructor=qi,ji.prototype=Vi(Ni.prototype),ji.prototype.constructor=ji,$i.prototype.clear=function(){this.__data__=Mi?Mi(null):{},this.size=0},$i.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},$i.prototype.get=function(t){var e=this.__data__;if(Mi){var i=e[t];return i===o?r:i}return Pt.call(e,t)?e[t]:r},$i.prototype.has=function(t){var e=this.__data__;return Mi?e[t]!==r:Pt.call(e,t)},$i.prototype.set=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=Mi&&e===r?o:e,this},Ui.prototype.clear=function(){this.__data__=[],this.size=0},Ui.prototype.delete=function(t){var e=this.__data__,i=tn(e,t);return!(i<0||(i==e.length-1?e.pop():Gt.call(e,i,1),--this.size,0))},Ui.prototype.get=function(t){var e=this.__data__,i=tn(e,t);return i<0?r:e[i][1]},Ui.prototype.has=function(t){return tn(this.__data__,t)>-1},Ui.prototype.set=function(t,e){var i=this.__data__,n=tn(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this},Zi.prototype.clear=function(){this.size=0,this.__data__={hash:new $i,map:new(ki||Ui),string:new $i}},Zi.prototype.delete=function(t){var e=as(this,t).delete(t);return this.size-=e?1:0,e},Zi.prototype.get=function(t){return as(this,t).get(t)},Zi.prototype.has=function(t){return as(this,t).has(t)},Zi.prototype.set=function(t,e){var i=as(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this},Wi.prototype.add=Wi.prototype.push=function(t){return this.__data__.set(t,o),this},Wi.prototype.has=function(t){return this.__data__.has(t)},Gi.prototype.clear=function(){this.__data__=new Ui,this.size=0},Gi.prototype.delete=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i},Gi.prototype.get=function(t){return this.__data__.get(t)},Gi.prototype.has=function(t){return this.__data__.has(t)},Gi.prototype.set=function(t,e){var i=this.__data__;if(i instanceof Ui){var n=i.__data__;if(!ki||n.length<199)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new Zi(n)}return i.set(t,e),this.size=i.size,this};var hn=Dr(xn),dn=Dr(vn,!0);function pn(t,e){var i=!0;return hn(t,(function(t,n,r){return i=!!e(t,n,r)})),i}function fn(t,e,i){for(var n=-1,s=t.length;++n<s;){var o=t[n],a=e(o);if(null!=a&&(l===r?a==a&&!ca(a):i(a,l)))var l=a,c=o}return c}function mn(t,e){var i=[];return hn(t,(function(t,n,r){e(t,n,r)&&i.push(t)})),i}function gn(t,e,i,n,r){var s=-1,o=t.length;for(i||(i=ms),r||(r=[]);++s<o;){var a=t[s];e>0&&i(a)?e>1?gn(a,e-1,i,n,r):ze(r,a):n||(r[r.length]=a)}return r}var _n=zr(),yn=zr(!0);function xn(t,e){return t&&_n(t,e,za)}function vn(t,e){return t&&yn(t,e,za)}function bn(t,e){return Ce(e,(function(e){return Jo(t[e])}))}function wn(t,e){for(var i=0,n=(e=_r(e,t)).length;null!=t&&i<n;)t=t[Os(e[i++])];return i&&i==n?t:r}function kn(t,e,i){var n=e(t);return Zo(t)?n:ze(n,i(t))}function Sn(t){return null==t?t===r?"[object Undefined]":"[object Null]":Jt&&Jt in St(t)?function(t){var e=Pt.call(t,Jt),i=t[Jt];try{t[Jt]=r;var n=!0}catch(t){}var s=Rt.call(t);return n&&(e?t[Jt]=i:delete t[Jt]),s}(t):function(t){return Rt.call(t)}(t)}function Tn(t,e){return t>e}function An(t,e){return null!=t&&Pt.call(t,e)}function Mn(t,e){return null!=t&&e in St(t)}function Cn(t,e,i){for(var s=i?Ie:Ee,o=t[0].length,a=t.length,l=a,c=n(a),u=1/0,h=[];l--;){var d=t[l];l&&e&&(d=De(d,Xe(e))),u=_i(d.length,u),c[l]=!i&&(e||o>=120&&d.length>=120)?new Wi(l&&d):r}d=t[0];var p=-1,f=c[0];t:for(;++p<o&&h.length<u;){var m=d[p],g=e?e(m):m;if(m=i||0!==m?m:0,!(f?Ke(f,g):s(h,g,i))){for(l=a;--l;){var _=c[l];if(!(_?Ke(_,g):s(t[l],g,i)))continue t}f&&f.push(g),h.push(m)}}return h}function En(t,e,i){var n=null==(t=Ts(t,e=_r(e,t)))?t:t[Os(Ys(e))];return null==n?r:ke(n,t,i)}function In(t){return ia(t)&&Sn(t)==m}function Dn(t,e,i,n,s){return t===e||(null==t||null==e||!ia(t)&&!ia(e)?t!=t&&e!=e:function(t,e,i,n,s,o){var a=Zo(t),l=Zo(e),c=a?g:ds(t),u=l?g:ds(e),h=(c=c==m?S:c)==S,d=(u=u==m?S:u)==S,p=c==u;if(p&&Xo(t)){if(!Xo(e))return!1;a=!0,h=!1}if(p&&!h)return o||(o=new Gi),a||ua(t)?Qr(t,e,i,n,s,o):function(t,e,i,n,r,s,o){switch(i){case z:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case D:return!(t.byteLength!=e.byteLength||!s(new jt(t),new jt(e)));case _:case y:case k:return qo(+t,+e);case x:return t.name==e.name&&t.message==e.message;case A:case C:return t==e+"";case w:var a=si;case M:var l=1&n;if(a||(a=li),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;n|=2,o.set(t,e);var u=Qr(a(t),a(e),n,r,s,o);return o.delete(t),u;case E:if(Ri)return Ri.call(t)==Ri.call(e)}return!1}(t,e,c,i,n,s,o);if(!(1&i)){var f=h&&Pt.call(t,"__wrapped__"),v=d&&Pt.call(e,"__wrapped__");if(f||v){var b=f?t.value():t,T=v?e.value():e;return o||(o=new Gi),s(b,T,i,n,o)}}return!!p&&(o||(o=new Gi),function(t,e,i,n,s,o){var a=1&i,l=es(t),c=l.length;if(c!=es(e).length&&!a)return!1;for(var u=c;u--;){var h=l[u];if(!(a?h in e:Pt.call(e,h)))return!1}var d=o.get(t),p=o.get(e);if(d&&p)return d==e&&p==t;var f=!0;o.set(t,e),o.set(e,t);for(var m=a;++u<c;){var g=t[h=l[u]],_=e[h];if(n)var y=a?n(_,g,h,e,t,o):n(g,_,h,t,e,o);if(!(y===r?g===_||s(g,_,i,n,o):y)){f=!1;break}m||(m="constructor"==h)}if(f&&!m){var x=t.constructor,v=e.constructor;x==v||!("constructor"in t)||!("constructor"in e)||"function"==typeof x&&x instanceof x&&"function"==typeof v&&v instanceof v||(f=!1)}return o.delete(t),o.delete(e),f}(t,e,i,n,s,o))}(t,e,i,n,Dn,s))}function zn(t,e,i,n){var s=i.length,o=s,a=!n;if(null==t)return!o;for(t=St(t);s--;){var l=i[s];if(a&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++s<o;){var c=(l=i[s])[0],u=t[c],h=l[1];if(a&&l[2]){if(u===r&&!(c in t))return!1}else{var d=new Gi;if(n)var p=n(u,h,c,t,e,d);if(!(p===r?Dn(h,u,3,n,d):p))return!1}}return!0}function Pn(t){return!(!ea(t)||(e=t,Ft&&Ft in e))&&(Jo(t)?Vt:mt).test(Bs(t));var e}function Ln(t){return"function"==typeof t?t:null==t?rl:"object"==typeof t?Zo(t)?Vn(t[0],t[1]):Bn(t):pl(t)}function Fn(t){if(!bs(t))return mi(t);var e=[];for(var i in St(t))Pt.call(t,i)&&"constructor"!=i&&e.push(i);return e}function Rn(t,e){return t<e}function On(t,e){var i=-1,r=Go(t)?n(t.length):[];return hn(t,(function(t,n,s){r[++i]=e(t,n,s)})),r}function Bn(t){var e=ls(t);return 1==e.length&&e[0][2]?ks(e[0][0],e[0][1]):function(i){return i===t||zn(i,t,e)}}function Vn(t,e){return ys(t)&&ws(e)?ks(Os(t),e):function(i){var n=Ma(i,t);return n===r&&n===e?Ca(i,t):Dn(e,n,3)}}function Nn(t,e,i,n,s){t!==e&&_n(e,(function(o,a){if(s||(s=new Gi),ea(o))!function(t,e,i,n,s,o,a){var l=Ms(t,i),c=Ms(e,i),u=a.get(c);if(u)Ji(t,i,u);else{var h=o?o(l,c,i+"",t,e,a):r,d=h===r;if(d){var p=Zo(c),f=!p&&Xo(c),m=!p&&!f&&ua(c);h=c,p||f||m?Zo(l)?h=l:Ho(l)?h=Mr(l):f?(d=!1,h=br(c,!0)):m?(d=!1,h=kr(c,!0)):h=[]:sa(c)||Uo(c)?(h=l,Uo(l)?h=ya(l):ea(l)&&!Jo(l)||(h=fs(c))):d=!1}d&&(a.set(c,h),s(h,c,n,o,a),a.delete(c)),Ji(t,i,h)}}(t,e,a,i,Nn,n,s);else{var l=n?n(Ms(t,a),o,a+"",t,e,s):r;l===r&&(l=o),Ji(t,a,l)}}),Pa)}function qn(t,e){var i=t.length;if(i)return gs(e+=e<0?i:0,i)?t[e]:r}function jn(t,e,i){e=e.length?De(e,(function(t){return Zo(t)?function(e){return wn(e,1===t.length?t[0]:t)}:t})):[rl];var n=-1;e=De(e,Xe(os()));var r=On(t,(function(t,i,r){var s=De(e,(function(e){return e(t)}));return{criteria:s,index:++n,value:t}}));return function(t,e){var n=t.length;for(t.sort((function(t,e){return function(t,e,i){for(var n=-1,r=t.criteria,s=e.criteria,o=r.length,a=i.length;++n<o;){var l=Sr(r[n],s[n]);if(l)return n>=a?l:l*("desc"==i[n]?-1:1)}return t.index-e.index}(t,e,i)}));n--;)t[n]=t[n].value;return t}(r)}function $n(t,e,i){for(var n=-1,r=e.length,s={};++n<r;){var o=e[n],a=wn(t,o);i(a,o)&&Kn(s,_r(o,t),a)}return s}function Un(t,e,i,n){var r=n?Ne:Ve,s=-1,o=e.length,a=t;for(t===e&&(e=Mr(e)),i&&(a=De(t,Xe(i)));++s<o;)for(var l=0,c=e[s],u=i?i(c):c;(l=r(a,u,l,n))>-1;)a!==t&&Gt.call(a,l,1),Gt.call(t,l,1);return t}function Zn(t,e){for(var i=t?e.length:0,n=i-1;i--;){var r=e[i];if(i==n||r!==s){var s=r;gs(r)?Gt.call(t,r,1):cr(t,r)}}return t}function Wn(t,e){return t+pe(vi()*(e-t+1))}function Gn(t,e){var i="";if(!t||e<1||e>h)return i;do{e%2&&(i+=t),(e=pe(e/2))&&(t+=t)}while(e);return i}function Hn(t,e){return Is(Ss(t,e,rl),t+"")}function Xn(t){return Xi(qa(t))}function Yn(t,e){var i=qa(t);return Ps(i,on(e,0,i.length))}function Kn(t,e,i,n){if(!ea(t))return t;for(var s=-1,o=(e=_r(e,t)).length,a=o-1,l=t;null!=l&&++s<o;){var c=Os(e[s]),u=i;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(s!=a){var h=l[c];(u=n?n(h,c,l):r)===r&&(u=ea(h)?h:gs(e[s+1])?[]:{})}Qi(l,c,u),l=l[c]}return t}var Jn=Ci?function(t,e){return Ci.set(t,e),t}:rl,Qn=te?function(t,e){return te(t,"toString",{configurable:!0,enumerable:!1,value:el(e),writable:!0})}:rl;function tr(t){return Ps(qa(t))}function er(t,e,i){var r=-1,s=t.length;e<0&&(e=-e>s?0:s+e),(i=i>s?s:i)<0&&(i+=s),s=e>i?0:i-e>>>0,e>>>=0;for(var o=n(s);++r<s;)o[r]=t[r+e];return o}function ir(t,e){var i;return hn(t,(function(t,n,r){return!(i=e(t,n,r))})),!!i}function nr(t,e,i){var n=0,r=null==t?n:t.length;if("number"==typeof e&&e==e&&r<=2147483647){for(;n<r;){var s=n+r>>>1,o=t[s];null!==o&&!ca(o)&&(i?o<=e:o<e)?n=s+1:r=s}return r}return rr(t,e,rl,i)}function rr(t,e,i,n){var s=0,o=null==t?0:t.length;if(0===o)return 0;for(var a=(e=i(e))!=e,l=null===e,c=ca(e),u=e===r;s<o;){var h=pe((s+o)/2),d=i(t[h]),p=d!==r,f=null===d,m=d==d,g=ca(d);if(a)var _=n||m;else _=u?m&&(n||p):l?m&&p&&(n||!f):c?m&&p&&!f&&(n||!g):!f&&!g&&(n?d<=e:d<e);_?s=h+1:o=h}return _i(o,4294967294)}function sr(t,e){for(var i=-1,n=t.length,r=0,s=[];++i<n;){var o=t[i],a=e?e(o):o;if(!i||!qo(a,l)){var l=a;s[r++]=0===o?0:o}}return s}function or(t){return"number"==typeof t?t:ca(t)?d:+t}function ar(t){if("string"==typeof t)return t;if(Zo(t))return De(t,ar)+"";if(ca(t))return Oi?Oi.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function lr(t,e,i){var n=-1,r=Ee,s=t.length,o=!0,a=[],l=a;if(i)o=!1,r=Ie;else if(s>=200){var c=e?null:Gr(t);if(c)return li(c);o=!1,r=Ke,l=new Wi}else l=e?[]:a;t:for(;++n<s;){var u=t[n],h=e?e(u):u;if(u=i||0!==u?u:0,o&&h==h){for(var d=l.length;d--;)if(l[d]===h)continue t;e&&l.push(h),a.push(u)}else r(l,h,i)||(l!==a&&l.push(h),a.push(u))}return a}function cr(t,e){return null==(t=Ts(t,e=_r(e,t)))||delete t[Os(Ys(e))]}function ur(t,e,i,n){return Kn(t,e,i(wn(t,e)),n)}function hr(t,e,i,n){for(var r=t.length,s=n?r:-1;(n?s--:++s<r)&&e(t[s],s,t););return i?er(t,n?0:s,n?s+1:r):er(t,n?s+1:0,n?r:s)}function dr(t,e){var i=t;return i instanceof ji&&(i=i.value()),Pe(e,(function(t,e){return e.func.apply(e.thisArg,ze([t],e.args))}),i)}function pr(t,e,i){var r=t.length;if(r<2)return r?lr(t[0]):[];for(var s=-1,o=n(r);++s<r;)for(var a=t[s],l=-1;++l<r;)l!=s&&(o[s]=un(o[s]||a,t[l],e,i));return lr(gn(o,1),e,i)}function fr(t,e,i){for(var n=-1,s=t.length,o=e.length,a={};++n<s;){var l=n<o?e[n]:r;i(a,t[n],l)}return a}function mr(t){return Ho(t)?t:[]}function gr(t){return"function"==typeof t?t:rl}function _r(t,e){return Zo(t)?t:ys(t,e)?[t]:Rs(xa(t))}var yr=Hn;function xr(t,e,i){var n=t.length;return i=i===r?n:i,!e&&i>=n?t:er(t,e,i)}var vr=oe||function(t){return he.clearTimeout(t)};function br(t,e){if(e)return t.slice();var i=t.length,n=$t?$t(i):new t.constructor(i);return t.copy(n),n}function wr(t){var e=new t.constructor(t.byteLength);return new jt(e).set(new jt(t)),e}function kr(t,e){var i=e?wr(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}function Sr(t,e){if(t!==e){var i=t!==r,n=null===t,s=t==t,o=ca(t),a=e!==r,l=null===e,c=e==e,u=ca(e);if(!l&&!u&&!o&&t>e||o&&a&&c&&!l&&!u||n&&a&&c||!i&&c||!s)return 1;if(!n&&!o&&!u&&t<e||u&&i&&s&&!n&&!o||l&&i&&s||!a&&s||!c)return-1}return 0}function Tr(t,e,i,r){for(var s=-1,o=t.length,a=i.length,l=-1,c=e.length,u=gi(o-a,0),h=n(c+u),d=!r;++l<c;)h[l]=e[l];for(;++s<a;)(d||s<o)&&(h[i[s]]=t[s]);for(;u--;)h[l++]=t[s++];return h}function Ar(t,e,i,r){for(var s=-1,o=t.length,a=-1,l=i.length,c=-1,u=e.length,h=gi(o-l,0),d=n(h+u),p=!r;++s<h;)d[s]=t[s];for(var f=s;++c<u;)d[f+c]=e[c];for(;++a<l;)(p||s<o)&&(d[f+i[a]]=t[s++]);return d}function Mr(t,e){var i=-1,r=t.length;for(e||(e=n(r));++i<r;)e[i]=t[i];return e}function Cr(t,e,i,n){var s=!i;i||(i={});for(var o=-1,a=e.length;++o<a;){var l=e[o],c=n?n(i[l],t[l],l,i,t):r;c===r&&(c=t[l]),s?rn(i,l,c):Qi(i,l,c)}return i}function Er(t,e){return function(i,n){var r=Zo(i)?Se:en,s=e?e():{};return r(i,t,os(n,2),s)}}function Ir(t){return Hn((function(e,i){var n=-1,s=i.length,o=s>1?i[s-1]:r,a=s>2?i[2]:r;for(o=t.length>3&&"function"==typeof o?(s--,o):r,a&&_s(i[0],i[1],a)&&(o=s<3?r:o,s=1),e=St(e);++n<s;){var l=i[n];l&&t(e,l,n,o)}return e}))}function Dr(t,e){return function(i,n){if(null==i)return i;if(!Go(i))return t(i,n);for(var r=i.length,s=e?r:-1,o=St(i);(e?s--:++s<r)&&!1!==n(o[s],s,o););return i}}function zr(t){return function(e,i,n){for(var r=-1,s=St(e),o=n(e),a=o.length;a--;){var l=o[t?a:++r];if(!1===i(s[l],l,s))break}return e}}function Pr(t){return function(e){var i=ri(e=xa(e))?hi(e):r,n=i?i[0]:e.charAt(0),s=i?xr(i,1).join(""):e.slice(1);return n[t]()+s}}function Lr(t){return function(e){return Pe(Ja(Ua(e).replace(Yt,"")),t,"")}}function Fr(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var i=Vi(t.prototype),n=t.apply(i,e);return ea(n)?n:i}}function Rr(t){return function(e,i,n){var s=St(e);if(!Go(e)){var o=os(i,3);e=za(e),i=function(t){return o(s[t],t,s)}}var a=t(e,i,n);return a>-1?s[o?e[a]:a]:r}}function Or(t){return ts((function(e){var i=e.length,n=i,o=qi.prototype.thru;for(t&&e.reverse();n--;){var a=e[n];if("function"!=typeof a)throw new Mt(s);if(o&&!l&&"wrapper"==rs(a))var l=new qi([],!0)}for(n=l?n:i;++n<i;){var c=rs(a=e[n]),u="wrapper"==c?ns(a):r;l=u&&xs(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?l[rs(u[0])].apply(l,u[3]):1==a.length&&xs(a)?l[c]():l.thru(a)}return function(){var t=arguments,n=t[0];if(l&&1==t.length&&Zo(n))return l.plant(n).value();for(var r=0,s=i?e[r].apply(this,t):n;++r<i;)s=e[r].call(this,s);return s}}))}function Br(t,e,i,s,o,a,l,u,h,d){var p=e&c,f=1&e,m=2&e,g=24&e,_=512&e,y=m?r:Fr(t);return function r(){for(var c=arguments.length,x=n(c),v=c;v--;)x[v]=arguments[v];if(g)var b=ss(r),w=ti(x,b);if(s&&(x=Tr(x,s,o,g)),a&&(x=Ar(x,a,l,g)),c-=w,g&&c<d){var k=ai(x,b);return Zr(t,e,Br,r.placeholder,i,x,k,u,h,d-c)}var S=f?i:this,T=m?S[t]:t;return c=x.length,u?x=As(x,u):_&&c>1&&x.reverse(),p&&h<c&&(x.length=h),this&&this!==he&&this instanceof r&&(T=y||Fr(T)),T.apply(S,x)}}function Vr(t,e){return function(i,n){return function(t,e,i,n){return xn(t,(function(t,r,s){e(n,i(t),r,s)})),n}(i,t,e(n),{})}}function Nr(t,e){return function(i,n){var s;if(i===r&&n===r)return e;if(i!==r&&(s=i),n!==r){if(s===r)return n;"string"==typeof i||"string"==typeof n?(i=ar(i),n=ar(n)):(i=or(i),n=or(n)),s=t(i,n)}return s}}function qr(t){return ts((function(e){return e=De(e,Xe(os())),Hn((function(i){var n=this;return t(e,(function(t){return ke(t,n,i)}))}))}))}function jr(t,e){var i=(e=e===r?" ":ar(e)).length;if(i<2)return i?Gn(e,t):e;var n=Gn(e,de(t/ui(e)));return ri(e)?xr(hi(n),0,t).join(""):n.slice(0,t)}function $r(t){return function(e,i,s){return s&&"number"!=typeof s&&_s(e,i,s)&&(i=s=r),e=fa(e),i===r?(i=e,e=0):i=fa(i),function(t,e,i,r){for(var s=-1,o=gi(de((e-t)/(i||1)),0),a=n(o);o--;)a[r?o:++s]=t,t+=i;return a}(e,i,s=s===r?e<i?1:-1:fa(s),t)}}function Ur(t){return function(e,i){return"string"==typeof e&&"string"==typeof i||(e=_a(e),i=_a(i)),t(e,i)}}function Zr(t,e,i,n,s,o,a,c,u,h){var d=8&e;e|=d?l:64,4&(e&=~(d?64:l))||(e&=-4);var p=[t,e,s,d?o:r,d?a:r,d?r:o,d?r:a,c,u,h],f=i.apply(r,p);return xs(t)&&Cs(f,p),f.placeholder=n,Ds(f,t,e)}function Wr(t){var e=kt[t];return function(t,i){if(t=_a(t),(i=null==i?0:_i(ma(i),292))&&Re(t)){var n=(xa(t)+"e").split("e");return+((n=(xa(e(n[0]+"e"+(+n[1]+i)))+"e").split("e"))[0]+"e"+(+n[1]-i))}return e(t)}}var Gr=Ti&&1/li(new Ti([,-0]))[1]==u?function(t){return new Ti(t)}:cl;function Hr(t){return function(e){var i=ds(e);return i==w?si(e):i==M?ci(e):function(t,e){return De(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Xr(t,e,i,o,u,h,d,p){var f=2&e;if(!f&&"function"!=typeof t)throw new Mt(s);var m=o?o.length:0;if(m||(e&=-97,o=u=r),d=d===r?d:gi(ma(d),0),p=p===r?p:ma(p),m-=u?u.length:0,64&e){var g=o,_=u;o=u=r}var y=f?r:ns(t),x=[t,e,i,o,u,g,_,h,d,p];if(y&&function(t,e){var i=t[1],n=e[1],r=i|n,s=r<131,o=n==c&&8==i||n==c&&256==i&&t[7].length<=e[8]||384==n&&e[7].length<=e[8]&&8==i;if(!s&&!o)return t;1&n&&(t[2]=e[2],r|=1&i?0:4);var l=e[3];if(l){var u=t[3];t[3]=u?Tr(u,l,e[4]):l,t[4]=u?ai(t[3],a):e[4]}(l=e[5])&&(u=t[5],t[5]=u?Ar(u,l,e[6]):l,t[6]=u?ai(t[5],a):e[6]),(l=e[7])&&(t[7]=l),n&c&&(t[8]=null==t[8]?e[8]:_i(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=r}(x,y),t=x[0],e=x[1],i=x[2],o=x[3],u=x[4],!(p=x[9]=x[9]===r?f?0:t.length:gi(x[9]-m,0))&&24&e&&(e&=-25),e&&1!=e)v=8==e||16==e?function(t,e,i){var s=Fr(t);return function o(){for(var a=arguments.length,l=n(a),c=a,u=ss(o);c--;)l[c]=arguments[c];var h=a<3&&l[0]!==u&&l[a-1]!==u?[]:ai(l,u);return(a-=h.length)<i?Zr(t,e,Br,o.placeholder,r,l,h,r,r,i-a):ke(this&&this!==he&&this instanceof o?s:t,this,l)}}(t,e,p):e!=l&&33!=e||u.length?Br.apply(r,x):function(t,e,i,r){var s=1&e,o=Fr(t);return function e(){for(var a=-1,l=arguments.length,c=-1,u=r.length,h=n(u+l),d=this&&this!==he&&this instanceof e?o:t;++c<u;)h[c]=r[c];for(;l--;)h[c++]=arguments[++a];return ke(d,s?i:this,h)}}(t,e,i,o);else var v=function(t,e,i){var n=1&e,r=Fr(t);return function e(){return(this&&this!==he&&this instanceof e?r:t).apply(n?i:this,arguments)}}(t,e,i);return Ds((y?Jn:Cs)(v,x),t,e)}function Yr(t,e,i,n){return t===r||qo(t,It[i])&&!Pt.call(n,i)?e:t}function Kr(t,e,i,n,s,o){return ea(t)&&ea(e)&&(o.set(e,t),Nn(t,e,r,Kr,o),o.delete(e)),t}function Jr(t){return sa(t)?r:t}function Qr(t,e,i,n,s,o){var a=1&i,l=t.length,c=e.length;if(l!=c&&!(a&&c>l))return!1;var u=o.get(t),h=o.get(e);if(u&&h)return u==e&&h==t;var d=-1,p=!0,f=2&i?new Wi:r;for(o.set(t,e),o.set(e,t);++d<l;){var m=t[d],g=e[d];if(n)var _=a?n(g,m,d,e,t,o):n(m,g,d,t,e,o);if(_!==r){if(_)continue;p=!1;break}if(f){if(!Fe(e,(function(t,e){if(!Ke(f,e)&&(m===t||s(m,t,i,n,o)))return f.push(e)}))){p=!1;break}}else if(m!==g&&!s(m,g,i,n,o)){p=!1;break}}return o.delete(t),o.delete(e),p}function ts(t){return Is(Ss(t,r,Zs),t+"")}function es(t){return kn(t,za,us)}function is(t){return kn(t,Pa,hs)}var ns=Ci?function(t){return Ci.get(t)}:cl;function rs(t){for(var e=t.name+"",i=Ei[e],n=Pt.call(Ei,e)?i.length:0;n--;){var r=i[n],s=r.func;if(null==s||s==t)return r.name}return e}function ss(t){return(Pt.call(Bi,"placeholder")?Bi:t).placeholder}function os(){var t=Bi.iteratee||sl;return t=t===sl?Ln:t,arguments.length?t(arguments[0],arguments[1]):t}function as(t,e){var i,n,r=t.__data__;return("string"==(n=typeof(i=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==i:null===i)?r["string"==typeof e?"string":"hash"]:r.map}function ls(t){for(var e=za(t),i=e.length;i--;){var n=e[i],r=t[n];e[i]=[n,r,ws(r)]}return e}function cs(t,e){var i=function(t,e){return null==t?r:t[e]}(t,e);return Pn(i)?i:r}var us=me?function(t){return null==t?[]:(t=St(t),Ce(me(t),(function(e){return Wt.call(t,e)})))}:gl,hs=me?function(t){for(var e=[];t;)ze(e,us(t)),t=Ut(t);return e}:gl,ds=Sn;function ps(t,e,i){for(var n=-1,r=(e=_r(e,t)).length,s=!1;++n<r;){var o=Os(e[n]);if(!(s=null!=t&&i(t,o)))break;t=t[o]}return s||++n!=r?s:!!(r=null==t?0:t.length)&&ta(r)&&gs(o,r)&&(Zo(t)||Uo(t))}function fs(t){return"function"!=typeof t.constructor||bs(t)?{}:Vi(Ut(t))}function ms(t){return Zo(t)||Uo(t)||!!(Ht&&t&&t[Ht])}function gs(t,e){var i=typeof t;return!!(e=null==e?h:e)&&("number"==i||"symbol"!=i&&_t.test(t))&&t>-1&&t%1==0&&t<e}function _s(t,e,i){if(!ea(i))return!1;var n=typeof e;return!!("number"==n?Go(i)&&gs(e,i.length):"string"==n&&e in i)&&qo(i[e],t)}function ys(t,e){if(Zo(t))return!1;var i=typeof t;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!ca(t))||Q.test(t)||!J.test(t)||null!=e&&t in St(e)}function xs(t){var e=rs(t),i=Bi[e];if("function"!=typeof i||!(e in ji.prototype))return!1;if(t===i)return!0;var n=ns(i);return!!n&&t===n[0]}(wi&&ds(new wi(new ArrayBuffer(1)))!=z||ki&&ds(new ki)!=w||Si&&ds(Si.resolve())!=T||Ti&&ds(new Ti)!=M||Ai&&ds(new Ai)!=I)&&(ds=function(t){var e=Sn(t),i=e==S?t.constructor:r,n=i?Bs(i):"";if(n)switch(n){case Ii:return z;case Di:return w;case zi:return T;case Pi:return M;case Li:return I}return e});var vs=Dt?Jo:_l;function bs(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||It)}function ws(t){return t==t&&!ea(t)}function ks(t,e){return function(i){return null!=i&&i[t]===e&&(e!==r||t in St(i))}}function Ss(t,e,i){return e=gi(e===r?t.length-1:e,0),function(){for(var r=arguments,s=-1,o=gi(r.length-e,0),a=n(o);++s<o;)a[s]=r[e+s];s=-1;for(var l=n(e+1);++s<e;)l[s]=r[s];return l[e]=i(a),ke(t,this,l)}}function Ts(t,e){return e.length<2?t:wn(t,er(e,0,-1))}function As(t,e){for(var i=t.length,n=_i(e.length,i),s=Mr(t);n--;){var o=e[n];t[n]=gs(o,i)?s[o]:r}return t}function Ms(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Cs=zs(Jn),Es=ue||function(t,e){return he.setTimeout(t,e)},Is=zs(Qn);function Ds(t,e,i){var n=e+"";return Is(t,function(t,e){var i=e.length;if(!i)return t;var n=i-1;return e[n]=(i>1?"& ":"")+e[n],e=e.join(i>2?", ":" "),t.replace(st,"{\n/* [wrapped with "+e+"] */\n")}(n,function(t,e){return Te(f,(function(i){var n="_."+i[0];e&i[1]&&!Ee(t,n)&&t.push(n)})),t.sort()}(function(t){var e=t.match(ot);return e?e[1].split(at):[]}(n),i)))}function zs(t){var e=0,i=0;return function(){var n=yi(),s=16-(n-i);if(i=n,s>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(r,arguments)}}function Ps(t,e){var i=-1,n=t.length,s=n-1;for(e=e===r?n:e;++i<e;){var o=Wn(i,s),a=t[o];t[o]=t[i],t[i]=a}return t.length=e,t}var Ls,Fs,Rs=(Ls=Fo((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(tt,(function(t,i,n,r){e.push(n?r.replace(ut,"$1"):i||t)})),e}),(function(t){return 500===Fs.size&&Fs.clear(),t})),Fs=Ls.cache,Ls);function Os(t){if("string"==typeof t||ca(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Bs(t){if(null!=t){try{return zt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Vs(t){if(t instanceof ji)return t.clone();var e=new qi(t.__wrapped__,t.__chain__);return e.__actions__=Mr(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Ns=Hn((function(t,e){return Ho(t)?un(t,gn(e,1,Ho,!0)):[]})),qs=Hn((function(t,e){var i=Ys(e);return Ho(i)&&(i=r),Ho(t)?un(t,gn(e,1,Ho,!0),os(i,2)):[]})),js=Hn((function(t,e){var i=Ys(e);return Ho(i)&&(i=r),Ho(t)?un(t,gn(e,1,Ho,!0),r,i):[]}));function $s(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var r=null==i?0:ma(i);return r<0&&(r=gi(n+r,0)),Be(t,os(e,3),r)}function Us(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var s=n-1;return i!==r&&(s=ma(i),s=i<0?gi(n+s,0):_i(s,n-1)),Be(t,os(e,3),s,!0)}function Zs(t){return null!=t&&t.length?gn(t,1):[]}function Ws(t){return t&&t.length?t[0]:r}var Gs=Hn((function(t){var e=De(t,mr);return e.length&&e[0]===t[0]?Cn(e):[]})),Hs=Hn((function(t){var e=Ys(t),i=De(t,mr);return e===Ys(i)?e=r:i.pop(),i.length&&i[0]===t[0]?Cn(i,os(e,2)):[]})),Xs=Hn((function(t){var e=Ys(t),i=De(t,mr);return(e="function"==typeof e?e:r)&&i.pop(),i.length&&i[0]===t[0]?Cn(i,r,e):[]}));function Ys(t){var e=null==t?0:t.length;return e?t[e-1]:r}var Ks=Hn(Js);function Js(t,e){return t&&t.length&&e&&e.length?Un(t,e):t}var Qs=ts((function(t,e){var i=null==t?0:t.length,n=sn(t,e);return Zn(t,De(e,(function(t){return gs(t,i)?+t:t})).sort(Sr)),n}));function to(t){return null==t?t:bi.call(t)}var eo=Hn((function(t){return lr(gn(t,1,Ho,!0))})),io=Hn((function(t){var e=Ys(t);return Ho(e)&&(e=r),lr(gn(t,1,Ho,!0),os(e,2))})),no=Hn((function(t){var e=Ys(t);return e="function"==typeof e?e:r,lr(gn(t,1,Ho,!0),r,e)}));function ro(t){if(!t||!t.length)return[];var e=0;return t=Ce(t,(function(t){if(Ho(t))return e=gi(t.length,e),!0})),Ge(e,(function(e){return De(t,$e(e))}))}function so(t,e){if(!t||!t.length)return[];var i=ro(t);return null==e?i:De(i,(function(t){return ke(e,r,t)}))}var oo=Hn((function(t,e){return Ho(t)?un(t,e):[]})),ao=Hn((function(t){return pr(Ce(t,Ho))})),lo=Hn((function(t){var e=Ys(t);return Ho(e)&&(e=r),pr(Ce(t,Ho),os(e,2))})),co=Hn((function(t){var e=Ys(t);return e="function"==typeof e?e:r,pr(Ce(t,Ho),r,e)})),uo=Hn(ro),ho=Hn((function(t){var e=t.length,i=e>1?t[e-1]:r;return i="function"==typeof i?(t.pop(),i):r,so(t,i)}));function po(t){var e=Bi(t);return e.__chain__=!0,e}function fo(t,e){return e(t)}var mo=ts((function(t){var e=t.length,i=e?t[0]:0,n=this.__wrapped__,s=function(e){return sn(e,t)};return!(e>1||this.__actions__.length)&&n instanceof ji&&gs(i)?((n=n.slice(i,+i+(e?1:0))).__actions__.push({func:fo,args:[s],thisArg:r}),new qi(n,this.__chain__).thru((function(t){return e&&!t.length&&t.push(r),t}))):this.thru(s)})),go=Er((function(t,e,i){Pt.call(t,i)?++t[i]:rn(t,i,1)})),_o=Rr($s),yo=Rr(Us);function xo(t,e){return(Zo(t)?Te:hn)(t,os(e,3))}function vo(t,e){return(Zo(t)?Ae:dn)(t,os(e,3))}var bo=Er((function(t,e,i){Pt.call(t,i)?t[i].push(e):rn(t,i,[e])})),wo=Hn((function(t,e,i){var r=-1,s="function"==typeof e,o=Go(t)?n(t.length):[];return hn(t,(function(t){o[++r]=s?ke(e,t,i):En(t,e,i)})),o})),ko=Er((function(t,e,i){rn(t,i,e)}));function So(t,e){return(Zo(t)?De:On)(t,os(e,3))}var To=Er((function(t,e,i){t[i?0:1].push(e)}),(function(){return[[],[]]})),Ao=Hn((function(t,e){if(null==t)return[];var i=e.length;return i>1&&_s(t,e[0],e[1])?e=[]:i>2&&_s(e[0],e[1],e[2])&&(e=[e[0]]),jn(t,gn(e,1),[])})),Mo=ce||function(){return he.Date.now()};function Co(t,e,i){return e=i?r:e,e=t&&null==e?t.length:e,Xr(t,c,r,r,r,r,e)}function Eo(t,e){var i;if("function"!=typeof e)throw new Mt(s);return t=ma(t),function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=r),i}}var Io=Hn((function(t,e,i){var n=1;if(i.length){var r=ai(i,ss(Io));n|=l}return Xr(t,n,e,i,r)})),Do=Hn((function(t,e,i){var n=3;if(i.length){var r=ai(i,ss(Do));n|=l}return Xr(e,n,t,i,r)}));function zo(t,e,i){var n,o,a,l,c,u,h=0,d=!1,p=!1,f=!0;if("function"!=typeof t)throw new Mt(s);function m(e){var i=n,s=o;return n=o=r,h=e,l=t.apply(s,i)}function g(t){return h=t,c=Es(y,e),d?m(t):l}function _(t){var i=t-u;return u===r||i>=e||i<0||p&&t-h>=a}function y(){var t=Mo();if(_(t))return x(t);c=Es(y,function(t){var i=e-(t-u);return p?_i(i,a-(t-h)):i}(t))}function x(t){return c=r,f&&n?m(t):(n=o=r,l)}function v(){var t=Mo(),i=_(t);if(n=arguments,o=this,u=t,i){if(c===r)return g(u);if(p)return vr(c),c=Es(y,e),m(u)}return c===r&&(c=Es(y,e)),l}return e=_a(e)||0,ea(i)&&(d=!!i.leading,a=(p="maxWait"in i)?gi(_a(i.maxWait)||0,e):a,f="trailing"in i?!!i.trailing:f),v.cancel=function(){c!==r&&vr(c),h=0,n=u=o=c=r},v.flush=function(){return c===r?l:x(Mo())},v}var Po=Hn((function(t,e){return cn(t,1,e)})),Lo=Hn((function(t,e,i){return cn(t,_a(e)||0,i)}));function Fo(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new Mt(s);var i=function(){var n=arguments,r=e?e.apply(this,n):n[0],s=i.cache;if(s.has(r))return s.get(r);var o=t.apply(this,n);return i.cache=s.set(r,o)||s,o};return i.cache=new(Fo.Cache||Zi),i}function Ro(t){if("function"!=typeof t)throw new Mt(s);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Fo.Cache=Zi;var Oo=yr((function(t,e){var i=(e=1==e.length&&Zo(e[0])?De(e[0],Xe(os())):De(gn(e,1),Xe(os()))).length;return Hn((function(n){for(var r=-1,s=_i(n.length,i);++r<s;)n[r]=e[r].call(this,n[r]);return ke(t,this,n)}))})),Bo=Hn((function(t,e){var i=ai(e,ss(Bo));return Xr(t,l,r,e,i)})),Vo=Hn((function(t,e){var i=ai(e,ss(Vo));return Xr(t,64,r,e,i)})),No=ts((function(t,e){return Xr(t,256,r,r,r,e)}));function qo(t,e){return t===e||t!=t&&e!=e}var jo=Ur(Tn),$o=Ur((function(t,e){return t>=e})),Uo=In(function(){return arguments}())?In:function(t){return ia(t)&&Pt.call(t,"callee")&&!Wt.call(t,"callee")},Zo=n.isArray,Wo=_e?Xe(_e):function(t){return ia(t)&&Sn(t)==D};function Go(t){return null!=t&&ta(t.length)&&!Jo(t)}function Ho(t){return ia(t)&&Go(t)}var Xo=ge||_l,Yo=ye?Xe(ye):function(t){return ia(t)&&Sn(t)==y};function Ko(t){if(!ia(t))return!1;var e=Sn(t);return e==x||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!sa(t)}function Jo(t){if(!ea(t))return!1;var e=Sn(t);return e==v||e==b||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Qo(t){return"number"==typeof t&&t==ma(t)}function ta(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=h}function ea(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function ia(t){return null!=t&&"object"==typeof t}var na=xe?Xe(xe):function(t){return ia(t)&&ds(t)==w};function ra(t){return"number"==typeof t||ia(t)&&Sn(t)==k}function sa(t){if(!ia(t)||Sn(t)!=S)return!1;var e=Ut(t);if(null===e)return!0;var i=Pt.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&zt.call(i)==Ot}var oa=ve?Xe(ve):function(t){return ia(t)&&Sn(t)==A},aa=be?Xe(be):function(t){return ia(t)&&ds(t)==M};function la(t){return"string"==typeof t||!Zo(t)&&ia(t)&&Sn(t)==C}function ca(t){return"symbol"==typeof t||ia(t)&&Sn(t)==E}var ua=we?Xe(we):function(t){return ia(t)&&ta(t.length)&&!!re[Sn(t)]},ha=Ur(Rn),da=Ur((function(t,e){return t<=e}));function pa(t){if(!t)return[];if(Go(t))return la(t)?hi(t):Mr(t);if(Xt&&t[Xt])return function(t){for(var e,i=[];!(e=t.next()).done;)i.push(e.value);return i}(t[Xt]());var e=ds(t);return(e==w?si:e==M?li:qa)(t)}function fa(t){return t?(t=_a(t))===u||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ma(t){var e=fa(t),i=e%1;return e==e?i?e-i:e:0}function ga(t){return t?on(ma(t),0,p):0}function _a(t){if("number"==typeof t)return t;if(ca(t))return d;if(ea(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=ea(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=He(t);var i=ft.test(t);return i||gt.test(t)?le(t.slice(2),i?2:8):pt.test(t)?d:+t}function ya(t){return Cr(t,Pa(t))}function xa(t){return null==t?"":ar(t)}var va=Ir((function(t,e){if(bs(e)||Go(e))Cr(e,za(e),t);else for(var i in e)Pt.call(e,i)&&Qi(t,i,e[i])})),ba=Ir((function(t,e){Cr(e,Pa(e),t)})),wa=Ir((function(t,e,i,n){Cr(e,Pa(e),t,n)})),ka=Ir((function(t,e,i,n){Cr(e,za(e),t,n)})),Sa=ts(sn),Ta=Hn((function(t,e){t=St(t);var i=-1,n=e.length,s=n>2?e[2]:r;for(s&&_s(e[0],e[1],s)&&(n=1);++i<n;)for(var o=e[i],a=Pa(o),l=-1,c=a.length;++l<c;){var u=a[l],h=t[u];(h===r||qo(h,It[u])&&!Pt.call(t,u))&&(t[u]=o[u])}return t})),Aa=Hn((function(t){return t.push(r,Kr),ke(Fa,r,t)}));function Ma(t,e,i){var n=null==t?r:wn(t,e);return n===r?i:n}function Ca(t,e){return null!=t&&ps(t,e,Mn)}var Ea=Vr((function(t,e,i){null!=e&&"function"!=typeof e.toString&&(e=Rt.call(e)),t[e]=i}),el(rl)),Ia=Vr((function(t,e,i){null!=e&&"function"!=typeof e.toString&&(e=Rt.call(e)),Pt.call(t,e)?t[e].push(i):t[e]=[i]}),os),Da=Hn(En);function za(t){return Go(t)?Hi(t):Fn(t)}function Pa(t){return Go(t)?Hi(t,!0):function(t){if(!ea(t))return function(t){var e=[];if(null!=t)for(var i in St(t))e.push(i);return e}(t);var e=bs(t),i=[];for(var n in t)("constructor"!=n||!e&&Pt.call(t,n))&&i.push(n);return i}(t)}var La=Ir((function(t,e,i){Nn(t,e,i)})),Fa=Ir((function(t,e,i,n){Nn(t,e,i,n)})),Ra=ts((function(t,e){var i={};if(null==t)return i;var n=!1;e=De(e,(function(e){return e=_r(e,t),n||(n=e.length>1),e})),Cr(t,is(t),i),n&&(i=an(i,7,Jr));for(var r=e.length;r--;)cr(i,e[r]);return i})),Oa=ts((function(t,e){return null==t?{}:function(t,e){return $n(t,e,(function(e,i){return Ca(t,i)}))}(t,e)}));function Ba(t,e){if(null==t)return{};var i=De(is(t),(function(t){return[t]}));return e=os(e),$n(t,i,(function(t,i){return e(t,i[0])}))}var Va=Hr(za),Na=Hr(Pa);function qa(t){return null==t?[]:Ye(t,za(t))}var ja=Lr((function(t,e,i){return e=e.toLowerCase(),t+(i?$a(e):e)}));function $a(t){return Ka(xa(t).toLowerCase())}function Ua(t){return(t=xa(t))&&t.replace(yt,ei).replace(Kt,"")}var Za=Lr((function(t,e,i){return t+(i?"-":"")+e.toLowerCase()})),Wa=Lr((function(t,e,i){return t+(i?" ":"")+e.toLowerCase()})),Ga=Pr("toLowerCase"),Ha=Lr((function(t,e,i){return t+(i?"_":"")+e.toLowerCase()})),Xa=Lr((function(t,e,i){return t+(i?" ":"")+Ka(e)})),Ya=Lr((function(t,e,i){return t+(i?" ":"")+e.toUpperCase()})),Ka=Pr("toUpperCase");function Ja(t,e,i){return t=xa(t),(e=i?r:e)===r?function(t){return ee.test(t)}(t)?function(t){return t.match(Qt)||[]}(t):function(t){return t.match(lt)||[]}(t):t.match(e)||[]}var Qa=Hn((function(t,e){try{return ke(t,r,e)}catch(t){return Ko(t)?t:new bt(t)}})),tl=ts((function(t,e){return Te(e,(function(e){e=Os(e),rn(t,e,Io(t[e],t))})),t}));function el(t){return function(){return t}}var il=Or(),nl=Or(!0);function rl(t){return t}function sl(t){return Ln("function"==typeof t?t:an(t,1))}var ol=Hn((function(t,e){return function(i){return En(i,t,e)}})),al=Hn((function(t,e){return function(i){return En(t,i,e)}}));function ll(t,e,i){var n=za(e),r=bn(e,n);null!=i||ea(e)&&(r.length||!n.length)||(i=e,e=t,t=this,r=bn(e,za(e)));var s=!(ea(i)&&"chain"in i&&!i.chain),o=Jo(t);return Te(r,(function(i){var n=e[i];t[i]=n,o&&(t.prototype[i]=function(){var e=this.__chain__;if(s||e){var i=t(this.__wrapped__),r=i.__actions__=Mr(this.__actions__);return r.push({func:n,args:arguments,thisArg:t}),i.__chain__=e,i}return n.apply(t,ze([this.value()],arguments))})})),t}function cl(){}var ul=qr(De),hl=qr(Me),dl=qr(Fe);function pl(t){return ys(t)?$e(Os(t)):function(t){return function(e){return wn(e,t)}}(t)}var fl=$r(),ml=$r(!0);function gl(){return[]}function _l(){return!1}var yl,xl=Nr((function(t,e){return t+e}),0),vl=Wr("ceil"),bl=Nr((function(t,e){return t/e}),1),wl=Wr("floor"),kl=Nr((function(t,e){return t*e}),1),Sl=Wr("round"),Tl=Nr((function(t,e){return t-e}),0);return Bi.after=function(t,e){if("function"!=typeof e)throw new Mt(s);return t=ma(t),function(){if(--t<1)return e.apply(this,arguments)}},Bi.ary=Co,Bi.assign=va,Bi.assignIn=ba,Bi.assignInWith=wa,Bi.assignWith=ka,Bi.at=Sa,Bi.before=Eo,Bi.bind=Io,Bi.bindAll=tl,Bi.bindKey=Do,Bi.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Zo(t)?t:[t]},Bi.chain=po,Bi.chunk=function(t,e,i){e=(i?_s(t,e,i):e===r)?1:gi(ma(e),0);var s=null==t?0:t.length;if(!s||e<1)return[];for(var o=0,a=0,l=n(de(s/e));o<s;)l[a++]=er(t,o,o+=e);return l},Bi.compact=function(t){for(var e=-1,i=null==t?0:t.length,n=0,r=[];++e<i;){var s=t[e];s&&(r[n++]=s)}return r},Bi.concat=function(){var t=arguments.length;if(!t)return[];for(var e=n(t-1),i=arguments[0],r=t;r--;)e[r-1]=arguments[r];return ze(Zo(i)?Mr(i):[i],gn(e,1))},Bi.cond=function(t){var e=null==t?0:t.length,i=os();return t=e?De(t,(function(t){if("function"!=typeof t[1])throw new Mt(s);return[i(t[0]),t[1]]})):[],Hn((function(i){for(var n=-1;++n<e;){var r=t[n];if(ke(r[0],this,i))return ke(r[1],this,i)}}))},Bi.conforms=function(t){return function(t){var e=za(t);return function(i){return ln(i,t,e)}}(an(t,1))},Bi.constant=el,Bi.countBy=go,Bi.create=function(t,e){var i=Vi(t);return null==e?i:nn(i,e)},Bi.curry=function t(e,i,n){var s=Xr(e,8,r,r,r,r,r,i=n?r:i);return s.placeholder=t.placeholder,s},Bi.curryRight=function t(e,i,n){var s=Xr(e,16,r,r,r,r,r,i=n?r:i);return s.placeholder=t.placeholder,s},Bi.debounce=zo,Bi.defaults=Ta,Bi.defaultsDeep=Aa,Bi.defer=Po,Bi.delay=Lo,Bi.difference=Ns,Bi.differenceBy=qs,Bi.differenceWith=js,Bi.drop=function(t,e,i){var n=null==t?0:t.length;return n?er(t,(e=i||e===r?1:ma(e))<0?0:e,n):[]},Bi.dropRight=function(t,e,i){var n=null==t?0:t.length;return n?er(t,0,(e=n-(e=i||e===r?1:ma(e)))<0?0:e):[]},Bi.dropRightWhile=function(t,e){return t&&t.length?hr(t,os(e,3),!0,!0):[]},Bi.dropWhile=function(t,e){return t&&t.length?hr(t,os(e,3),!0):[]},Bi.fill=function(t,e,i,n){var s=null==t?0:t.length;return s?(i&&"number"!=typeof i&&_s(t,e,i)&&(i=0,n=s),function(t,e,i,n){var s=t.length;for((i=ma(i))<0&&(i=-i>s?0:s+i),(n=n===r||n>s?s:ma(n))<0&&(n+=s),n=i>n?0:ga(n);i<n;)t[i++]=e;return t}(t,e,i,n)):[]},Bi.filter=function(t,e){return(Zo(t)?Ce:mn)(t,os(e,3))},Bi.flatMap=function(t,e){return gn(So(t,e),1)},Bi.flatMapDeep=function(t,e){return gn(So(t,e),u)},Bi.flatMapDepth=function(t,e,i){return i=i===r?1:ma(i),gn(So(t,e),i)},Bi.flatten=Zs,Bi.flattenDeep=function(t){return null!=t&&t.length?gn(t,u):[]},Bi.flattenDepth=function(t,e){return null!=t&&t.length?gn(t,e=e===r?1:ma(e)):[]},Bi.flip=function(t){return Xr(t,512)},Bi.flow=il,Bi.flowRight=nl,Bi.fromPairs=function(t){for(var e=-1,i=null==t?0:t.length,n={};++e<i;){var r=t[e];n[r[0]]=r[1]}return n},Bi.functions=function(t){return null==t?[]:bn(t,za(t))},Bi.functionsIn=function(t){return null==t?[]:bn(t,Pa(t))},Bi.groupBy=bo,Bi.initial=function(t){return null!=t&&t.length?er(t,0,-1):[]},Bi.intersection=Gs,Bi.intersectionBy=Hs,Bi.intersectionWith=Xs,Bi.invert=Ea,Bi.invertBy=Ia,Bi.invokeMap=wo,Bi.iteratee=sl,Bi.keyBy=ko,Bi.keys=za,Bi.keysIn=Pa,Bi.map=So,Bi.mapKeys=function(t,e){var i={};return e=os(e,3),xn(t,(function(t,n,r){rn(i,e(t,n,r),t)})),i},Bi.mapValues=function(t,e){var i={};return e=os(e,3),xn(t,(function(t,n,r){rn(i,n,e(t,n,r))})),i},Bi.matches=function(t){return Bn(an(t,1))},Bi.matchesProperty=function(t,e){return Vn(t,an(e,1))},Bi.memoize=Fo,Bi.merge=La,Bi.mergeWith=Fa,Bi.method=ol,Bi.methodOf=al,Bi.mixin=ll,Bi.negate=Ro,Bi.nthArg=function(t){return t=ma(t),Hn((function(e){return qn(e,t)}))},Bi.omit=Ra,Bi.omitBy=function(t,e){return Ba(t,Ro(os(e)))},Bi.once=function(t){return Eo(2,t)},Bi.orderBy=function(t,e,i,n){return null==t?[]:(Zo(e)||(e=null==e?[]:[e]),Zo(i=n?r:i)||(i=null==i?[]:[i]),jn(t,e,i))},Bi.over=ul,Bi.overArgs=Oo,Bi.overEvery=hl,Bi.overSome=dl,Bi.partial=Bo,Bi.partialRight=Vo,Bi.partition=To,Bi.pick=Oa,Bi.pickBy=Ba,Bi.property=pl,Bi.propertyOf=function(t){return function(e){return null==t?r:wn(t,e)}},Bi.pull=Ks,Bi.pullAll=Js,Bi.pullAllBy=function(t,e,i){return t&&t.length&&e&&e.length?Un(t,e,os(i,2)):t},Bi.pullAllWith=function(t,e,i){return t&&t.length&&e&&e.length?Un(t,e,r,i):t},Bi.pullAt=Qs,Bi.range=fl,Bi.rangeRight=ml,Bi.rearg=No,Bi.reject=function(t,e){return(Zo(t)?Ce:mn)(t,Ro(os(e,3)))},Bi.remove=function(t,e){var i=[];if(!t||!t.length)return i;var n=-1,r=[],s=t.length;for(e=os(e,3);++n<s;){var o=t[n];e(o,n,t)&&(i.push(o),r.push(n))}return Zn(t,r),i},Bi.rest=function(t,e){if("function"!=typeof t)throw new Mt(s);return Hn(t,e=e===r?e:ma(e))},Bi.reverse=to,Bi.sampleSize=function(t,e,i){return e=(i?_s(t,e,i):e===r)?1:ma(e),(Zo(t)?Yi:Yn)(t,e)},Bi.set=function(t,e,i){return null==t?t:Kn(t,e,i)},Bi.setWith=function(t,e,i,n){return n="function"==typeof n?n:r,null==t?t:Kn(t,e,i,n)},Bi.shuffle=function(t){return(Zo(t)?Ki:tr)(t)},Bi.slice=function(t,e,i){var n=null==t?0:t.length;return n?(i&&"number"!=typeof i&&_s(t,e,i)?(e=0,i=n):(e=null==e?0:ma(e),i=i===r?n:ma(i)),er(t,e,i)):[]},Bi.sortBy=Ao,Bi.sortedUniq=function(t){return t&&t.length?sr(t):[]},Bi.sortedUniqBy=function(t,e){return t&&t.length?sr(t,os(e,2)):[]},Bi.split=function(t,e,i){return i&&"number"!=typeof i&&_s(t,e,i)&&(e=i=r),(i=i===r?p:i>>>0)?(t=xa(t))&&("string"==typeof e||null!=e&&!oa(e))&&!(e=ar(e))&&ri(t)?xr(hi(t),0,i):t.split(e,i):[]},Bi.spread=function(t,e){if("function"!=typeof t)throw new Mt(s);return e=null==e?0:gi(ma(e),0),Hn((function(i){var n=i[e],r=xr(i,0,e);return n&&ze(r,n),ke(t,this,r)}))},Bi.tail=function(t){var e=null==t?0:t.length;return e?er(t,1,e):[]},Bi.take=function(t,e,i){return t&&t.length?er(t,0,(e=i||e===r?1:ma(e))<0?0:e):[]},Bi.takeRight=function(t,e,i){var n=null==t?0:t.length;return n?er(t,(e=n-(e=i||e===r?1:ma(e)))<0?0:e,n):[]},Bi.takeRightWhile=function(t,e){return t&&t.length?hr(t,os(e,3),!1,!0):[]},Bi.takeWhile=function(t,e){return t&&t.length?hr(t,os(e,3)):[]},Bi.tap=function(t,e){return e(t),t},Bi.throttle=function(t,e,i){var n=!0,r=!0;if("function"!=typeof t)throw new Mt(s);return ea(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),zo(t,e,{leading:n,maxWait:e,trailing:r})},Bi.thru=fo,Bi.toArray=pa,Bi.toPairs=Va,Bi.toPairsIn=Na,Bi.toPath=function(t){return Zo(t)?De(t,Os):ca(t)?[t]:Mr(Rs(xa(t)))},Bi.toPlainObject=ya,Bi.transform=function(t,e,i){var n=Zo(t),r=n||Xo(t)||ua(t);if(e=os(e,4),null==i){var s=t&&t.constructor;i=r?n?new s:[]:ea(t)&&Jo(s)?Vi(Ut(t)):{}}return(r?Te:xn)(t,(function(t,n,r){return e(i,t,n,r)})),i},Bi.unary=function(t){return Co(t,1)},Bi.union=eo,Bi.unionBy=io,Bi.unionWith=no,Bi.uniq=function(t){return t&&t.length?lr(t):[]},Bi.uniqBy=function(t,e){return t&&t.length?lr(t,os(e,2)):[]},Bi.uniqWith=function(t,e){return e="function"==typeof e?e:r,t&&t.length?lr(t,r,e):[]},Bi.unset=function(t,e){return null==t||cr(t,e)},Bi.unzip=ro,Bi.unzipWith=so,Bi.update=function(t,e,i){return null==t?t:ur(t,e,gr(i))},Bi.updateWith=function(t,e,i,n){return n="function"==typeof n?n:r,null==t?t:ur(t,e,gr(i),n)},Bi.values=qa,Bi.valuesIn=function(t){return null==t?[]:Ye(t,Pa(t))},Bi.without=oo,Bi.words=Ja,Bi.wrap=function(t,e){return Bo(gr(e),t)},Bi.xor=ao,Bi.xorBy=lo,Bi.xorWith=co,Bi.zip=uo,Bi.zipObject=function(t,e){return fr(t||[],e||[],Qi)},Bi.zipObjectDeep=function(t,e){return fr(t||[],e||[],Kn)},Bi.zipWith=ho,Bi.entries=Va,Bi.entriesIn=Na,Bi.extend=ba,Bi.extendWith=wa,ll(Bi,Bi),Bi.add=xl,Bi.attempt=Qa,Bi.camelCase=ja,Bi.capitalize=$a,Bi.ceil=vl,Bi.clamp=function(t,e,i){return i===r&&(i=e,e=r),i!==r&&(i=(i=_a(i))==i?i:0),e!==r&&(e=(e=_a(e))==e?e:0),on(_a(t),e,i)},Bi.clone=function(t){return an(t,4)},Bi.cloneDeep=function(t){return an(t,5)},Bi.cloneDeepWith=function(t,e){return an(t,5,e="function"==typeof e?e:r)},Bi.cloneWith=function(t,e){return an(t,4,e="function"==typeof e?e:r)},Bi.conformsTo=function(t,e){return null==e||ln(t,e,za(e))},Bi.deburr=Ua,Bi.defaultTo=function(t,e){return null==t||t!=t?e:t},Bi.divide=bl,Bi.endsWith=function(t,e,i){t=xa(t),e=ar(e);var n=t.length,s=i=i===r?n:on(ma(i),0,n);return(i-=e.length)>=0&&t.slice(i,s)==e},Bi.eq=qo,Bi.escape=function(t){return(t=xa(t))&&H.test(t)?t.replace(W,ii):t},Bi.escapeRegExp=function(t){return(t=xa(t))&&it.test(t)?t.replace(et,"\\$&"):t},Bi.every=function(t,e,i){var n=Zo(t)?Me:pn;return i&&_s(t,e,i)&&(e=r),n(t,os(e,3))},Bi.find=_o,Bi.findIndex=$s,Bi.findKey=function(t,e){return Oe(t,os(e,3),xn)},Bi.findLast=yo,Bi.findLastIndex=Us,Bi.findLastKey=function(t,e){return Oe(t,os(e,3),vn)},Bi.floor=wl,Bi.forEach=xo,Bi.forEachRight=vo,Bi.forIn=function(t,e){return null==t?t:_n(t,os(e,3),Pa)},Bi.forInRight=function(t,e){return null==t?t:yn(t,os(e,3),Pa)},Bi.forOwn=function(t,e){return t&&xn(t,os(e,3))},Bi.forOwnRight=function(t,e){return t&&vn(t,os(e,3))},Bi.get=Ma,Bi.gt=jo,Bi.gte=$o,Bi.has=function(t,e){return null!=t&&ps(t,e,An)},Bi.hasIn=Ca,Bi.head=Ws,Bi.identity=rl,Bi.includes=function(t,e,i,n){t=Go(t)?t:qa(t),i=i&&!n?ma(i):0;var r=t.length;return i<0&&(i=gi(r+i,0)),la(t)?i<=r&&t.indexOf(e,i)>-1:!!r&&Ve(t,e,i)>-1},Bi.indexOf=function(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var r=null==i?0:ma(i);return r<0&&(r=gi(n+r,0)),Ve(t,e,r)},Bi.inRange=function(t,e,i){return e=fa(e),i===r?(i=e,e=0):i=fa(i),function(t,e,i){return t>=_i(e,i)&&t<gi(e,i)}(t=_a(t),e,i)},Bi.invoke=Da,Bi.isArguments=Uo,Bi.isArray=Zo,Bi.isArrayBuffer=Wo,Bi.isArrayLike=Go,Bi.isArrayLikeObject=Ho,Bi.isBoolean=function(t){return!0===t||!1===t||ia(t)&&Sn(t)==_},Bi.isBuffer=Xo,Bi.isDate=Yo,Bi.isElement=function(t){return ia(t)&&1===t.nodeType&&!sa(t)},Bi.isEmpty=function(t){if(null==t)return!0;if(Go(t)&&(Zo(t)||"string"==typeof t||"function"==typeof t.splice||Xo(t)||ua(t)||Uo(t)))return!t.length;var e=ds(t);if(e==w||e==M)return!t.size;if(bs(t))return!Fn(t).length;for(var i in t)if(Pt.call(t,i))return!1;return!0},Bi.isEqual=function(t,e){return Dn(t,e)},Bi.isEqualWith=function(t,e,i){var n=(i="function"==typeof i?i:r)?i(t,e):r;return n===r?Dn(t,e,r,i):!!n},Bi.isError=Ko,Bi.isFinite=function(t){return"number"==typeof t&&Re(t)},Bi.isFunction=Jo,Bi.isInteger=Qo,Bi.isLength=ta,Bi.isMap=na,Bi.isMatch=function(t,e){return t===e||zn(t,e,ls(e))},Bi.isMatchWith=function(t,e,i){return i="function"==typeof i?i:r,zn(t,e,ls(e),i)},Bi.isNaN=function(t){return ra(t)&&t!=+t},Bi.isNative=function(t){if(vs(t))throw new bt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Pn(t)},Bi.isNil=function(t){return null==t},Bi.isNull=function(t){return null===t},Bi.isNumber=ra,Bi.isObject=ea,Bi.isObjectLike=ia,Bi.isPlainObject=sa,Bi.isRegExp=oa,Bi.isSafeInteger=function(t){return Qo(t)&&t>=-9007199254740991&&t<=h},Bi.isSet=aa,Bi.isString=la,Bi.isSymbol=ca,Bi.isTypedArray=ua,Bi.isUndefined=function(t){return t===r},Bi.isWeakMap=function(t){return ia(t)&&ds(t)==I},Bi.isWeakSet=function(t){return ia(t)&&"[object WeakSet]"==Sn(t)},Bi.join=function(t,e){return null==t?"":Ue.call(t,e)},Bi.kebabCase=Za,Bi.last=Ys,Bi.lastIndexOf=function(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var s=n;return i!==r&&(s=(s=ma(i))<0?gi(n+s,0):_i(s,n-1)),e==e?function(t,e,i){for(var n=i+1;n--;)if(t[n]===e)return n;return n}(t,e,s):Be(t,qe,s,!0)},Bi.lowerCase=Wa,Bi.lowerFirst=Ga,Bi.lt=ha,Bi.lte=da,Bi.max=function(t){return t&&t.length?fn(t,rl,Tn):r},Bi.maxBy=function(t,e){return t&&t.length?fn(t,os(e,2),Tn):r},Bi.mean=function(t){return je(t,rl)},Bi.meanBy=function(t,e){return je(t,os(e,2))},Bi.min=function(t){return t&&t.length?fn(t,rl,Rn):r},Bi.minBy=function(t,e){return t&&t.length?fn(t,os(e,2),Rn):r},Bi.stubArray=gl,Bi.stubFalse=_l,Bi.stubObject=function(){return{}},Bi.stubString=function(){return""},Bi.stubTrue=function(){return!0},Bi.multiply=kl,Bi.nth=function(t,e){return t&&t.length?qn(t,ma(e)):r},Bi.noConflict=function(){return he._===this&&(he._=Bt),this},Bi.noop=cl,Bi.now=Mo,Bi.pad=function(t,e,i){t=xa(t);var n=(e=ma(e))?ui(t):0;if(!e||n>=e)return t;var r=(e-n)/2;return jr(pe(r),i)+t+jr(de(r),i)},Bi.padEnd=function(t,e,i){t=xa(t);var n=(e=ma(e))?ui(t):0;return e&&n<e?t+jr(e-n,i):t},Bi.padStart=function(t,e,i){t=xa(t);var n=(e=ma(e))?ui(t):0;return e&&n<e?jr(e-n,i)+t:t},Bi.parseInt=function(t,e,i){return i||null==e?e=0:e&&(e=+e),xi(xa(t).replace(nt,""),e||0)},Bi.random=function(t,e,i){if(i&&"boolean"!=typeof i&&_s(t,e,i)&&(e=i=r),i===r&&("boolean"==typeof e?(i=e,e=r):"boolean"==typeof t&&(i=t,t=r)),t===r&&e===r?(t=0,e=1):(t=fa(t),e===r?(e=t,t=0):e=fa(e)),t>e){var n=t;t=e,e=n}if(i||t%1||e%1){var s=vi();return _i(t+s*(e-t+ae("1e-"+((s+"").length-1))),e)}return Wn(t,e)},Bi.reduce=function(t,e,i){var n=Zo(t)?Pe:Ze,r=arguments.length<3;return n(t,os(e,4),i,r,hn)},Bi.reduceRight=function(t,e,i){var n=Zo(t)?Le:Ze,r=arguments.length<3;return n(t,os(e,4),i,r,dn)},Bi.repeat=function(t,e,i){return e=(i?_s(t,e,i):e===r)?1:ma(e),Gn(xa(t),e)},Bi.replace=function(){var t=arguments,e=xa(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Bi.result=function(t,e,i){var n=-1,s=(e=_r(e,t)).length;for(s||(s=1,t=r);++n<s;){var o=null==t?r:t[Os(e[n])];o===r&&(n=s,o=i),t=Jo(o)?o.call(t):o}return t},Bi.round=Sl,Bi.runInContext=t,Bi.sample=function(t){return(Zo(t)?Xi:Xn)(t)},Bi.size=function(t){if(null==t)return 0;if(Go(t))return la(t)?ui(t):t.length;var e=ds(t);return e==w||e==M?t.size:Fn(t).length},Bi.snakeCase=Ha,Bi.some=function(t,e,i){var n=Zo(t)?Fe:ir;return i&&_s(t,e,i)&&(e=r),n(t,os(e,3))},Bi.sortedIndex=function(t,e){return nr(t,e)},Bi.sortedIndexBy=function(t,e,i){return rr(t,e,os(i,2))},Bi.sortedIndexOf=function(t,e){var i=null==t?0:t.length;if(i){var n=nr(t,e);if(n<i&&qo(t[n],e))return n}return-1},Bi.sortedLastIndex=function(t,e){return nr(t,e,!0)},Bi.sortedLastIndexBy=function(t,e,i){return rr(t,e,os(i,2),!0)},Bi.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var i=nr(t,e,!0)-1;if(qo(t[i],e))return i}return-1},Bi.startCase=Xa,Bi.startsWith=function(t,e,i){return t=xa(t),i=null==i?0:on(ma(i),0,t.length),e=ar(e),t.slice(i,i+e.length)==e},Bi.subtract=Tl,Bi.sum=function(t){return t&&t.length?We(t,rl):0},Bi.sumBy=function(t,e){return t&&t.length?We(t,os(e,2)):0},Bi.template=function(t,e,i){var n=Bi.templateSettings;i&&_s(t,e,i)&&(e=r),t=xa(t),e=wa({},e,n,Yr);var s,o,a=wa({},e.imports,n.imports,Yr),l=za(a),c=Ye(a,l),u=0,h=e.interpolate||xt,d="__p += '",p=Tt((e.escape||xt).source+"|"+h.source+"|"+(h===K?ht:xt).source+"|"+(e.evaluate||xt).source+"|$","g"),f="//# sourceURL="+(Pt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ne+"]")+"\n";t.replace(p,(function(e,i,n,r,a,l){return n||(n=r),d+=t.slice(u,l).replace(vt,ni),i&&(s=!0,d+="' +\n__e("+i+") +\n'"),a&&(o=!0,d+="';\n"+a+";\n__p += '"),n&&(d+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),u=l+e.length,e})),d+="';\n";var m=Pt.call(e,"variable")&&e.variable;if(m){if(ct.test(m))throw new bt("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(o?d.replace(j,""):d).replace($,"$1").replace(U,"$1;"),d="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(s?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=Qa((function(){return wt(l,f+"return "+d).apply(r,c)}));if(g.source=d,Ko(g))throw g;return g},Bi.times=function(t,e){if((t=ma(t))<1||t>h)return[];var i=p,n=_i(t,p);e=os(e),t-=p;for(var r=Ge(n,e);++i<t;)e(i);return r},Bi.toFinite=fa,Bi.toInteger=ma,Bi.toLength=ga,Bi.toLower=function(t){return xa(t).toLowerCase()},Bi.toNumber=_a,Bi.toSafeInteger=function(t){return t?on(ma(t),-9007199254740991,h):0===t?t:0},Bi.toString=xa,Bi.toUpper=function(t){return xa(t).toUpperCase()},Bi.trim=function(t,e,i){if((t=xa(t))&&(i||e===r))return He(t);if(!t||!(e=ar(e)))return t;var n=hi(t),s=hi(e);return xr(n,Je(n,s),Qe(n,s)+1).join("")},Bi.trimEnd=function(t,e,i){if((t=xa(t))&&(i||e===r))return t.slice(0,di(t)+1);if(!t||!(e=ar(e)))return t;var n=hi(t);return xr(n,0,Qe(n,hi(e))+1).join("")},Bi.trimStart=function(t,e,i){if((t=xa(t))&&(i||e===r))return t.replace(nt,"");if(!t||!(e=ar(e)))return t;var n=hi(t);return xr(n,Je(n,hi(e))).join("")},Bi.truncate=function(t,e){var i=30,n="...";if(ea(e)){var s="separator"in e?e.separator:s;i="length"in e?ma(e.length):i,n="omission"in e?ar(e.omission):n}var o=(t=xa(t)).length;if(ri(t)){var a=hi(t);o=a.length}if(i>=o)return t;var l=i-ui(n);if(l<1)return n;var c=a?xr(a,0,l).join(""):t.slice(0,l);if(s===r)return c+n;if(a&&(l+=c.length-l),oa(s)){if(t.slice(l).search(s)){var u,h=c;for(s.global||(s=Tt(s.source,xa(dt.exec(s))+"g")),s.lastIndex=0;u=s.exec(h);)var d=u.index;c=c.slice(0,d===r?l:d)}}else if(t.indexOf(ar(s),l)!=l){var p=c.lastIndexOf(s);p>-1&&(c=c.slice(0,p))}return c+n},Bi.unescape=function(t){return(t=xa(t))&&G.test(t)?t.replace(Z,pi):t},Bi.uniqueId=function(t){var e=++Lt;return xa(t)+e},Bi.upperCase=Ya,Bi.upperFirst=Ka,Bi.each=xo,Bi.eachRight=vo,Bi.first=Ws,ll(Bi,(yl={},xn(Bi,(function(t,e){Pt.call(Bi.prototype,e)||(yl[e]=t)})),yl),{chain:!1}),Bi.VERSION="4.17.21",Te(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Bi[t].placeholder=Bi})),Te(["drop","take"],(function(t,e){ji.prototype[t]=function(i){i=i===r?1:gi(ma(i),0);var n=this.__filtered__&&!e?new ji(this):this.clone();return n.__filtered__?n.__takeCount__=_i(i,n.__takeCount__):n.__views__.push({size:_i(i,p),type:t+(n.__dir__<0?"Right":"")}),n},ji.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),Te(["filter","map","takeWhile"],(function(t,e){var i=e+1,n=1==i||3==i;ji.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:os(t,3),type:i}),e.__filtered__=e.__filtered__||n,e}})),Te(["head","last"],(function(t,e){var i="take"+(e?"Right":"");ji.prototype[t]=function(){return this[i](1).value()[0]}})),Te(["initial","tail"],(function(t,e){var i="drop"+(e?"":"Right");ji.prototype[t]=function(){return this.__filtered__?new ji(this):this[i](1)}})),ji.prototype.compact=function(){return this.filter(rl)},ji.prototype.find=function(t){return this.filter(t).head()},ji.prototype.findLast=function(t){return this.reverse().find(t)},ji.prototype.invokeMap=Hn((function(t,e){return"function"==typeof t?new ji(this):this.map((function(i){return En(i,t,e)}))})),ji.prototype.reject=function(t){return this.filter(Ro(os(t)))},ji.prototype.slice=function(t,e){t=ma(t);var i=this;return i.__filtered__&&(t>0||e<0)?new ji(i):(t<0?i=i.takeRight(-t):t&&(i=i.drop(t)),e!==r&&(i=(e=ma(e))<0?i.dropRight(-e):i.take(e-t)),i)},ji.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},ji.prototype.toArray=function(){return this.take(p)},xn(ji.prototype,(function(t,e){var i=/^(?:filter|find|map|reject)|While$/.test(e),n=/^(?:head|last)$/.test(e),s=Bi[n?"take"+("last"==e?"Right":""):e],o=n||/^find/.test(e);s&&(Bi.prototype[e]=function(){var e=this.__wrapped__,a=n?[1]:arguments,l=e instanceof ji,c=a[0],u=l||Zo(e),h=function(t){var e=s.apply(Bi,ze([t],a));return n&&d?e[0]:e};u&&i&&"function"==typeof c&&1!=c.length&&(l=u=!1);var d=this.__chain__,p=!!this.__actions__.length,f=o&&!d,m=l&&!p;if(!o&&u){e=m?e:new ji(this);var g=t.apply(e,a);return g.__actions__.push({func:fo,args:[h],thisArg:r}),new qi(g,d)}return f&&m?t.apply(this,a):(g=this.thru(h),f?n?g.value()[0]:g.value():g)})})),Te(["pop","push","shift","sort","splice","unshift"],(function(t){var e=Ct[t],i=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=/^(?:pop|shift)$/.test(t);Bi.prototype[t]=function(){var t=arguments;if(n&&!this.__chain__){var r=this.value();return e.apply(Zo(r)?r:[],t)}return this[i]((function(i){return e.apply(Zo(i)?i:[],t)}))}})),xn(ji.prototype,(function(t,e){var i=Bi[e];if(i){var n=i.name+"";Pt.call(Ei,n)||(Ei[n]=[]),Ei[n].push({name:e,func:i})}})),Ei[Br(r,2).name]=[{name:"wrapper",func:r}],ji.prototype.clone=function(){var t=new ji(this.__wrapped__);return t.__actions__=Mr(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Mr(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Mr(this.__views__),t},ji.prototype.reverse=function(){if(this.__filtered__){var t=new ji(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},ji.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,i=Zo(t),n=e<0,r=i?t.length:0,s=function(t,e,i){for(var n=-1,r=i.length;++n<r;){var s=i[n],o=s.size;switch(s.type){case"drop":t+=o;break;case"dropRight":e-=o;break;case"take":e=_i(e,t+o);break;case"takeRight":t=gi(t,e-o)}}return{start:t,end:e}}(0,r,this.__views__),o=s.start,a=s.end,l=a-o,c=n?a:o-1,u=this.__iteratees__,h=u.length,d=0,p=_i(l,this.__takeCount__);if(!i||!n&&r==l&&p==l)return dr(t,this.__actions__);var f=[];t:for(;l--&&d<p;){for(var m=-1,g=t[c+=e];++m<h;){var _=u[m],y=_.iteratee,x=_.type,v=y(g);if(2==x)g=v;else if(!v){if(1==x)continue t;break t}}f[d++]=g}return f},Bi.prototype.at=mo,Bi.prototype.chain=function(){return po(this)},Bi.prototype.commit=function(){return new qi(this.value(),this.__chain__)},Bi.prototype.next=function(){this.__values__===r&&(this.__values__=pa(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?r:this.__values__[this.__index__++]}},Bi.prototype.plant=function(t){for(var e,i=this;i instanceof Ni;){var n=Vs(i);n.__index__=0,n.__values__=r,e?s.__wrapped__=n:e=n;var s=n;i=i.__wrapped__}return s.__wrapped__=t,e},Bi.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof ji){var e=t;return this.__actions__.length&&(e=new ji(this)),(e=e.reverse()).__actions__.push({func:fo,args:[to],thisArg:r}),new qi(e,this.__chain__)}return this.thru(to)},Bi.prototype.toJSON=Bi.prototype.valueOf=Bi.prototype.value=function(){return dr(this.__wrapped__,this.__actions__)},Bi.prototype.first=Bi.prototype.head,Xt&&(Bi.prototype[Xt]=function(){return this}),Bi}();he._=fi,(n=function(){return fi}.call(e,i,e,t))===r||(t.exports=n)}.call(this)},65128:function(t){"use strict";function e(t,e){e=e?Array.isArray(e)?e:[e]:[],Object.freeze(e);var i=t.renderer.rules.link_open||this.defaultRender;t.renderer.rules.link_open=function(t,n,r,s,o){var a=function(t,e){var i,n,r=t.attrs[t.attrIndex("href")][1];for(i=0;i<e.length;++i)if(!(n=e[i]).pattern||new RegExp(n.pattern).test(r))return n}(t[n],e),l=a&&a.attrs;return l&&function(t,e,i){Object.keys(i).forEach((function(n){var r,s=i[n];"className"===n&&(n="class"),(r=e[t].attrIndex(n))<0?e[t].attrPush([n,s]):e[t].attrs[r][1]=s}))}(n,t,l),i(t,n,r,s,o)}}e.defaultRender=function(t,e,i,n,r){return r.renderToken(t,e,i)},t.exports=e},60777:function(t){"use strict";t.exports=function(t){function e(t,e){var i,n,r,s,o,a=[],l=e.length;for(i=0;i<l;i++)61===(r=e[i]).marker&&-1!==r.end&&(s=e[r.end],(o=t.tokens[r.token]).type="mark_open",o.tag="mark",o.nesting=1,o.markup="==",o.content="",(o=t.tokens[s.token]).type="mark_close",o.tag="mark",o.nesting=-1,o.markup="==",o.content="","text"===t.tokens[s.token-1].type&&"="===t.tokens[s.token-1].content&&a.push(s.token-1));for(;a.length;){for(n=(i=a.pop())+1;n<t.tokens.length&&"mark_close"===t.tokens[n].type;)n++;i!==--n&&(o=t.tokens[n],t.tokens[n]=t.tokens[i],t.tokens[i]=o)}}t.inline.ruler.before("emphasis","mark",(function(t,e){var i,n,r,s,o=t.pos,a=t.src.charCodeAt(o);if(e)return!1;if(61!==a)return!1;if(r=(n=t.scanDelims(t.pos,!0)).length,s=String.fromCharCode(a),r<2)return!1;for(r%2&&(t.push("text","",0).content=s,r--),i=0;i<r;i+=2)t.push("text","",0).content=s+s,(n.can_open||n.can_close)&&t.delimiters.push({marker:a,length:0,jump:i/2,token:t.tokens.length-1,end:-1,open:n.can_open,close:n.can_close});return t.pos+=n.length,!0})),t.inline.ruler2.before("emphasis","mark",(function(t){var i,n=t.tokens_meta,r=(t.tokens_meta||[]).length;for(e(t,t.delimiters),i=0;i<r;i++)n[i]&&n[i].delimiters&&e(t,n[i].delimiters)}))}},34438:function(t){"use strict";var e={};function i(t,n){var r;return"string"!=typeof n&&(n=i.defaultChars),r=function(t){var i,n,r=e[t];if(r)return r;for(r=e[t]=[],i=0;i<128;i++)n=String.fromCharCode(i),r.push(n);for(i=0;i<t.length;i++)r[n=t.charCodeAt(i)]="%"+("0"+n.toString(16).toUpperCase()).slice(-2);return r}(n),t.replace(/(%[a-f0-9]{2})+/gi,(function(t){var e,i,n,s,o,a,l,c="";for(e=0,i=t.length;e<i;e+=3)(n=parseInt(t.slice(e+1,e+3),16))<128?c+=r[n]:192==(224&n)&&e+3<i&&128==(192&(s=parseInt(t.slice(e+4,e+6),16)))?(c+=(l=n<<6&1984|63&s)<128?"��":String.fromCharCode(l),e+=3):224==(240&n)&&e+6<i&&(s=parseInt(t.slice(e+4,e+6),16),o=parseInt(t.slice(e+7,e+9),16),128==(192&s)&&128==(192&o))?(c+=(l=n<<12&61440|s<<6&4032|63&o)<2048||l>=55296&&l<=57343?"���":String.fromCharCode(l),e+=6):240==(248&n)&&e+9<i&&(s=parseInt(t.slice(e+4,e+6),16),o=parseInt(t.slice(e+7,e+9),16),a=parseInt(t.slice(e+10,e+12),16),128==(192&s)&&128==(192&o)&&128==(192&a))?((l=n<<18&1835008|s<<12&258048|o<<6&4032|63&a)<65536||l>1114111?c+="����":(l-=65536,c+=String.fromCharCode(55296+(l>>10),56320+(1023&l))),e+=9):c+="�";return c}))}i.defaultChars=";/?:@&=+$,#",i.componentChars="",t.exports=i},21466:function(t){"use strict";var e={};function i(t,n,r){var s,o,a,l,c,u="";for("string"!=typeof n&&(r=n,n=i.defaultChars),void 0===r&&(r=!0),c=function(t){var i,n,r=e[t];if(r)return r;for(r=e[t]=[],i=0;i<128;i++)n=String.fromCharCode(i),/^[0-9a-z]$/i.test(n)?r.push(n):r.push("%"+("0"+i.toString(16).toUpperCase()).slice(-2));for(i=0;i<t.length;i++)r[t.charCodeAt(i)]=t[i];return r}(n),s=0,o=t.length;s<o;s++)if(a=t.charCodeAt(s),r&&37===a&&s+2<o&&/^[0-9a-f]{2}$/i.test(t.slice(s+1,s+3)))u+=t.slice(s,s+3),s+=2;else if(a<128)u+=c[a];else if(a>=55296&&a<=57343){if(a>=55296&&a<=56319&&s+1<o&&(l=t.charCodeAt(s+1))>=56320&&l<=57343){u+=encodeURIComponent(t[s]+t[s+1]),s++;continue}u+="%EF%BF%BD"}else u+=encodeURIComponent(t[s]);return u}i.defaultChars=";/?:@&=+$,-_.!~*'()#",i.componentChars="-_.!~*'()",t.exports=i},52843:function(t){"use strict";t.exports=function(t){var e="";return e+=t.protocol||"",e+=t.slashes?"//":"",e+=t.auth?t.auth+"@":"",t.hostname&&-1!==t.hostname.indexOf(":")?e+="["+t.hostname+"]":e+=t.hostname||"",e+=t.port?":"+t.port:"",e+=t.pathname||"",(e+=t.search||"")+(t.hash||"")}},75692:function(t,e,i){"use strict";t.exports.encode=i(21466),t.exports.decode=i(34438),t.exports.format=i(52843),t.exports.parse=i(42639)},42639:function(t){"use strict";function e(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}var i=/^([a-z0-9.+-]+:)/i,n=/:[0-9]*$/,r=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,s=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),o=["'"].concat(s),a=["%","/","?",";","#"].concat(o),l=["/","?","#"],c=/^[+a-z0-9A-Z_-]{0,63}$/,u=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,h={javascript:!0,"javascript:":!0},d={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};e.prototype.parse=function(t,e){var n,s,o,p,f,m=t;if(m=m.trim(),!e&&1===t.split("#").length){var g=r.exec(m);if(g)return this.pathname=g[1],g[2]&&(this.search=g[2]),this}var _=i.exec(m);if(_&&(o=(_=_[0]).toLowerCase(),this.protocol=_,m=m.substr(_.length)),(e||_||m.match(/^\/\/[^@\/]+@[^@\/]+/))&&(!(f="//"===m.substr(0,2))||_&&h[_]||(m=m.substr(2),this.slashes=!0)),!h[_]&&(f||_&&!d[_])){var y,x,v=-1;for(n=0;n<l.length;n++)-1!==(p=m.indexOf(l[n]))&&(-1===v||p<v)&&(v=p);for(-1!==(x=-1===v?m.lastIndexOf("@"):m.lastIndexOf("@",v))&&(y=m.slice(0,x),m=m.slice(x+1),this.auth=y),v=-1,n=0;n<a.length;n++)-1!==(p=m.indexOf(a[n]))&&(-1===v||p<v)&&(v=p);-1===v&&(v=m.length),":"===m[v-1]&&v--;var b=m.slice(0,v);m=m.slice(v),this.parseHost(b),this.hostname=this.hostname||"";var w="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!w){var k=this.hostname.split(/\./);for(n=0,s=k.length;n<s;n++){var S=k[n];if(S&&!S.match(c)){for(var T="",A=0,M=S.length;A<M;A++)S.charCodeAt(A)>127?T+="x":T+=S[A];if(!T.match(c)){var C=k.slice(0,n),E=k.slice(n+1),I=S.match(u);I&&(C.push(I[1]),E.unshift(I[2])),E.length&&(m=E.join(".")+m),this.hostname=C.join(".");break}}}}this.hostname.length>255&&(this.hostname=""),w&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}var D=m.indexOf("#");-1!==D&&(this.hash=m.substr(D),m=m.slice(0,D));var z=m.indexOf("?");return-1!==z&&(this.search=m.substr(z),m=m.slice(0,z)),m&&(this.pathname=m),d[o]&&this.hostname&&!this.pathname&&(this.pathname=""),this},e.prototype.parseHost=function(t){var e=n.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)},t.exports=function(t,i){if(t&&t instanceof e)return t;var n=new e;return n.parse(t,i),n}},37378:function(t,e,i){"use strict";i.r(e),i.d(e,{decode:function(){return _},encode:function(){return y},toASCII:function(){return v},toUnicode:function(){return x},ucs2decode:function(){return p},ucs2encode:function(){return f}});const n=2147483647,r=36,s=/^xn--/,o=/[^\0-\x7E]/,a=/[\x2E\u3002\uFF0E\uFF61]/g,l={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},c=Math.floor,u=String.fromCharCode;function h(t){throw new RangeError(l[t])}function d(t,e){const i=t.split("@");let n="";i.length>1&&(n=i[0]+"@",t=i[1]);const r=function(t,e){const i=[];let n=t.length;for(;n--;)i[n]=e(t[n]);return i}((t=t.replace(a,".")).split("."),e).join(".");return n+r}function p(t){const e=[];let i=0;const n=t.length;for(;i<n;){const r=t.charCodeAt(i++);if(r>=55296&&r<=56319&&i<n){const n=t.charCodeAt(i++);56320==(64512&n)?e.push(((1023&r)<<10)+(1023&n)+65536):(e.push(r),i--)}else e.push(r)}return e}const f=t=>String.fromCodePoint(...t),m=function(t,e){return t+22+75*(t<26)-((0!=e)<<5)},g=function(t,e,i){let n=0;for(t=i?c(t/700):t>>1,t+=c(t/e);t>455;n+=r)t=c(t/35);return c(n+36*t/(t+38))},_=function(t){const e=[],i=t.length;let s=0,o=128,a=72,l=t.lastIndexOf("-");l<0&&(l=0);for(let i=0;i<l;++i)t.charCodeAt(i)>=128&&h("not-basic"),e.push(t.charCodeAt(i));for(let d=l>0?l+1:0;d<i;){let l=s;for(let e=1,o=r;;o+=r){d>=i&&h("invalid-input");const l=(u=t.charCodeAt(d++))-48<10?u-22:u-65<26?u-65:u-97<26?u-97:r;(l>=r||l>c((n-s)/e))&&h("overflow"),s+=l*e;const p=o<=a?1:o>=a+26?26:o-a;if(l<p)break;const f=r-p;e>c(n/f)&&h("overflow"),e*=f}const p=e.length+1;a=g(s-l,p,0==l),c(s/p)>n-o&&h("overflow"),o+=c(s/p),s%=p,e.splice(s++,0,o)}var u;return String.fromCodePoint(...e)},y=function(t){const e=[];let i=(t=p(t)).length,s=128,o=0,a=72;for(const i of t)i<128&&e.push(u(i));let l=e.length,d=l;for(l&&e.push("-");d<i;){let i=n;for(const e of t)e>=s&&e<i&&(i=e);const p=d+1;i-s>c((n-o)/p)&&h("overflow"),o+=(i-s)*p,s=i;for(const i of t)if(i<s&&++o>n&&h("overflow"),i==s){let t=o;for(let i=r;;i+=r){const n=i<=a?1:i>=a+26?26:i-a;if(t<n)break;const s=t-n,o=r-n;e.push(u(m(n+s%o,0))),t=c(s/o)}e.push(u(m(t,0))),a=g(o,p,d==l),o=0,++d}++o,++s}return e.join("")},x=function(t){return d(t,(function(t){return s.test(t)?_(t.slice(4).toLowerCase()):t}))},v=function(t){return d(t,(function(t){return o.test(t)?"xn--"+y(t):t}))},b={version:"2.1.0",ucs2:{decode:p,encode:f},decode:_,encode:y,toASCII:v,toUnicode:x};e.default=b},91197:function(t,e,i){"use strict";var n=i(48122),r=i(7374),s="tippy-content",o="tippy-arrow",a="tippy-svg-arrow",l={passive:!0,capture:!0},c=function(){return document.body};function u(t,e,i){if(Array.isArray(t)){var n=t[e];return null==n?Array.isArray(i)?i[e]:i:n}return t}function h(t,e){var i={}.toString.call(t);return 0===i.indexOf("[object")&&i.indexOf(e+"]")>-1}function d(t,e){return"function"==typeof t?t.apply(void 0,e):t}function p(t,e){return 0===e?t:function(n){clearTimeout(i),i=setTimeout((function(){t(n)}),e)};var i}function f(t){return[].concat(t)}function m(t,e){-1===t.indexOf(e)&&t.push(e)}function g(t){return[].slice.call(t)}function _(t){return Object.keys(t).reduce((function(e,i){return void 0!==t[i]&&(e[i]=t[i]),e}),{})}function y(){return document.createElement("div")}function x(t){return["Element","Fragment"].some((function(e){return h(t,e)}))}function v(t,e){t.forEach((function(t){t&&(t.style.transitionDuration=e+"ms")}))}function b(t,e){t.forEach((function(t){t&&t.setAttribute("data-state",e)}))}function w(t,e,i){var n=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(e){t[n](e,i)}))}function k(t,e){for(var i=e;i;){var n;if(t.contains(i))return!0;i=null==i.getRootNode||null==(n=i.getRootNode())?void 0:n.host}return!1}var S={isTouch:!1},T=0;function A(){S.isTouch||(S.isTouch=!0,window.performance&&document.addEventListener("mousemove",M))}function M(){var t=performance.now();t-T<20&&(S.isTouch=!1,document.removeEventListener("mousemove",M)),T=t}function C(){var t,e=document.activeElement;if((t=e)&&t._tippy&&t._tippy.reference===t){var i=e._tippy;e.blur&&!i.state.isVisible&&e.blur()}}var E=!("undefined"==typeof window||"undefined"==typeof document||!window.msCrypto),I=Object.assign({appendTo:c,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),D=Object.keys(I);function z(t){var e=(t.plugins||[]).reduce((function(e,i){var n,r=i.name,s=i.defaultValue;return r&&(e[r]=void 0!==t[r]?t[r]:null!=(n=I[r])?n:s),e}),{});return Object.assign({},t,e)}function P(t,e){var i=Object.assign({},e,{content:d(e.content,[t])},e.ignoreAttributes?{}:function(t,e){return(e?Object.keys(z(Object.assign({},I,{plugins:e}))):D).reduce((function(e,i){var n=(t.getAttribute("data-tippy-"+i)||"").trim();if(!n)return e;if("content"===i)e[i]=n;else try{e[i]=JSON.parse(n)}catch(t){e[i]=n}return e}),{})}(t,e.plugins));return i.aria=Object.assign({},I.aria,i.aria),i.aria={expanded:"auto"===i.aria.expanded?e.interactive:i.aria.expanded,content:"auto"===i.aria.content?e.interactive?null:"describedby":i.aria.content},i}function L(t,e){t.innerHTML=e}function F(t){var e=y();return!0===t?e.className=o:(e.className=a,x(t)?e.appendChild(t):L(e,t)),e}function R(t,e){x(e.content)?(L(t,""),t.appendChild(e.content)):"function"!=typeof e.content&&(e.allowHTML?L(t,e.content):t.textContent=e.content)}function O(t){var e=t.firstElementChild,i=g(e.children);return{box:e,content:i.find((function(t){return t.classList.contains(s)})),arrow:i.find((function(t){return t.classList.contains(o)||t.classList.contains(a)})),backdrop:i.find((function(t){return t.classList.contains("tippy-backdrop")}))}}function B(t){var e=y(),i=y();i.className="tippy-box",i.setAttribute("data-state","hidden"),i.setAttribute("tabindex","-1");var n=y();function r(i,n){var r=O(e),s=r.box,o=r.content,a=r.arrow;n.theme?s.setAttribute("data-theme",n.theme):s.removeAttribute("data-theme"),"string"==typeof n.animation?s.setAttribute("data-animation",n.animation):s.removeAttribute("data-animation"),n.inertia?s.setAttribute("data-inertia",""):s.removeAttribute("data-inertia"),s.style.maxWidth="number"==typeof n.maxWidth?n.maxWidth+"px":n.maxWidth,n.role?s.setAttribute("role",n.role):s.removeAttribute("role"),i.content===n.content&&i.allowHTML===n.allowHTML||R(o,t.props),n.arrow?a?i.arrow!==n.arrow&&(s.removeChild(a),s.appendChild(F(n.arrow))):s.appendChild(F(n.arrow)):a&&s.removeChild(a)}return n.className=s,n.setAttribute("data-state","hidden"),R(n,t.props),e.appendChild(i),i.appendChild(n),r(t.props,t.props),{popper:e,onUpdate:r}}B.$$tippy=!0;var V=1,N=[],q=[];function j(t,e){var i,r,s,o,a,x,T,A,M=P(t,Object.assign({},I,z(_(e)))),C=!1,D=!1,L=!1,F=!1,R=[],B=p(yt,M.interactiveDebounce),j=V++,$=(A=M.plugins).filter((function(t,e){return A.indexOf(t)===e})),U={id:j,reference:t,popper:y(),popperInstance:null,props:M,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:$,clearDelayTimeouts:function(){clearTimeout(i),clearTimeout(r),cancelAnimationFrame(s)},setProps:function(e){if(!U.state.isDestroyed){rt("onBeforeUpdate",[U,e]),gt();var i=U.props,n=P(t,Object.assign({},i,_(e),{ignoreAttributes:!0}));U.props=n,mt(),i.interactiveDebounce!==n.interactiveDebounce&&(at(),B=p(yt,n.interactiveDebounce)),i.triggerTarget&&!n.triggerTarget?f(i.triggerTarget).forEach((function(t){t.removeAttribute("aria-expanded")})):n.triggerTarget&&t.removeAttribute("aria-expanded"),ot(),nt(),G&&G(i,n),U.popperInstance&&(wt(),St().forEach((function(t){requestAnimationFrame(t._tippy.popperInstance.forceUpdate)}))),rt("onAfterUpdate",[U,e])}},setContent:function(t){U.setProps({content:t})},show:function(){var t=U.state.isVisible,e=U.state.isDestroyed,i=!U.state.isEnabled,n=S.isTouch&&!U.props.touch,r=u(U.props.duration,0,I.duration);if(!(t||e||i||n||Q().hasAttribute("disabled")||(rt("onShow",[U],!1),!1===U.props.onShow(U)))){if(U.state.isVisible=!0,J()&&(W.style.visibility="visible"),nt(),ht(),U.state.isMounted||(W.style.transition="none"),J()){var s=et();v([s.box,s.content],0)}var o,a,l;x=function(){var t;if(U.state.isVisible&&!F){if(F=!0,W.offsetHeight,W.style.transition=U.props.moveTransition,J()&&U.props.animation){var e=et(),i=e.box,n=e.content;v([i,n],r),b([i,n],"visible")}st(),ot(),m(q,U),null==(t=U.popperInstance)||t.forceUpdate(),rt("onMount",[U]),U.props.animation&&J()&&function(t,e){pt(t,(function(){U.state.isShown=!0,rt("onShown",[U])}))}(r)}},a=U.props.appendTo,l=Q(),(o=U.props.interactive&&a===c||"parent"===a?l.parentNode:d(a,[l])).contains(W)||o.appendChild(W),U.state.isMounted=!0,wt()}},hide:function(){var t=!U.state.isVisible,e=U.state.isDestroyed,i=!U.state.isEnabled,n=u(U.props.duration,1,I.duration);if(!(t||e||i)&&(rt("onHide",[U],!1),!1!==U.props.onHide(U))){if(U.state.isVisible=!1,U.state.isShown=!1,F=!1,C=!1,J()&&(W.style.visibility="hidden"),at(),dt(),nt(!0),J()){var r=et(),s=r.box,o=r.content;U.props.animation&&(v([s,o],n),b([s,o],"hidden"))}st(),ot(),U.props.animation?J()&&function(t,e){pt(t,(function(){!U.state.isVisible&&W.parentNode&&W.parentNode.contains(W)&&e()}))}(n,U.unmount):U.unmount()}},hideWithInteractivity:function(t){tt().addEventListener("mousemove",B),m(N,B),B(t)},enable:function(){U.state.isEnabled=!0},disable:function(){U.hide(),U.state.isEnabled=!1},unmount:function(){U.state.isVisible&&U.hide(),U.state.isMounted&&(kt(),St().forEach((function(t){t._tippy.unmount()})),W.parentNode&&W.parentNode.removeChild(W),q=q.filter((function(t){return t!==U})),U.state.isMounted=!1,rt("onHidden",[U]))},destroy:function(){U.state.isDestroyed||(U.clearDelayTimeouts(),U.unmount(),gt(),delete t._tippy,U.state.isDestroyed=!0,rt("onDestroy",[U]))}};if(!M.render)return U;var Z=M.render(U),W=Z.popper,G=Z.onUpdate;W.setAttribute("data-tippy-root",""),W.id="tippy-"+U.id,U.popper=W,t._tippy=U,W._tippy=U;var H=$.map((function(t){return t.fn(U)})),X=t.hasAttribute("aria-expanded");return mt(),ot(),nt(),rt("onCreate",[U]),M.showOnCreate&&Tt(),W.addEventListener("mouseenter",(function(){U.props.interactive&&U.state.isVisible&&U.clearDelayTimeouts()})),W.addEventListener("mouseleave",(function(){U.props.interactive&&U.props.trigger.indexOf("mouseenter")>=0&&tt().addEventListener("mousemove",B)})),U;function Y(){var t=U.props.touch;return Array.isArray(t)?t:[t,0]}function K(){return"hold"===Y()[0]}function J(){var t;return!(null==(t=U.props.render)||!t.$$tippy)}function Q(){return T||t}function tt(){var t,e,i=Q().parentNode;return i?null!=(e=f(i)[0])&&null!=(t=e.ownerDocument)&&t.body?e.ownerDocument:document:document}function et(){return O(W)}function it(t){return U.state.isMounted&&!U.state.isVisible||S.isTouch||o&&"focus"===o.type?0:u(U.props.delay,t?0:1,I.delay)}function nt(t){void 0===t&&(t=!1),W.style.pointerEvents=U.props.interactive&&!t?"":"none",W.style.zIndex=""+U.props.zIndex}function rt(t,e,i){var n;void 0===i&&(i=!0),H.forEach((function(i){i[t]&&i[t].apply(i,e)})),i&&(n=U.props)[t].apply(n,e)}function st(){var e=U.props.aria;if(e.content){var i="aria-"+e.content,n=W.id;f(U.props.triggerTarget||t).forEach((function(t){var e=t.getAttribute(i);if(U.state.isVisible)t.setAttribute(i,e?e+" "+n:n);else{var r=e&&e.replace(n,"").trim();r?t.setAttribute(i,r):t.removeAttribute(i)}}))}}function ot(){!X&&U.props.aria.expanded&&f(U.props.triggerTarget||t).forEach((function(t){U.props.interactive?t.setAttribute("aria-expanded",U.state.isVisible&&t===Q()?"true":"false"):t.removeAttribute("aria-expanded")}))}function at(){tt().removeEventListener("mousemove",B),N=N.filter((function(t){return t!==B}))}function lt(e){if(!S.isTouch||!L&&"mousedown"!==e.type){var i=e.composedPath&&e.composedPath()[0]||e.target;if(!U.props.interactive||!k(W,i)){if(f(U.props.triggerTarget||t).some((function(t){return k(t,i)}))){if(S.isTouch)return;if(U.state.isVisible&&U.props.trigger.indexOf("click")>=0)return}else rt("onClickOutside",[U,e]);!0===U.props.hideOnClick&&(U.clearDelayTimeouts(),U.hide(),D=!0,setTimeout((function(){D=!1})),U.state.isMounted||dt())}}}function ct(){L=!0}function ut(){L=!1}function ht(){var t=tt();t.addEventListener("mousedown",lt,!0),t.addEventListener("touchend",lt,l),t.addEventListener("touchstart",ut,l),t.addEventListener("touchmove",ct,l)}function dt(){var t=tt();t.removeEventListener("mousedown",lt,!0),t.removeEventListener("touchend",lt,l),t.removeEventListener("touchstart",ut,l),t.removeEventListener("touchmove",ct,l)}function pt(t,e){var i=et().box;function n(t){t.target===i&&(w(i,"remove",n),e())}if(0===t)return e();w(i,"remove",a),w(i,"add",n),a=n}function ft(e,i,n){void 0===n&&(n=!1),f(U.props.triggerTarget||t).forEach((function(t){t.addEventListener(e,i,n),R.push({node:t,eventType:e,handler:i,options:n})}))}function mt(){var t;K()&&(ft("touchstart",_t,{passive:!0}),ft("touchend",xt,{passive:!0})),(t=U.props.trigger,t.split(/\s+/).filter(Boolean)).forEach((function(t){if("manual"!==t)switch(ft(t,_t),t){case"mouseenter":ft("mouseleave",xt);break;case"focus":ft(E?"focusout":"blur",vt);break;case"focusin":ft("focusout",vt)}}))}function gt(){R.forEach((function(t){var e=t.node,i=t.eventType,n=t.handler,r=t.options;e.removeEventListener(i,n,r)})),R=[]}function _t(t){var e,i=!1;if(U.state.isEnabled&&!bt(t)&&!D){var n="focus"===(null==(e=o)?void 0:e.type);o=t,T=t.currentTarget,ot(),!U.state.isVisible&&h(t,"MouseEvent")&&N.forEach((function(e){return e(t)})),"click"===t.type&&(U.props.trigger.indexOf("mouseenter")<0||C)&&!1!==U.props.hideOnClick&&U.state.isVisible?i=!0:Tt(t),"click"===t.type&&(C=!i),i&&!n&&At(t)}}function yt(t){var e=t.target,i=Q().contains(e)||W.contains(e);if("mousemove"!==t.type||!i){var n=St().concat(W).map((function(t){var e,i=null==(e=t._tippy.popperInstance)?void 0:e.state;return i?{popperRect:t.getBoundingClientRect(),popperState:i,props:M}:null})).filter(Boolean);(function(t,e){var i=e.clientX,n=e.clientY;return t.every((function(t){var e=t.popperRect,r=t.popperState,s=t.props.interactiveBorder,o=r.placement.split("-")[0],a=r.modifiersData.offset;if(!a)return!0;var l="bottom"===o?a.top.y:0,c="top"===o?a.bottom.y:0,u="right"===o?a.left.x:0,h="left"===o?a.right.x:0,d=e.top-n+l>s,p=n-e.bottom-c>s,f=e.left-i+u>s,m=i-e.right-h>s;return d||p||f||m}))})(n,t)&&(at(),At(t))}}function xt(t){bt(t)||U.props.trigger.indexOf("click")>=0&&C||(U.props.interactive?U.hideWithInteractivity(t):At(t))}function vt(t){U.props.trigger.indexOf("focusin")<0&&t.target!==Q()||U.props.interactive&&t.relatedTarget&&W.contains(t.relatedTarget)||At(t)}function bt(t){return!!S.isTouch&&K()!==t.type.indexOf("touch")>=0}function wt(){kt();var e=U.props,i=e.popperOptions,r=e.placement,s=e.offset,o=e.getReferenceClientRect,a=e.moveTransition,l=J()?O(W).arrow:null,c=o?{getBoundingClientRect:o,contextElement:o.contextElement||Q()}:t,u=[{name:"offset",options:{offset:s}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!a}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(t){var e=t.state;if(J()){var i=et().box;["placement","reference-hidden","escaped"].forEach((function(t){"placement"===t?i.setAttribute("data-placement",e.placement):e.attributes.popper["data-popper-"+t]?i.setAttribute("data-"+t,""):i.removeAttribute("data-"+t)})),e.attributes.popper={}}}}];J()&&l&&u.push({name:"arrow",options:{element:l,padding:3}}),u.push.apply(u,(null==i?void 0:i.modifiers)||[]),U.popperInstance=(0,n.n4)(c,W,Object.assign({},i,{placement:r,onFirstUpdate:x,modifiers:u}))}function kt(){U.popperInstance&&(U.popperInstance.destroy(),U.popperInstance=null)}function St(){return g(W.querySelectorAll("[data-tippy-root]"))}function Tt(t){U.clearDelayTimeouts(),t&&rt("onTrigger",[U,t]),ht();var e=it(!0),n=Y(),r=n[0],s=n[1];S.isTouch&&"hold"===r&&s&&(e=s),e?i=setTimeout((function(){U.show()}),e):U.show()}function At(t){if(U.clearDelayTimeouts(),rt("onUntrigger",[U,t]),U.state.isVisible){if(!(U.props.trigger.indexOf("mouseenter")>=0&&U.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(t.type)>=0&&C)){var e=it(!1);e?r=setTimeout((function(){U.state.isVisible&&U.hide()}),e):s=requestAnimationFrame((function(){U.hide()}))}}else dt()}}function $(t,e){void 0===e&&(e={});var i=I.plugins.concat(e.plugins||[]);document.addEventListener("touchstart",A,l),window.addEventListener("blur",C);var n,r=Object.assign({},e,{plugins:i}),s=(n=t,x(n)?[n]:function(t){return h(t,"NodeList")}(n)?g(n):Array.isArray(n)?n:g(document.querySelectorAll(n))).reduce((function(t,e){var i=e&&j(e,r);return i&&t.push(i),t}),[]);return x(t)?s[0]:s}$.defaultProps=I,$.setDefaultProps=function(t){Object.keys(t).forEach((function(e){I[e]=t[e]}))},$.currentInput=S,Object.assign({},r.A,{effect:function(t){var e=t.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow)}}),$.setDefaultProps({render:B}),e.Ay=$},5621:function(t){t.exports=/[\0-\x1F\x7F-\x9F]/},86250:function(t){t.exports=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/},85273:function(t){t.exports=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3E]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/},64807:function(t){t.exports=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/},30606:function(t,e,i){"use strict";e.Any=i(97250),e.Cc=i(5621),e.Cf=i(86250),e.P=i(85273),e.Z=i(64807)},97250:function(t){t.exports=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/},49098:function(t){t.exports=function(){"use strict";var t="3.6.2";function e(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))}function i(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}"function"==typeof SuppressedError&&SuppressedError;var n=r;function r(t,e){this.x=t,this.y=e}r.prototype={clone:function(){return new r(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=n,this},_rotateAround:function(t,e){var i=Math.cos(t),n=Math.sin(t),r=e.y+n*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-n*(this.y-e.y),this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},r.convert=function(t){return t instanceof r?t:Array.isArray(t)?new r(t[0],t[1]):t};var s=i(n),o=a;function a(t,e,i,n){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=i,this.p2y=n}a.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var i=t,n=0;n<8;n++){var r=this.sampleCurveX(i)-t;if(Math.abs(r)<e)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=r/s}var o=0,a=1;for(i=t,n=0;n<20&&(r=this.sampleCurveX(i),!(Math.abs(r-t)<e));n++)t>r?o=i:a=i,i=.5*(a-o)+o;return i},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var l=i(o);let c,u;function h(){return null==c&&(c="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),c}function d(t,e,i,n){const r=new l(t,e,i,n);return function(t){return r.solve(t)}}const p=d(.25,.1,.25,1);function f(t,e,i){return Math.min(i,Math.max(e,t))}function m(t,e,i){const n=i-e,r=((t-e)%n+n)%n+e;return r===e?i:r}function g(t,e,i){if(!t.length)return i(null,[]);let n=t.length;const r=new Array(t.length);let s=null;t.forEach(((t,o)=>{e(t,((t,e)=>{t&&(s=t),r[o]=e,0==--n&&i(s,r)}))}))}function _(t,...e){for(const i of e)for(const e in i)t[e]=i[e];return t}function y(t,e){const i={};for(let n=0;n<e.length;n++){const r=e[n];r in t&&(i[r]=t[r])}return i}let x=1;function v(){return x++}function b(t,e,i){const n={};for(const r in t)n[r]=e.call(i||this,t[r],r,t);return n}function w(t,e,i){const n={};for(const r in t)e.call(i||this,t[r],r,t)&&(n[r]=t[r]);return n}function k(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!k(t[i],e[i]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const i in t)if(!k(t[i],e[i]))return!1;return!0}return t===e}function S(t){return Array.isArray(t)?t.map(S):"object"==typeof t&&t?b(t,S):t}const T={};function A(t){T[t]||("undefined"!=typeof console&&console.warn(t),T[t]=!0)}function M(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}function C(t){let e=0;for(let i,n,r=0,s=t.length,o=s-1;r<s;o=r++)i=t[r],n=t[o],e+=(n.x-i.x)*(i.y+n.y);return e}function E(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}let I=null;function D(t){if(null==I){const e=t.navigator?t.navigator.userAgent:null;I=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return I}function z(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap}const P="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let L,F;const R={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(t){const e=requestAnimationFrame(t);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(t,e=0){return this.getImageCanvasContext(t).getImageData(-e,-e,t.width+2*e,t.height+2*e)},getImageCanvasContext(t){const e=window.document.createElement("canvas"),i=e.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,i.drawImage(t,0,0,t.width,t.height),i},resolveURL:t=>(L||(L=document.createElement("a")),L.href=t,L.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==F&&(F=matchMedia("(prefers-reduced-motion: reduce)")),F.matches)}};class O{static testProp(t){if(!O.docStyle)return t[0];for(let e=0;e<t.length;e++)if(t[e]in O.docStyle)return t[e];return t[0]}static create(t,e,i){const n=window.document.createElement(t);return void 0!==e&&(n.className=e),i&&i.appendChild(n),n}static createNS(t,e){return window.document.createElementNS(t,e)}static disableDrag(){O.docStyle&&O.selectProp&&(O.userSelect=O.docStyle[O.selectProp],O.docStyle[O.selectProp]="none")}static enableDrag(){O.docStyle&&O.selectProp&&(O.docStyle[O.selectProp]=O.userSelect)}static setTransform(t,e){t.style[O.transformProp]=e}static addEventListener(t,e,i,n={}){t.addEventListener(e,i,"passive"in n?n:n.capture)}static removeEventListener(t,e,i,n={}){t.removeEventListener(e,i,"passive"in n?n:n.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",O.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",O.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",O.suppressClickInternal,!0)}),0)}static mousePos(t,e){const i=t.getBoundingClientRect();return new s(e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop)}static touchPos(t,e){const i=t.getBoundingClientRect(),n=[];for(let r=0;r<e.length;r++)n.push(new s(e[r].clientX-i.left-t.clientLeft,e[r].clientY-i.top-t.clientTop));return n}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}O.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,O.selectProp=O.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),O.transformProp=O.testProp(["transform","WebkitTransform"]);const B={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class V extends Error{constructor(t,e,i,n){super(`AJAXError: ${e} (${t}): ${i}`),this.status=t,this.statusText=e,this.url=i,this.body=n}}const N=E()?()=>self.worker&&self.worker.referrer:()=>("blob:"===window.location.protocol?window.parent:window).location.href,q=t=>B.REGISTERED_PROTOCOLS[t.substring(0,t.indexOf("://"))];function j(t,e){const i=new AbortController,n=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,cache:t.cache,referrer:N(),signal:i.signal});let r=!1,s=!1;return"json"===t.type&&n.headers.set("Accept","application/json"),s||fetch(n).then((i=>i.ok?(i=>{("arrayBuffer"===t.type||"image"===t.type?i.arrayBuffer():"json"===t.type?i.json():i.text()).then((t=>{s||(r=!0,e(null,t,i.headers.get("Cache-Control"),i.headers.get("Expires")))})).catch((t=>{s||e(new Error(t.message))}))})(i):i.blob().then((n=>e(new V(i.status,i.statusText,t.url,n)))))).catch((t=>{20!==t.code&&e(new Error(t.message))})),{cancel:()=>{s=!0,r||i.abort()}}}const $=function(t,e){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){if(E()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e);if(!E())return(q(t.url)||j)(t,e)}if(!(/^file:/.test(i=t.url)||/^file:/.test(N())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return j(t,e);if(E()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var i;return function(t,e){const i=new XMLHttpRequest;i.open(t.method||"GET",t.url,!0),"arrayBuffer"!==t.type&&"image"!==t.type||(i.responseType="arraybuffer");for(const e in t.headers)i.setRequestHeader(e,t.headers[e]);return"json"===t.type&&(i.responseType="text",i.setRequestHeader("Accept","application/json")),i.withCredentials="include"===t.credentials,i.onerror=()=>{e(new Error(i.statusText))},i.onload=()=>{if((i.status>=200&&i.status<300||0===i.status)&&null!==i.response){let n=i.response;if("json"===t.type)try{n=JSON.parse(i.response)}catch(t){return e(t)}e(null,n,i.getResponseHeader("Cache-Control"),i.getResponseHeader("Expires"))}else{const n=new Blob([i.response],{type:i.getResponseHeader("Content-Type")});e(new V(i.status,i.statusText,t.url,n))}},i.send(t.body),{cancel:()=>i.abort()}}(t,e)},U=function(t,e){return $(_(t,{type:"json"}),e)},Z=function(t,e){return $(_(t,{type:"arrayBuffer"}),e)};function W(t){if(!t||t.indexOf("://")<=0||0===t.indexOf("data:image/")||0===t.indexOf("blob:"))return!0;const e=new URL(t),i=window.location;return e.protocol===i.protocol&&e.host===i.host}const G={supported:!1,testSupport:function(t){!Y&&X&&(K?J(t):H=t)}};let H,X,Y=!1,K=!1;function J(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,X),t.isContextLost())return;G.supported=!0}catch(t){}t.deleteTexture(e),Y=!0}var Q,tt;"undefined"!=typeof document&&(X=document.createElement("img"),X.onload=function(){H&&J(H),H=null,K=!0},X.onerror=function(){Y=!0,H=null},X.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(t){let e,i,n,r;t.resetRequestQueue=()=>{e=[],i=0,n=0,r={}},t.addThrottleControl=t=>{const e=n++;return r[e]=t,e},t.removeThrottleControl=t=>{delete r[t],a()},t.getImage=(t,n,r=!0)=>{G.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*");const s={requestParameters:t,supportImageRefresh:r,callback:n,cancelled:!1,completed:!1,cancel:()=>{s.completed||s.cancelled||(s.cancelled=!0,s.innerRequest&&(s.innerRequest.cancel(),i--),a())}};return e.push(s),a(),s};const s=t=>{const{requestParameters:e,supportImageRefresh:i,callback:n}=t;return _(e,{type:"image"}),(!1!==i||E()||q(e.url)||e.headers&&!Object.keys(e.headers).reduce(((t,e)=>t&&"accept"===e),!0)?$:l)(e,((e,i,r,s)=>{o(t,n,e,i,r,s)}))},o=(t,e,n,r,s,o)=>{n?e(n):r instanceof HTMLImageElement||z(r)?e(null,r):r&&((t,e)=>{"function"==typeof createImageBitmap?function(t,e){const i=new Blob([new Uint8Array(t)],{type:"image/png"});createImageBitmap(i).then((t=>{e(null,t)})).catch((t=>{e(new Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))}(t,e):function(t,e){const i=new Image;i.onload=()=>{e(null,i),URL.revokeObjectURL(i.src),i.onload=null,window.requestAnimationFrame((()=>{i.src=P}))},i.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const n=new Blob([new Uint8Array(t)],{type:"image/png"});i.src=t.byteLength?URL.createObjectURL(n):P}(t,e)})(r,((t,i)=>{null!=t?e(t):null!=i&&e(null,i,{cacheControl:s,expires:o})})),t.cancelled||(t.completed=!0,i--,a())},a=()=>{const t=(()=>{const t=Object.keys(r);let e=!1;if(t.length>0)for(const i of t)if(e=r[i](),e)break;return e})()?B.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:B.MAX_PARALLEL_IMAGE_REQUESTS;for(let n=i;n<t&&e.length>0;n++){const t=e.shift();if(t.cancelled){n--;continue}const r=s(t);i++,t.innerRequest=r}},l=(t,e)=>{const i=new Image,n=t.url;let r=!1;const s=t.credentials;return s&&"include"===s?i.crossOrigin="use-credentials":(s&&"same-origin"===s||!W(n))&&(i.crossOrigin="anonymous"),i.fetchPriority="high",i.onload=()=>{e(null,i),i.onerror=i.onload=null},i.onerror=()=>{r||e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),i.onerror=i.onload=null},i.src=n,{cancel:()=>{r=!0,i.src=""}}}}(Q||(Q={})),Q.resetRequestQueue(),function(t){t.Glyphs="Glyphs",t.Image="Image",t.Source="Source",t.SpriteImage="SpriteImage",t.SpriteJSON="SpriteJSON",t.Style="Style",t.Tile="Tile",t.Unknown="Unknown"}(tt||(tt={}));class et{constructor(t){this._transformRequestFn=t}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeSpriteURL(t,e,i){const n=function(t){const e=t.match(it);if(!e)throw new Error(`Unable to parse URL "${t}"`);return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}(t);return n.path+=`${e}${i}`,function(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}(n)}setTransformRequest(t){this._transformRequestFn=t}}const it=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function nt(t,e,i){i[t]&&-1!==i[t].indexOf(e)||(i[t]=i[t]||[],i[t].push(e))}function rt(t,e,i){if(i&&i[t]){const n=i[t].indexOf(e);-1!==n&&i[t].splice(n,1)}}class st{constructor(t,e={}){_(this,e),this.type=t}}class ot extends st{constructor(t,e={}){super("error",_({error:t},e))}}class at{on(t,e){return this._listeners=this._listeners||{},nt(t,e,this._listeners),this}off(t,e){return rt(t,e,this._listeners),rt(t,e,this._oneTimeListeners),this}once(t,e){return e?(this._oneTimeListeners=this._oneTimeListeners||{},nt(t,e,this._oneTimeListeners),this):new Promise((e=>this.once(t,e)))}fire(t,e){"string"==typeof t&&(t=new st(t,e||{}));const i=t.type;if(this.listens(i)){t.target=this;const e=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];for(const i of e)i.call(this,t);const n=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];for(const e of n)rt(i,e,this._oneTimeListeners),e.call(this,t);const r=this._eventedParent;r&&(_(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),r.fire(t))}else t instanceof ot&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}var lt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ct=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ut(t,e){const i={};for(const e in t)"ref"!==e&&(i[e]=t[e]);return ct.forEach((t=>{t in e&&(i[t]=e[t])})),i}function ht(t){t=t.slice();const e=Object.create(null);for(let i=0;i<t.length;i++)e[t[i].id]=t[i];for(let i=0;i<t.length;i++)"ref"in t[i]&&(t[i]=ut(t[i],e[t[i].ref]));return t}function dt(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!dt(t[i],e[i]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const i in t)if(!dt(t[i],e[i]))return!1;return!0}return t===e}const pt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ft(t,e,i){i.push({command:pt.addSource,args:[t,e[t]]})}function mt(t,e,i){e.push({command:pt.removeSource,args:[t]}),i[t]=!0}function gt(t,e,i,n){mt(t,i,n),ft(t,e,i)}function _t(t,e,i){let n;for(n in t[i])if(Object.prototype.hasOwnProperty.call(t[i],n)&&"data"!==n&&!dt(t[i][n],e[i][n]))return!1;for(n in e[i])if(Object.prototype.hasOwnProperty.call(e[i],n)&&"data"!==n&&!dt(t[i][n],e[i][n]))return!1;return!0}function yt(t,e,i,n,r,s){let o;for(o in e=e||{},t=t||{})Object.prototype.hasOwnProperty.call(t,o)&&(dt(t[o],e[o])||i.push({command:s,args:[n,o,e[o],r]}));for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&!Object.prototype.hasOwnProperty.call(t,o)&&(dt(t[o],e[o])||i.push({command:s,args:[n,o,e[o],r]}))}function xt(t){return t.id}function vt(t,e){return t[e.id]=e,t}class bt{constructor(t,e,i,n){this.message=(t?`${t}: `:"")+i,n&&(this.identifier=n),null!=e&&e.__line__&&(this.line=e.__line__)}}function wt(t,...e){for(const i of e)for(const e in i)t[e]=i[e];return t}class kt extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}class St{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[t,i]of e)this.bindings[t]=i}concat(t){return new St(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Tt={kind:"null"},At={kind:"number"},Mt={kind:"string"},Ct={kind:"boolean"},Et={kind:"color"},It={kind:"object"},Dt={kind:"value"},zt={kind:"collator"},Pt={kind:"formatted"},Lt={kind:"padding"},Ft={kind:"resolvedImage"},Rt={kind:"variableAnchorOffsetCollection"};function Ot(t,e){return{kind:"array",itemType:t,N:e}}function Bt(t){if("array"===t.kind){const e=Bt(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const Vt=[Tt,At,Mt,Ct,Et,Pt,It,Ot(Dt),Lt,Ft,Rt];function Nt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Nt(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of Vt)if(!Nt(t,e))return null}return`Expected ${Bt(t)} but found ${Bt(e)} instead.`}function qt(t,e){return e.some((e=>e.kind===t.kind))}function jt(t,e){return e.some((e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t))}function $t(t,e){return"array"===t.kind&&"array"===e.kind?t.itemType.kind===e.itemType.kind&&"number"==typeof t.N:t.kind===e.kind}const Ut=.96422,Zt=.82521,Wt=4/29,Gt=6/29,Ht=3*Gt*Gt,Xt=Math.PI/180,Yt=180/Math.PI;function Kt(t){return(t%=360)<0&&(t+=360),t}function Jt([t,e,i,n]){let r,s;const o=te((.2225045*(t=Qt(t))+.7168786*(e=Qt(e))+.0606169*(i=Qt(i)))/1);t===e&&e===i?r=s=o:(r=te((.4360747*t+.3850649*e+.1430804*i)/Ut),s=te((.0139322*t+.0971045*e+.7141733*i)/Zt));const a=116*o-16;return[a<0?0:a,500*(r-o),200*(o-s),n]}function Qt(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function te(t){return t>.008856451679035631?Math.pow(t,1/3):t/Ht+Wt}function ee([t,e,i,n]){let r=(t+16)/116,s=isNaN(e)?r:r+e/500,o=isNaN(i)?r:r-i/200;return r=1*ne(r),s=Ut*ne(s),o=Zt*ne(o),[ie(3.1338561*s-1.6168667*r-.4906146*o),ie(-.9787684*s+1.9161415*r+.033454*o),ie(.0719453*s-.2289914*r+1.4052427*o),n]}function ie(t){return(t=t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055)<0?0:t>1?1:t}function ne(t){return t>Gt?t*t*t:Ht*(t-Wt)}function re(t){return parseInt(t.padEnd(2,t),16)/255}function se(t,e){return oe(e?t/100:t,0,1)}function oe(t,e,i){return Math.min(Math.max(e,t),i)}function ae(t){return!t.some(Number.isNaN)}const le={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class ce{constructor(t,e,i,n=1,r=!0){this.r=t,this.g=e,this.b=i,this.a=n,r||(this.r*=n,this.g*=n,this.b*=n,n||this.overwriteGetter("rgb",[t,e,i,n]))}static parse(t){if(t instanceof ce)return t;if("string"!=typeof t)return;const e=function(t){if("transparent"===(t=t.toLowerCase().trim()))return[0,0,0,0];const e=le[t];if(e){const[t,i,n]=e;return[t/255,i/255,n/255,1]}if(t.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(t)){const e=t.length<6?1:2;let i=1;return[re(t.slice(i,i+=e)),re(t.slice(i,i+=e)),re(t.slice(i,i+=e)),re(t.slice(i,i+e)||"ff")]}if(t.startsWith("rgb")){const e=t.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(e){const[t,i,n,r,s,o,a,l,c,u,h,d]=e,p=[r||" ",a||" ",u].join("");if("  "===p||"  /"===p||",,"===p||",,,"===p){const t=[n,o,c].join(""),e="%%%"===t?100:""===t?255:0;if(e){const t=[oe(+i/e,0,1),oe(+s/e,0,1),oe(+l/e,0,1),h?se(+h,d):1];if(ae(t))return t}}return}}const i=t.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(i){const[t,e,n,r,s,o,a,l,c]=i,u=[n||" ",s||" ",a].join("");if("  "===u||"  /"===u||",,"===u||",,,"===u){const t=[+e,oe(+r,0,100),oe(+o,0,100),l?se(+l,c):1];if(ae(t))return function([t,e,i,n]){function r(n){const r=(n+t/30)%12,s=e*Math.min(i,1-i);return i-s*Math.max(-1,Math.min(r-3,9-r,1))}return t=Kt(t),e/=100,i/=100,[r(0),r(8),r(4),n]}(t)}}}(t);return e?new ce(...e,!1):void 0}get rgb(){const{r:t,g:e,b:i,a:n}=this,r=n||1/0;return this.overwriteGetter("rgb",[t/r,e/r,i/r,n])}get hcl(){return this.overwriteGetter("hcl",function(t){const[e,i,n,r]=Jt(t),s=Math.sqrt(i*i+n*n);return[Math.round(1e4*s)?Kt(Math.atan2(n,i)*Yt):NaN,s,e,r]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Jt(this.rgb))}overwriteGetter(t,e){return Object.defineProperty(this,t,{value:e}),e}toString(){const[t,e,i,n]=this.rgb;return`rgba(${[t,e,i].map((t=>Math.round(255*t))).join(",")},${n})`}}ce.black=new ce(0,0,0,1),ce.white=new ce(1,1,1,1),ce.transparent=new ce(0,0,0,0),ce.red=new ce(1,0,0,1);class ue{constructor(t,e,i){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class he{constructor(t,e,i,n,r){this.text=t,this.image=e,this.scale=i,this.fontStack=n,this.textColor=r}}class de{constructor(t){this.sections=t}static fromString(t){return new de([new he(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((t=>0!==t.text.length||t.image&&0!==t.image.name.length))}static factory(t){return t instanceof de?t:de.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map((t=>t.text)).join("")}}class pe{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof pe)return t;if("number"==typeof t)return new pe([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const e of t)if("number"!=typeof e)return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new pe(t)}}toString(){return JSON.stringify(this.values)}}const fe=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class me{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof me)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let e=0;e<t.length;e+=2){const i=t[e],n=t[e+1];if("string"!=typeof i||!fe.has(i))return;if(!Array.isArray(n)||2!==n.length||"number"!=typeof n[0]||"number"!=typeof n[1])return}return new me(t)}}toString(){return JSON.stringify(this.values)}}class ge{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new ge({name:t,available:!1}):null}}function _e(t,e,i,n){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:`Invalid rgba value [${[t,e,i,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof n?[t,e,i,n]:[t,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ye(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof ce||t instanceof ue||t instanceof de||t instanceof pe||t instanceof me||t instanceof ge)return!0;if(Array.isArray(t)){for(const e of t)if(!ye(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!ye(t[e]))return!1;return!0}return!1}function xe(t){if(null===t)return Tt;if("string"==typeof t)return Mt;if("boolean"==typeof t)return Ct;if("number"==typeof t)return At;if(t instanceof ce)return Et;if(t instanceof ue)return zt;if(t instanceof de)return Pt;if(t instanceof pe)return Lt;if(t instanceof me)return Rt;if(t instanceof ge)return Ft;if(Array.isArray(t)){const e=t.length;let i;for(const e of t){const t=xe(e);if(i){if(i===t)continue;i=Dt;break}i=t}return Ot(i||Dt,e)}return It}function ve(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof ce||t instanceof de||t instanceof pe||t instanceof me||t instanceof ge?t.toString():JSON.stringify(t)}class be{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ye(t[1]))return e.error("invalid value");const i=t[1];let n=xe(i);const r=e.expectedType;return"array"!==n.kind||0!==n.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(n=r),new be(n,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class we{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const ke={string:Mt,number:At,boolean:Ct,object:It};class Se{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let i,n=1;const r=t[0];if("array"===r){let r,s;if(t.length>2){const i=t[1];if("string"!=typeof i||!(i in ke)||"object"===i)return e.error('The item type argument of "array" must be one of string, number, boolean',1);r=ke[i],n++}else r=Dt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);s=t[2],n++}i=Ot(r,s)}else{if(!ke[r])throw new Error(`Types doesn't contain name = ${r}`);i=ke[r]}const s=[];for(;n<t.length;n++){const i=e.parse(t[n],n,Dt);if(!i)return null;s.push(i)}return new Se(i,s)}evaluate(t){for(let e=0;e<this.args.length;e++){const i=this.args[e].evaluate(t);if(!Nt(this.type,xe(i)))return i;if(e===this.args.length-1)throw new we(`Expected value to be of type ${Bt(this.type)}, but found ${Bt(xe(i))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const Te={"to-boolean":Ct,"to-color":Et,"to-number":At,"to-string":Mt};class Ae{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[0];if(!Te[i])throw new Error(`Can't parse ${i} as it is not part of the known types`);if(("to-boolean"===i||"to-string"===i)&&2!==t.length)return e.error("Expected one argument.");const n=Te[i],r=[];for(let i=1;i<t.length;i++){const n=e.parse(t[i],i,Dt);if(!n)return null;r.push(n)}return new Ae(n,r)}evaluate(t){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(t));case"color":{let e,i;for(const n of this.args){if(e=n.evaluate(t),i=null,e instanceof ce)return e;if("string"==typeof e){const i=t.parseColor(e);if(i)return i}else if(Array.isArray(e)&&(i=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:_e(e[0],e[1],e[2],e[3]),!i))return new ce(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new we(i||`Could not parse color from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}case"padding":{let e;for(const i of this.args){e=i.evaluate(t);const n=pe.parse(e);if(n)return n}throw new we(`Could not parse padding from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}case"variableAnchorOffsetCollection":{let e;for(const i of this.args){e=i.evaluate(t);const n=me.parse(e);if(n)return n}throw new we(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}case"number":{let e=null;for(const i of this.args){if(e=i.evaluate(t),null===e)return 0;const n=Number(e);if(!isNaN(n))return n}throw new we(`Could not convert ${JSON.stringify(e)} to number.`)}case"formatted":return de.fromString(ve(this.args[0].evaluate(t)));case"resolvedImage":return ge.fromString(ve(this.args[0].evaluate(t)));default:return ve(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const Me=["Unknown","Point","LineString","Polygon"];class Ce{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Me[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=ce.parse(t)),e}}class Ee{constructor(t,e,i=[],n,r=new St,s=[]){this.registry=t,this.path=i,this.key=i.map((t=>`[${t}]`)).join(""),this.scope=r,this.errors=s,this.expectedType=n,this._isConstant=e}parse(t,e,i,n,r={}){return e?this.concat(e,i,n)._parse(t,r):this._parse(t,r)}_parse(t,e){function i(t,e,i){return"assert"===i?new Se(e,[t]):"coerce"===i?new Ae(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const n=t[0];if("string"!=typeof n)return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const r=this.registry[n];if(r){let n=r.parse(t,this);if(!n)return null;if(this.expectedType){const t=this.expectedType,r=n.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==r.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==r.kind&&"string"!==r.kind)if("padding"!==t.kind||"value"!==r.kind&&"number"!==r.kind&&"array"!==r.kind)if("variableAnchorOffsetCollection"!==t.kind||"value"!==r.kind&&"array"!==r.kind){if(this.checkSubtype(t,r))return null}else n=i(n,t,e.typeAnnotation||"coerce");else n=i(n,t,e.typeAnnotation||"coerce");else n=i(n,t,e.typeAnnotation||"coerce");else n=i(n,t,e.typeAnnotation||"assert")}if(!(n instanceof be)&&"resolvedImage"!==n.type.kind&&this._isConstant(n)){const e=new Ce;try{n=new be(n.type,n.evaluate(e))}catch(t){return this.error(t.message),null}}return n}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,e,i){const n="number"==typeof t?this.path.concat(t):this.path,r=i?this.scope.concat(i):this.scope;return new Ee(this.registry,this._isConstant,n,e||null,r,this.errors)}error(t,...e){const i=`${this.key}${e.map((t=>`[${t}]`)).join("")}`;this.errors.push(new kt(i,t))}checkSubtype(t,e){const i=Nt(t,e);return i&&this.error(i),i}}class Ie{constructor(t,e,i){this.type=zt,this.locale=i,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const i=t[1];if("object"!=typeof i||Array.isArray(i))return e.error("Collator options argument must be an object.");const n=e.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,Ct);if(!n)return null;const r=e.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,Ct);if(!r)return null;let s=null;return i.locale&&(s=e.parse(i.locale,1,Mt),!s)?null:new Ie(n,r,s)}evaluate(t){return new ue(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}const De=8192;function ze(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Pe(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Le(t,e){const i=(180+t[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,r=Math.pow(2,e.z);return[Math.round(i*r*De),Math.round(n*r*De)]}function Fe(t,e,i){const n=t[0]-e[0],r=t[1]-e[1],s=t[0]-i[0],o=t[1]-i[1];return n*o-s*r==0&&n*s<=0&&r*o<=0}function Re(t,e){let i=!1;for(let o=0,a=e.length;o<a;o++){const a=e[o];for(let e=0,o=a.length;e<o-1;e++){if(Fe(t,a[e],a[e+1]))return!1;(r=a[e])[1]>(n=t)[1]!=(s=a[e+1])[1]>n[1]&&n[0]<(s[0]-r[0])*(n[1]-r[1])/(s[1]-r[1])+r[0]&&(i=!i)}}var n,r,s;return i}function Oe(t,e){for(let i=0;i<e.length;i++)if(Re(t,e[i]))return!0;return!1}function Be(t,e,i,n){const r=n[0]-i[0],s=n[1]-i[1],o=(t[0]-i[0])*s-r*(t[1]-i[1]),a=(e[0]-i[0])*s-r*(e[1]-i[1]);return o>0&&a<0||o<0&&a>0}function Ve(t,e,i){for(const c of i)for(let i=0;i<c.length-1;++i)if(0!=(a=[(o=c[i+1])[0]-(s=c[i])[0],o[1]-s[1]])[0]*(l=[(r=e)[0]-(n=t)[0],r[1]-n[1]])[1]-a[1]*l[0]&&Be(n,r,s,o)&&Be(s,o,n,r))return!0;var n,r,s,o,a,l;return!1}function Ne(t,e){for(let i=0;i<t.length;++i)if(!Re(t[i],e))return!1;for(let i=0;i<t.length-1;++i)if(Ve(t[i],t[i+1],e))return!1;return!0}function qe(t,e){for(let i=0;i<e.length;i++)if(Ne(t,e[i]))return!0;return!1}function je(t,e,i){const n=[];for(let r=0;r<t.length;r++){const s=[];for(let n=0;n<t[r].length;n++){const o=Le(t[r][n],i);ze(e,o),s.push(o)}n.push(s)}return n}function $e(t,e,i){const n=[];for(let r=0;r<t.length;r++){const s=je(t[r],e,i);n.push(s)}return n}function Ue(t,e,i,n){if(t[0]<i[0]||t[0]>i[2]){const e=.5*n;let r=t[0]-i[0]>e?-n:i[0]-t[0]>e?n:0;0===r&&(r=t[0]-i[2]>e?-n:i[2]-t[0]>e?n:0),t[0]+=r}ze(e,t)}function Ze(t,e,i,n){const r=Math.pow(2,n.z)*De,s=[n.x*De,n.y*De],o=[];for(const n of t)for(const t of n){const n=[t.x+s[0],t.y+s[1]];Ue(n,e,i,r),o.push(n)}return o}function We(t,e,i,n){const r=Math.pow(2,n.z)*De,s=[n.x*De,n.y*De],o=[];for(const i of t){const t=[];for(const n of i){const i=[n.x+s[0],n.y+s[1]];ze(e,i),t.push(i)}o.push(t)}if(e[2]-e[0]<=r/2){(a=e)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(const t of o)for(const n of t)Ue(n,e,i,r)}var a;return o}class Ge{constructor(t,e){this.type=Ct,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ye(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const i=e.features[t].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new Ge(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new Ge(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new Ge(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const i=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){const s=je(e.coordinates,n,r),o=Ze(t.geometry(),i,n,r);if(!Pe(i,n))return!1;for(const t of o)if(!Re(t,s))return!1}if("MultiPolygon"===e.type){const s=$e(e.coordinates,n,r),o=Ze(t.geometry(),i,n,r);if(!Pe(i,n))return!1;for(const t of o)if(!Oe(t,s))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const i=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){const s=je(e.coordinates,n,r),o=We(t.geometry(),i,n,r);if(!Pe(i,n))return!1;for(const t of o)if(!Ne(t,s))return!1}if("MultiPolygon"===e.type){const s=$e(e.coordinates,n,r),o=We(t.geometry(),i,n,r);if(!Pe(i,n))return!1;for(const t of o)if(!qe(t,s))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class He{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const i=t[1];return e.scope.has(i)?new He(i,e.scope.get(i)):e.error(`Unknown variable "${i}". Make sure "${i}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Xe{constructor(t,e,i,n){this.name=t,this.type=e,this._evaluate=i,this.args=n}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,e){const i=t[0],n=Xe.definitions[i];if(!n)return e.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0);const r=Array.isArray(n)?n[0]:n.type,s=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,o=s.filter((([e])=>!Array.isArray(e)||e.length===t.length-1));let a=null;for(const[n,s]of o){a=new Ee(e.registry,Ye,e.path,null,e.scope);const o=[];let l=!1;for(let e=1;e<t.length;e++){const i=t[e],r=Array.isArray(n)?n[e-1]:n.type,s=a.parse(i,1+o.length,r);if(!s){l=!0;break}o.push(s)}if(!l)if(Array.isArray(n)&&n.length!==o.length)a.error(`Expected ${n.length} arguments, but found ${o.length} instead.`);else{for(let t=0;t<o.length;t++){const e=Array.isArray(n)?n[t]:n.type,i=o[t];a.concat(t+1).checkSubtype(e,i.type)}if(0===a.errors.length)return new Xe(i,r,s,o)}}if(1===o.length)e.errors.push(...a.errors);else{const i=(o.length?o:s).map((([t])=>{return e=t,Array.isArray(e)?`(${e.map(Bt).join(", ")})`:`(${Bt(e.type)}...)`;var e})).join(" | "),n=[];for(let i=1;i<t.length;i++){const r=e.parse(t[i],1+n.length);if(!r)return null;n.push(Bt(r.type))}e.error(`Expected arguments of type ${i}, but found (${n.join(", ")}) instead.`)}return null}static register(t,e){Xe.definitions=e;for(const i in e)t[i]=Xe}}function Ye(t){if(t instanceof He)return Ye(t.boundExpression);if(t instanceof Xe&&"error"===t.name)return!1;if(t instanceof Ie)return!1;if(t instanceof Ge)return!1;const e=t instanceof Ae||t instanceof Se;let i=!0;return t.eachChild((t=>{i=e?i&&Ye(t):i&&t instanceof be})),!!i&&Ke(t)&&Qe(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ke(t){if(t instanceof Xe){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof Ge)return!1;let e=!0;return t.eachChild((t=>{e&&!Ke(t)&&(e=!1)})),e}function Je(t){if(t instanceof Xe&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild((t=>{e&&!Je(t)&&(e=!1)})),e}function Qe(t,e){if(t instanceof Xe&&e.indexOf(t.name)>=0)return!1;let i=!0;return t.eachChild((t=>{i&&!Qe(t,e)&&(i=!1)})),i}function ti(t,e){const i=t.length-1;let n,r,s=0,o=i,a=0;for(;s<=o;)if(a=Math.floor((s+o)/2),n=t[a],r=t[a+1],n<=e){if(a===i||e<r)return a;s=a+1}else{if(!(n>e))throw new we("Input is not a number.");o=a-1}return 0}class ei{constructor(t,e,i){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[t,e]of i)this.labels.push(t),this.outputs.push(e)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const i=e.parse(t[1],1,At);if(!i)return null;const n=[];let r=null;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(let i=1;i<t.length;i+=2){const s=1===i?-1/0:t[i],o=t[i+1],a=i,l=i+1;if("number"!=typeof s)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(n.length&&n[n.length-1][0]>=s)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const c=e.parse(o,l,r);if(!c)return null;r=r||c.type,n.push([s,c])}return new ei(r,i,n)}evaluate(t){const e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);const n=this.input.evaluate(t);if(n<=e[0])return i[0].evaluate(t);const r=e.length;return n>=e[r-1]?i[r-1].evaluate(t):i[ti(e,n)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function ii(t,e,i){return t+i*(e-t)}function ni(t,e,i){return t.map(((t,n)=>ii(t,e[n],i)))}const ri={number:ii,color:function(t,e,i,n="rgb"){switch(n){case"rgb":{const[n,r,s,o]=ni(t.rgb,e.rgb,i);return new ce(n,r,s,o,!1)}case"hcl":{const[n,r,s,o]=t.hcl,[a,l,c,u]=e.hcl;let h,d;if(isNaN(n)||isNaN(a))isNaN(n)?isNaN(a)?h=NaN:(h=a,1!==s&&0!==s||(d=l)):(h=n,1!==c&&0!==c||(d=r));else{let t=a-n;a>n&&t>180?t-=360:a<n&&n-a>180&&(t+=360),h=n+i*t}const[p,f,m,g]=function([t,e,i,n]){return t=isNaN(t)?0:t*Xt,ee([i,Math.cos(t)*e,Math.sin(t)*e,n])}([h,null!=d?d:ii(r,l,i),ii(s,c,i),ii(o,u,i)]);return new ce(p,f,m,g,!1)}case"lab":{const[n,r,s,o]=ee(ni(t.lab,e.lab,i));return new ce(n,r,s,o,!1)}}},array:ni,padding:function(t,e,i){return new pe(ni(t.values,e.values,i))},variableAnchorOffsetCollection:function(t,e,i){const n=t.values,r=e.values;if(n.length!==r.length)throw new we(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${e.toString()}`);const s=[];for(let t=0;t<n.length;t+=2){if(n[t]!==r[t])throw new we(`Cannot interpolate values containing mismatched anchors. from[${t}]: ${n[t]}, to[${t}]: ${r[t]}`);s.push(n[t]);const[e,o]=n[t+1],[a,l]=r[t+1];s.push([ii(e,a,i),ii(o,l,i)])}return new me(s)}};class si{constructor(t,e,i,n,r){this.type=t,this.operator=e,this.interpolation=i,this.input=n,this.labels=[],this.outputs=[];for(const[t,e]of r)this.labels.push(t),this.outputs.push(e)}static interpolationFactor(t,e,i,n){let r=0;if("exponential"===t.name)r=oi(e,t.base,i,n);else if("linear"===t.name)r=oi(e,1,i,n);else if("cubic-bezier"===t.name){const s=t.controlPoints;r=new l(s[0],s[1],s[2],s[3]).solve(oi(e,1,i,n))}return r}static parse(t,e){let[i,n,r,...s]=t;if(!Array.isArray(n)||0===n.length)return e.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const t=n[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:t}}else{if("cubic-bezier"!==n[0])return e.error(`Unknown interpolation type ${String(n[0])}`,1,0);{const t=n.slice(1);if(4!==t.length||t.some((t=>"number"!=typeof t||t<0||t>1)))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(r=e.parse(r,2,At),!r)return null;const o=[];let a=null;"interpolate-hcl"===i||"interpolate-lab"===i?a=Et:e.expectedType&&"value"!==e.expectedType.kind&&(a=e.expectedType);for(let t=0;t<s.length;t+=2){const i=s[t],n=s[t+1],r=t+3,l=t+4;if("number"!=typeof i)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',r);if(o.length&&o[o.length-1][0]>=i)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',r);const c=e.parse(n,l,a);if(!c)return null;a=a||c.type,o.push([i,c])}return $t(a,At)||$t(a,Et)||$t(a,Lt)||$t(a,Rt)||$t(a,Ot(At))?new si(a,i,n,r,o):e.error(`Type ${Bt(a)} is not interpolatable.`)}evaluate(t){const e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);const n=this.input.evaluate(t);if(n<=e[0])return i[0].evaluate(t);const r=e.length;if(n>=e[r-1])return i[r-1].evaluate(t);const s=ti(e,n),o=si.interpolationFactor(this.interpolation,n,e[s],e[s+1]),a=i[s].evaluate(t),l=i[s+1].evaluate(t);switch(this.operator){case"interpolate":return ri[this.type.kind](a,l,o);case"interpolate-hcl":return ri.color(a,l,o,"hcl");case"interpolate-lab":return ri.color(a,l,o,"lab")}}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function oi(t,e,i,n){const r=n-i,s=t-i;return 0===r?0:1===e?s/r:(Math.pow(e,s)-1)/(Math.pow(e,r)-1)}class ai{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let i=null;const n=e.expectedType;n&&"value"!==n.kind&&(i=n);const r=[];for(const n of t.slice(1)){const t=e.parse(n,1+r.length,i,void 0,{typeAnnotation:"omit"});if(!t)return null;i=i||t.type,r.push(t)}if(!i)throw new Error("No output type");const s=n&&r.some((t=>Nt(n,t.type)));return new ai(s?Dt:i,r)}evaluate(t){let e,i=null,n=0;for(const r of this.args)if(n++,i=r.evaluate(t),i&&i instanceof ge&&!i.available&&(e||(e=i.name),i=null,n===this.args.length&&(i=e)),null!==i)break;return i}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}class li{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const i=[];for(let n=1;n<t.length-1;n+=2){const r=t[n];if("string"!=typeof r)return e.error(`Expected string, but found ${typeof r} instead.`,n);if(/[^a-zA-Z0-9_]/.test(r))return e.error("Variable names must contain only alphanumeric characters or '_'.",n);const s=e.parse(t[n+1],n+1);if(!s)return null;i.push([r,s])}const n=e.parse(t[t.length-1],t.length-1,e.expectedType,i);return n?new li(i,n):null}outputDefined(){return this.result.outputDefined()}}class ci{constructor(t,e,i){this.type=t,this.index=e,this.input=i}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,At),n=e.parse(t[2],2,Ot(e.expectedType||Dt));return i&&n?new ci(n.type.itemType,i,n):null}evaluate(t){const e=this.index.evaluate(t),i=this.input.evaluate(t);if(e<0)throw new we(`Array index out of bounds: ${e} < 0.`);if(e>=i.length)throw new we(`Array index out of bounds: ${e} > ${i.length-1}.`);if(e!==Math.floor(e))throw new we(`Array index must be an integer, but found ${e} instead.`);return i[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class ui{constructor(t,e){this.type=Ct,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,Dt),n=e.parse(t[2],2,Dt);return i&&n?qt(i.type,[Ct,Mt,At,Tt,Dt])?new ui(i,n):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${Bt(i.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!i)return!1;if(!jt(e,["boolean","string","number","null"]))throw new we(`Expected first argument to be of type boolean, string, number or null, but found ${Bt(xe(e))} instead.`);if(!jt(i,["string","array"]))throw new we(`Expected second argument to be of type array or string, but found ${Bt(xe(i))} instead.`);return i.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class hi{constructor(t,e,i){this.type=At,this.needle=t,this.haystack=e,this.fromIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,Dt),n=e.parse(t[2],2,Dt);if(!i||!n)return null;if(!qt(i.type,[Ct,Mt,At,Tt,Dt]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${Bt(i.type)} instead`);if(4===t.length){const r=e.parse(t[3],3,At);return r?new hi(i,n,r):null}return new hi(i,n)}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!jt(e,["boolean","string","number","null"]))throw new we(`Expected first argument to be of type boolean, string, number or null, but found ${Bt(xe(e))} instead.`);if(!jt(i,["string","array"]))throw new we(`Expected second argument to be of type array or string, but found ${Bt(xe(i))} instead.`);if(this.fromIndex){const n=this.fromIndex.evaluate(t);return i.indexOf(e,n)}return i.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class di{constructor(t,e,i,n,r,s){this.inputType=t,this.type=e,this.input=i,this.cases=n,this.outputs=r,this.otherwise=s}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let i,n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);const r={},s=[];for(let o=2;o<t.length-1;o+=2){let a=t[o];const l=t[o+1];Array.isArray(a)||(a=[a]);const c=e.concat(o);if(0===a.length)return c.error("Expected at least one branch label.");for(const t of a){if("number"!=typeof t&&"string"!=typeof t)return c.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return c.error("Numeric branch labels must be integer values.");if(i){if(c.checkSubtype(i,xe(t)))return null}else i=xe(t);if(void 0!==r[String(t)])return c.error("Branch labels must be unique.");r[String(t)]=s.length}const u=e.parse(l,o,n);if(!u)return null;n=n||u.type,s.push(u)}const o=e.parse(t[1],1,Dt);if(!o)return null;const a=e.parse(t[t.length-1],t.length-1,n);return a?"value"!==o.type.kind&&e.concat(1).checkSubtype(i,o.type)?null:new di(i,n,o,r,s,a):null}evaluate(t){const e=this.input.evaluate(t);return(xe(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}}class pi{constructor(t,e,i){this.type=t,this.branches=e,this.otherwise=i}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);const n=[];for(let r=1;r<t.length-1;r+=2){const s=e.parse(t[r],r,Ct);if(!s)return null;const o=e.parse(t[r+1],r+1,i);if(!o)return null;n.push([s,o]),i=i||o.type}const r=e.parse(t[t.length-1],t.length-1,i);if(!r)return null;if(!i)throw new Error("Can't infer output type");return new pi(i,n,r)}evaluate(t){for(const[e,i]of this.branches)if(e.evaluate(t))return i.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,i]of this.branches)t(e),t(i);t(this.otherwise)}outputDefined(){return this.branches.every((([t,e])=>e.outputDefined()))&&this.otherwise.outputDefined()}}class fi{constructor(t,e,i,n){this.type=t,this.input=e,this.beginIndex=i,this.endIndex=n}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,Dt),n=e.parse(t[2],2,At);if(!i||!n)return null;if(!qt(i.type,[Ot(Dt),Mt,Dt]))return e.error(`Expected first argument to be of type array or string, but found ${Bt(i.type)} instead`);if(4===t.length){const r=e.parse(t[3],3,At);return r?new fi(i.type,i,n,r):null}return new fi(i.type,i,n)}evaluate(t){const e=this.input.evaluate(t),i=this.beginIndex.evaluate(t);if(!jt(e,["string","array"]))throw new we(`Expected first argument to be of type array or string, but found ${Bt(xe(e))} instead.`);if(this.endIndex){const n=this.endIndex.evaluate(t);return e.slice(i,n)}return e.slice(i)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function mi(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function gi(t,e,i,n){return 0===n.compare(e,i)}function _i(t,e,i){const n="=="!==t&&"!="!==t;return class r{constructor(t,e,i){this.type=Ct,this.lhs=t,this.rhs=e,this.collator=i,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const i=t[0];let s=e.parse(t[1],1,Dt);if(!s)return null;if(!mi(i,s.type))return e.concat(1).error(`"${i}" comparisons are not supported for type '${Bt(s.type)}'.`);let o=e.parse(t[2],2,Dt);if(!o)return null;if(!mi(i,o.type))return e.concat(2).error(`"${i}" comparisons are not supported for type '${Bt(o.type)}'.`);if(s.type.kind!==o.type.kind&&"value"!==s.type.kind&&"value"!==o.type.kind)return e.error(`Cannot compare types '${Bt(s.type)}' and '${Bt(o.type)}'.`);n&&("value"===s.type.kind&&"value"!==o.type.kind?s=new Se(o.type,[s]):"value"!==s.type.kind&&"value"===o.type.kind&&(o=new Se(s.type,[o])));let a=null;if(4===t.length){if("string"!==s.type.kind&&"string"!==o.type.kind&&"value"!==s.type.kind&&"value"!==o.type.kind)return e.error("Cannot use collator to compare non-string types.");if(a=e.parse(t[3],3,zt),!a)return null}return new r(s,o,a)}evaluate(r){const s=this.lhs.evaluate(r),o=this.rhs.evaluate(r);if(n&&this.hasUntypedArgument){const e=xe(s),i=xe(o);if(e.kind!==i.kind||"string"!==e.kind&&"number"!==e.kind)throw new we(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${i.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const t=xe(s),i=xe(o);if("string"!==t.kind||"string"!==i.kind)return e(r,s,o)}return this.collator?i(r,s,o,this.collator.evaluate(r)):e(r,s,o)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}}}const yi=_i("==",(function(t,e,i){return e===i}),gi),xi=_i("!=",(function(t,e,i){return e!==i}),(function(t,e,i,n){return!gi(0,e,i,n)})),vi=_i("<",(function(t,e,i){return e<i}),(function(t,e,i,n){return n.compare(e,i)<0})),bi=_i(">",(function(t,e,i){return e>i}),(function(t,e,i,n){return n.compare(e,i)>0})),wi=_i("<=",(function(t,e,i){return e<=i}),(function(t,e,i,n){return n.compare(e,i)<=0})),ki=_i(">=",(function(t,e,i){return e>=i}),(function(t,e,i,n){return n.compare(e,i)>=0}));class Si{constructor(t,e,i,n,r){this.type=Mt,this.number=t,this.locale=e,this.currency=i,this.minFractionDigits=n,this.maxFractionDigits=r}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const i=e.parse(t[1],1,At);if(!i)return null;const n=t[2];if("object"!=typeof n||Array.isArray(n))return e.error("NumberFormat options argument must be an object.");let r=null;if(n.locale&&(r=e.parse(n.locale,1,Mt),!r))return null;let s=null;if(n.currency&&(s=e.parse(n.currency,1,Mt),!s))return null;let o=null;if(n["min-fraction-digits"]&&(o=e.parse(n["min-fraction-digits"],1,At),!o))return null;let a=null;return n["max-fraction-digits"]&&(a=e.parse(n["max-fraction-digits"],1,At),!a)?null:new Si(i,r,s,o,a)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Ti{constructor(t){this.type=Pt,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[1];if(!Array.isArray(i)&&"object"==typeof i)return e.error("First argument must be an image or text section.");const n=[];let r=!1;for(let i=1;i<=t.length-1;++i){const s=t[i];if(r&&"object"==typeof s&&!Array.isArray(s)){r=!1;let t=null;if(s["font-scale"]&&(t=e.parse(s["font-scale"],1,At),!t))return null;let i=null;if(s["text-font"]&&(i=e.parse(s["text-font"],1,Ot(Mt)),!i))return null;let o=null;if(s["text-color"]&&(o=e.parse(s["text-color"],1,Et),!o))return null;const a=n[n.length-1];a.scale=t,a.font=i,a.textColor=o}else{const s=e.parse(t[i],1,Dt);if(!s)return null;const o=s.type.kind;if("string"!==o&&"value"!==o&&"null"!==o&&"resolvedImage"!==o)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,n.push({content:s,scale:null,font:null,textColor:null})}}return new Ti(n)}evaluate(t){return new de(this.sections.map((e=>{const i=e.content.evaluate(t);return xe(i)===Ft?new he("",i,null,null,null):new he(ve(i),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}}class Ai{constructor(t){this.type=Ft,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const i=e.parse(t[1],1,Mt);return i?new Ai(i):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),i=ge.fromString(e);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(e)>-1),i}eachChild(t){t(this.input)}outputDefined(){return!1}}class Mi{constructor(t){this.type=At,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const i=e.parse(t[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?e.error(`Expected argument of type string or array, but found ${Bt(i.type)} instead.`):new Mi(i):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new we(`Expected value to be of type string or array, but found ${Bt(xe(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Ci={"==":yi,"!=":xi,">":bi,"<":vi,">=":ki,"<=":wi,array:Se,at:ci,boolean:Se,case:pi,coalesce:ai,collator:Ie,format:Ti,image:Ai,in:ui,"index-of":hi,interpolate:si,"interpolate-hcl":si,"interpolate-lab":si,length:Mi,let:li,literal:be,match:di,number:Se,"number-format":Si,object:Se,slice:fi,step:ei,string:Se,"to-boolean":Ae,"to-color":Ae,"to-number":Ae,"to-string":Ae,var:He,within:Ge};function Ei(t,[e,i,n,r]){e=e.evaluate(t),i=i.evaluate(t),n=n.evaluate(t);const s=r?r.evaluate(t):1,o=_e(e,i,n,s);if(o)throw new we(o);return new ce(e/255,i/255,n/255,s,!1)}function Ii(t,e){return t in e}function Di(t,e){const i=e[t];return void 0===i?null:i}function zi(t){return{type:t}}function Pi(t){return{result:"success",value:t}}function Li(t){return{result:"error",value:t}}function Fi(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Ri(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Oi(t){return!!t.expression&&t.expression.interpolated}function Bi(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Vi(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Ni(t){return t}function qi(t,e){const i="color"===e.type,n=t.stops&&"object"==typeof t.stops[0][0],r=n||!(n||void 0!==t.property),s=t.type||(Oi(e)?"exponential":"interval");if(i||"padding"===e.type){const n=i?ce.parse:pe.parse;(t=wt({},t)).stops&&(t.stops=t.stops.map((t=>[t[0],n(t[1])]))),t.default=n(t.default?t.default:e.default)}if(t.colorSpace&&"rgb"!==(o=t.colorSpace)&&"hcl"!==o&&"lab"!==o)throw new Error(`Unknown color space: "${t.colorSpace}"`);var o;let a,l,c;if("exponential"===s)a=Zi;else if("interval"===s)a=Ui;else if("categorical"===s){a=$i,l=Object.create(null);for(const e of t.stops)l[e[0]]=e[1];c=typeof t.stops[0][0]}else{if("identity"!==s)throw new Error(`Unknown function type "${s}"`);a=Wi}if(n){const i={},n=[];for(let e=0;e<t.stops.length;e++){const r=t.stops[e],s=r[0].zoom;void 0===i[s]&&(i[s]={zoom:s,type:t.type,property:t.property,default:t.default,stops:[]},n.push(s)),i[s].stops.push([r[0].value,r[1]])}const r=[];for(const t of n)r.push([i[t].zoom,qi(i[t],e)]);const s={name:"linear"};return{kind:"composite",interpolationType:s,interpolationFactor:si.interpolationFactor.bind(void 0,s),zoomStops:r.map((t=>t[0])),evaluate:({zoom:i},n)=>Zi({stops:r,base:t.base},e,i).evaluate(i,n)}}if(r){const i="exponential"===s?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:i,interpolationFactor:si.interpolationFactor.bind(void 0,i),zoomStops:t.stops.map((t=>t[0])),evaluate:({zoom:i})=>a(t,e,i,l,c)}}return{kind:"source",evaluate(i,n){const r=n&&n.properties?n.properties[t.property]:void 0;return void 0===r?ji(t.default,e.default):a(t,e,r,l,c)}}}function ji(t,e,i){return void 0!==t?t:void 0!==e?e:void 0!==i?i:void 0}function $i(t,e,i,n,r){return ji(typeof i===r?n[i]:void 0,t.default,e.default)}function Ui(t,e,i){if("number"!==Bi(i))return ji(t.default,e.default);const n=t.stops.length;if(1===n)return t.stops[0][1];if(i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[n-1][0])return t.stops[n-1][1];const r=ti(t.stops.map((t=>t[0])),i);return t.stops[r][1]}function Zi(t,e,i){const n=void 0!==t.base?t.base:1;if("number"!==Bi(i))return ji(t.default,e.default);const r=t.stops.length;if(1===r)return t.stops[0][1];if(i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[r-1][0])return t.stops[r-1][1];const s=ti(t.stops.map((t=>t[0])),i),o=function(t,e,i,n){const r=n-i,s=t-i;return 0===r?0:1===e?s/r:(Math.pow(e,s)-1)/(Math.pow(e,r)-1)}(i,n,t.stops[s][0],t.stops[s+1][0]),a=t.stops[s][1],l=t.stops[s+1][1],c=ri[e.type]||Ni;return"function"==typeof a.evaluate?{evaluate(...e){const i=a.evaluate.apply(void 0,e),n=l.evaluate.apply(void 0,e);if(void 0!==i&&void 0!==n)return c(i,n,o,t.colorSpace)}}:c(a,l,o,t.colorSpace)}function Wi(t,e,i){switch(e.type){case"color":i=ce.parse(i);break;case"formatted":i=de.fromString(i.toString());break;case"resolvedImage":i=ge.fromString(i.toString());break;case"padding":i=pe.parse(i);break;default:Bi(i)===e.type||"enum"===e.type&&e.values[i]||(i=void 0)}return ji(i,t.default,e.default)}Xe.register(Ci,{error:[{kind:"error"},[Mt],(t,[e])=>{throw new we(e.evaluate(t))}],typeof:[Mt,[Dt],(t,[e])=>Bt(xe(e.evaluate(t)))],"to-rgba":[Ot(At,4),[Et],(t,[e])=>{const[i,n,r,s]=e.evaluate(t).rgb;return[255*i,255*n,255*r,s]}],rgb:[Et,[At,At,At],Ei],rgba:[Et,[At,At,At,At],Ei],has:{type:Ct,overloads:[[[Mt],(t,[e])=>Ii(e.evaluate(t),t.properties())],[[Mt,It],(t,[e,i])=>Ii(e.evaluate(t),i.evaluate(t))]]},get:{type:Dt,overloads:[[[Mt],(t,[e])=>Di(e.evaluate(t),t.properties())],[[Mt,It],(t,[e,i])=>Di(e.evaluate(t),i.evaluate(t))]]},"feature-state":[Dt,[Mt],(t,[e])=>Di(e.evaluate(t),t.featureState||{})],properties:[It,[],t=>t.properties()],"geometry-type":[Mt,[],t=>t.geometryType()],id:[Dt,[],t=>t.id()],zoom:[At,[],t=>t.globals.zoom],"heatmap-density":[At,[],t=>t.globals.heatmapDensity||0],"line-progress":[At,[],t=>t.globals.lineProgress||0],accumulated:[Dt,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[At,zi(At),(t,e)=>{let i=0;for(const n of e)i+=n.evaluate(t);return i}],"*":[At,zi(At),(t,e)=>{let i=1;for(const n of e)i*=n.evaluate(t);return i}],"-":{type:At,overloads:[[[At,At],(t,[e,i])=>e.evaluate(t)-i.evaluate(t)],[[At],(t,[e])=>-e.evaluate(t)]]},"/":[At,[At,At],(t,[e,i])=>e.evaluate(t)/i.evaluate(t)],"%":[At,[At,At],(t,[e,i])=>e.evaluate(t)%i.evaluate(t)],ln2:[At,[],()=>Math.LN2],pi:[At,[],()=>Math.PI],e:[At,[],()=>Math.E],"^":[At,[At,At],(t,[e,i])=>Math.pow(e.evaluate(t),i.evaluate(t))],sqrt:[At,[At],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[At,[At],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[At,[At],(t,[e])=>Math.log(e.evaluate(t))],log2:[At,[At],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[At,[At],(t,[e])=>Math.sin(e.evaluate(t))],cos:[At,[At],(t,[e])=>Math.cos(e.evaluate(t))],tan:[At,[At],(t,[e])=>Math.tan(e.evaluate(t))],asin:[At,[At],(t,[e])=>Math.asin(e.evaluate(t))],acos:[At,[At],(t,[e])=>Math.acos(e.evaluate(t))],atan:[At,[At],(t,[e])=>Math.atan(e.evaluate(t))],min:[At,zi(At),(t,e)=>Math.min(...e.map((e=>e.evaluate(t))))],max:[At,zi(At),(t,e)=>Math.max(...e.map((e=>e.evaluate(t))))],abs:[At,[At],(t,[e])=>Math.abs(e.evaluate(t))],round:[At,[At],(t,[e])=>{const i=e.evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[At,[At],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[At,[At],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Ct,[Mt,Dt],(t,[e,i])=>t.properties()[e.value]===i.value],"filter-id-==":[Ct,[Dt],(t,[e])=>t.id()===e.value],"filter-type-==":[Ct,[Mt],(t,[e])=>t.geometryType()===e.value],"filter-<":[Ct,[Mt,Dt],(t,[e,i])=>{const n=t.properties()[e.value],r=i.value;return typeof n==typeof r&&n<r}],"filter-id-<":[Ct,[Dt],(t,[e])=>{const i=t.id(),n=e.value;return typeof i==typeof n&&i<n}],"filter->":[Ct,[Mt,Dt],(t,[e,i])=>{const n=t.properties()[e.value],r=i.value;return typeof n==typeof r&&n>r}],"filter-id->":[Ct,[Dt],(t,[e])=>{const i=t.id(),n=e.value;return typeof i==typeof n&&i>n}],"filter-<=":[Ct,[Mt,Dt],(t,[e,i])=>{const n=t.properties()[e.value],r=i.value;return typeof n==typeof r&&n<=r}],"filter-id-<=":[Ct,[Dt],(t,[e])=>{const i=t.id(),n=e.value;return typeof i==typeof n&&i<=n}],"filter->=":[Ct,[Mt,Dt],(t,[e,i])=>{const n=t.properties()[e.value],r=i.value;return typeof n==typeof r&&n>=r}],"filter-id->=":[Ct,[Dt],(t,[e])=>{const i=t.id(),n=e.value;return typeof i==typeof n&&i>=n}],"filter-has":[Ct,[Dt],(t,[e])=>e.value in t.properties()],"filter-has-id":[Ct,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[Ct,[Ot(Mt)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Ct,[Ot(Dt)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Ct,[Mt,Ot(Dt)],(t,[e,i])=>i.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Ct,[Mt,Ot(Dt)],(t,[e,i])=>function(t,e,i,n){for(;i<=n;){const r=i+n>>1;if(e[r]===t)return!0;e[r]>t?n=r-1:i=r+1}return!1}(t.properties()[e.value],i.value,0,i.value.length-1)],all:{type:Ct,overloads:[[[Ct,Ct],(t,[e,i])=>e.evaluate(t)&&i.evaluate(t)],[zi(Ct),(t,e)=>{for(const i of e)if(!i.evaluate(t))return!1;return!0}]]},any:{type:Ct,overloads:[[[Ct,Ct],(t,[e,i])=>e.evaluate(t)||i.evaluate(t)],[zi(Ct),(t,e)=>{for(const i of e)if(i.evaluate(t))return!0;return!1}]]},"!":[Ct,[Ct],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Ct,[Mt],(t,[e])=>{const i=t.globals&&t.globals.isSupportedScript;return!i||i(e.evaluate(t))}],upcase:[Mt,[Mt],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Mt,[Mt],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Mt,zi(Dt),(t,e)=>e.map((e=>ve(e.evaluate(t)))).join("")],"resolved-locale":[Mt,[zt],(t,[e])=>e.evaluate(t).resolvedLocale()]});class Gi{constructor(t,e){var i;this.expression=t,this._warningHistory={},this._evaluator=new Ce,this._defaultValue=e?"color"===(i=e).type&&Vi(i.default)?new ce(0,0,0,0):"color"===i.type?ce.parse(i.default)||null:"padding"===i.type?pe.parse(i.default)||null:"variableAnchorOffsetCollection"===i.type?me.parse(i.default)||null:void 0===i.default?null:i.default:null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,i,n,r,s){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=i,this._evaluator.canonical=n,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=s,this.expression.evaluate(this._evaluator)}evaluate(t,e,i,n,r,s){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=i||null,this._evaluator.canonical=n,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=s||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new we(`Expected value to be one of ${Object.keys(this._enumValues).map((t=>JSON.stringify(t))).join(", ")}, but found ${JSON.stringify(t)} instead.`);return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}function Hi(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Ci}function Xi(t,e){const i=new Ee(Ci,Ye,[],e?function(t){const e={color:Et,string:Mt,number:At,enum:Mt,boolean:Ct,formatted:Pt,padding:Lt,resolvedImage:Ft,variableAnchorOffsetCollection:Rt};return"array"===t.type?Ot(e[t.value]||Dt,t.length):e[t.type]}(e):void 0),n=i.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return n?Pi(new Gi(n,e)):Li(i.errors)}class Yi{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Je(e.expression)}evaluateWithoutErrorHandling(t,e,i,n,r,s){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,n,r,s)}evaluate(t,e,i,n,r,s){return this._styleExpression.evaluate(t,e,i,n,r,s)}}class Ki{constructor(t,e,i,n){this.kind=t,this.zoomStops=i,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Je(e.expression),this.interpolationType=n}evaluateWithoutErrorHandling(t,e,i,n,r,s){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,n,r,s)}evaluate(t,e,i,n,r,s){return this._styleExpression.evaluate(t,e,i,n,r,s)}interpolationFactor(t,e,i){return this.interpolationType?si.interpolationFactor(this.interpolationType,t,e,i):0}}function Ji(t,e){const i=Xi(t,e);if("error"===i.result)return i;const n=i.value.expression,r=Ke(n);if(!r&&!Fi(e))return Li([new kt("","data expressions not supported")]);const s=Qe(n,["zoom"]);if(!s&&!Ri(e))return Li([new kt("","zoom expressions not supported")]);const o=tn(n);return o||s?o instanceof kt?Li([o]):o instanceof si&&!Oi(e)?Li([new kt("",'"interpolate" expressions cannot be used with this property')]):Pi(o?new Ki(r?"camera":"composite",i.value,o.labels,o instanceof si?o.interpolation:void 0):new Yi(r?"constant":"source",i.value)):Li([new kt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Qi{constructor(t,e){this._parameters=t,this._specification=e,wt(this,qi(this._parameters,this._specification))}static deserialize(t){return new Qi(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function tn(t){let e=null;if(t instanceof li)e=tn(t.result);else if(t instanceof ai){for(const i of t.args)if(e=tn(i),e)break}else(t instanceof ei||t instanceof si)&&t.input instanceof Xe&&"zoom"===t.input.name&&(e=t);return e instanceof kt||t.eachChild((t=>{const i=tn(t);i instanceof kt?e=i:!e&&i?e=new kt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&i&&e!==i&&(e=new kt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function en(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!en(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}const nn={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function rn(t){if(null==t)return{filter:()=>!0,needGeometry:!1};en(t)||(t=an(t));const e=Xi(t,nn);if("error"===e.result)throw new Error(e.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return{filter:(t,i,n)=>e.value.evaluate(t,i,{},n),needGeometry:on(t)}}function sn(t,e){return t<e?-1:t>e?1:0}function on(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(on(t[e]))return!0;return!1}function an(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?ln(t[1],t[2],"=="):"!="===e?hn(ln(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?ln(t[1],t[2],e):"any"===e?(i=t.slice(1),["any"].concat(i.map(an))):"all"===e?["all"].concat(t.slice(1).map(an)):"none"===e?["all"].concat(t.slice(1).map(an).map(hn)):"in"===e?cn(t[1],t.slice(2)):"!in"===e?hn(cn(t[1],t.slice(2))):"has"===e?un(t[1]):"!has"===e?hn(un(t[1])):"within"!==e||t;var i}function ln(t,e,i){switch(t){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,t,e]}}function cn(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((t=>typeof t!=typeof e[0]))?["filter-in-large",t,["literal",e.sort(sn)]]:["filter-in-small",t,["literal",e]]}}function un(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function hn(t){return["!",t]}function dn(t){const e=t.value;return e?[new bt(t.key,e,"constants have been deprecated as of v8")]:[]}function pn(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function fn(t){if(Array.isArray(t))return t.map(fn);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const i in t)e[i]=fn(t[i]);return e}return pn(t)}function mn(t){const e=t.key,i=t.value,n=t.valueSpec||{},r=t.objectElementValidators||{},s=t.style,o=t.styleSpec,a=t.validateSpec;let l=[];const c=Bi(i);if("object"!==c)return[new bt(e,i,`object expected, ${c} found`)];for(const t in i){const c=t.split(".")[0],u=n[c]||n["*"];let h;if(r[c])h=r[c];else if(n[c])h=a;else if(r["*"])h=r["*"];else{if(!n["*"]){l.push(new bt(e,i[t],`unknown property "${t}"`));continue}h=a}l=l.concat(h({key:(e?`${e}.`:e)+t,value:i[t],valueSpec:u,style:s,styleSpec:o,object:i,objectKey:t,validateSpec:a},i))}for(const t in n)r[t]||n[t].required&&void 0===n[t].default&&void 0===i[t]&&l.push(new bt(e,i,`missing required property "${t}"`));return l}function gn(t){const e=t.value,i=t.valueSpec,n=t.style,r=t.styleSpec,s=t.key,o=t.arrayElementValidator||t.validateSpec;if("array"!==Bi(e))return[new bt(s,e,`array expected, ${Bi(e)} found`)];if(i.length&&e.length!==i.length)return[new bt(s,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new bt(s,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let a={type:i.value,values:i.values};r.$version<7&&(a.function=i.function),"object"===Bi(i.value)&&(a=i.value);let l=[];for(let i=0;i<e.length;i++)l=l.concat(o({array:e,arrayIndex:i,value:e[i],valueSpec:a,validateSpec:t.validateSpec,style:n,styleSpec:r,key:`${s}[${i}]`}));return l}function _n(t){const e=t.key,i=t.value,n=t.valueSpec;let r=Bi(i);return"number"===r&&i!=i&&(r="NaN"),"number"!==r?[new bt(e,i,`number expected, ${r} found`)]:"minimum"in n&&i<n.minimum?[new bt(e,i,`${i} is less than the minimum value ${n.minimum}`)]:"maximum"in n&&i>n.maximum?[new bt(e,i,`${i} is greater than the maximum value ${n.maximum}`)]:[]}function yn(t){const e=t.valueSpec,i=pn(t.value.type);let n,r,s,o={};const a="categorical"!==i&&void 0===t.value.property,l=!a,c="array"===Bi(t.value.stops)&&"array"===Bi(t.value.stops[0])&&"object"===Bi(t.value.stops[0][0]),u=mn({key:t.key,value:t.value,valueSpec:t.styleSpec.function,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===i)return[new bt(t.key,t.value,'identity function may not have a "stops" property')];let e=[];const n=t.value;return e=e.concat(gn({key:t.key,value:n,valueSpec:t.valueSpec,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===Bi(n)&&0===n.length&&e.push(new bt(t.key,n,"array must have at least one stop")),e},default:function(t){return t.validateSpec({key:t.key,value:t.value,valueSpec:e,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===i&&a&&u.push(new bt(t.key,t.value,'missing required property "property"')),"identity"===i||t.value.stops||u.push(new bt(t.key,t.value,'missing required property "stops"')),"exponential"===i&&t.valueSpec.expression&&!Oi(t.valueSpec)&&u.push(new bt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!Fi(t.valueSpec)?u.push(new bt(t.key,t.value,"property functions not supported")):a&&!Ri(t.valueSpec)&&u.push(new bt(t.key,t.value,"zoom functions not supported"))),"categorical"!==i&&!c||void 0!==t.value.property||u.push(new bt(t.key,t.value,'"property" property is required')),u;function h(t){let i=[];const n=t.value,a=t.key;if("array"!==Bi(n))return[new bt(a,n,`array expected, ${Bi(n)} found`)];if(2!==n.length)return[new bt(a,n,`array length 2 expected, length ${n.length} found`)];if(c){if("object"!==Bi(n[0]))return[new bt(a,n,`object expected, ${Bi(n[0])} found`)];if(void 0===n[0].zoom)return[new bt(a,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new bt(a,n,"object stop key must have value")];if(s&&s>pn(n[0].zoom))return[new bt(a,n[0].zoom,"stop zoom values must appear in ascending order")];pn(n[0].zoom)!==s&&(s=pn(n[0].zoom),r=void 0,o={}),i=i.concat(mn({key:`${a}[0]`,value:n[0],valueSpec:{zoom:{}},validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:_n,value:d}}))}else i=i.concat(d({key:`${a}[0]`,value:n[0],valueSpec:{},validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec},n));return Hi(fn(n[1]))?i.concat([new bt(`${a}[1]`,n[1],"expressions are not allowed in function stops.")]):i.concat(t.validateSpec({key:`${a}[1]`,value:n[1],valueSpec:e,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec}))}function d(t,s){const a=Bi(t.value),l=pn(t.value),c=null!==t.value?t.value:s;if(n){if(a!==n)return[new bt(t.key,c,`${a} stop domain type must match previous stop domain type ${n}`)]}else n=a;if("number"!==a&&"string"!==a&&"boolean"!==a)return[new bt(t.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==a&&"categorical"!==i){let n=`number expected, ${a} found`;return Fi(e)&&void 0===i&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new bt(t.key,c,n)]}return"categorical"!==i||"number"!==a||isFinite(l)&&Math.floor(l)===l?"categorical"!==i&&"number"===a&&void 0!==r&&l<r?[new bt(t.key,c,"stop domain values must appear in ascending order")]:(r=l,"categorical"===i&&l in o?[new bt(t.key,c,"stop domain values must be unique")]:(o[l]=!0,[])):[new bt(t.key,c,`integer expected, found ${l}`)]}}function xn(t){const e=("property"===t.expressionContext?Ji:Xi)(fn(t.value),t.valueSpec);if("error"===e.result)return e.value.map((e=>new bt(`${t.key}${e.key}`,t.value,e.message)));const i=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!i.outputDefined())return[new bt(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Je(i))return[new bt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Je(i))return[new bt(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Qe(i,["zoom","feature-state"]))return[new bt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Ke(i))return[new bt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function vn(t){const e=t.key,i=t.value,n=t.valueSpec,r=[];return Array.isArray(n.values)?-1===n.values.indexOf(pn(i))&&r.push(new bt(e,i,`expected one of [${n.values.join(", ")}], ${JSON.stringify(i)} found`)):-1===Object.keys(n.values).indexOf(pn(i))&&r.push(new bt(e,i,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(i)} found`)),r}function bn(t){return en(fn(t.value))?xn(wt({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):wn(t)}function wn(t){const e=t.value,i=t.key;if("array"!==Bi(e))return[new bt(i,e,`array expected, ${Bi(e)} found`)];const n=t.styleSpec;let r,s=[];if(e.length<1)return[new bt(i,e,"filter array must have at least 1 element")];switch(s=s.concat(vn({key:`${i}[0]`,value:e[0],valueSpec:n.filter_operator,style:t.style,styleSpec:t.styleSpec})),pn(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===pn(e[1])&&s.push(new bt(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&s.push(new bt(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(r=Bi(e[1]),"string"!==r&&s.push(new bt(`${i}[1]`,e[1],`string expected, ${r} found`)));for(let o=2;o<e.length;o++)r=Bi(e[o]),"$type"===pn(e[1])?s=s.concat(vn({key:`${i}[${o}]`,value:e[o],valueSpec:n.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&s.push(new bt(`${i}[${o}]`,e[o],`string, number, or boolean expected, ${r} found`));break;case"any":case"all":case"none":for(let n=1;n<e.length;n++)s=s.concat(wn({key:`${i}[${n}]`,value:e[n],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":r=Bi(e[1]),2!==e.length?s.push(new bt(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==r&&s.push(new bt(`${i}[1]`,e[1],`string expected, ${r} found`));break;case"within":r=Bi(e[1]),2!==e.length?s.push(new bt(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==r&&s.push(new bt(`${i}[1]`,e[1],`object expected, ${r} found`))}return s}function kn(t,e){const i=t.key,n=t.validateSpec,r=t.style,s=t.styleSpec,o=t.value,a=t.objectKey,l=s[`${e}_${t.layerType}`];if(!l)return[];const c=a.match(/^(.*)-transition$/);if("paint"===e&&c&&l[c[1]]&&l[c[1]].transition)return n({key:i,value:o,valueSpec:s.transition,style:r,styleSpec:s});const u=t.valueSpec||l[a];if(!u)return[new bt(i,o,`unknown property "${a}"`)];let h;if("string"===Bi(o)&&Fi(u)&&!u.tokens&&(h=/^{([^}]+)}$/.exec(o)))return[new bt(i,o,`"${a}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(h[1])} }\`.`)];const d=[];return"symbol"===t.layerType&&("text-field"===a&&r&&!r.glyphs&&d.push(new bt(i,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&Vi(fn(o))&&"identity"===pn(o.type)&&d.push(new bt(i,o,'"text-font" does not support identity functions'))),d.concat(n({key:t.key,value:o,valueSpec:u,style:r,styleSpec:s,expressionContext:"property",propertyType:e,propertyKey:a}))}function Sn(t){return kn(t,"paint")}function Tn(t){return kn(t,"layout")}function An(t){let e=[];const i=t.value,n=t.key,r=t.style,s=t.styleSpec;i.type||i.ref||e.push(new bt(n,i,'either "type" or "ref" is required'));let o=pn(i.type);const a=pn(i.ref);if(i.id){const s=pn(i.id);for(let o=0;o<t.arrayIndex;o++){const t=r.layers[o];pn(t.id)===s&&e.push(new bt(n,i.id,`duplicate layer id "${i.id}", previously used at line ${t.id.__line__}`))}}if("ref"in i){let t;["type","source","source-layer","filter","layout"].forEach((t=>{t in i&&e.push(new bt(n,i[t],`"${t}" is prohibited for ref layers`))})),r.layers.forEach((e=>{pn(e.id)===a&&(t=e)})),t?t.ref?e.push(new bt(n,i.ref,"ref cannot reference another ref layer")):o=pn(t.type):e.push(new bt(n,i.ref,`ref layer "${a}" not found`))}else if("background"!==o)if(i.source){const t=r.sources&&r.sources[i.source],s=t&&pn(t.type);t?"vector"===s&&"raster"===o?e.push(new bt(n,i.source,`layer "${i.id}" requires a raster source`)):"raster-dem"!==s&&"hillshade"===o?e.push(new bt(n,i.source,`layer "${i.id}" requires a raster-dem source`)):"raster"===s&&"raster"!==o?e.push(new bt(n,i.source,`layer "${i.id}" requires a vector source`)):"vector"!==s||i["source-layer"]?"raster-dem"===s&&"hillshade"!==o?e.push(new bt(n,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==o||!i.paint||!i.paint["line-gradient"]||"geojson"===s&&t.lineMetrics||e.push(new bt(n,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new bt(n,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new bt(n,i.source,`source "${i.source}" not found`))}else e.push(new bt(n,i,'missing required property "source"'));return e=e.concat(mn({key:n,value:i,valueSpec:s.layer,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":()=>[],type:()=>t.validateSpec({key:`${n}.type`,value:i.type,valueSpec:s.layer.type,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,object:i,objectKey:"type"}),filter:bn,layout:t=>mn({layer:i,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":t=>Tn(wt({layerType:o},t))}}),paint:t=>mn({layer:i,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":t=>Sn(wt({layerType:o},t))}})}})),e}function Mn(t){const e=t.value,i=t.key,n=Bi(e);return"string"!==n?[new bt(i,e,`string expected, ${n} found`)]:[]}const Cn={promoteId:function({key:t,value:e}){if("string"===Bi(e))return Mn({key:t,value:e});{const i=[];for(const n in e)i.push(...Mn({key:`${t}.${n}`,value:e[n]}));return i}}};function En(t){const e=t.value,i=t.key,n=t.styleSpec,r=t.style,s=t.validateSpec;if(!e.type)return[new bt(i,e,'"type" is required')];const o=pn(e.type);let a;switch(o){case"vector":case"raster":return a=mn({key:i,value:e,valueSpec:n[`source_${o.replace("-","_")}`],style:t.style,styleSpec:n,objectElementValidators:Cn,validateSpec:s}),a;case"raster-dem":return a=function(t){var e;const i=null!==(e=t.sourceName)&&void 0!==e?e:"",n=t.value,r=t.styleSpec,s=r.source_raster_dem,o=t.style;let a=[];const l=Bi(n);if(void 0===n)return a;if("object"!==l)return a.push(new bt("source_raster_dem",n,`object expected, ${l} found`)),a;const c="custom"===pn(n.encoding),u=["redFactor","greenFactor","blueFactor","baseShift"],h=t.value.encoding?`"${t.value.encoding}"`:"Default";for(const e in n)!c&&u.includes(e)?a.push(new bt(e,n[e],`In "${i}": "${e}" is only valid when "encoding" is set to "custom". ${h} encoding found`)):s[e]?a=a.concat(t.validateSpec({key:e,value:n[e],valueSpec:s[e],validateSpec:t.validateSpec,style:o,styleSpec:r})):a.push(new bt(e,n[e],`unknown property "${e}"`));return a}({sourceName:i,value:e,style:t.style,styleSpec:n,validateSpec:s}),a;case"geojson":if(a=mn({key:i,value:e,valueSpec:n.source_geojson,style:r,styleSpec:n,validateSpec:s,objectElementValidators:Cn}),e.cluster)for(const t in e.clusterProperties){const[n,r]=e.clusterProperties[t],o="string"==typeof n?[n,["accumulated"],["get",t]]:n;a.push(...xn({key:`${i}.${t}.map`,value:r,validateSpec:s,expressionContext:"cluster-map"})),a.push(...xn({key:`${i}.${t}.reduce`,value:o,validateSpec:s,expressionContext:"cluster-reduce"}))}return a;case"video":return mn({key:i,value:e,valueSpec:n.source_video,style:r,validateSpec:s,styleSpec:n});case"image":return mn({key:i,value:e,valueSpec:n.source_image,style:r,validateSpec:s,styleSpec:n});case"canvas":return[new bt(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vn({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:r,validateSpec:s,styleSpec:n})}}function In(t){const e=t.value,i=t.styleSpec,n=i.light,r=t.style;let s=[];const o=Bi(e);if(void 0===e)return s;if("object"!==o)return s=s.concat([new bt("light",e,`object expected, ${o} found`)]),s;for(const o in e){const a=o.match(/^(.*)-transition$/);s=s.concat(a&&n[a[1]]&&n[a[1]].transition?t.validateSpec({key:o,value:e[o],valueSpec:i.transition,validateSpec:t.validateSpec,style:r,styleSpec:i}):n[o]?t.validateSpec({key:o,value:e[o],valueSpec:n[o],validateSpec:t.validateSpec,style:r,styleSpec:i}):[new bt(o,e[o],`unknown property "${o}"`)])}return s}function Dn(t){const e=t.value,i=t.styleSpec,n=i.terrain,r=t.style;let s=[];const o=Bi(e);if(void 0===e)return s;if("object"!==o)return s=s.concat([new bt("terrain",e,`object expected, ${o} found`)]),s;for(const o in e)s=s.concat(n[o]?t.validateSpec({key:o,value:e[o],valueSpec:n[o],validateSpec:t.validateSpec,style:r,styleSpec:i}):[new bt(o,e[o],`unknown property "${o}"`)]);return s}function zn(t){let e=[];const i=t.value,n=t.key;if(Array.isArray(i)){const r=[],s=[];for(const o in i)i[o].id&&r.includes(i[o].id)&&e.push(new bt(n,i,`all the sprites' ids must be unique, but ${i[o].id} is duplicated`)),r.push(i[o].id),i[o].url&&s.includes(i[o].url)&&e.push(new bt(n,i,`all the sprites' URLs must be unique, but ${i[o].url} is duplicated`)),s.push(i[o].url),e=e.concat(mn({key:`${n}[${o}]`,value:i[o],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:t.validateSpec}));return e}return Mn({key:n,value:i})}const Pn={"*":()=>[],array:gn,boolean:function(t){const e=t.value,i=t.key,n=Bi(e);return"boolean"!==n?[new bt(i,e,`boolean expected, ${n} found`)]:[]},number:_n,color:function(t){const e=t.key,i=t.value,n=Bi(i);return"string"!==n?[new bt(e,i,`color expected, ${n} found`)]:ce.parse(String(i))?[]:[new bt(e,i,`color expected, "${i}" found`)]},constants:dn,enum:vn,filter:bn,function:yn,layer:An,object:mn,source:En,light:In,terrain:Dn,string:Mn,formatted:function(t){return 0===Mn(t).length?[]:xn(t)},resolvedImage:function(t){return 0===Mn(t).length?[]:xn(t)},padding:function(t){const e=t.key,i=t.value;if("array"===Bi(i)){if(i.length<1||i.length>4)return[new bt(e,i,`padding requires 1 to 4 values; ${i.length} values found`)];const n={type:"number"};let r=[];for(let s=0;s<i.length;s++)r=r.concat(t.validateSpec({key:`${e}[${s}]`,value:i[s],validateSpec:t.validateSpec,valueSpec:n}));return r}return _n({key:e,value:i,valueSpec:{}})},variableAnchorOffsetCollection:function(t){const e=t.key,i=t.value,n=Bi(i),r=t.styleSpec;if("array"!==n||i.length<1||i.length%2!=0)return[new bt(e,i,"variableAnchorOffsetCollection requires a non-empty array of even length")];let s=[];for(let n=0;n<i.length;n+=2)s=s.concat(vn({key:`${e}[${n}]`,value:i[n],valueSpec:r.layout_symbol["text-anchor"]})),s=s.concat(gn({key:`${e}[${n+1}]`,value:i[n+1],valueSpec:{length:2,value:"number"},validateSpec:t.validateSpec,style:t.style,styleSpec:r}));return s},sprite:zn};function Ln(t){const e=t.value,i=t.valueSpec,n=t.styleSpec;return t.validateSpec=Ln,i.expression&&Vi(pn(e))?yn(t):i.expression&&Hi(fn(e))?xn(t):i.type&&Pn[i.type]?Pn[i.type](t):mn(wt({},t,{valueSpec:i.type?n[i.type]:i}))}function Fn(t){const e=t.value,i=t.key,n=Mn(t);return n.length||(-1===e.indexOf("{fontstack}")&&n.push(new bt(i,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&n.push(new bt(i,e,'"glyphs" url must include a "{range}" token'))),n}function Rn(t,e=lt){let i=[];return i=i.concat(Ln({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,validateSpec:Ln,objectElementValidators:{glyphs:Fn,"*":()=>[]}})),t.constants&&(i=i.concat(dn({key:"constants",value:t.constants,style:t,styleSpec:e,validateSpec:Ln}))),Bn(i)}function On(t){return function(e){return t({...e,validateSpec:Ln})}}function Bn(t){return[].concat(t).sort(((t,e)=>t.line-e.line))}function Vn(t){return function(...e){return Bn(t.apply(this,e))}}Rn.source=Vn(On(En)),Rn.sprite=Vn(On(zn)),Rn.glyphs=Vn(On(Fn)),Rn.light=Vn(On(In)),Rn.terrain=Vn(On(Dn)),Rn.layer=Vn(On(An)),Rn.filter=Vn(On(bn)),Rn.paintProperty=Vn(On(Sn)),Rn.layoutProperty=Vn(On(Tn));const Nn=Rn,qn=Nn.light,jn=Nn.paintProperty,$n=Nn.layoutProperty;function Un(t,e){let i=!1;if(e&&e.length)for(const n of e)t.fire(new ot(new Error(n.message))),i=!0;return i}class Zn{constructor(t,e,i){const n=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const r=new Int32Array(this.arrayBuffer);t=r[0],this.d=(e=r[1])+2*(i=r[2]);for(let t=0;t<this.d*this.d;t++){const e=r[3+t],i=r[3+t+1];n.push(e===i?null:r.subarray(e,i))}const s=r[3+n.length+1];this.keys=r.subarray(r[3+n.length],s),this.bboxes=r.subarray(s),this.insert=this._insertReadonly}else{this.d=e+2*i;for(let t=0;t<this.d*this.d;t++)n.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;const r=i/e*t;this.min=-r,this.max=t+r}insert(t,e,i,n,r){this._forEachCell(e,i,n,r,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(r)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,e,i,n,r,s){this.cells[r].push(s)}query(t,e,i,n,r){const s=this.min,o=this.max;if(t<=s&&e<=s&&o<=i&&o<=n&&!r)return Array.prototype.slice.call(this.keys);{const s=[];return this._forEachCell(t,e,i,n,this._queryCell,s,{},r),s}}_queryCell(t,e,i,n,r,s,o,a){const l=this.cells[r];if(null!==l){const r=this.keys,c=this.bboxes;for(let u=0;u<l.length;u++){const h=l[u];if(void 0===o[h]){const l=4*h;(a?a(c[l+0],c[l+1],c[l+2],c[l+3]):t<=c[l+2]&&e<=c[l+3]&&i>=c[l+0]&&n>=c[l+1])?(o[h]=!0,s.push(r[h])):o[h]=!1}}}}_forEachCell(t,e,i,n,r,s,o,a){const l=this._convertToCellCoord(t),c=this._convertToCellCoord(e),u=this._convertToCellCoord(i),h=this._convertToCellCoord(n);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++){const c=this.d*l+d;if((!a||a(this._convertFromCellCoord(d),this._convertFromCellCoord(l),this._convertFromCellCoord(d+1),this._convertFromCellCoord(l+1)))&&r.call(this,t,e,i,n,c,s,o,a))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,e=3+this.cells.length+1+1;let i=0;for(let t=0;t<this.cells.length;t++)i+=this.cells[t].length;const n=new Int32Array(e+i+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;let r=e;for(let e=0;e<t.length;e++){const i=t[e];n[3+e]=r,n.set(i,r),r+=i.length}return n[3+t.length]=r,n.set(this.keys,r),r+=this.keys.length,n[3+t.length+1]=r,n.set(this.bboxes,r),r+=this.bboxes.length,n.buffer}static serialize(t,e){const i=t.toArrayBuffer();return e&&e.push(i),{buffer:i}}static deserialize(t){return new Zn(t.buffer)}}const Wn={};function Gn(t,e,i={}){if(Wn[t])throw new Error(`${t} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Wn[t]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}Gn("Object",Object),Gn("TransferableGridIndex",Zn),Gn("Color",ce),Gn("Error",Error),Gn("AJAXError",V),Gn("ResolvedImage",ge),Gn("StylePropertyFunction",Qi),Gn("StyleExpression",Gi,{omit:["_evaluator"]}),Gn("ZoomDependentExpression",Ki),Gn("ZoomConstantExpression",Yi),Gn("CompoundExpression",Xe,{omit:["_evaluate"]});for(const t in Ci)Ci[t]._classRegistryKey||Gn(`Expression_${t}`,Ci[t]);function Hn(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Xn(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob)return t;if(Hn(t))return e&&e.push(t),t;if(z(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const i=t;return e&&e.push(i.buffer),i}if(t instanceof ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const i=[];for(const n of t)i.push(Xn(n,e));return i}if("object"==typeof t){const i=t.constructor,n=i._classRegistryKey;if(!n)throw new Error("can't serialize object of unregistered class");if(!Wn[n])throw new Error(`${n} is not registered.`);const r=i.serialize?i.serialize(t,e):{};if(i.serialize){if(e&&r===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const i in t){if(!t.hasOwnProperty(i))continue;if(Wn[n].omit.indexOf(i)>=0)continue;const s=t[i];r[i]=Wn[n].shallow.indexOf(i)>=0?s:Xn(s,e)}t instanceof Error&&(r.message=t.message)}if(r.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==n&&(r.$name=n),r}throw new Error("can't serialize object of type "+typeof t)}function Yn(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||Hn(t)||z(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(Yn);if("object"==typeof t){const e=t.$name||"Object";if(!Wn[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:i}=Wn[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(t);const n=Object.create(i.prototype);for(const i of Object.keys(t)){if("$name"===i)continue;const r=t[i];n[i]=Wn[e].shallow.indexOf(i)>=0?r:Yn(r)}return n}throw new Error("can't deserialize object of type "+typeof t)}class Kn{constructor(){this.first=!0}update(t,e){const i=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=i,!0))}}const Jn=t=>t>=4352&&t<=4607,Qn=t=>t>=5120&&t<=5759,tr=t=>t>=6016&&t<=6143,er=t=>t>=6320&&t<=6399,ir=t=>t>=11904&&t<=12031,nr=t=>t>=12032&&t<=12255,rr=t=>t>=12272&&t<=12287,sr=t=>t>=12288&&t<=12351,or=t=>t>=12352&&t<=12447,ar=t=>t>=12448&&t<=12543,lr=t=>t>=12544&&t<=12591,cr=t=>t>=12592&&t<=12687,ur=t=>t>=12688&&t<=12703,hr=t=>t>=12704&&t<=12735,dr=t=>t>=12736&&t<=12783,pr=t=>t>=12784&&t<=12799,fr=t=>t>=12800&&t<=13055,mr=t=>t>=13056&&t<=13311,gr=t=>t>=13312&&t<=19903,_r=t=>t>=19904&&t<=19967,yr=t=>t>=19968&&t<=40959,xr=t=>t>=40960&&t<=42127,vr=t=>t>=42128&&t<=42191,br=t=>t>=43360&&t<=43391,wr=t=>t>=44032&&t<=55215,kr=t=>t>=55216&&t<=55295,Sr=t=>t>=63744&&t<=64255,Tr=t=>t>=64336&&t<=65023,Ar=t=>t>=65040&&t<=65055,Mr=t=>t>=65072&&t<=65103,Cr=t=>t>=65104&&t<=65135,Er=t=>t>=65136&&t<=65279,Ir=t=>t>=65280&&t<=65519;function Dr(t){for(const e of t)if(zr(e.charCodeAt(0)))return!0;return!1}function zr(t){return!(746!==t&&747!==t&&(t<4352||!(hr(t)||lr(t)||Mr(t)&&!(t>=65097&&t<=65103)||Sr(t)||mr(t)||ir(t)||dr(t)||!(!sr(t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||gr(t)||yr(t)||fr(t)||cr(t)||br(t)||kr(t)||Jn(t)||wr(t)||or(t)||rr(t)||ur(t)||nr(t)||pr(t)||ar(t)&&12540!==t||!(!Ir(t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Cr(t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Qn(t)||er(t)||Ar(t)||_r(t)||xr(t)||vr(t))))}function Pr(t){return t>=1424&&t<=2303||Tr(t)||Er(t)}function Lr(t,e){return!(!e&&Pr(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||tr(t))}function Fr(t){for(const e of t)if(Pr(e.charCodeAt(0)))return!0;return!1}const Rr="deferred",Or="loading",Br="loaded";let Vr=null,Nr="unavailable",qr=null;const jr=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Nr="error"),Vr&&Vr(t)};function $r(){Ur.fire(new st("pluginStateChange",{pluginStatus:Nr,pluginURL:qr}))}const Ur=new at,Zr=function(){return Nr},Wr=function(){if(Nr!==Rr||!qr)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Nr=Or,$r(),qr&&Z({url:qr},(t=>{t?jr(t):(Nr=Br,$r())}))},Gr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Nr===Br||null!=Gr.applyArabicShaping,isLoading:()=>Nr===Or,setState(t){if(!E())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Nr=t.pluginStatus,qr=t.pluginURL},isParsed(){if(!E())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return null!=Gr.applyArabicShaping},getPluginURL(){if(!E())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return qr}};class Hr{constructor(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Kn,this.transition={})}isSupportedScript(t){return function(t,e){for(const i of t)if(!Lr(i.charCodeAt(0),e))return!1;return!0}(t,Gr.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,e=t-Math.floor(t),i=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*e}}}class Xr{constructor(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(Vi(t))return new Qi(t,e);if(Hi(t)){const i=Ji(t,e);if("error"===i.result)throw new Error(i.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return i.value}{let i=t;return"color"===e.type&&"string"==typeof t?i=ce.parse(t):"padding"!==e.type||"number"!=typeof t&&!Array.isArray(t)?"variableAnchorOffsetCollection"===e.type&&Array.isArray(t)&&(i=me.parse(t)):i=pe.parse(t),{kind:"constant",evaluate:()=>i}}}(void 0===e?t.specification.default:e,t.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,e,i){return this.property.possiblyEvaluate(this,t,e,i)}}class Yr{constructor(t){this.property=t,this.value=new Xr(t,void 0)}transitioned(t,e){return new Jr(this.property,this.value,e,_({},t.transition,this.transition),t.now)}untransitioned(){return new Jr(this.property,this.value,null,{},0)}}class Kr{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return S(this._values[t].value.value)}setValue(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Yr(this._values[t].property)),this._values[t].value=new Xr(this._values[t].property,null===e?void 0:S(e))}getTransition(t){return S(this._values[t].transition)}setTransition(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Yr(this._values[t].property)),this._values[t].transition=S(e)||void 0}serialize(){const t={};for(const e of Object.keys(this._values)){const i=this.getValue(e);void 0!==i&&(t[e]=i);const n=this.getTransition(e);void 0!==n&&(t[`${e}-transition`]=n)}return t}transitioned(t,e){const i=new Qr(this._properties);for(const n of Object.keys(this._values))i._values[n]=this._values[n].transitioned(t,e._values[n]);return i}untransitioned(){const t=new Qr(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class Jr{constructor(t,e,i,n,r){this.property=t,this.value=e,this.begin=r+n.delay||0,this.end=this.begin+n.duration||0,t.specification.transition&&(n.delay||n.duration)&&(this.prior=i)}possiblyEvaluate(t,e,i){const n=t.now||0,r=this.value.possiblyEvaluate(t,e,i),s=this.prior;if(s){if(n>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(n<this.begin)return s.possiblyEvaluate(t,e,i);{const o=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(s.possiblyEvaluate(t,e,i),r,function(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,i=e*t;return 4*(t<.5?i:3*(t-e)+i-.75)}(o))}}return r}}class Qr{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,i){const n=new is(this._properties);for(const r of Object.keys(this._values))n._values[r]=this._values[r].possiblyEvaluate(t,e,i);return n}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class ts{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return void 0!==this._values[t].value}getValue(t){return S(this._values[t].value)}setValue(t,e){this._values[t]=new Xr(this._values[t].property,null===e?void 0:S(e))}serialize(){const t={};for(const e of Object.keys(this._values)){const i=this.getValue(e);void 0!==i&&(t[e]=i)}return t}possiblyEvaluate(t,e,i){const n=new is(this._properties);for(const r of Object.keys(this._values))n._values[r]=this._values[r].possiblyEvaluate(t,e,i);return n}}class es{constructor(t,e,i){this.property=t,this.value=e,this.parameters=i}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,e,i,n){return this.property.evaluate(this.value,this.parameters,t,e,i,n)}}class is{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class ns{constructor(t){this.specification=t}possiblyEvaluate(t,e){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(e)}interpolate(t,e,i){const n=ri[this.specification.type];return n?n(t,e,i):t}}class rs{constructor(t,e){this.specification=t,this.overrides=e}possiblyEvaluate(t,e,i,n){return new es(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},i,n)}:t.expression,e)}interpolate(t,e,i){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new es(this,{kind:"constant",value:void 0},t.parameters);const n=ri[this.specification.type];if(n){const r=n(t.value.value,e.value.value,i);return new es(this,{kind:"constant",value:r},t.parameters)}return t}evaluate(t,e,i,n,r,s){return"constant"===t.kind?t.value:t.evaluate(e,i,n,r,s)}}class ss extends rs{possiblyEvaluate(t,e,i,n){if(void 0===t.value)return new es(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){const r=t.expression.evaluate(e,null,{},i,n),s="resolvedImage"===t.property.specification.type&&"string"!=typeof r?r.name:r,o=this._calculate(s,s,s,e);return new es(this,{kind:"constant",value:o},e)}if("camera"===t.expression.kind){const i=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new es(this,{kind:"constant",value:i},e)}return new es(this,t.expression,e)}evaluate(t,e,i,n,r,s){if("source"===t.kind){const o=t.evaluate(e,i,n,r,s);return this._calculate(o,o,o,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},i,n),t.evaluate({zoom:Math.floor(e.zoom)},i,n),t.evaluate({zoom:Math.floor(e.zoom)+1},i,n),e):t.value}_calculate(t,e,i,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:i,to:e}}interpolate(t){return t}}class os{constructor(t){this.specification=t}possiblyEvaluate(t,e,i,n){if(void 0!==t.value){if("constant"===t.expression.kind){const r=t.expression.evaluate(e,null,{},i,n);return this._calculate(r,r,r,e)}return this._calculate(t.expression.evaluate(new Hr(Math.floor(e.zoom-1),e)),t.expression.evaluate(new Hr(Math.floor(e.zoom),e)),t.expression.evaluate(new Hr(Math.floor(e.zoom+1),e)),e)}}_calculate(t,e,i,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:i,to:e}}interpolate(t){return t}}class as{constructor(t){this.specification=t}possiblyEvaluate(t,e,i,n){return!!t.expression.evaluate(e,null,{},i,n)}interpolate(){return!1}}class ls{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const e in t){const i=t[e];i.specification.overridable&&this.overridableProperties.push(e);const n=this.defaultPropertyValues[e]=new Xr(i,void 0),r=this.defaultTransitionablePropertyValues[e]=new Yr(i);this.defaultTransitioningPropertyValues[e]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=n.possiblyEvaluate({})}}}Gn("DataDrivenProperty",rs),Gn("DataConstantProperty",ns),Gn("CrossFadedDataDrivenProperty",ss),Gn("CrossFadedProperty",os),Gn("ColorRampProperty",as);const cs="-transition";class us extends at{constructor(t,e){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==t.type&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new ts(e.layout)),e.paint)){this._transitionablePaint=new Kr(e.paint);for(const e in t.paint)this.setPaintProperty(e,t.paint[e],{validate:!1});for(const e in t.layout)this.setLayoutProperty(e,t.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new is(e.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,e,i={}){null!=e&&this._validate($n,`layers.${this.id}.layout.${t}`,t,e,i)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)}getPaintProperty(t){return t.endsWith(cs)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e,i={}){if(null!=e&&this._validate(jn,`layers.${this.id}.paint.${t}`,t,e,i))return!1;if(t.endsWith(cs))return this._transitionablePaint.setTransition(t.slice(0,-11),e||void 0),!1;{const i=this._transitionablePaint._values[t],n="cross-faded-data-driven"===i.property.specification["property-type"],r=i.value.isDataDriven(),s=i.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);const o=this._transitionablePaint._values[t].value;return o.isDataDriven()||r||n||this._handleOverridablePaintPropertyUpdate(t,s,o)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,e,i){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),w(t,((t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)))}_validate(t,e,i,n,r={}){return(!r||!1!==r.validate)&&Un(this,t.call(Nn,{key:e,layerType:this.type,objectKey:i,value:n,styleSpec:lt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof es&&Fi(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}}const hs={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ds{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ps{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function fs(t,e=1){let i=0,n=0;return{members:t.map((t=>{const r=hs[t.type].BYTES_PER_ELEMENT,s=i=ms(i,Math.max(e,r)),o=t.components||1;return n=Math.max(n,r),i+=r*o,{name:t.name,type:t.type,components:o,offset:s}})),size:ms(i,Math.max(n,e)),alignment:e}}function ms(t,e){return Math.ceil(t/e)*e}class gs extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e){const i=this.length;return this.resize(i+1),this.emplace(i,t,e)}emplace(t,e,i){const n=2*t;return this.int16[n+0]=e,this.int16[n+1]=i,t}}gs.prototype.bytesPerElement=4,Gn("StructArrayLayout2i4",gs);class _s extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i)}emplace(t,e,i,n){const r=3*t;return this.int16[r+0]=e,this.int16[r+1]=i,this.int16[r+2]=n,t}}_s.prototype.bytesPerElement=6,Gn("StructArrayLayout3i6",_s);class ys extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i,n)}emplace(t,e,i,n,r){const s=4*t;return this.int16[s+0]=e,this.int16[s+1]=i,this.int16[s+2]=n,this.int16[s+3]=r,t}}ys.prototype.bytesPerElement=8,Gn("StructArrayLayout4i8",ys);class xs extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,s){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,i,n,r,s)}emplace(t,e,i,n,r,s,o){const a=6*t;return this.int16[a+0]=e,this.int16[a+1]=i,this.int16[a+2]=n,this.int16[a+3]=r,this.int16[a+4]=s,this.int16[a+5]=o,t}}xs.prototype.bytesPerElement=12,Gn("StructArrayLayout2i4i12",xs);class vs extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,s){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,i,n,r,s)}emplace(t,e,i,n,r,s,o){const a=4*t,l=8*t;return this.int16[a+0]=e,this.int16[a+1]=i,this.uint8[l+4]=n,this.uint8[l+5]=r,this.uint8[l+6]=s,this.uint8[l+7]=o,t}}vs.prototype.bytesPerElement=8,Gn("StructArrayLayout2i4ub8",vs);class bs extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e){const i=this.length;return this.resize(i+1),this.emplace(i,t,e)}emplace(t,e,i){const n=2*t;return this.float32[n+0]=e,this.float32[n+1]=i,t}}bs.prototype.bytesPerElement=8,Gn("StructArrayLayout2f8",bs);class ws extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,s,o,a,l,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,e,i,n,r,s,o,a,l,c)}emplace(t,e,i,n,r,s,o,a,l,c,u){const h=10*t;return this.uint16[h+0]=e,this.uint16[h+1]=i,this.uint16[h+2]=n,this.uint16[h+3]=r,this.uint16[h+4]=s,this.uint16[h+5]=o,this.uint16[h+6]=a,this.uint16[h+7]=l,this.uint16[h+8]=c,this.uint16[h+9]=u,t}}ws.prototype.bytesPerElement=20,Gn("StructArrayLayout10ui20",ws);class ks extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,s,o,a,l,c,u,h){const d=this.length;return this.resize(d+1),this.emplace(d,t,e,i,n,r,s,o,a,l,c,u,h)}emplace(t,e,i,n,r,s,o,a,l,c,u,h,d){const p=12*t;return this.int16[p+0]=e,this.int16[p+1]=i,this.int16[p+2]=n,this.int16[p+3]=r,this.uint16[p+4]=s,this.uint16[p+5]=o,this.uint16[p+6]=a,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=u,this.int16[p+10]=h,this.int16[p+11]=d,t}}ks.prototype.bytesPerElement=24,Gn("StructArrayLayout4i4ui4i24",ks);class Ss extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i)}emplace(t,e,i,n){const r=3*t;return this.float32[r+0]=e,this.float32[r+1]=i,this.float32[r+2]=n,t}}Ss.prototype.bytesPerElement=12,Gn("StructArrayLayout3f12",Ss);class Ts extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}Ts.prototype.bytesPerElement=4,Gn("StructArrayLayout1ul4",Ts);class As extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,s,o,a,l){const c=this.length;return this.resize(c+1),this.emplace(c,t,e,i,n,r,s,o,a,l)}emplace(t,e,i,n,r,s,o,a,l,c){const u=10*t,h=5*t;return this.int16[u+0]=e,this.int16[u+1]=i,this.int16[u+2]=n,this.int16[u+3]=r,this.int16[u+4]=s,this.int16[u+5]=o,this.uint32[h+3]=a,this.uint16[u+8]=l,this.uint16[u+9]=c,t}}As.prototype.bytesPerElement=20,Gn("StructArrayLayout6i1ul2ui20",As);class Ms extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,s){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,i,n,r,s)}emplace(t,e,i,n,r,s,o){const a=6*t;return this.int16[a+0]=e,this.int16[a+1]=i,this.int16[a+2]=n,this.int16[a+3]=r,this.int16[a+4]=s,this.int16[a+5]=o,t}}Ms.prototype.bytesPerElement=12,Gn("StructArrayLayout2i2i2i12",Ms);class Cs extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,i,n,r)}emplace(t,e,i,n,r,s){const o=4*t,a=8*t;return this.float32[o+0]=e,this.float32[o+1]=i,this.float32[o+2]=n,this.int16[a+6]=r,this.int16[a+7]=s,t}}Cs.prototype.bytesPerElement=16,Gn("StructArrayLayout2f1f2i16",Cs);class Es extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i,n)}emplace(t,e,i,n,r){const s=12*t,o=3*t;return this.uint8[s+0]=e,this.uint8[s+1]=i,this.float32[o+1]=n,this.float32[o+2]=r,t}}Es.prototype.bytesPerElement=12,Gn("StructArrayLayout2ub2f12",Es);class Is extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i)}emplace(t,e,i,n){const r=3*t;return this.uint16[r+0]=e,this.uint16[r+1]=i,this.uint16[r+2]=n,t}}Is.prototype.bytesPerElement=6,Gn("StructArrayLayout3ui6",Is);class Ds extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,s,o,a,l,c,u,h,d,p,f,m,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,e,i,n,r,s,o,a,l,c,u,h,d,p,f,m,g)}emplace(t,e,i,n,r,s,o,a,l,c,u,h,d,p,f,m,g,_){const y=24*t,x=12*t,v=48*t;return this.int16[y+0]=e,this.int16[y+1]=i,this.uint16[y+2]=n,this.uint16[y+3]=r,this.uint32[x+2]=s,this.uint32[x+3]=o,this.uint32[x+4]=a,this.uint16[y+10]=l,this.uint16[y+11]=c,this.uint16[y+12]=u,this.float32[x+7]=h,this.float32[x+8]=d,this.uint8[v+36]=p,this.uint8[v+37]=f,this.uint8[v+38]=m,this.uint32[x+10]=g,this.int16[y+22]=_,t}}Ds.prototype.bytesPerElement=48,Gn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ds);class zs extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,s,o,a,l,c,u,h,d,p,f,m,g,_,y,x,v,b,w,k,S,T,A,M){const C=this.length;return this.resize(C+1),this.emplace(C,t,e,i,n,r,s,o,a,l,c,u,h,d,p,f,m,g,_,y,x,v,b,w,k,S,T,A,M)}emplace(t,e,i,n,r,s,o,a,l,c,u,h,d,p,f,m,g,_,y,x,v,b,w,k,S,T,A,M,C){const E=32*t,I=16*t;return this.int16[E+0]=e,this.int16[E+1]=i,this.int16[E+2]=n,this.int16[E+3]=r,this.int16[E+4]=s,this.int16[E+5]=o,this.int16[E+6]=a,this.int16[E+7]=l,this.uint16[E+8]=c,this.uint16[E+9]=u,this.uint16[E+10]=h,this.uint16[E+11]=d,this.uint16[E+12]=p,this.uint16[E+13]=f,this.uint16[E+14]=m,this.uint16[E+15]=g,this.uint16[E+16]=_,this.uint16[E+17]=y,this.uint16[E+18]=x,this.uint16[E+19]=v,this.uint16[E+20]=b,this.uint16[E+21]=w,this.uint16[E+22]=k,this.uint32[I+12]=S,this.float32[I+13]=T,this.float32[I+14]=A,this.uint16[E+30]=M,this.uint16[E+31]=C,t}}zs.prototype.bytesPerElement=64,Gn("StructArrayLayout8i15ui1ul2f2ui64",zs);class Ps extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}Ps.prototype.bytesPerElement=4,Gn("StructArrayLayout1f4",Ps);class Ls extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i)}emplace(t,e,i,n){const r=3*t;return this.uint16[6*t+0]=e,this.float32[r+1]=i,this.float32[r+2]=n,t}}Ls.prototype.bytesPerElement=12,Gn("StructArrayLayout1ui2f12",Ls);class Fs extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i)}emplace(t,e,i,n){const r=4*t;return this.uint32[2*t+0]=e,this.uint16[r+2]=i,this.uint16[r+3]=n,t}}Fs.prototype.bytesPerElement=8,Gn("StructArrayLayout1ul2ui8",Fs);class Rs extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e){const i=this.length;return this.resize(i+1),this.emplace(i,t,e)}emplace(t,e,i){const n=2*t;return this.uint16[n+0]=e,this.uint16[n+1]=i,t}}Rs.prototype.bytesPerElement=4,Gn("StructArrayLayout2ui4",Rs);class Os extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}Os.prototype.bytesPerElement=2,Gn("StructArrayLayout1ui2",Os);class Bs extends ps{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i,n)}emplace(t,e,i,n,r){const s=4*t;return this.float32[s+0]=e,this.float32[s+1]=i,this.float32[s+2]=n,this.float32[s+3]=r,t}}Bs.prototype.bytesPerElement=16,Gn("StructArrayLayout4f16",Bs);class Vs extends ds{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new s(this.anchorPointX,this.anchorPointY)}}Vs.prototype.size=20;class Ns extends As{get(t){return new Vs(this,t)}}Gn("CollisionBoxArray",Ns);class qs extends ds{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}qs.prototype.size=48;class js extends Ds{get(t){return new qs(this,t)}}Gn("PlacedSymbolArray",js);class $s extends ds{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}$s.prototype.size=64;class Us extends zs{get(t){return new $s(this,t)}}Gn("SymbolInstanceArray",Us);class Zs extends Ps{getoffsetX(t){return this.float32[1*t+0]}}Gn("GlyphOffsetArray",Zs);class Ws extends _s{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Gn("SymbolLineVertexArray",Ws);class Gs extends ds{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Gs.prototype.size=12;class Hs extends Ls{get(t){return new Gs(this,t)}}Gn("TextAnchorOffsetArray",Hs);class Xs extends ds{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Xs.prototype.size=8;class Ys extends Fs{get(t){return new Xs(this,t)}}Gn("FeatureIndexArray",Ys);class Ks extends gs{}class Js extends _s{}class Qs extends ys{}class to extends gs{}class eo extends gs{}class io extends xs{}class no extends vs{}class ro extends bs{}class so extends ws{}class oo extends ks{}class ao extends Ss{}class lo extends Ts{}class co extends Ms{}class uo extends Cs{}class ho extends Es{}class po extends Is{}class fo extends Is{}class mo extends Rs{}class go extends Os{}const _o=fs([{name:"a_pos",components:2,type:"Int16"}],4),{members:yo}=_o;class xo{constructor(t=[]){this.segments=t}prepareSegment(t,e,i,n){let r=this.segments[this.segments.length-1];return t>xo.MAX_VERTEX_ARRAY_LENGTH&&A(`Max vertices per segment is ${xo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!r||r.vertexLength+t>xo.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==n)&&(r={vertexOffset:e.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},void 0!==n&&(r.sortKey=n),this.segments.push(r)),r}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy()}static simpleSegment(t,e,i,n){return new xo([{vertexOffset:t,primitiveOffset:e,vertexLength:i,primitiveLength:n,vaos:{},sortKey:0}])}}function vo(t,e){return 256*(t=f(Math.floor(t),0,255))+f(Math.floor(e),0,255)}xo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Gn("SegmentVector",xo);const bo=fs([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var wo={exports:{}},ko={exports:{}};!function(t){t.exports=function(t,e){var i,n,r,s,o,a,l,c;for(n=t.length-(i=3&t.length),r=e,o=3432918353,a=461845907,c=0;c<n;)l=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,r=27492+(65535&(s=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(s>>>16)&65535)<<16);switch(l=0,i){case 3:l^=(255&t.charCodeAt(c+2))<<16;case 2:l^=(255&t.charCodeAt(c+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(c)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295}return r^=t.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0}}(ko);var So=ko.exports,To={exports:{}};!function(t){t.exports=function(t,e){for(var i,n=t.length,r=e^n,s=0;n>=4;)i=1540483477*(65535&(i=255&t.charCodeAt(s)|(255&t.charCodeAt(++s))<<8|(255&t.charCodeAt(++s))<<16|(255&t.charCodeAt(++s))<<24))+((1540483477*(i>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),n-=4,++s;switch(n){case 3:r^=(255&t.charCodeAt(s+2))<<16;case 2:r^=(255&t.charCodeAt(s+1))<<8;case 1:r=1540483477*(65535&(r^=255&t.charCodeAt(s)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0}}(To);var Ao=So,Mo=To.exports;wo.exports=Ao,wo.exports.murmur3=Ao,wo.exports.murmur2=Mo;var Co=i(wo.exports);class Eo{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,e,i,n){this.ids.push(Io(t)),this.positions.push(e,i,n)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const e=Io(t);let i=0,n=this.ids.length-1;for(;i<n;){const t=i+n>>1;this.ids[t]>=e?n=t:i=t+1}const r=[];for(;this.ids[i]===e;)r.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return r}static serialize(t,e){const i=new Float64Array(t.ids),n=new Uint32Array(t.positions);return Do(i,n,0,i.length-1),e&&e.push(i.buffer,n.buffer),{ids:i,positions:n}}static deserialize(t){const e=new Eo;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e}}function Io(t){const e=+t;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Co(String(t))}function Do(t,e,i,n){for(;i<n;){const r=t[i+n>>1];let s=i-1,o=n+1;for(;;){do{s++}while(t[s]<r);do{o--}while(t[o]>r);if(s>=o)break;zo(t,s,o),zo(e,3*s,3*o),zo(e,3*s+1,3*o+1),zo(e,3*s+2,3*o+2)}o-i<n-o?(Do(t,e,i,o),i=o+1):(Do(t,e,o+1,n),n=o)}}function zo(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}Gn("FeaturePositionMap",Eo);class Po{constructor(t,e){this.gl=t.gl,this.location=e}}class Lo extends Po{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}}class Fo extends Po{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Ro extends Po{constructor(t,e){super(t,e),this.current=[0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}}class Oo extends Po{constructor(t,e){super(t,e),this.current=[0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}}class Bo extends Po{constructor(t,e){super(t,e),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Vo extends Po{constructor(t,e){super(t,e),this.current=ce.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const No=new Float32Array(16);class qo extends Po{constructor(t,e){super(t,e),this.current=No}set(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(let e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}}function jo(t){return[vo(255*t.r,255*t.g),vo(255*t.b,255*t.a)]}class $o{constructor(t,e,i){this.value=t,this.uniformNames=e.map((t=>`u_${t}`)),this.type=i}setUniform(t,e,i){t.set(i.constantOr(this.value))}getBinding(t,e,i){return"color"===this.type?new Vo(t,e):new Fo(t,e)}}class Uo{constructor(t,e){this.uniformNames=e.map((t=>`u_${t}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr}setUniform(t,e,i,n){const r="u_pattern_to"===n?this.patternTo:"u_pattern_from"===n?this.patternFrom:"u_pixel_ratio_to"===n?this.pixelRatioTo:"u_pixel_ratio_from"===n?this.pixelRatioFrom:null;r&&t.set(r)}getBinding(t,e,i){return"u_pattern"===i.substr(0,9)?new Bo(t,e):new Fo(t,e)}}class Zo{constructor(t,e,i,n){this.expression=t,this.type=i,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===i?2:1,offset:0}))),this.paintVertexArray=new n}populatePaintArray(t,e,i,n,r){const s=this.paintVertexArray.length,o=this.expression.evaluate(new Hr(0),e,{},n,[],r);this.paintVertexArray.resize(t),this._setPaintValue(s,t,o)}updatePaintArray(t,e,i,n){const r=this.expression.evaluate({zoom:0},i,n);this._setPaintValue(t,e,r)}_setPaintValue(t,e,i){if("color"===this.type){const n=jo(i);for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,n[0],n[1])}else{for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Wo{constructor(t,e,i,n,r,s){this.expression=t,this.uniformNames=e.map((t=>`u_${t}_t`)),this.type=i,this.useIntegerZoom=n,this.zoom=r,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===i?4:2,offset:0}))),this.paintVertexArray=new s}populatePaintArray(t,e,i,n,r){const s=this.expression.evaluate(new Hr(this.zoom),e,{},n,[],r),o=this.expression.evaluate(new Hr(this.zoom+1),e,{},n,[],r),a=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(a,t,s,o)}updatePaintArray(t,e,i,n){const r=this.expression.evaluate({zoom:this.zoom},i,n),s=this.expression.evaluate({zoom:this.zoom+1},i,n);this._setPaintValue(t,e,r,s)}_setPaintValue(t,e,i,n){if("color"===this.type){const r=jo(i),s=jo(n);for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,r[0],r[1],s[0],s[1])}else{for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,i,n);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(n))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e){const i=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,n=f(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);t.set(n)}getBinding(t,e,i){return new Fo(t,e)}}class Go{constructor(t,e,i,n,r,s){this.expression=t,this.type=e,this.useIntegerZoom=i,this.zoom=n,this.layerId=s,this.zoomInPaintVertexArray=new r,this.zoomOutPaintVertexArray=new r}populatePaintArray(t,e,i){const n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(n,t,e.patterns&&e.patterns[this.layerId],i)}updatePaintArray(t,e,i,n,r){this._setPaintValues(t,e,i.patterns&&i.patterns[this.layerId],r)}_setPaintValues(t,e,i,n){if(!n||!i)return;const{min:r,mid:s,max:o}=i,a=n[r],l=n[s],c=n[o];if(a&&l&&c)for(let i=t;i<e;i++)this.zoomInPaintVertexArray.emplace(i,l.tl[0],l.tl[1],l.br[0],l.br[1],a.tl[0],a.tl[1],a.br[0],a.br[1],l.pixelRatio,a.pixelRatio),this.zoomOutPaintVertexArray.emplace(i,l.tl[0],l.tl[1],l.br[0],l.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],l.pixelRatio,c.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,bo.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,bo.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ho{constructor(t,e,i){this.binders={},this._buffers=[];const n=[];for(const r in t.paint._values){if(!i(r))continue;const s=t.paint.get(r);if(!(s instanceof es&&Fi(s.property.specification)))continue;const o=Yo(r,t.type),a=s.value,l=s.property.specification.type,c=s.property.useIntegerZoom,u=s.property.specification["property-type"],h="cross-faded"===u||"cross-faded-data-driven"===u;if("constant"===a.kind)this.binders[r]=h?new Uo(a.value,o):new $o(a.value,o,l),n.push(`/u_${r}`);else if("source"===a.kind||h){const i=Ko(r,l,"source");this.binders[r]=h?new Go(a,l,c,e,i,t.id):new Zo(a,o,l,i),n.push(`/a_${r}`)}else{const t=Ko(r,l,"composite");this.binders[r]=new Wo(a,o,l,c,e,t),n.push(`/z_${r}`)}}this.cacheKey=n.sort().join("")}getMaxValue(t){const e=this.binders[t];return e instanceof Zo||e instanceof Wo?e.maxValue:0}populatePaintArrays(t,e,i,n,r){for(const s in this.binders){const o=this.binders[s];(o instanceof Zo||o instanceof Wo||o instanceof Go)&&o.populatePaintArray(t,e,i,n,r)}}setConstantPatternPositions(t,e){for(const i in this.binders){const n=this.binders[i];n instanceof Uo&&n.setConstantPatternPositions(t,e)}}updatePaintArrays(t,e,i,n,r){let s=!1;for(const o in t){const a=e.getPositions(o);for(const e of a){const a=i.feature(e.index);for(const i in this.binders){const l=this.binders[i];if((l instanceof Zo||l instanceof Wo||l instanceof Go)&&!0===l.expression.isStateDependent){const c=n.paint.get(i);l.expression=c.value,l.updatePaintArray(e.start,e.end,a,t[o],r),s=!0}}}}return s}defines(){const t=[];for(const e in this.binders){const i=this.binders[e];(i instanceof $o||i instanceof Uo)&&t.push(...i.uniformNames.map((t=>`#define HAS_UNIFORM_${t}`)))}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const i=this.binders[e];if(i instanceof Zo||i instanceof Wo)for(let e=0;e<i.paintVertexAttributes.length;e++)t.push(i.paintVertexAttributes[e].name);else if(i instanceof Go)for(let e=0;e<bo.members.length;e++)t.push(bo.members[e].name)}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const i=this.binders[e];if(i instanceof $o||i instanceof Uo||i instanceof Wo)for(const e of i.uniformNames)t.push(e)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,e){const i=[];for(const n in this.binders){const r=this.binders[n];if(r instanceof $o||r instanceof Uo||r instanceof Wo)for(const s of r.uniformNames)if(e[s]){const o=r.getBinding(t,e[s],s);i.push({name:s,property:n,binding:o})}}return i}setUniforms(t,e,i,n){for(const{name:t,property:r,binding:s}of e)this.binders[r].setUniform(s,n,i.get(r),t)}updatePaintBuffers(t){this._buffers=[];for(const e in this.binders){const i=this.binders[e];if(t&&i instanceof Go){const e=2===t.fromScale?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;e&&this._buffers.push(e)}else(i instanceof Zo||i instanceof Wo)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(t){for(const e in this.binders){const i=this.binders[e];(i instanceof Zo||i instanceof Wo||i instanceof Go)&&i.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof Zo||e instanceof Wo||e instanceof Go)&&e.destroy()}}}class Xo{constructor(t,e,i=(()=>!0)){this.programConfigurations={};for(const n of t)this.programConfigurations[n.id]=new Ho(n,e,i);this.needsUpload=!1,this._featureMap=new Eo,this._bufferOffset=0}populatePaintArrays(t,e,i,n,r,s){for(const i in this.programConfigurations)this.programConfigurations[i].populatePaintArrays(t,e,n,r,s);void 0!==e.id&&this._featureMap.add(e.id,i,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,e,i,n){for(const r of i)this.needsUpload=this.programConfigurations[r.id].updatePaintArrays(t,this._featureMap,e,r,n)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Yo(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}function Ko(t,e,i){const n={color:{source:bs,composite:Bs},number:{source:Ps,composite:bs}},r=function(t){return{"line-pattern":{source:so,composite:so},"fill-pattern":{source:so,composite:so},"fill-extrusion-pattern":{source:so,composite:so}}[t]}(t);return r&&r[i]||n[e][i]}Gn("ConstantBinder",$o),Gn("CrossFadedConstantBinder",Uo),Gn("SourceExpressionBinder",Zo),Gn("CrossFadedCompositeBinder",Go),Gn("CompositeExpressionBinder",Wo),Gn("ProgramConfiguration",Ho,{omit:["_buffers"]}),Gn("ProgramConfigurationSet",Xo);const Jo=8192,Qo=Math.pow(2,14)-1,ta=-Qo-1;function ea(t){const e=Jo/t.extent,i=t.loadGeometry();for(let t=0;t<i.length;t++){const n=i[t];for(let t=0;t<n.length;t++){const i=n[t],r=Math.round(i.x*e),s=Math.round(i.y*e);i.x=f(r,ta,Qo),i.y=f(s,ta,Qo),(r<i.x||r>i.x+1||s<i.y||s>i.y+1)&&A("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function ia(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?ea(t):[]}}function na(t,e,i,n,r){t.emplaceBack(2*e+(n+1)/2,2*i+(r+1)/2)}class ra{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new to,this.indexArray=new fo,this.segments=new xo,this.programConfigurations=new Xo(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){const n=this.layers[0],r=[];let s=null,o=!1;"circle"===n.type&&(s=n.layout.get("circle-sort-key"),o=!s.isConstant());for(const{feature:e,id:n,index:a,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,c=ia(e,t);if(!this.layers[0]._featureFilter.filter(new Hr(this.zoom),c,i))continue;const u=o?s.evaluate(c,{},i):void 0,h={id:n,properties:e.properties,type:e.type,sourceLayerIndex:l,index:a,geometry:t?c.geometry:ea(e),patterns:{},sortKey:u};r.push(h)}o&&r.sort(((t,e)=>t.sortKey-e.sortKey));for(const n of r){const{geometry:r,index:s,sourceLayerIndex:o}=n,a=t[s].feature;this.addFeature(n,r,s,i),e.featureIndex.insert(a,r,s,o,this.index)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,yo),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,i,n){for(const i of e)for(const e of i){const i=e.x,n=e.y;if(i<0||i>=Jo||n<0||n>=Jo)continue;const r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),s=r.vertexLength;na(this.layoutVertexArray,i,n,-1,-1),na(this.layoutVertexArray,i,n,1,-1),na(this.layoutVertexArray,i,n,1,1),na(this.layoutVertexArray,i,n,-1,1),this.indexArray.emplaceBack(s,s+1,s+2),this.indexArray.emplaceBack(s,s+3,s+2),r.vertexLength+=4,r.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,{},n)}}function sa(t,e){for(let i=0;i<t.length;i++)if(fa(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(fa(t,e[i]))return!0;return!!ca(t,e)}function oa(t,e,i){return!!fa(t,e)||!!ha(e,t,i)}function aa(t,e){if(1===t.length)return pa(e,t[0]);for(let i=0;i<e.length;i++){const n=e[i];for(let e=0;e<n.length;e++)if(fa(t,n[e]))return!0}for(let i=0;i<t.length;i++)if(pa(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(ca(t,e[i]))return!0;return!1}function la(t,e,i){if(t.length>1){if(ca(t,e))return!0;for(let n=0;n<e.length;n++)if(ha(e[n],t,i))return!0}for(let n=0;n<t.length;n++)if(ha(t[n],e,i))return!0;return!1}function ca(t,e){if(0===t.length||0===e.length)return!1;for(let i=0;i<t.length-1;i++){const n=t[i],r=t[i+1];for(let t=0;t<e.length-1;t++)if(ua(n,r,e[t],e[t+1]))return!0}return!1}function ua(t,e,i,n){return M(t,i,n)!==M(e,i,n)&&M(t,e,i)!==M(t,e,n)}function ha(t,e,i){const n=i*i;if(1===e.length)return t.distSqr(e[0])<n;for(let i=1;i<e.length;i++)if(da(t,e[i-1],e[i])<n)return!0;return!1}function da(t,e,i){const n=e.distSqr(i);if(0===n)return t.distSqr(e);const r=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/n;return t.distSqr(r<0?e:r>1?i:i.sub(e)._mult(r)._add(e))}function pa(t,e){let i,n,r,s=!1;for(let o=0;o<t.length;o++){i=t[o];for(let t=0,o=i.length-1;t<i.length;o=t++)n=i[t],r=i[o],n.y>e.y!=r.y>e.y&&e.x<(r.x-n.x)*(e.y-n.y)/(r.y-n.y)+n.x&&(s=!s)}return s}function fa(t,e){let i=!1;for(let n=0,r=t.length-1;n<t.length;r=n++){const s=t[n],o=t[r];s.y>e.y!=o.y>e.y&&e.x<(o.x-s.x)*(e.y-s.y)/(o.y-s.y)+s.x&&(i=!i)}return i}function ma(t,e,i){const n=i[0],r=i[2];if(t.x<n.x&&e.x<n.x||t.x>r.x&&e.x>r.x||t.y<n.y&&e.y<n.y||t.y>r.y&&e.y>r.y)return!1;const s=M(t,e,i[0]);return s!==M(t,e,i[1])||s!==M(t,e,i[2])||s!==M(t,e,i[3])}function ga(t,e,i){const n=e.paint.get(t).value;return"constant"===n.kind?n.value:i.programConfigurations.get(e.id).getMaxValue(t)}function _a(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function ya(t,e,i,n,r){if(!e[0]&&!e[1])return t;const o=s.convert(e)._mult(r);"viewport"===i&&o._rotate(-n);const a=[];for(let e=0;e<t.length;e++)a.push(t[e].sub(o));return a}let xa,va;Gn("CircleBucket",ra,{omit:["layers"]});var ba={get paint(){return va=va||new ls({"circle-radius":new rs(lt.paint_circle["circle-radius"]),"circle-color":new rs(lt.paint_circle["circle-color"]),"circle-blur":new rs(lt.paint_circle["circle-blur"]),"circle-opacity":new rs(lt.paint_circle["circle-opacity"]),"circle-translate":new ns(lt.paint_circle["circle-translate"]),"circle-translate-anchor":new ns(lt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ns(lt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ns(lt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new rs(lt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new rs(lt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new rs(lt.paint_circle["circle-stroke-opacity"])})},get layout(){return xa=xa||new ls({"circle-sort-key":new rs(lt.layout_circle["circle-sort-key"])})}},wa=1e-6,ka="undefined"!=typeof Float32Array?Float32Array:Array;function Sa(){var t=new ka(16);return ka!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Ta(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Aa(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],_=e[15],y=i*a-n*o,x=i*l-r*o,v=i*c-s*o,b=n*l-r*a,w=n*c-s*a,k=r*c-s*l,S=u*m-h*f,T=u*g-d*f,A=u*_-p*f,M=h*g-d*m,C=h*_-p*m,E=d*_-p*g,I=y*E-x*C+v*M+b*A-w*T+k*S;return I?(t[0]=(a*E-l*C+c*M)*(I=1/I),t[1]=(r*C-n*E-s*M)*I,t[2]=(m*k-g*w+_*b)*I,t[3]=(d*w-h*k-p*b)*I,t[4]=(l*A-o*E-c*T)*I,t[5]=(i*E-r*A+s*T)*I,t[6]=(g*v-f*k-_*x)*I,t[7]=(u*k-d*v+p*x)*I,t[8]=(o*C-a*A+c*S)*I,t[9]=(n*A-i*C-s*S)*I,t[10]=(f*w-m*v+_*y)*I,t[11]=(h*v-u*w-p*y)*I,t[12]=(a*T-o*M-l*S)*I,t[13]=(i*M-n*T+r*S)*I,t[14]=(m*x-f*b-g*y)*I,t[15]=(u*b-h*x+d*y)*I,t):null}function Ma(t,e,i){var n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],_=e[14],y=e[15],x=i[0],v=i[1],b=i[2],w=i[3];return t[0]=x*n+v*a+b*h+w*m,t[1]=x*r+v*l+b*d+w*g,t[2]=x*s+v*c+b*p+w*_,t[3]=x*o+v*u+b*f+w*y,t[4]=(x=i[4])*n+(v=i[5])*a+(b=i[6])*h+(w=i[7])*m,t[5]=x*r+v*l+b*d+w*g,t[6]=x*s+v*c+b*p+w*_,t[7]=x*o+v*u+b*f+w*y,t[8]=(x=i[8])*n+(v=i[9])*a+(b=i[10])*h+(w=i[11])*m,t[9]=x*r+v*l+b*d+w*g,t[10]=x*s+v*c+b*p+w*_,t[11]=x*o+v*u+b*f+w*y,t[12]=(x=i[12])*n+(v=i[13])*a+(b=i[14])*h+(w=i[15])*m,t[13]=x*r+v*l+b*d+w*g,t[14]=x*s+v*c+b*p+w*_,t[15]=x*o+v*u+b*f+w*y,t}function Ca(t,e,i){var n,r,s,o,a,l,c,u,h,d,p,f,m=i[0],g=i[1],_=i[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*_+e[12],t[13]=e[1]*m+e[5]*g+e[9]*_+e[13],t[14]=e[2]*m+e[6]*g+e[10]*_+e[14],t[15]=e[3]*m+e[7]*g+e[11]*_+e[15]):(r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],t[0]=n=e[0],t[1]=r,t[2]=s,t[3]=o,t[4]=a,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=d,t[10]=p,t[11]=f,t[12]=n*m+a*g+h*_+e[12],t[13]=r*m+l*g+d*_+e[13],t[14]=s*m+c*g+p*_+e[14],t[15]=o*m+u*g+f*_+e[15]),t}function Ea(t,e,i){var n=i[0],r=i[1],s=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ia(t,e,i){var n=Math.sin(i),r=Math.cos(i),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r+c*n,t[1]=o*r+u*n,t[2]=a*r+h*n,t[3]=l*r+d*n,t[4]=c*r-s*n,t[5]=u*r-o*n,t[6]=h*r-a*n,t[7]=d*r-l*n,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Da=function(t,e,i,n,r,s,o){var a=1/(e-i),l=1/(n-r),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+i)*a,t[13]=(r+n)*l,t[14]=(o+s)*c,t[15]=1,t},za=Ma;function Pa(t){var e=new ka(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}var La,Fa=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t};function Ra(t,e,i){var n=e[0],r=e[1],s=e[2],o=e[3];return t[0]=i[0]*n+i[4]*r+i[8]*s+i[12]*o,t[1]=i[1]*n+i[5]*r+i[9]*s+i[13]*o,t[2]=i[2]*n+i[6]*r+i[10]*s+i[14]*o,t[3]=i[3]*n+i[7]*r+i[11]*s+i[15]*o,t}La=new ka(3),ka!=Float32Array&&(La[0]=0,La[1]=0,La[2]=0),function(){var t=new ka(4);ka!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var Oa=function(t){var e=t[0],i=t[1];return e*e+i*i};!function(){var t=new ka(2);ka!=Float32Array&&(t[0]=0,t[1]=0)}();class Ba extends us{constructor(t){super(t,ba)}createBucket(t){return new ra(t)}queryRadius(t){const e=t;return ga("circle-radius",this,e)+ga("circle-stroke-width",this,e)+_a(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,i,n,r,s,o,a){const l=ya(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),s.angle,o),c=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i),u="map"===this.paint.get("circle-pitch-alignment"),h=u?l:function(t,e){return t.map((t=>Va(t,e)))}(l,a),d=u?c*o:c;for(const t of n)for(const e of t){const t=u?e:Va(e,a);let i=d;const n=Ra([],[e.x,e.y,0,1],a);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?i*=n[3]/s.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(i*=s.cameraToCenterDistance/n[3]),oa(h,t,i))return!0}return!1}}function Va(t,e){const i=Ra([],[t.x,t.y,0,1],e);return new s(i[0]/i[3],i[1]/i[3])}class Na extends ra{}let qa;Gn("HeatmapBucket",Na,{omit:["layers"]});var ja={get paint(){return qa=qa||new ls({"heatmap-radius":new rs(lt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new rs(lt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ns(lt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new as(lt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ns(lt.paint_heatmap["heatmap-opacity"])})}};function $a(t,{width:e,height:i},n,r){if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==e*i*n)throw new RangeError(`mismatched image size. expected: ${r.length} but got: ${e*i*n}`)}else r=new Uint8Array(e*i*n);return t.width=e,t.height=i,t.data=r,t}function Ua(t,{width:e,height:i},n){if(e===t.width&&i===t.height)return;const r=$a({},{width:e,height:i},n);Za(t,r,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,i)},n),t.width=e,t.height=i,t.data=r.data}function Za(t,e,i,n,r,s){if(0===r.width||0===r.height)return e;if(r.width>t.width||r.height>t.height||i.x>t.width-r.width||i.y>t.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>e.width||r.height>e.height||n.x>e.width-r.width||n.y>e.height-r.height)throw new RangeError("out of range destination coordinates for image copy");const o=t.data,a=e.data;if(o===a)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<r.height;l++){const c=((i.y+l)*t.width+i.x)*s,u=((n.y+l)*e.width+n.x)*s;for(let t=0;t<r.width*s;t++)a[u+t]=o[c+t]}return e}class Wa{constructor(t,e){$a(this,t,1,e)}resize(t){Ua(this,t,1)}clone(){return new Wa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,i,n,r){Za(t,e,i,n,r,1)}}class Ga{constructor(t,e){$a(this,t,4,e)}resize(t){Ua(this,t,4)}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Ga({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,i,n,r){Za(t,e,i,n,r,4)}}function Ha(t){const e={},i=t.resolution||256,n=t.clips?t.clips.length:1,r=t.image||new Ga({width:i,height:n});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const s=(i,n,s)=>{e[t.evaluationKey]=s;const o=t.expression.evaluate(e);r.data[i+n+0]=Math.floor(255*o.r/o.a),r.data[i+n+1]=Math.floor(255*o.g/o.a),r.data[i+n+2]=Math.floor(255*o.b/o.a),r.data[i+n+3]=Math.floor(255*o.a)};if(t.clips)for(let e=0,r=0;e<n;++e,r+=4*i)for(let n=0,o=0;n<i;n++,o+=4){const a=n/(i-1),{start:l,end:c}=t.clips[e];s(r,o,l*(1-a)+c*a)}else for(let t=0,e=0;t<i;t++,e+=4)s(0,e,t/(i-1));return r}Gn("AlphaImage",Wa),Gn("RGBAImage",Ga);class Xa extends us{createBucket(t){return new Na(t)}constructor(t){super(t,ja),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ha({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let Ya;var Ka={get paint(){return Ya=Ya||new ls({"hillshade-illumination-direction":new ns(lt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ns(lt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ns(lt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ns(lt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ns(lt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ns(lt.paint_hillshade["hillshade-accent-color"])})}};class Ja extends us{constructor(t){super(t,Ka)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}const Qa=fs([{name:"a_pos",components:2,type:"Int16"}],4),{members:tl}=Qa;var el={exports:{}};function il(t,e,i){i=i||2;var n,r,s,o,a,l,c,u=e&&e.length,h=u?e[0]*i:t.length,d=nl(t,0,h,i,!0),p=[];if(!d||d.next===d.prev)return p;if(u&&(d=function(t,e,i,n){var r,s,o,a=[];for(r=0,s=e.length;r<s;r++)(o=nl(t,e[r]*n,r<s-1?e[r+1]*n:t.length,n,!1))===o.next&&(o.steiner=!0),a.push(fl(o));for(a.sort(ul),r=0;r<a.length;r++)i=hl(a[r],i);return i}(t,e,d,i)),t.length>80*i){n=s=t[0],r=o=t[1];for(var f=i;f<h;f+=i)(a=t[f])<n&&(n=a),(l=t[f+1])<r&&(r=l),a>s&&(s=a),l>o&&(o=l);c=0!==(c=Math.max(s-n,o-r))?32767/c:0}return sl(d,p,i,n,r,c,0),p}function nl(t,e,i,n,r){var s,o;if(r===Ml(t,e,i,n)>0)for(s=e;s<i;s+=n)o=Sl(s,t[s],t[s+1],o);else for(s=i-n;s>=e;s-=n)o=Sl(s,t[s],t[s+1],o);return o&&yl(o,o.next)&&(Tl(o),o=o.next),o}function rl(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!yl(n,n.next)&&0!==_l(n.prev,n,n.next))n=n.next;else{if(Tl(n),(n=e=n.prev)===n.next)break;i=!0}}while(i||n!==e);return e}function sl(t,e,i,n,r,s,o){if(t){!o&&s&&function(t,e,i,n){var r=t;do{0===r.z&&(r.z=pl(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,i,n,r,s,o,a,l,c=1;do{for(i=t,t=null,s=null,o=0;i;){for(o++,n=i,a=0,e=0;e<c&&(a++,n=n.nextZ);e++);for(l=c;a>0||l>0&&n;)0!==a&&(0===l||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=n}s.nextZ=null,c*=2}while(o>1)}(r)}(t,n,r,s);for(var a,l,c=t;t.prev!==t.next;)if(a=t.prev,l=t.next,s?al(t,n,r,s):ol(t))e.push(a.i/i|0),e.push(t.i/i|0),e.push(l.i/i|0),Tl(t),t=l.next,c=l.next;else if((t=l)===c){o?1===o?sl(t=ll(rl(t),e,i),e,i,n,r,s,2):2===o&&cl(t,e,i,n,r,s):sl(rl(t),e,i,n,r,s,1);break}}}function ol(t){var e=t.prev,i=t,n=t.next;if(_l(e,i,n)>=0)return!1;for(var r=e.x,s=i.x,o=n.x,a=e.y,l=i.y,c=n.y,u=r<s?r<o?r:o:s<o?s:o,h=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,p=a>l?a>c?a:c:l>c?l:c,f=n.next;f!==e;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&ml(r,a,s,l,o,c,f.x,f.y)&&_l(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function al(t,e,i,n){var r=t.prev,s=t,o=t.next;if(_l(r,s,o)>=0)return!1;for(var a=r.x,l=s.x,c=o.x,u=r.y,h=s.y,d=o.y,p=a<l?a<c?a:c:l<c?l:c,f=u<h?u<d?u:d:h<d?h:d,m=a>l?a>c?a:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,_=pl(p,f,e,i,n),y=pl(m,g,e,i,n),x=t.prevZ,v=t.nextZ;x&&x.z>=_&&v&&v.z<=y;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==o&&ml(a,u,l,h,c,d,x.x,x.y)&&_l(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==r&&v!==o&&ml(a,u,l,h,c,d,v.x,v.y)&&_l(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;x&&x.z>=_;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==o&&ml(a,u,l,h,c,d,x.x,x.y)&&_l(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;v&&v.z<=y;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==r&&v!==o&&ml(a,u,l,h,c,d,v.x,v.y)&&_l(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function ll(t,e,i){var n=t;do{var r=n.prev,s=n.next.next;!yl(r,s)&&xl(r,n,n.next,s)&&wl(r,s)&&wl(s,r)&&(e.push(r.i/i|0),e.push(n.i/i|0),e.push(s.i/i|0),Tl(n),Tl(n.next),n=t=s),n=n.next}while(n!==t);return rl(n)}function cl(t,e,i,n,r,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&gl(o,a)){var l=kl(o,a);return o=rl(o,o.next),l=rl(l,l.next),sl(o,e,i,n,r,s,0),void sl(l,e,i,n,r,s,0)}a=a.next}o=o.next}while(o!==t)}function ul(t,e){return t.x-e.x}function hl(t,e){var i=function(t,e){var i,n=e,r=t.x,s=t.y,o=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var a=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>o&&(o=a,i=n.x<n.next.x?n:n.next,a===r))return i}n=n.next}while(n!==e);if(!i)return null;var l,c=i,u=i.x,h=i.y,d=1/0;n=i;do{r>=n.x&&n.x>=u&&r!==n.x&&ml(s<h?r:o,s,u,h,s<h?o:r,s,n.x,n.y)&&(l=Math.abs(s-n.y)/(r-n.x),wl(n,t)&&(l<d||l===d&&(n.x>i.x||n.x===i.x&&dl(i,n)))&&(i=n,d=l)),n=n.next}while(n!==c);return i}(t,e);if(!i)return e;var n=kl(i,t);return rl(n,n.next),rl(i,i.next)}function dl(t,e){return _l(t.prev,t,e.prev)<0&&_l(e.next,t,t.next)<0}function pl(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function fl(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function ml(t,e,i,n,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(n-a)>=(i-o)*(e-a)&&(i-o)*(s-a)>=(r-o)*(n-a)}function gl(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&xl(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(wl(t,e)&&wl(e,t)&&function(t,e){var i=t,n=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)&&(_l(t.prev,t,e.prev)||_l(t,e.prev,e))||yl(t,e)&&_l(t.prev,t,t.next)>0&&_l(e.prev,e,e.next)>0)}function _l(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function yl(t,e){return t.x===e.x&&t.y===e.y}function xl(t,e,i,n){var r=bl(_l(t,e,i)),s=bl(_l(t,e,n)),o=bl(_l(i,n,t)),a=bl(_l(i,n,e));return r!==s&&o!==a||!(0!==r||!vl(t,i,e))||!(0!==s||!vl(t,n,e))||!(0!==o||!vl(i,t,n))||!(0!==a||!vl(i,e,n))}function vl(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function bl(t){return t>0?1:t<0?-1:0}function wl(t,e){return _l(t.prev,t,t.next)<0?_l(t,e,t.next)>=0&&_l(t,t.prev,e)>=0:_l(t,e,t.prev)<0||_l(t,t.next,e)<0}function kl(t,e){var i=new Al(t.i,t.x,t.y),n=new Al(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function Sl(t,e,i,n){var r=new Al(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Tl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Al(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ml(t,e,i,n){for(var r=0,s=e,o=i-n;s<i;s+=n)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}el.exports=il,el.exports.default=il,il.deviation=function(t,e,i,n){var r=e&&e.length,s=Math.abs(Ml(t,0,r?e[0]*i:t.length,i));if(r)for(var o=0,a=e.length;o<a;o++)s-=Math.abs(Ml(t,e[o]*i,o<a-1?e[o+1]*i:t.length,i));var l=0;for(o=0;o<n.length;o+=3){var c=n[o]*i,u=n[o+1]*i,h=n[o+2]*i;l+=Math.abs((t[c]-t[h])*(t[u+1]-t[c+1])-(t[c]-t[u])*(t[h+1]-t[c+1]))}return 0===s&&0===l?0:Math.abs((l-s)/s)},il.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var o=0;o<e;o++)i.vertices.push(t[r][s][o]);r>0&&i.holes.push(n+=t[r-1].length)}return i};var Cl=i(el.exports);function El(t,e,i,n,r){Il(t,e,i||0,n||t.length-1,r||zl)}function Il(t,e,i,n,r){for(;n>i;){if(n-i>600){var s=n-i+1,o=e-i+1,a=Math.log(s),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(s-l)/s)*(o-s/2<0?-1:1);Il(t,e,Math.max(i,Math.floor(e-o*l/s+c)),Math.min(n,Math.floor(e+(s-o)*l/s+c)),r)}var u=t[e],h=i,d=n;for(Dl(t,i,e),r(t[n],u)>0&&Dl(t,i,n);h<d;){for(Dl(t,h,d),h++,d--;r(t[h],u)<0;)h++;for(;r(t[d],u)>0;)d--}0===r(t[i],u)?Dl(t,i,d):Dl(t,++d,n),d<=e&&(i=d+1),e<=d&&(n=d-1)}}function Dl(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function zl(t,e){return t<e?-1:t>e?1:0}function Pl(t,e){const i=t.length;if(i<=1)return[t];const n=[];let r,s;for(let e=0;e<i;e++){const i=C(t[e]);0!==i&&(t[e].area=Math.abs(i),void 0===s&&(s=i<0),s===i<0?(r&&n.push(r),r=[t[e]]):r.push(t[e]))}if(r&&n.push(r),e>1)for(let t=0;t<n.length;t++)n[t].length<=e||(El(n[t],e,1,n[t].length-1,Ll),n[t]=n[t].slice(0,e));return n}function Ll(t,e){return e.area-t.area}function Fl(t,e,i){const n=i.patternDependencies;let r=!1;for(const i of e){const e=i.paint.get(`${t}-pattern`);e.isConstant()||(r=!0);const s=e.constantOr(null);s&&(r=!0,n[s.to]=!0,n[s.from]=!0)}return r}function Rl(t,e,i,n,r){const s=r.patternDependencies;for(const o of e){const e=o.paint.get(`${t}-pattern`).value;if("constant"!==e.kind){let t=e.evaluate({zoom:n-1},i,{},r.availableImages),a=e.evaluate({zoom:n},i,{},r.availableImages),l=e.evaluate({zoom:n+1},i,{},r.availableImages);t=t&&t.name?t.name:t,a=a&&a.name?a.name:a,l=l&&l.name?l.name:l,s[t]=!0,s[a]=!0,s[l]=!0,i.patterns[o.id]={min:t,mid:a,max:l}}}return i}class Ol{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new eo,this.indexArray=new fo,this.indexArray2=new mo,this.programConfigurations=new Xo(t.layers,t.zoom),this.segments=new xo,this.segments2=new xo,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){this.hasPattern=Fl("fill",this.layers,e);const n=this.layers[0].layout.get("fill-sort-key"),r=!n.isConstant(),s=[];for(const{feature:o,id:a,index:l,sourceLayerIndex:c}of t){const t=this.layers[0]._featureFilter.needGeometry,u=ia(o,t);if(!this.layers[0]._featureFilter.filter(new Hr(this.zoom),u,i))continue;const h=r?n.evaluate(u,{},i,e.availableImages):void 0,d={id:a,properties:o.properties,type:o.type,sourceLayerIndex:c,index:l,geometry:t?u.geometry:ea(o),patterns:{},sortKey:h};s.push(d)}r&&s.sort(((t,e)=>t.sortKey-e.sortKey));for(const n of s){const{geometry:r,index:s,sourceLayerIndex:o}=n;if(this.hasPattern){const t=Rl("fill",this.layers,n,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(n,r,s,i,{});e.featureIndex.insert(t[s].feature,r,s,o,this.index)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}addFeatures(t,e,i){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,tl),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,i,n,r){for(const t of Pl(e,500)){let e=0;for(const i of t)e+=i.length;const i=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),n=i.vertexLength,r=[],s=[];for(const e of t){if(0===e.length)continue;e!==t[0]&&s.push(r.length/2);const i=this.segments2.prepareSegment(e.length,this.layoutVertexArray,this.indexArray2),n=i.vertexLength;this.layoutVertexArray.emplaceBack(e[0].x,e[0].y),this.indexArray2.emplaceBack(n+e.length-1,n),r.push(e[0].x),r.push(e[0].y);for(let t=1;t<e.length;t++)this.layoutVertexArray.emplaceBack(e[t].x,e[t].y),this.indexArray2.emplaceBack(n+t-1,n+t),r.push(e[t].x),r.push(e[t].y);i.vertexLength+=e.length,i.primitiveLength+=e.length}const o=Cl(r,s);for(let t=0;t<o.length;t+=3)this.indexArray.emplaceBack(n+o[t],n+o[t+1],n+o[t+2]);i.vertexLength+=e,i.primitiveLength+=o.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,r,n)}}let Bl,Vl;Gn("FillBucket",Ol,{omit:["layers","patternFeatures"]});var Nl={get paint(){return Vl=Vl||new ls({"fill-antialias":new ns(lt.paint_fill["fill-antialias"]),"fill-opacity":new rs(lt.paint_fill["fill-opacity"]),"fill-color":new rs(lt.paint_fill["fill-color"]),"fill-outline-color":new rs(lt.paint_fill["fill-outline-color"]),"fill-translate":new ns(lt.paint_fill["fill-translate"]),"fill-translate-anchor":new ns(lt.paint_fill["fill-translate-anchor"]),"fill-pattern":new ss(lt.paint_fill["fill-pattern"])})},get layout(){return Bl=Bl||new ls({"fill-sort-key":new rs(lt.layout_fill["fill-sort-key"])})}};class ql extends us{constructor(t){super(t,Nl)}recalculate(t,e){super.recalculate(t,e);const i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Ol(t)}queryRadius(){return _a(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,i,n,r,s,o){return aa(ya(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),s.angle,o),n)}isTileClipped(){return!0}}const jl=fs([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),$l=fs([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Ul}=jl;var Zl={},Wl=n,Gl=Hl;function Hl(t,e,i,n,r){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=r,t.readFields(Xl,this,e)}function Xl(t,e,i){1==t?e.id=i.readVarint():2==t?function(t,e){for(var i=t.readVarint()+t.pos;t.pos<i;){var n=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[n]=r}}(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}function Yl(t){for(var e,i,n=0,r=0,s=t.length,o=s-1;r<s;o=r++)n+=((i=t[o]).x-(e=t[r]).x)*(e.y+i.y);return n}Hl.types=["Unknown","Point","LineString","Polygon"],Hl.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,n=1,r=0,s=0,o=0,a=[];t.pos<i;){if(r<=0){var l=t.readVarint();n=7&l,r=l>>3}if(r--,1===n||2===n)s+=t.readSVarint(),o+=t.readSVarint(),1===n&&(e&&a.push(e),e=[]),e.push(new Wl(s,o));else{if(7!==n)throw new Error("unknown command "+n);e&&e.push(e[0].clone())}}return e&&a.push(e),a},Hl.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,n=0,r=0,s=0,o=1/0,a=-1/0,l=1/0,c=-1/0;t.pos<e;){if(n<=0){var u=t.readVarint();i=7&u,n=u>>3}if(n--,1===i||2===i)(r+=t.readSVarint())<o&&(o=r),r>a&&(a=r),(s+=t.readSVarint())<l&&(l=s),s>c&&(c=s);else if(7!==i)throw new Error("unknown command "+i)}return[o,l,a,c]},Hl.prototype.toGeoJSON=function(t,e,i){var n,r,s=this.extent*Math.pow(2,i),o=this.extent*t,a=this.extent*e,l=this.loadGeometry(),c=Hl.types[this.type];function u(t){for(var e=0;e<t.length;e++){var i=t[e];t[e]=[360*(i.x+o)/s-180,360/Math.PI*Math.atan(Math.exp((180-360*(i.y+a)/s)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(n=0;n<l.length;n++)h[n]=l[n][0];u(l=h);break;case 2:for(n=0;n<l.length;n++)u(l[n]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var i,n,r=[],s=0;s<e;s++){var o=Yl(t[s]);0!==o&&(void 0===n&&(n=o<0),n===o<0?(i&&r.push(i),i=[t[s]]):i.push(t[s]))}return i&&r.push(i),r}(l),n=0;n<l.length;n++)for(r=0;r<l[n].length;r++)u(l[n][r])}1===l.length?l=l[0]:c="Multi"+c;var d={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(d.id=this.id),d};var Kl=Gl,Jl=Ql;function Ql(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(tc,this,e),this.length=this._features.length}function tc(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(t){for(var e=null,i=t.readVarint()+t.pos;t.pos<i;){var n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}(i))}Ql.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Kl(this._pbf,e,this.extent,this._keys,this._values)};var ec=Jl;function ic(t,e,i){if(3===t){var n=new ec(i,i.readVarint()+i.pos);n.length&&(e[n.name]=n)}}Zl.VectorTile=function(t,e){this.layers=t.readFields(ic,{},e)},Zl.VectorTileFeature=Gl,Zl.VectorTileLayer=Jl;const nc=Zl.VectorTileFeature.types,rc=Math.pow(2,13);function sc(t,e,i,n,r,s,o,a){t.emplaceBack(e,i,2*Math.floor(n*rc)+o,r*rc*2,s*rc*2,Math.round(a))}class oc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new io,this.centroidVertexArray=new Ks,this.indexArray=new fo,this.programConfigurations=new Xo(t.layers,t.zoom),this.segments=new xo,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){this.features=[],this.hasPattern=Fl("fill-extrusion",this.layers,e);for(const{feature:n,id:r,index:s,sourceLayerIndex:o}of t){const t=this.layers[0]._featureFilter.needGeometry,a=ia(n,t);if(!this.layers[0]._featureFilter.filter(new Hr(this.zoom),a,i))continue;const l={id:r,sourceLayerIndex:o,index:s,geometry:t?a.geometry:ea(n),properties:n.properties,type:n.type,patterns:{}};this.hasPattern?this.features.push(Rl("fill-extrusion",this.layers,l,this.zoom,e)):this.addFeature(l,l.geometry,s,i,{}),e.featureIndex.insert(n,l.geometry,s,o,this.index,!0)}}addFeatures(t,e,i){for(const t of this.features){const{geometry:n}=t;this.addFeature(t,n,t.index,e,i)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ul),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,$l.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,e,i,n,r){const s={x:0,y:0,vertexCount:0};for(const i of Pl(e,500)){let e=0;for(const t of i)e+=t.length;let n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const t of i){if(0===t.length)continue;if(lc(t))continue;let e=0;for(let i=0;i<t.length;i++){const r=t[i];if(i>=1){const o=t[i-1];if(!ac(r,o)){n.vertexLength+4>xo.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const t=r.sub(o)._perp()._unit(),i=o.dist(r);e+i>32768&&(e=0),sc(this.layoutVertexArray,r.x,r.y,t.x,t.y,0,0,e),sc(this.layoutVertexArray,r.x,r.y,t.x,t.y,0,1,e),s.x+=2*r.x,s.y+=2*r.y,s.vertexCount+=2,e+=i,sc(this.layoutVertexArray,o.x,o.y,t.x,t.y,0,0,e),sc(this.layoutVertexArray,o.x,o.y,t.x,t.y,0,1,e),s.x+=2*o.x,s.y+=2*o.y,s.vertexCount+=2;const a=n.vertexLength;this.indexArray.emplaceBack(a,a+2,a+1),this.indexArray.emplaceBack(a+1,a+2,a+3),n.vertexLength+=4,n.primitiveLength+=2}}}}if(n.vertexLength+e>xo.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray)),"Polygon"!==nc[t.type])continue;const r=[],o=[],a=n.vertexLength;for(const t of i)if(0!==t.length){t!==i[0]&&o.push(r.length/2);for(let e=0;e<t.length;e++){const i=t[e];sc(this.layoutVertexArray,i.x,i.y,0,0,1,1,0),s.x+=i.x,s.y+=i.y,s.vertexCount+=1,r.push(i.x),r.push(i.y)}}const l=Cl(r,o);for(let t=0;t<l.length;t+=3)this.indexArray.emplaceBack(a+l[t],a+l[t+2],a+l[t+1]);n.primitiveLength+=l.length/3,n.vertexLength+=e}for(let t=0;t<s.vertexCount;t++)this.centroidVertexArray.emplaceBack(Math.floor(s.x/s.vertexCount),Math.floor(s.y/s.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,r,n)}}function ac(t,e){return t.x===e.x&&(t.x<0||t.x>Jo)||t.y===e.y&&(t.y<0||t.y>Jo)}function lc(t){return t.every((t=>t.x<0))||t.every((t=>t.x>Jo))||t.every((t=>t.y<0))||t.every((t=>t.y>Jo))}let cc;Gn("FillExtrusionBucket",oc,{omit:["layers","features"]});var uc={get paint(){return cc=cc||new ls({"fill-extrusion-opacity":new ns(lt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new rs(lt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ns(lt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ns(lt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ss(lt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new rs(lt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new rs(lt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ns(lt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class hc extends us{constructor(t){super(t,uc)}createBucket(t){return new oc(t)}queryRadius(){return _a(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,e,i,n,r,o,a,l){const c=ya(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,a),u=this.paint.get("fill-extrusion-height").evaluate(e,i),h=this.paint.get("fill-extrusion-base").evaluate(e,i),d=function(t,e,i,n){const r=[];for(const i of t){const t=[i.x,i.y,0,1];Ra(t,t,e),r.push(new s(t[0]/t[3],t[1]/t[3]))}return r}(c,l),p=function(t,e,i,n){const r=[],o=[],a=n[8]*e,l=n[9]*e,c=n[10]*e,u=n[11]*e,h=n[8]*i,d=n[9]*i,p=n[10]*i,f=n[11]*i;for(const e of t){const t=[],i=[];for(const r of e){const e=r.x,o=r.y,m=n[0]*e+n[4]*o+n[12],g=n[1]*e+n[5]*o+n[13],_=n[2]*e+n[6]*o+n[14],y=n[3]*e+n[7]*o+n[15],x=_+c,v=y+u,b=m+h,w=g+d,k=_+p,S=y+f,T=new s((m+a)/v,(g+l)/v);T.z=x/v,t.push(T);const A=new s(b/S,w/S);A.z=k/S,i.push(A)}r.push(t),o.push(i)}return[r,o]}(n,h,u,l);return function(t,e,i){let n=1/0;aa(i,e)&&(n=pc(i,e[0]));for(let r=0;r<e.length;r++){const s=e[r],o=t[r];for(let t=0;t<s.length-1;t++){const e=s[t],r=[e,s[t+1],o[t+1],o[t],e];sa(i,r)&&(n=Math.min(n,pc(i,r)))}}return n!==1/0&&n}(p[0],p[1],d)}}function dc(t,e){return t.x*e.x+t.y*e.y}function pc(t,e){if(1===t.length){let i=0;const n=e[i++];let r;for(;!r||n.equals(r);)if(r=e[i++],!r)return 1/0;for(;i<e.length;i++){const s=e[i],o=t[0],a=r.sub(n),l=s.sub(n),c=o.sub(n),u=dc(a,a),h=dc(a,l),d=dc(l,l),p=dc(c,a),f=dc(c,l),m=u*d-h*h,g=(d*p-h*f)/m,_=(u*f-h*p)/m,y=n.z*(1-g-_)+r.z*g+s.z*_;if(isFinite(y))return y}return 1/0}{let t=1/0;for(const i of e)t=Math.min(t,i.z);return t}}const fc=fs([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:mc}=fc,gc=fs([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:_c}=gc,yc=Zl.VectorTileFeature.types,xc=Math.cos(Math.PI/180*37.5),vc=Math.pow(2,14)/.5;class bc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((t=>{this.gradients[t.id]={}})),this.layoutVertexArray=new no,this.layoutVertexArray2=new ro,this.indexArray=new fo,this.programConfigurations=new Xo(t.layers,t.zoom),this.segments=new xo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){this.hasPattern=Fl("line",this.layers,e);const n=this.layers[0].layout.get("line-sort-key"),r=!n.isConstant(),s=[];for(const{feature:e,id:o,index:a,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,c=ia(e,t);if(!this.layers[0]._featureFilter.filter(new Hr(this.zoom),c,i))continue;const u=r?n.evaluate(c,{},i):void 0,h={id:o,properties:e.properties,type:e.type,sourceLayerIndex:l,index:a,geometry:t?c.geometry:ea(e),patterns:{},sortKey:u};s.push(h)}r&&s.sort(((t,e)=>t.sortKey-e.sortKey));for(const n of s){const{geometry:r,index:s,sourceLayerIndex:o}=n;if(this.hasPattern){const t=Rl("line",this.layers,n,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(n,r,s,i,{});e.featureIndex.insert(t[s].feature,r,s,o,this.index)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}addFeatures(t,e,i){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,_c)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,mc),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,i,n,r){const s=this.layers[0].layout,o=s.get("line-join").evaluate(t,{}),a=s.get("line-cap"),l=s.get("line-miter-limit"),c=s.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const i of e)this.addLine(i,t,o,a,l,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,r,n)}addLine(t,e,i,n,r,s){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const o="Polygon"===yc[e.type];let a=t.length;for(;a>=2&&t[a-1].equals(t[a-2]);)a--;let l=0;for(;l<a-1&&t[l].equals(t[l+1]);)l++;if(a<(o?3:2))return;"bevel"===i&&(r=1.05);const c=this.overscaling<=16?15*Jo/(512*this.overscaling):0,u=this.segments.prepareSegment(10*a,this.layoutVertexArray,this.indexArray);let h,d,p,f,m;this.e1=this.e2=-1,o&&(h=t[a-2],m=t[l].sub(h)._unit()._perp());for(let e=l;e<a;e++){if(p=e===a-1?o?t[l+1]:void 0:t[e+1],p&&t[e].equals(p))continue;m&&(f=m),h&&(d=h),h=t[e],m=p?p.sub(h)._unit()._perp():f,f=f||m;let g=f.add(m);0===g.x&&0===g.y||g._unit();const _=f.x*m.x+f.y*m.y,y=g.x*m.x+g.y*m.y,x=0!==y?1/y:1/0,v=2*Math.sqrt(2-2*y),b=y<xc&&d&&p,w=f.x*m.y-f.y*m.x>0;if(b&&e>l){const t=h.dist(d);if(t>2*c){const e=h.sub(h.sub(d)._mult(c/t)._round());this.updateDistance(d,e),this.addCurrentVertex(e,f,0,0,u),d=e}}const k=d&&p;let S=k?i:o?"butt":n;if(k&&"round"===S&&(x<s?S="miter":x<=2&&(S="fakeround")),"miter"===S&&x>r&&(S="bevel"),"bevel"===S&&(x>2&&(S="flipbevel"),x<r&&(S="miter")),d&&this.updateDistance(d,h),"miter"===S)g._mult(x),this.addCurrentVertex(h,g,0,0,u);else if("flipbevel"===S){if(x>100)g=m.mult(-1);else{const t=x*f.add(m).mag()/f.sub(m).mag();g._perp()._mult(t*(w?-1:1))}this.addCurrentVertex(h,g,0,0,u),this.addCurrentVertex(h,g.mult(-1),0,0,u)}else if("bevel"===S||"fakeround"===S){const t=-Math.sqrt(x*x-1),e=w?t:0,i=w?0:t;if(d&&this.addCurrentVertex(h,f,e,i,u),"fakeround"===S){const t=Math.round(180*v/Math.PI/20);for(let e=1;e<t;e++){let i=e/t;if(.5!==i){const t=i-.5;i+=i*t*(i-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*t*t+(.848013+_*(.215638*_-1.06021)))}const n=m.sub(f)._mult(i)._add(f)._unit()._mult(w?-1:1);this.addHalfVertex(h,n.x,n.y,!1,w,0,u)}}p&&this.addCurrentVertex(h,m,-e,-i,u)}else if("butt"===S)this.addCurrentVertex(h,g,0,0,u);else if("square"===S){const t=d?1:-1;this.addCurrentVertex(h,g,t,t,u)}else"round"===S&&(d&&(this.addCurrentVertex(h,f,0,0,u),this.addCurrentVertex(h,f,1,1,u,!0)),p&&(this.addCurrentVertex(h,m,-1,-1,u,!0),this.addCurrentVertex(h,m,0,0,u)));if(b&&e<a-1){const t=h.dist(p);if(t>2*c){const e=h.add(p.sub(h)._mult(c/t)._round());this.updateDistance(h,e),this.addCurrentVertex(e,m,0,0,u),h=e}}}}addCurrentVertex(t,e,i,n,r,s=!1){const o=e.y*n-e.x,a=-e.y-e.x*n;this.addHalfVertex(t,e.x+e.y*i,e.y-e.x*i,s,!1,i,r),this.addHalfVertex(t,o,a,s,!0,-n,r),this.distance>vc/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,e,i,n,r,s))}addHalfVertex({x:t,y:e},i,n,r,s,o,a){const l=.5*(this.lineClips?this.scaledDistance*(vc-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(r?1:0),(e<<1)+(s?1:0),Math.round(63*i)+128,Math.round(63*n)+128,1+(0===o?0:o<0?-1:1)|(63&l)<<2,l>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const c=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,c),a.primitiveLength++),s?this.e2=c:this.e1=c}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}let wc,kc;Gn("LineBucket",bc,{omit:["layers","patternFeatures"]});var Sc={get paint(){return kc=kc||new ls({"line-opacity":new rs(lt.paint_line["line-opacity"]),"line-color":new rs(lt.paint_line["line-color"]),"line-translate":new ns(lt.paint_line["line-translate"]),"line-translate-anchor":new ns(lt.paint_line["line-translate-anchor"]),"line-width":new rs(lt.paint_line["line-width"]),"line-gap-width":new rs(lt.paint_line["line-gap-width"]),"line-offset":new rs(lt.paint_line["line-offset"]),"line-blur":new rs(lt.paint_line["line-blur"]),"line-dasharray":new os(lt.paint_line["line-dasharray"]),"line-pattern":new ss(lt.paint_line["line-pattern"]),"line-gradient":new as(lt.paint_line["line-gradient"])})},get layout(){return wc=wc||new ls({"line-cap":new ns(lt.layout_line["line-cap"]),"line-join":new rs(lt.layout_line["line-join"]),"line-miter-limit":new ns(lt.layout_line["line-miter-limit"]),"line-round-limit":new ns(lt.layout_line["line-round-limit"]),"line-sort-key":new rs(lt.layout_line["line-sort-key"])})}};class Tc extends rs{possiblyEvaluate(t,e){return e=new Hr(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,i,n){return e=_({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,i,n)}}let Ac;class Mc extends us{constructor(t){super(t,Sc),this.gradientVersion=0,Ac||(Ac=new Tc(Sc.paint.properties["line-width"].specification),Ac.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const t=this.gradientExpression();this.stepInterpolant=!!function(t){return void 0!==t._styleExpression}(t)&&t._styleExpression.expression instanceof ei,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=Ac.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new bc(t)}queryRadius(t){const e=t,i=Cc(ga("line-width",this,e),ga("line-gap-width",this,e)),n=ga("line-offset",this,e);return i/2+Math.abs(n)+_a(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,i,n,r,o,a){const l=ya(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,a),c=a/2*Cc(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),u=this.paint.get("line-offset").evaluate(e,i);return u&&(n=function(t,e){const i=[];for(let n=0;n<t.length;n++){const r=t[n],o=[];for(let t=0;t<r.length;t++){const i=r[t-1],n=r[t],a=r[t+1],l=0===t?new s(0,0):n.sub(i)._unit()._perp(),c=t===r.length-1?new s(0,0):a.sub(n)._unit()._perp(),u=l._add(c)._unit(),h=u.x*c.x+u.y*c.y;0!==h&&u._mult(1/h),o.push(u._mult(e)._add(n))}i.push(o)}return i}(n,u*a)),function(t,e,i){for(let n=0;n<e.length;n++){const r=e[n];if(t.length>=3)for(let e=0;e<r.length;e++)if(fa(t,r[e]))return!0;if(la(t,r,i))return!0}return!1}(l,n,c)}isTileClipped(){return!0}}function Cc(t,e){return e>0?e+2*t:t}const Ec=fs([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Ic=fs([{name:"a_projected_pos",components:3,type:"Float32"}],4);fs([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Dc=fs([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);fs([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const zc=fs([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Pc=fs([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Lc(t,e,i){return t.sections.forEach((t=>{t.text=function(t,e,i){const n=e.layout.get("text-transform").evaluate(i,{});return"uppercase"===n?t=t.toLocaleUpperCase():"lowercase"===n&&(t=t.toLocaleLowerCase()),t}(t.text,e,i)})),t}fs([{name:"triangle",components:3,type:"Uint16"}]),fs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),fs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),fs([{type:"Float32",name:"offsetX"}]),fs([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),fs([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Fc={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Rc=Vc,Oc=function(t,e,i,n,r){var s,o,a=8*r-n-1,l=(1<<a)-1,c=l>>1,u=-7,h=i?r-1:0,d=i?-1:1,p=t[e+h];for(h+=d,s=p&(1<<-u)-1,p>>=-u,u+=a;u>0;s=256*s+t[e+h],h+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;u>0;o=256*o+t[e+h],h+=d,u-=8);if(0===s)s=1-c;else{if(s===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),s-=c}return(p?-1:1)*o*Math.pow(2,s-n)},Bc=function(t,e,i,n,r,s){var o,a,l,c=8*s-r-1,u=(1<<c)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,f=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),(e+=o+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(o++,l/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(e*l-1)*Math.pow(2,r),o+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;t[i+p]=255&a,p+=f,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;t[i+p]=255&o,p+=f,o/=256,c-=8);t[i+p-f]|=128*m};function Vc(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Vc.Varint=0,Vc.Fixed64=1,Vc.Bytes=2,Vc.Fixed32=5;var Nc=4294967296,qc=1/Nc,jc="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function $c(t){return t.type===Vc.Bytes?t.readVarint()+t.pos:t.pos+1}function Uc(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Zc(t,e,i){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(n);for(var r=i.pos-1;r>=t;r--)i.buf[r+n]=i.buf[r]}function Wc(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function Gc(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function Hc(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function Xc(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function Yc(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function Kc(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function Jc(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function Qc(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function tu(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function eu(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function iu(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function nu(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Vc.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),r=n>>3,s=this.pos;this.type=7&n,t(r,e,this),this.pos===s&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=eu(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=nu(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=eu(this.buf,this.pos)+eu(this.buf,this.pos+4)*Nc;return this.pos+=8,t},readSFixed64:function(){var t=eu(this.buf,this.pos)+nu(this.buf,this.pos+4)*Nc;return this.pos+=8,t},readFloat:function(){var t=Oc(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Oc(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,n=this.buf;return e=127&(i=n[this.pos++]),i<128?e:(e|=(127&(i=n[this.pos++]))<<7,i<128?e:(e|=(127&(i=n[this.pos++]))<<14,i<128?e:(e|=(127&(i=n[this.pos++]))<<21,i<128?e:function(t,e,i){var n,r,s=i.buf;if(n=(112&(r=s[i.pos++]))>>4,r<128)return Uc(t,n,e);if(n|=(127&(r=s[i.pos++]))<<3,r<128)return Uc(t,n,e);if(n|=(127&(r=s[i.pos++]))<<10,r<128)return Uc(t,n,e);if(n|=(127&(r=s[i.pos++]))<<17,r<128)return Uc(t,n,e);if(n|=(127&(r=s[i.pos++]))<<24,r<128)return Uc(t,n,e);if(n|=(1&(r=s[i.pos++]))<<31,r<128)return Uc(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&jc?function(t,e,i){return jc.decode(t.subarray(e,i))}(this.buf,e,t):function(t,e,i){for(var n="",r=e;r<i;){var s,o,a,l=t[r],c=null,u=l>239?4:l>223?3:l>191?2:1;if(r+u>i)break;1===u?l<128&&(c=l):2===u?128==(192&(s=t[r+1]))&&(c=(31&l)<<6|63&s)<=127&&(c=null):3===u?(o=t[r+2],128==(192&(s=t[r+1]))&&128==(192&o)&&((c=(15&l)<<12|(63&s)<<6|63&o)<=2047||c>=55296&&c<=57343)&&(c=null)):4===u&&(o=t[r+2],a=t[r+3],128==(192&(s=t[r+1]))&&128==(192&o)&&128==(192&a)&&((c=(15&l)<<18|(63&s)<<12|(63&o)<<6|63&a)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,u=1):c>65535&&(c-=65536,n+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),n+=String.fromCharCode(c),r+=u}return n}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Vc.Bytes)return t.push(this.readVarint(e));var i=$c(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Vc.Bytes)return t.push(this.readSVarint());var e=$c(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Vc.Bytes)return t.push(this.readBoolean());var e=$c(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Vc.Bytes)return t.push(this.readFloat());var e=$c(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Vc.Bytes)return t.push(this.readDouble());var e=$c(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Vc.Bytes)return t.push(this.readFixed32());var e=$c(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Vc.Bytes)return t.push(this.readSFixed32());var e=$c(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Vc.Bytes)return t.push(this.readFixed64());var e=$c(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Vc.Bytes)return t.push(this.readSFixed64());var e=$c(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Vc.Varint)for(;this.buf[this.pos++]>127;);else if(e===Vc.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Vc.Fixed32)this.pos+=4;else{if(e!==Vc.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),iu(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),iu(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),iu(this.buf,-1&t,this.pos),iu(this.buf,Math.floor(t*qc),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),iu(this.buf,-1&t,this.pos),iu(this.buf,Math.floor(t*qc),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var i,n;if(t>=0?(i=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,n=n+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,i.buf[i.pos]=127&(t>>>=7)}(i,0,e),function(t,e){var i=(7&t)<<4;e.buf[e.pos++]|=i|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var n,r,s=0;s<e.length;s++){if((n=e.charCodeAt(s))>55295&&n<57344){if(!r){n>56319||s+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):r=n;continue}if(n<56320){t[i++]=239,t[i++]=191,t[i++]=189,r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&(t[i++]=239,t[i++]=191,t[i++]=189,r=null);n<128?t[i++]=n:(n<2048?t[i++]=n>>6|192:(n<65536?t[i++]=n>>12|224:(t[i++]=n>>18|240,t[i++]=n>>12&63|128),t[i++]=n>>6&63|128),t[i++]=63&n|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&Zc(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),Bc(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Bc(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var n=this.pos-i;n>=128&&Zc(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,i){this.writeTag(t,Vc.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Wc,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Gc,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Yc,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Hc,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Xc,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Kc,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Jc,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Qc,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,tu,e)},writeBytesField:function(t,e){this.writeTag(t,Vc.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Vc.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Vc.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Vc.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Vc.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Vc.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Vc.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Vc.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Vc.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Vc.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var ru=i(Rc);function su(t,e,i){1===t&&i.readMessage(ou,e)}function ou(t,e,i){if(3===t){const{id:t,bitmap:n,width:r,height:s,left:o,top:a,advance:l}=i.readMessage(au,{});e.push({id:t,bitmap:new Wa({width:r+6,height:s+6},n),metrics:{width:r,height:s,left:o,top:a,advance:l}})}}function au(t,e,i){1===t?e.id=i.readVarint():2===t?e.bitmap=i.readBytes():3===t?e.width=i.readVarint():4===t?e.height=i.readVarint():5===t?e.left=i.readSVarint():6===t?e.top=i.readSVarint():7===t&&(e.advance=i.readVarint())}function lu(t){let e=0,i=0;for(const n of t)e+=n.w*n.h,i=Math.max(i,n.w);t.sort(((t,e)=>e.h-t.h));const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let r=0,s=0;for(const e of t)for(let t=n.length-1;t>=0;t--){const i=n[t];if(!(e.w>i.w||e.h>i.h)){if(e.x=i.x,e.y=i.y,s=Math.max(s,e.y+e.h),r=Math.max(r,e.x+e.w),e.w===i.w&&e.h===i.h){const e=n.pop();t<n.length&&(n[t]=e)}else e.h===i.h?(i.x+=e.w,i.w-=e.w):e.w===i.w?(i.y+=e.h,i.h-=e.h):(n.push({x:i.x+e.w,y:i.y,w:i.w-e.w,h:e.h}),i.y+=e.h,i.h-=e.h);break}}return{w:r,h:s,fill:e/(r*s)||0}}class cu{constructor(t,{pixelRatio:e,version:i,stretchX:n,stretchY:r,content:s}){this.paddedRect=t,this.pixelRatio=e,this.stretchX=n,this.stretchY=r,this.content=s,this.version=i}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}var uu;function hu(t){let e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}Gn("ImagePosition",cu),Gn("ImageAtlas",class{constructor(t,e){const i={},n={};this.haveRenderCallbacks=[];const r=[];this.addImages(t,i,r),this.addImages(e,n,r);const{w:s,h:o}=lu(r),a=new Ga({width:s||1,height:o||1});for(const e in t){const n=t[e],r=i[e].paddedRect;Ga.copy(n.data,a,{x:0,y:0},{x:r.x+1,y:r.y+1},n.data)}for(const t in e){const i=e[t],r=n[t].paddedRect,s=r.x+1,o=r.y+1,l=i.data.width,c=i.data.height;Ga.copy(i.data,a,{x:0,y:0},{x:s,y:o},i.data),Ga.copy(i.data,a,{x:0,y:c-1},{x:s,y:o-1},{width:l,height:1}),Ga.copy(i.data,a,{x:0,y:0},{x:s,y:o+c},{width:l,height:1}),Ga.copy(i.data,a,{x:l-1,y:0},{x:s-1,y:o},{width:1,height:c}),Ga.copy(i.data,a,{x:0,y:0},{x:s+l,y:o},{width:1,height:c})}this.image=a,this.iconPositions=i,this.patternPositions=n}addImages(t,e,i){for(const n in t){const r=t[n],s={x:0,y:0,w:r.data.width+2,h:r.data.height+2};i.push(s),e[n]=new cu(s,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}patchUpdatedImages(t,e){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const i in t.updatedImages)this.patchUpdatedImage(this.iconPositions[i],t.getImage(i),e),this.patchUpdatedImage(this.patternPositions[i],t.getImage(i),e)}patchUpdatedImage(t,e,i){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[n,r]=t.tl;i.update(e.data,void 0,{x:n,y:r})}}),function(t){t[t.none=0]="none",t[t.horizontal=1]="horizontal",t[t.vertical=2]="vertical",t[t.horizontalOnly=3]="horizontalOnly"}(uu||(uu={}));const du=128;function pu(t,e){const{expression:i}=e;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new Hr(t+1))};if("source"===i.kind)return{kind:"source"};{const{zoomStops:e,interpolationType:n}=i;let r=0;for(;r<e.length&&e[r]<=t;)r++;r=Math.max(0,r-1);let s=r;for(;s<e.length&&e[s]<t+1;)s++;s=Math.min(e.length-1,s);const o=e[r],a=e[s];return"composite"===i.kind?{kind:"composite",minZoom:o,maxZoom:a,interpolationType:n}:{kind:"camera",minZoom:o,maxZoom:a,minSize:i.evaluate(new Hr(o)),maxSize:i.evaluate(new Hr(a)),interpolationType:n}}}function fu(t,{uSize:e,uSizeT:i},{lowerSize:n,upperSize:r}){return"source"===t.kind?n/du:"composite"===t.kind?ri.number(n/du,r/du,i):e}function mu(t,e){let i=0,n=0;if("constant"===t.kind)n=t.layoutSize;else if("source"!==t.kind){const{interpolationType:r,minZoom:s,maxZoom:o}=t,a=r?f(si.interpolationFactor(r,e,s,o),0,1):0;"camera"===t.kind?n=ri.number(t.minSize,t.maxSize,a):i=a}return{uSizeT:i,uSize:n}}function gu(t,e,i){let n="never";const r=t.get(e);return r?n=r:t.get(i)&&(n="always"),n}const _u=Zl.VectorTileFeature.types,yu=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function xu(t,e,i,n,r,s,o,a,l,c,u,h,d){const p=a?Math.min(32640,Math.round(a[0])):0,f=a?Math.min(32640,Math.round(a[1])):0;t.emplaceBack(e,i,Math.round(32*n),Math.round(32*r),s,o,(p<<1)+(l?1:0),f,16*c,16*u,256*h,256*d)}function vu(t,e,i){t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i)}function bu(t){for(const e of t.sections)if(Fr(e.text))return!0;return!1}class wu{constructor(t){this.layoutVertexArray=new oo,this.indexArray=new fo,this.programConfigurations=t,this.segments=new xo,this.dynamicLayoutVertexArray=new ao,this.opacityVertexArray=new lo,this.hasVisibleVertices=!1,this.placedSymbolArray=new js}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(t,e,i,n){this.isEmpty()||(i&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ec.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Ic.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,yu,!0),this.opacityVertexBuffer.itemSize=1),(i||n)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Gn("SymbolBuffers",wu);class ku{constructor(t,e,i){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new i,this.segments=new xo,this.collisionVertexArray=new ho}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Dc.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Gn("CollisionBuffers",ku);class Su{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ta([]),this.placementViewportMatrix=Ta([]);const e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=pu(this.zoom,e["text-size"]),this.iconSizeData=pu(this.zoom,e["icon-size"]);const i=this.layers[0].layout,n=i.get("symbol-sort-key"),r=i.get("symbol-z-order");this.canOverlap="never"!==gu(i,"text-overlap","text-allow-overlap")||"never"!==gu(i,"icon-overlap","icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==r&&!n.isConstant(),this.sortFeaturesByY=("viewport-y"===r||"auto"===r&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===i.get("symbol-placement")&&(this.writingModes=i.get("text-writing-mode").map((t=>uu[t]))),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.sourceID=t.sourceID}createArrays(){this.text=new wu(new Xo(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new wu(new Xo(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new Zs,this.lineVertexArray=new Ws,this.symbolInstances=new Us,this.textAnchorOffsets=new Hs}calculateGlyphDependencies(t,e,i,n,r){for(let s=0;s<t.length;s++)if(e[t.charCodeAt(s)]=!0,(i||n)&&r){const i=Fc[t.charAt(s)];i&&(e[i.charCodeAt(0)]=!0)}}populate(t,e,i){const n=this.layers[0],r=n.layout,s=r.get("text-font"),o=r.get("text-field"),a=r.get("icon-image"),l=("constant"!==o.value.kind||o.value.value instanceof de&&!o.value.value.isEmpty()||o.value.value.toString().length>0)&&("constant"!==s.value.kind||s.value.value.length>0),c="constant"!==a.value.kind||!!a.value.value||Object.keys(a.parameters).length>0,u=r.get("symbol-sort-key");if(this.features=[],!l&&!c)return;const h=e.iconDependencies,d=e.glyphDependencies,p=e.availableImages,f=new Hr(this.zoom);for(const{feature:e,id:o,index:a,sourceLayerIndex:m}of t){const t=n._featureFilter.needGeometry,g=ia(e,t);if(!n._featureFilter.filter(f,g,i))continue;let _,y;if(t||(g.geometry=ea(e)),l){const t=n.getValueAndResolveTokens("text-field",g,i,p),e=de.factory(t);bu(e)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Zr()||this.hasRTLText&&Gr.isParsed())&&(_=Lc(e,n,g))}if(c){const t=n.getValueAndResolveTokens("icon-image",g,i,p);y=t instanceof ge?t:ge.fromString(t)}if(!_&&!y)continue;const x=this.sortFeaturesByKey?u.evaluate(g,{},i):void 0;if(this.features.push({id:o,text:_,icon:y,index:a,sourceLayerIndex:m,geometry:g.geometry,properties:e.properties,type:_u[e.type],sortKey:x}),y&&(h[y.name]=!0),_){const t=s.evaluate(g,{},i).join(","),e="viewport"!==r.get("text-rotation-alignment")&&"point"!==r.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(uu.vertical)>=0;for(const i of _.sections)if(i.image)h[i.image.name]=!0;else{const n=Dr(_.toString()),r=i.fontStack||t,s=d[r]=d[r]||{};this.calculateGlyphDependencies(i.text,s,e,this.allowVerticalPlacement,n)}}}"line"===r.get("symbol-placement")&&(this.features=function(t){const e={},i={},n=[];let r=0;function s(e){n.push(t[e]),r++}function o(t,e,r){const s=i[t];return delete i[t],i[e]=s,n[s].geometry[0].pop(),n[s].geometry[0]=n[s].geometry[0].concat(r[0]),s}function a(t,i,r){const s=e[i];return delete e[i],e[t]=s,n[s].geometry[0].shift(),n[s].geometry[0]=r[0].concat(n[s].geometry[0]),s}function l(t,e,i){const n=i?e[0][e[0].length-1]:e[0][0];return`${t}:${n.x}:${n.y}`}for(let c=0;c<t.length;c++){const u=t[c],h=u.geometry,d=u.text?u.text.toString():null;if(!d){s(c);continue}const p=l(d,h),f=l(d,h,!0);if(p in i&&f in e&&i[p]!==e[f]){const t=a(p,f,h),r=o(p,f,n[t].geometry);delete e[p],delete i[f],i[l(d,n[r].geometry,!0)]=r,n[t].geometry=null}else p in i?o(p,f,h):f in e?a(p,f,h):(s(c),e[p]=r-1,i[f]=r-1)}return n.filter((t=>t.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((t,e)=>t.sortKey-e.sortKey))}update(t,e,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,i),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,i))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,e){const i=this.lineVertexArray.length;if(void 0!==t.segment){let i=t.dist(e[t.segment+1]),n=t.dist(e[t.segment]);const r={};for(let n=t.segment+1;n<e.length;n++)r[n]={x:e[n].x,y:e[n].y,tileUnitDistanceFromAnchor:i},n<e.length-1&&(i+=e[n+1].dist(e[n]));for(let i=t.segment||0;i>=0;i--)r[i]={x:e[i].x,y:e[i].y,tileUnitDistanceFromAnchor:n},i>0&&(n+=e[i-1].dist(e[i]));for(let t=0;t<e.length;t++){const e=r[t];this.lineVertexArray.emplaceBack(e.x,e.y,e.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}}addSymbols(t,e,i,n,r,s,o,a,l,c,u,h){const d=t.indexArray,p=t.layoutVertexArray,f=t.segments.prepareSegment(4*e.length,p,d,this.canOverlap?s.sortKey:void 0),m=this.glyphOffsetArray.length,g=f.vertexLength,_=this.allowVerticalPlacement&&o===uu.vertical?Math.PI/2:0,y=s.text&&s.text.sections;for(let n=0;n<e.length;n++){const{tl:r,tr:o,bl:l,br:c,tex:u,pixelOffsetTL:m,pixelOffsetBR:g,minFontScaleX:x,minFontScaleY:v,glyphOffset:b,isSDF:w,sectionIndex:k}=e[n],S=f.vertexLength,T=b[1];xu(p,a.x,a.y,r.x,T+r.y,u.x,u.y,i,w,m.x,m.y,x,v),xu(p,a.x,a.y,o.x,T+o.y,u.x+u.w,u.y,i,w,g.x,m.y,x,v),xu(p,a.x,a.y,l.x,T+l.y,u.x,u.y+u.h,i,w,m.x,g.y,x,v),xu(p,a.x,a.y,c.x,T+c.y,u.x+u.w,u.y+u.h,i,w,g.x,g.y,x,v),vu(t.dynamicLayoutVertexArray,a,_),d.emplaceBack(S,S+1,S+2),d.emplaceBack(S+1,S+2,S+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(b[0]),n!==e.length-1&&k===e[n+1].sectionIndex||t.programConfigurations.populatePaintArrays(p.length,s,s.index,{},h,y&&y[k])}t.placedSymbolArray.emplaceBack(a.x,a.y,m,this.glyphOffsetArray.length-m,g,l,c,a.segment,i?i[0]:0,i?i[1]:0,n[0],n[1],o,0,!1,0,u)}_addCollisionDebugVertex(t,e,i,n,r,s){return e.emplaceBack(0,0),t.emplaceBack(i.x,i.y,n,r,Math.round(s.x),Math.round(s.y))}addCollisionDebugVertices(t,e,i,n,r,o,a){const l=r.segments.prepareSegment(4,r.layoutVertexArray,r.indexArray),c=l.vertexLength,u=r.layoutVertexArray,h=r.collisionVertexArray,d=a.anchorX,p=a.anchorY;this._addCollisionDebugVertex(u,h,o,d,p,new s(t,e)),this._addCollisionDebugVertex(u,h,o,d,p,new s(i,e)),this._addCollisionDebugVertex(u,h,o,d,p,new s(i,n)),this._addCollisionDebugVertex(u,h,o,d,p,new s(t,n)),l.vertexLength+=4;const f=r.indexArray;f.emplaceBack(c,c+1),f.emplaceBack(c+1,c+2),f.emplaceBack(c+2,c+3),f.emplaceBack(c+3,c),l.primitiveLength+=4}addDebugCollisionBoxes(t,e,i,n){for(let r=t;r<e;r++){const t=this.collisionBoxArray.get(r);this.addCollisionDebugVertices(t.x1,t.y1,t.x2,t.y2,n?this.textCollisionBox:this.iconCollisionBox,t.anchorPoint,i)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ku(co,zc.members,mo),this.iconCollisionBox=new ku(co,zc.members,mo);for(let t=0;t<this.symbolInstances.length;t++){const e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}}_deserializeCollisionBoxesForSymbol(t,e,i,n,r,s,o,a,l){const c={};for(let n=e;n<i;n++){const e=t.get(n);c.textBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.textFeatureIndex=e.featureIndex;break}for(let e=n;e<r;e++){const i=t.get(e);c.verticalTextBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},c.verticalTextFeatureIndex=i.featureIndex;break}for(let e=s;e<o;e++){const i=t.get(e);c.iconBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},c.iconFeatureIndex=i.featureIndex;break}for(let e=a;e<l;e++){const i=t.get(e);c.verticalIconBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},c.verticalIconFeatureIndex=i.featureIndex;break}return c}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const i=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,e){const i=t.placedSymbolArray.get(e),n=i.vertexStartIndex+4*i.numGlyphs;for(let e=i.vertexStartIndex;e<n;e+=4)t.indexArray.emplaceBack(e,e+1,e+2),t.indexArray.emplaceBack(e+1,e+2,e+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),i=Math.cos(t),n=[],r=[],s=[];for(let t=0;t<this.symbolInstances.length;++t){s.push(t);const o=this.symbolInstances.get(t);n.push(0|Math.round(e*o.anchorX+i*o.anchorY)),r.push(o.featureIndex)}return s.sort(((t,e)=>n[t]-n[e]||r[e]-r[t])),s}addToSortKeyRanges(t,e){const i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===e?i.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex),[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach(((t,e,i)=>{t>=0&&i.indexOf(t)===e&&this.addIndicesForPlacedSymbol(this.text,t)})),e.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,e.verticalPlacedTextSymbolIndex),e.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.placedIconSymbolIndex),e.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Tu,Au;Gn("SymbolBucket",Su,{omit:["layers","collisionBoxArray","features","compareText"]}),Su.MAX_GLYPHS=65535,Su.addDynamicAttributes=vu;var Mu={get paint(){return Au=Au||new ls({"icon-opacity":new rs(lt.paint_symbol["icon-opacity"]),"icon-color":new rs(lt.paint_symbol["icon-color"]),"icon-halo-color":new rs(lt.paint_symbol["icon-halo-color"]),"icon-halo-width":new rs(lt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new rs(lt.paint_symbol["icon-halo-blur"]),"icon-translate":new ns(lt.paint_symbol["icon-translate"]),"icon-translate-anchor":new ns(lt.paint_symbol["icon-translate-anchor"]),"text-opacity":new rs(lt.paint_symbol["text-opacity"]),"text-color":new rs(lt.paint_symbol["text-color"],{runtimeType:Et,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new rs(lt.paint_symbol["text-halo-color"]),"text-halo-width":new rs(lt.paint_symbol["text-halo-width"]),"text-halo-blur":new rs(lt.paint_symbol["text-halo-blur"]),"text-translate":new ns(lt.paint_symbol["text-translate"]),"text-translate-anchor":new ns(lt.paint_symbol["text-translate-anchor"])})},get layout(){return Tu=Tu||new ls({"symbol-placement":new ns(lt.layout_symbol["symbol-placement"]),"symbol-spacing":new ns(lt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ns(lt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new rs(lt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ns(lt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ns(lt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ns(lt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ns(lt.layout_symbol["icon-ignore-placement"]),"icon-optional":new ns(lt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ns(lt.layout_symbol["icon-rotation-alignment"]),"icon-size":new rs(lt.layout_symbol["icon-size"]),"icon-text-fit":new ns(lt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ns(lt.layout_symbol["icon-text-fit-padding"]),"icon-image":new rs(lt.layout_symbol["icon-image"]),"icon-rotate":new rs(lt.layout_symbol["icon-rotate"]),"icon-padding":new rs(lt.layout_symbol["icon-padding"]),"icon-keep-upright":new ns(lt.layout_symbol["icon-keep-upright"]),"icon-offset":new rs(lt.layout_symbol["icon-offset"]),"icon-anchor":new rs(lt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ns(lt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ns(lt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ns(lt.layout_symbol["text-rotation-alignment"]),"text-field":new rs(lt.layout_symbol["text-field"]),"text-font":new rs(lt.layout_symbol["text-font"]),"text-size":new rs(lt.layout_symbol["text-size"]),"text-max-width":new rs(lt.layout_symbol["text-max-width"]),"text-line-height":new ns(lt.layout_symbol["text-line-height"]),"text-letter-spacing":new rs(lt.layout_symbol["text-letter-spacing"]),"text-justify":new rs(lt.layout_symbol["text-justify"]),"text-radial-offset":new rs(lt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ns(lt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new rs(lt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new rs(lt.layout_symbol["text-anchor"]),"text-max-angle":new ns(lt.layout_symbol["text-max-angle"]),"text-writing-mode":new ns(lt.layout_symbol["text-writing-mode"]),"text-rotate":new rs(lt.layout_symbol["text-rotate"]),"text-padding":new ns(lt.layout_symbol["text-padding"]),"text-keep-upright":new ns(lt.layout_symbol["text-keep-upright"]),"text-transform":new rs(lt.layout_symbol["text-transform"]),"text-offset":new rs(lt.layout_symbol["text-offset"]),"text-allow-overlap":new ns(lt.layout_symbol["text-allow-overlap"]),"text-overlap":new ns(lt.layout_symbol["text-overlap"]),"text-ignore-placement":new ns(lt.layout_symbol["text-ignore-placement"]),"text-optional":new ns(lt.layout_symbol["text-optional"])})}};class Cu{constructor(t){if(void 0===t.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Tt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Gn("FormatSectionOverride",Cu,{omit:["defaultValue"]});class Eu extends us{constructor(t){super(t,Mu)}recalculate(t,e){if(super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const t=this.layout.get("text-writing-mode");if(t){const e=[];for(const i of t)e.indexOf(i)<0&&e.push(i);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,e,i,n){const r=this.layout.get(t).evaluate(e,{},i,n),s=this._unevaluatedLayout._values[t];return s.isDataDriven()||Hi(s.value)||!r?r:function(t,e){return e.replace(/{([^{}]+)}/g,((e,i)=>t&&i in t?String(t[i]):""))}(e.properties,r)}createBucket(t){return new Su(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Mu.paint.overridableProperties){if(!Eu.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),i=new Cu(e),n=new Gi(i,e.property.specification);let r=null;r="constant"===e.value.kind||"source"===e.value.kind?new Yi("source",n):new Ki("composite",n,e.value.zoomStops),this.paint._values[t]=new es(e.property,r,e.parameters)}}_handleOverridablePaintPropertyUpdate(t,e,i){return!(!this.layout||e.isDataDriven()||i.isDataDriven())&&Eu.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const i=t.get("text-field"),n=Mu.paint.properties[e];let r=!1;const s=t=>{for(const e of t)if(n.overrides&&n.overrides.hasOverride(e))return void(r=!0)};if("constant"===i.value.kind&&i.value.value instanceof de)s(i.value.value.sections);else if("source"===i.value.kind){const t=e=>{r||(e instanceof be&&xe(e.value)===Pt?s(e.value.sections):e instanceof Ti?s(e.sections):e.eachChild(t))},e=i.value;e._styleExpression&&t(e._styleExpression.expression)}return r}}let Iu;var Du={get paint(){return Iu=Iu||new ls({"background-color":new ns(lt.paint_background["background-color"]),"background-pattern":new os(lt.paint_background["background-pattern"]),"background-opacity":new ns(lt.paint_background["background-opacity"])})}};class zu extends us{constructor(t){super(t,Du)}}let Pu;var Lu={get paint(){return Pu=Pu||new ls({"raster-opacity":new ns(lt.paint_raster["raster-opacity"]),"raster-hue-rotate":new ns(lt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ns(lt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ns(lt.paint_raster["raster-brightness-max"]),"raster-saturation":new ns(lt.paint_raster["raster-saturation"]),"raster-contrast":new ns(lt.paint_raster["raster-contrast"]),"raster-resampling":new ns(lt.paint_raster["raster-resampling"]),"raster-fade-duration":new ns(lt.paint_raster["raster-fade-duration"])})}};class Fu extends us{constructor(t){super(t,Lu)}}class Ru extends us{constructor(t){super(t,{}),this.onAdd=t=>{this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},this.onRemove=t=>{this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},this.implementation=t}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}function Ou(t){if("custom"===t.type)return new Ru(t);switch(t.type){case"background":return new zu(t);case"circle":return new Ba(t);case"fill":return new ql(t);case"fill-extrusion":return new hc(t);case"heatmap":return new Xa(t);case"hillshade":return new Ja(t);case"line":return new Mc(t);case"raster":return new Fu(t);case"symbol":return new Eu(t)}}function Bu(t){const e=[];if("string"==typeof t)e.push({id:"default",url:t});else if(t&&t.length>0){const i=[];for(const{id:n,url:r}of t){const t=`${n}${r}`;-1===i.indexOf(t)&&(i.push(t),e.push({id:n,url:r}))}}return e}function Vu(t,e,i,n,r){if(n)return void t(n);if(r!==Object.values(e).length||r!==Object.values(i).length)return;const s={};for(const t in e){s[t]={};const n=R.getImageCanvasContext(i[t]),r=e[t];for(const e in r){const{width:i,height:o,x:a,y:l,sdf:c,pixelRatio:u,stretchX:h,stretchY:d,content:p}=r[e];s[t][e]={data:null,pixelRatio:u,sdf:c,stretchX:h,stretchY:d,content:p,spriteData:{width:i,height:o,x:a,y:l,context:n}}}}t(null,s)}class Nu{constructor(t,e,i,n){this.context=t,this.format=i,this.texture=t.gl.createTexture(),this.update(e,n)}update(t,e,i){const{width:n,height:r}=t,s=!(this.size&&this.size[0]===n&&this.size[1]===r||i),{context:o}=this,{gl:a}=o;if(this.useMipmap=Boolean(e&&e.useMipmap),a.bindTexture(a.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===a.RGBA&&(!e||!1!==e.premultiply)),s)this.size=[n,r],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||z(t)?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,t):a.texImage2D(a.TEXTURE_2D,0,this.format,n,r,0,this.format,a.UNSIGNED_BYTE,t.data);else{const{x:e,y:s}=i||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||z(t)?a.texSubImage2D(a.TEXTURE_2D,0,e,s,a.RGBA,a.UNSIGNED_BYTE,t):a.texSubImage2D(a.TEXTURE_2D,0,e,s,n,r,a.RGBA,a.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&a.generateMipmap(a.TEXTURE_2D)}bind(t,e,i){const{context:n}=this,{gl:r}=n;r.bindTexture(r.TEXTURE_2D,this.texture),i!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=r.LINEAR),t!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,i||t),this.filter=t),e!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e),this.wrap=e)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function qu(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class ju extends at{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new Ga({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:t,callback:e}of this.requestors)this._notify(t,e);this.requestors=[]}}getImage(t){const e=this.images[t];if(e&&!e.data&&e.spriteData){const t=e.spriteData;e.data=new Ga({width:t.width,height:t.height},t.context.getImageData(t.x,t.y,t.width,t.height).data),e.spriteData=null}return e}addImage(t,e){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,e)&&(this.images[t]=e)}_validate(t,e){let i=!0;const n=e.data||e.spriteData;return this._validateStretch(e.stretchX,n&&n.width)||(this.fire(new ot(new Error(`Image "${t}" has invalid "stretchX" value`))),i=!1),this._validateStretch(e.stretchY,n&&n.height)||(this.fire(new ot(new Error(`Image "${t}" has invalid "stretchY" value`))),i=!1),this._validateContent(e.content,e)||(this.fire(new ot(new Error(`Image "${t}" has invalid "content" value`))),i=!1),i}_validateStretch(t,e){if(!t)return!0;let i=0;for(const n of t){if(n[0]<i||n[1]<n[0]||e<n[1])return!1;i=n[1]}return!0}_validateContent(t,e){if(!t)return!0;if(4!==t.length)return!1;const i=e.spriteData,n=i&&i.width||e.data.width,r=i&&i.height||e.data.height;return!(t[0]<0||n<t[0]||t[1]<0||r<t[1]||t[2]<0||n<t[2]||t[3]<0||r<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,e,i=!0){const n=this.getImage(t);if(i&&(n.data.width!==e.data.width||n.data.height!==e.data.height))throw new Error(`size mismatch between old image (${n.data.width}x${n.data.height}) and new image (${e.data.width}x${e.data.height}).`);e.version=n.version+1,this.images[t]=e,this.updatedImages[t]=!0}removeImage(t){const e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,e){let i=!0;if(!this.isLoaded())for(const e of t)this.images[e]||(i=!1);this.isLoaded()||i?this._notify(t,e):this.requestors.push({ids:t,callback:e})}_notify(t,e){const i={};for(const e of t){let t=this.getImage(e);t||(this.fire(new st("styleimagemissing",{id:e})),t=this.getImage(e)),t?i[e]={data:t.data.clone(),pixelRatio:t.pixelRatio,sdf:t.sdf,version:t.version,stretchX:t.stretchX,stretchY:t.stretchY,content:t.content,hasRenderCallback:Boolean(t.userImage&&t.userImage.render)}:A(`Image "${e}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}e(null,i)}getPixelSize(){const{width:t,height:e}=this.atlasImage;return{width:t,height:e}}getPattern(t){const e=this.patterns[t],i=this.getImage(t);if(!i)return null;if(e&&e.position.version===i.version)return e.position;if(e)e.position.version=i.version;else{const e={w:i.data.width+2,h:i.data.height+2,x:0,y:0},n=new cu(e,i);this.patterns[t]={bin:e,position:n}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const e=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Nu(t,this.atlasImage,e.RGBA),this.atlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const e in this.patterns)t.push(this.patterns[e].bin);const{w:e,h:i}=lu(t),n=this.atlasImage;n.resize({width:e||1,height:i||1});for(const t in this.patterns){const{bin:e}=this.patterns[t],i=e.x+1,r=e.y+1,s=this.getImage(t).data,o=s.width,a=s.height;Ga.copy(s,n,{x:0,y:0},{x:i,y:r},{width:o,height:a}),Ga.copy(s,n,{x:0,y:a-1},{x:i,y:r-1},{width:o,height:1}),Ga.copy(s,n,{x:0,y:0},{x:i,y:r+a},{width:o,height:1}),Ga.copy(s,n,{x:o-1,y:0},{x:i-1,y:r},{width:1,height:a}),Ga.copy(s,n,{x:0,y:0},{x:i+o,y:r},{width:1,height:a})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const e of t){if(this.callbackDispatchedThisFrame[e])continue;this.callbackDispatchedThisFrame[e]=!0;const t=this.getImage(e);t||A(`Image with ID: "${e}" was not found`),qu(t)&&this.updateImage(e,t)}}}const $u=1e20;function Uu(t,e,i,n,r,s,o,a,l){for(let c=e;c<e+n;c++)Zu(t,i*s+c,s,r,o,a,l);for(let c=i;c<i+r;c++)Zu(t,c*s+e,1,n,o,a,l)}function Zu(t,e,i,n,r,s,o){s[0]=0,o[0]=-$u,o[1]=$u,r[0]=t[e];for(let a=1,l=0,c=0;a<n;a++){r[a]=t[e+a*i];const n=a*a;do{const t=s[l];c=(r[a]-r[t]+n-t*t)/(a-t)/2}while(c<=o[l]&&--l>-1);l++,s[l]=a,o[l]=c,o[l+1]=$u}for(let a=0,l=0;a<n;a++){for(;o[l+1]<a;)l++;const n=s[l],c=a-n;t[e+a*i]=r[n]+c*c}}class Wu{constructor(t,e){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={}}setURL(t){this.url=t}getGlyphs(t,e){const i=[];for(const e in t)for(const n of t[e])i.push({stack:e,id:n});g(i,(({stack:t,id:e},i)=>{let n=this.entries[t];n||(n=this.entries[t]={glyphs:{},requests:{},ranges:{}});let r=n.glyphs[e];if(void 0!==r)return void i(null,{stack:t,id:e,glyph:r});if(r=this._tinySDF(n,t,e),r)return n.glyphs[e]=r,void i(null,{stack:t,id:e,glyph:r});const s=Math.floor(e/256);if(256*s>65535)return void i(new Error("glyphs > 65535 not supported"));if(n.ranges[s])return void i(null,{stack:t,id:e,glyph:r});if(!this.url)return void i(new Error("glyphsUrl is not set"));let o=n.requests[s];o||(o=n.requests[s]=[],Wu.loadGlyphRange(t,s,this.url,this.requestManager,((t,e)=>{if(e){for(const t in e)this._doesCharSupportLocalGlyph(+t)||(n.glyphs[+t]=e[+t]);n.ranges[s]=!0}for(const i of o)i(t,e);delete n.requests[s]}))),o.push(((n,r)=>{n?i(n):r&&i(null,{stack:t,id:e,glyph:r[e]||null})}))}),((t,i)=>{if(t)e(t);else if(i){const t={};for(const{stack:e,id:n,glyph:r}of i)(t[e]||(t[e]={}))[n]=r&&{id:r.id,bitmap:r.bitmap.clone(),metrics:r.metrics};e(null,t)}}))}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(yr(t)||wr(t)||or(t)||ar(t))}_tinySDF(t,e,i){const n=this.localIdeographFontFamily;if(!n)return;if(!this._doesCharSupportLocalGlyph(i))return;let r=t.tinySDF;if(!r){let i="400";/bold/i.test(e)?i="900":/medium/i.test(e)?i="500":/light/i.test(e)&&(i="200"),r=t.tinySDF=new Wu.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:n,fontWeight:i})}const s=r.draw(String.fromCharCode(i));return{id:i,bitmap:new Wa({width:s.width||60,height:s.height||60},s.data),metrics:{width:s.glyphWidth/2||24,height:s.glyphHeight/2||24,left:s.glyphLeft/2+.5||0,top:s.glyphTop/2-27.5||-8,advance:s.glyphAdvance/2||24,isDoubleResolution:!0}}}}Wu.loadGlyphRange=function(t,e,i,n,r){const s=256*e,o=s+255,a=n.transformRequest(i.replace("{fontstack}",t).replace("{range}",`${s}-${o}`),tt.Glyphs);Z(a,((t,e)=>{if(t)r(t);else if(e){const t={};for(const i of function(t){return new ru(t).readFields(su,[])}(e))t[i.id]=i;r(null,t)}}))},Wu.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:i=8,cutoff:n=.25,fontFamily:r="sans-serif",fontWeight:s="normal",fontStyle:o="normal"}={}){this.buffer=e,this.cutoff=n,this.radius=i;const a=this.size=t+4*e,l=this._createCanvas(a),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font=`${o} ${s} ${t}px ${r}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:n,actualBoundingBoxLeft:r,actualBoundingBoxRight:s}=this.ctx.measureText(t),o=Math.ceil(i),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(s-r))),l=Math.min(this.size-this.buffer,o+Math.ceil(n)),c=a+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),p={data:d,width:c,height:u,glyphWidth:a,glyphHeight:l,glyphTop:o,glyphLeft:0,glyphAdvance:e};if(0===a||0===l)return p;const{ctx:f,buffer:m,gridInner:g,gridOuter:_}=this;f.clearRect(m,m,a,l),f.fillText(t,m,m+o);const y=f.getImageData(m,m,a,l);_.fill($u,0,h),g.fill(0,0,h);for(let t=0;t<l;t++)for(let e=0;e<a;e++){const i=y.data[4*(t*a+e)+3]/255;if(0===i)continue;const n=(t+m)*c+e+m;if(1===i)_[n]=0,g[n]=$u;else{const t=.5-i;_[n]=t>0?t*t:0,g[n]=t<0?t*t:0}}Uu(_,0,0,c,u,c,this.f,this.v,this.z),Uu(g,m,m,a,l,c,this.f,this.v,this.z);for(let t=0;t<h;t++){const e=Math.sqrt(_[t])-Math.sqrt(g[t]);d[t]=Math.round(255-255*(e/this.radius+this.cutoff))}return p}};class Gu{constructor(){this.specification=lt.light.position}possiblyEvaluate(t,e){return function([t,e,i]){return e+=90,e*=Math.PI/180,i*=Math.PI/180,{x:t*Math.cos(e)*Math.sin(i),y:t*Math.sin(e)*Math.sin(i),z:t*Math.cos(i)}}(t.expression.evaluate(e))}interpolate(t,e,i){return{x:ri.number(t.x,e.x,i),y:ri.number(t.y,e.y,i),z:ri.number(t.z,e.z,i)}}}let Hu;class Xu extends at{constructor(t){super(),Hu=Hu||new ls({anchor:new ns(lt.light.anchor),position:new Gu,color:new ns(lt.light.color),intensity:new ns(lt.light.intensity)}),this._transitionable=new Kr(Hu),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,e={}){if(!this._validate(qn,t,e))for(const e in t){const i=t[e];e.endsWith("-transition")?this._transitionable.setTransition(e.slice(0,-11),i):this._transitionable.setValue(e,i)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,e,i){return(!i||!1!==i.validate)&&Un(this,t.call(Nn,_({value:e,style:{glyphs:!0,sprite:!0},styleSpec:lt})))}}class Yu{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,e){const i=t.join(",")+String(e);return this.dashEntry[i]||(this.dashEntry[i]=this.addDash(t,e)),this.dashEntry[i]}getDashRanges(t,e,i){const n=[];let r=t.length%2==1?-t[t.length-1]*i:0,s=t[0]*i,o=!0;n.push({left:r,right:s,isDash:o,zeroLength:0===t[0]});let a=t[0];for(let e=1;e<t.length;e++){o=!o;const l=t[e];r=a*i,a+=l,s=a*i,n.push({left:r,right:s,isDash:o,zeroLength:0===l})}return n}addRoundDash(t,e,i){const n=e/2;for(let e=-i;e<=i;e++){const r=this.width*(this.nextRow+i+e);let s=0,o=t[s];for(let a=0;a<this.width;a++){a/o.right>1&&(o=t[++s]);const l=Math.abs(a-o.left),c=Math.abs(a-o.right),u=Math.min(l,c);let h;const d=e/i*(n+1);if(o.isDash){const t=n-Math.abs(d);h=Math.sqrt(u*u+t*t)}else h=n-Math.sqrt(u*u+d*d);this.data[r+a]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(t){for(let e=t.length-1;e>=0;--e){const i=t[e],n=t[e+1];i.zeroLength?t.splice(e,1):n&&n.isDash===i.isDash&&(n.left=i.left,t.splice(e,1))}const e=t[0],i=t[t.length-1];e.isDash===i.isDash&&(e.left=i.left-this.width,i.right=e.right+this.width);const n=this.width*this.nextRow;let r=0,s=t[r];for(let e=0;e<this.width;e++){e/s.right>1&&(s=t[++r]);const i=Math.abs(e-s.left),o=Math.abs(e-s.right),a=Math.min(i,o);this.data[n+e]=Math.max(0,Math.min(255,(s.isDash?a:-a)+128))}}addDash(t,e){const i=e?7:0,n=2*i+1;if(this.nextRow+n>this.height)return A("LineAtlas out of space"),null;let r=0;for(let e=0;e<t.length;e++)r+=t[e];if(0!==r){const n=this.width/r,s=this.getDashRanges(t,this.width,n);e?this.addRoundDash(s,n,i):this.addRegularDash(s)}const s={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:r};return this.nextRow+=n,this.dirty=!0,s}bind(t){const e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))}}class Ku{constructor(t){this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){delete this._channel,this._callback=()=>{}}}class Ju{constructor(t,e,i){this.receive=t=>{const e=t.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[i];const t=this.cancelCallbacks[i];delete this.cancelCallbacks[i],t&&t()}else E()||e.mustQueue?(this.tasks[i]=e,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,e)},this.process=()=>{if(!this.taskQueue.length)return;const t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)},this.target=t,this.parent=e,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new Ku(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=E()?t:window}send(t,e,i,n,r=!1){const s=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[s]=i);const o=[],a={id:s,type:t,hasCallback:!!i,targetMapId:n,mustQueue:r,sourceMapId:this.mapId,data:Xn(e,o)};return this.target.postMessage(a,{transfer:o}),{cancel:()=>{i&&delete this.callbacks[s],this.target.postMessage({id:s,type:"<cancel>",targetMapId:n,sourceMapId:this.mapId})}}}processTask(t,e){if("<response>"===e.type){const i=this.callbacks[t];delete this.callbacks[t],i&&(e.error?i(Yn(e.error)):i(null,Yn(e.data)))}else{let i=!1;const n=[],r=e.hasCallback?(e,r)=>{i=!0,delete this.cancelCallbacks[t];const s={id:t,type:"<response>",sourceMapId:this.mapId,error:e?Xn(e):null,data:Xn(r,n)};this.target.postMessage(s,{transfer:n})}:t=>{i=!0};let s=null;const o=Yn(e.data);if(this.parent[e.type])s=this.parent[e.type](e.sourceMapId,o,r);else if("getWorkerSource"in this.parent){const t=e.type.split(".");s=this.parent.getWorkerSource(e.sourceMapId,t[0],o.source)[t[1]](o,r)}else r(new Error(`Could not find function ${e.type}`));!i&&s&&s.cancel&&(this.cancelCallbacks[t]=s.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Qu{constructor(t,e,i){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=i;const n=this.workerPool.acquire(i);for(let t=0;t<n.length;t++){const r=new Ju(n[t],e,i);r.name=`Worker ${t}`,this.actors.push(r)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,e,i){g(this.actors,((i,n)=>{i.send(t,e,n)}),i=i||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((t=>{t.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}}function th(t,e,i){const n=function(e,n){if(e)return i(e);if(n){const e=y(_(n,t),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);n.vector_layers&&(e.vectorLayers=n.vector_layers,e.vectorLayerIds=e.vectorLayers.map((t=>t.id))),i(null,e)}};return t.url?U(e.transformRequest(t.url,tt.Source),n):R.frame((()=>n(null,t)))}const eh=6371008.8;class ih{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error(`Invalid LngLat object: (${t}, ${e})`);if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ih(m(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const e=Math.PI/180,i=this.lat*e,n=t.lat*e,r=Math.sin(i)*Math.sin(n)+Math.cos(i)*Math.cos(n)*Math.cos((t.lng-this.lng)*e);return eh*Math.acos(Math.min(r,1))}static convert(t){if(t instanceof ih)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new ih(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new ih(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class nh{constructor(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):Array.isArray(t)&&(4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof ih?new ih(t.lng,t.lat):ih.convert(t),this}setSouthWest(t){return this._sw=t instanceof ih?new ih(t.lng,t.lat):ih.convert(t),this}extend(t){const e=this._sw,i=this._ne;let n,r;if(t instanceof ih)n=t,r=t;else{if(!(t instanceof nh))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(nh.convert(t)):this.extend(ih.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(ih.convert(t)):this;if(n=t._sw,r=t._ne,!n||!r)return this}return e||i?(e.lng=Math.min(n.lng,e.lng),e.lat=Math.min(n.lat,e.lat),i.lng=Math.max(r.lng,i.lng),i.lat=Math.max(r.lat,i.lat)):(this._sw=new ih(n.lng,n.lat),this._ne=new ih(r.lng,r.lat)),this}getCenter(){return new ih((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ih(this.getWest(),this.getNorth())}getSouthEast(){return new ih(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:e,lat:i}=ih.convert(t);let n=this._sw.lng<=e&&e<=this._ne.lng;return this._sw.lng>this._ne.lng&&(n=this._sw.lng>=e&&e>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&n}static convert(t){return t instanceof nh?t:t?new nh(t):t}static fromLngLat(t,e=0){const i=360*e/40075017,n=i/Math.cos(Math.PI/180*t.lat);return new nh(new ih(t.lng-n,t.lat-i),new ih(t.lng+n,t.lat+i))}}const rh=2*Math.PI*eh;function sh(t){return rh*Math.cos(t*Math.PI/180)}function oh(t){return(180+t)/360}function ah(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function lh(t,e){return t/sh(e)}function ch(t){return 360*t-180}function uh(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}class hh{constructor(t,e,i=0){this.x=+t,this.y=+e,this.z=+i}static fromLngLat(t,e=0){const i=ih.convert(t);return new hh(oh(i.lng),ah(i.lat),lh(e,i.lat))}toLngLat(){return new ih(ch(this.x),uh(this.y))}toAltitude(){return this.z*sh(uh(this.y))}meterInMercatorCoordinateUnits(){return 1/rh*(t=uh(this.y),1/Math.cos(t*Math.PI/180));var t}}class dh{constructor(t,e,i){this.bounds=nh.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=i||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const e=Math.pow(2,t.z),i=Math.floor(oh(this.bounds.getWest())*e),n=Math.floor(ah(this.bounds.getNorth())*e),r=Math.ceil(oh(this.bounds.getEast())*e),s=Math.ceil(ah(this.bounds.getSouth())*e);return t.x>=i&&t.x<r&&t.y>=n&&t.y<s}}class ph extends at{constructor(t,e,i,n){if(super(),this.load=()=>{this._loaded=!1,this.fire(new st("dataloading",{dataType:"source"})),this._tileJSONRequest=th(this._options,this.map._requestManager,((t,e)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t?this.fire(new ot(t)):e&&(_(this,e),e.bounds&&(this.tileBounds=new dh(e.bounds,this.minzoom,this.maxzoom)),this.fire(new st("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new st("data",{dataType:"source",sourceDataType:"content"})))}))},this.serialize=()=>_({},this._options),this.id=t,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,_(this,y(e,["url","scheme","tileSize","promoteId"])),this._options=_({type:"vector"},e),this._collectResourceTiming=e.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(n)}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(t,e){const i=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),n={request:this.map._requestManager.transformRequest(i,tt.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function r(i,n){return delete t.request,t.aborted?e(null):i&&404!==i.status?e(i):(n&&n.resourceTiming&&(t.resourceTiming=n.resourceTiming),this.map._refreshExpiredTiles&&n&&t.setExpiryData(n),t.loadVectorData(n,this.map.painter),e(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}n.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state?"loading"===t.state?t.reloadCallback=e:t.request=t.actor.send("reloadTile",n,r.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",n,r.bind(this)))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class fh extends at{constructor(t,e,i,n){super(),this.id=t,this.dispatcher=i,this.setEventedParent(n),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=_({type:"raster"},e),_(this,y(e,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new st("dataloading",{dataType:"source"})),this._tileJSONRequest=th(this._options,this.map._requestManager,((t,e)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new ot(t)):e&&(_(this,e),e.bounds&&(this.tileBounds=new dh(e.bounds,this.minzoom,this.maxzoom)),this.fire(new st("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new st("data",{dataType:"source",sourceDataType:"content"})))}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}serialize(){return _({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,e){const i=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.request=Q.getImage(this.map._requestManager.transformRequest(i,tt.Tile),((i,n,r)=>{if(delete t.request,t.aborted)t.state="unloaded",e(null);else if(i)t.state="errored",e(i);else if(n){this.map._refreshExpiredTiles&&r&&t.setExpiryData(r);const i=this.map.painter.context,s=i.gl;t.texture=this.map.painter.getTileTexture(n.width),t.texture?t.texture.update(n,{useMipmap:!0}):(t.texture=new Nu(i,n,s.RGBA,{useMipmap:!0}),t.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),i.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax)),t.state="loaded",e(null)}}),this.map._refreshExpiredTiles)}abortTile(t,e){t.request&&(t.request.cancel(),delete t.request),e()}unloadTile(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()}hasTransition(){return!1}}function mh(t,e,i){var n=2*Math.PI*6378137/256/Math.pow(2,i);return[t*n-2*Math.PI*6378137/2,e*n-2*Math.PI*6378137/2]}class gh{constructor(t,e,i){if(t<0||t>25||i<0||i>=Math.pow(2,t)||e<0||e>=Math.pow(2,t))throw new Error(`x=${e}, y=${i}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=e,this.y=i,this.key=xh(0,t,t,e,i)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e,i){const n=(s=this.y,o=this.z,a=mh(256*(r=this.x),256*(s=Math.pow(2,o)-s-1),o),l=mh(256*(r+1),256*(s+1),o),a[0]+","+a[1]+","+l[0]+","+l[1]);var r,s,o,a,l;const c=function(t,e,i){let n,r="";for(let s=t;s>0;s--)n=1<<s-1,r+=(e&n?1:0)+(i&n?2:0);return r}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===i?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,e>1?"@2x":"").replace(/{quadkey}/g,c).replace(/{bbox-epsg-3857}/g,n)}isChildOf(t){const e=this.z-t.z;return e>0&&t.x===this.x>>e&&t.y===this.y>>e}getTilePoint(t){const e=Math.pow(2,this.z);return new s((t.x*e-this.x)*Jo,(t.y*e-this.y)*Jo)}toString(){return`${this.z}/${this.x}/${this.y}`}}class _h{constructor(t,e){this.wrap=t,this.canonical=e,this.key=xh(t,e.z,e.z,e.x,e.y)}}class yh{constructor(t,e,i,n,r){if(t<i)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${i}`);this.overscaledZ=t,this.wrap=e,this.canonical=new gh(i,+n,+r),this.key=xh(e,t,i,n,r)}clone(){return new yh(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const e=this.canonical.z-t;return t>this.canonical.z?new yh(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new yh(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t,e){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-t;return t>this.canonical.z?xh(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):xh(this.wrap*+e,t,t,this.canonical.x>>i,this.canonical.y>>i)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return[new yh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,i=2*this.canonical.x,n=2*this.canonical.y;return[new yh(e,this.wrap,e,i,n),new yh(e,this.wrap,e,i+1,n),new yh(e,this.wrap,e,i,n+1),new yh(e,this.wrap,e,i+1,n+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new yh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new yh(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new _h(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new hh(t.x-this.wrap,t.y))}}function xh(t,e,i,n,r){(t*=2)<0&&(t=-1*t-1);const s=1<<i;return(s*s*t+s*r+n).toString(36)+i.toString(36)+e.toString(36)}Gn("CanonicalTileID",gh),Gn("OverscaledTileID",yh,{omit:["posMatrix"]}),Gn("DEMData",class{constructor(t,e,i,n=1,r=1,s=1,o=0){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(i&&!["mapbox","terrarium","custom"].includes(i))return void A(`"${i}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=e.height;const a=this.dim=e.height-2;switch(this.data=new Uint32Array(e.data.buffer),i){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=n,this.greenFactor=r,this.blueFactor=s,this.baseShift=o;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let t=0;t<a;t++)this.data[this._idx(-1,t)]=this.data[this._idx(0,t)],this.data[this._idx(a,t)]=this.data[this._idx(a-1,t)],this.data[this._idx(t,-1)]=this.data[this._idx(t,0)],this.data[this._idx(t,a)]=this.data[this._idx(t,a-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(a,-1)]=this.data[this._idx(a-1,0)],this.data[this._idx(-1,a)]=this.data[this._idx(0,a-1)],this.data[this._idx(a,a)]=this.data[this._idx(a-1,a-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let t=0;t<a;t++)for(let e=0;e<a;e++){const i=this.get(t,e);i>this.max&&(this.max=i),i<this.min&&(this.min=i)}}get(t,e){const i=new Uint8Array(this.data.buffer),n=4*this._idx(t,e);return this.unpack(i[n],i[n+1],i[n+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}unpack(t,e,i){return t*this.redFactor+e*this.greenFactor+i*this.blueFactor-this.baseShift}getPixels(){return new Ga({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,e,i){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let n=e*this.dim,r=e*this.dim+this.dim,s=i*this.dim,o=i*this.dim+this.dim;switch(e){case-1:n=r-1;break;case 1:r=n+1}switch(i){case-1:s=o-1;break;case 1:o=s+1}const a=-e*this.dim,l=-i*this.dim;for(let e=s;e<o;e++)for(let i=n;i<r;i++)this.data[this._idx(i,e)]=t.data[this._idx(i+a,e+l)]}});class vh extends fh{constructor(t,e,i,n){super(t,e,i,n),this.type="raster-dem",this.maxzoom=22,this._options=_({type:"raster-dem"},e),this.encoding=e.encoding||"mapbox",this.redFactor=e.redFactor,this.greenFactor=e.greenFactor,this.blueFactor=e.blueFactor,this.baseShift=e.baseShift}loadTile(t,i){const n=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r=this.map._requestManager.transformRequest(n,tt.Tile);function s(e,n){e&&(t.state="errored",i(e)),n&&(t.dem=n,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded",i(null))}t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.request=Q.getImage(r,((n,r,o)=>e(this,void 0,void 0,(function*(){if(delete t.request,t.aborted)t.state="unloaded",i(null);else if(n)t.state="errored",i(n);else if(r){this.map._refreshExpiredTiles&&t.setExpiryData(o);const i=z(r)&&h()?r:yield function(t){return e(this,void 0,void 0,(function*(){if("undefined"!=typeof VideoFrame&&function(){if(null==u&&(u=!1,h())){const t=5,e=new OffscreenCanvas(t,t).getContext("2d",{willReadFrequently:!0});if(e){for(let i=0;i<t*t;i++){const n=4*i;e.fillStyle=`rgb(${n},${n+1},${n+2})`,e.fillRect(i%t,Math.floor(i/t),1,1)}const i=e.getImageData(0,0,t,t).data;for(let e=0;e<t*t*4;e++)if(e%4!=3&&i[e]!==e){u=!0;break}}}return u||!1}()){const i=t.width+2,n=t.height+2;try{return new Ga({width:i,height:n},yield function(t,i,n,r,s){return e(this,void 0,void 0,(function*(){if("undefined"==typeof VideoFrame)throw new Error("VideoFrame not supported");const e=new VideoFrame(t,{timestamp:0});try{const i=null==e?void 0:e.format;if(!i||!i.startsWith("BGR")&&!i.startsWith("RGB"))throw new Error(`Unrecognized format ${i}`);const n=i.startsWith("BGR"),o=new Uint8ClampedArray(r*s*4);if(yield e.copyTo(o,function(t,e,i,n,r){const s=4*Math.max(1,0),o=(Math.max(0,-1)- -1)*n*4+s,a=4*n,l=Math.max(0,-1),c=Math.max(0,-1);return{rect:{x:l,y:c,width:Math.min(t.width,-1+n)-l,height:Math.min(t.height,-1+r)-c},layout:[{offset:o,stride:a}]}}(t,0,0,r,s)),n)for(let t=0;t<o.length;t+=4){const e=o[t];o[t]=o[t+2],o[t+2]=e}return o}finally{e.close()}}))}(t,0,0,i,n))}catch(t){}}return R.getImageData(t,1)}))}(r),n={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:i,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",n,s))}}))),this.map._refreshExpiredTiles)}_getNeighboringTiles(t){const e=t.canonical,i=Math.pow(2,e.z),n=(e.x-1+i)%i,r=0===e.x?t.wrap-1:t.wrap,s=(e.x+1+i)%i,o=e.x+1===i?t.wrap+1:t.wrap,a={};return a[new yh(t.overscaledZ,r,e.z,n,e.y).key]={backfilled:!1},a[new yh(t.overscaledZ,o,e.z,s,e.y).key]={backfilled:!1},e.y>0&&(a[new yh(t.overscaledZ,r,e.z,n,e.y-1).key]={backfilled:!1},a[new yh(t.overscaledZ,t.wrap,e.z,e.x,e.y-1).key]={backfilled:!1},a[new yh(t.overscaledZ,o,e.z,s,e.y-1).key]={backfilled:!1}),e.y+1<i&&(a[new yh(t.overscaledZ,r,e.z,n,e.y+1).key]={backfilled:!1},a[new yh(t.overscaledZ,t.wrap,e.z,e.x,e.y+1).key]={backfilled:!1},a[new yh(t.overscaledZ,o,e.z,s,e.y+1).key]={backfilled:!1}),a}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})}}class bh extends at{constructor(t,e,i,n){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>_({},this._options,{type:this.type,data:this._data}),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=i.getActor(),this.setEventedParent(n),this._data=e.data,this._options=_({},e),this._collectResourceTiming=e.collectResourceTiming,void 0!==e.maxzoom&&(this.maxzoom=e.maxzoom),e.type&&(this.type=e.type),e.attribution&&(this.attribution=e.attribution),this.promoteId=e.promoteId;const r=Jo/this.tileSize;this.workerOptions=_({source:this.id,cluster:e.cluster||!1,geojsonVtOptions:{buffer:(void 0!==e.buffer?e.buffer:128)*r,tolerance:(void 0!==e.tolerance?e.tolerance:.375)*r,extent:Jo,maxZoom:this.maxzoom,lineMetrics:e.lineMetrics||!1,generateId:e.generateId||!1},superclusterOptions:{maxZoom:void 0!==e.clusterMaxZoom?e.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,e.clusterMinPoints||2),extent:Jo,radius:(e.clusterRadius||50)*r,log:!1,generateId:e.generateId||!1},clusterProperties:e.clusterProperties,filter:e.filter},e.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(void 0!==t.clusterRadius&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),void 0!==t.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this}getClusterChildren(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this}getClusterLeaves(t,e,i,n){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:i},n),this}_updateWorkerData(t){const e=_({},this.workerOptions);t?e.dataDiff=t:"string"==typeof this._data?(e.request=this.map._requestManager.transformRequest(R.resolveURL(this._data),tt.Source),e.request.collectResourceTiming=this._collectResourceTiming):e.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new st("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,e,((t,e)=>{if(this._pendingLoads--,this._removed||e&&e.abandoned)return void this.fire(new st("dataabort",{dataType:"source"}));let i=null;if(e&&e.resourceTiming&&e.resourceTiming[this.id]&&(i=e.resourceTiming[this.id].slice(0)),t)return void this.fire(new ot(t));const n={dataType:"source"};this._collectResourceTiming&&i&&i.length>0&&_(n,{resourceTiming:i}),this.fire(new st("data",Object.assign(Object.assign({},n),{sourceDataType:"metadata"}))),this.fire(new st("data",Object.assign(Object.assign({},n),{sourceDataType:"content"})))}))}loaded(){return 0===this._pendingLoads}loadTile(t,e){const i=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const n={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.request=this.actor.send(i,n,((n,r)=>(delete t.request,t.unloadVectorData(),t.aborted?e(null):n?e(n):(t.loadVectorData(r,this.map.painter,"reloadTile"===i),e(null)))))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var wh=fs([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class kh extends at{constructor(t,e,i,n){super(),this.load=(t,e)=>{this._loaded=!1,this.fire(new st("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=Q.getImage(this.map._requestManager.transformRequest(this.url,tt.Image),((i,n)=>{this._request=null,this._loaded=!0,i?this.fire(new ot(i)):n&&(this.image=n,t&&(this.coordinates=t),e&&e(),this._finishLoading())}))},this.prepare=()=>{if(0===Object.keys(this.tiles).length||!this.image)return;const t=this.map.painter.context,e=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,wh.members)),this.boundsSegments||(this.boundsSegments=xo.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Nu(t,this.image,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE));let i=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,i=!0)}i&&this.fire(new st("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=t,this.dispatcher=i,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=e}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=t.url,this.load(t.coordinates,(()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new st("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(t){this.coordinates=t;const e=t.map(hh.fromLngLat);this.tileID=function(t){let e=1/0,i=1/0,n=-1/0,r=-1/0;for(const s of t)e=Math.min(e,s.x),i=Math.min(i,s.y),n=Math.max(n,s.x),r=Math.max(r,s.y);const s=Math.max(n-e,r-i),o=Math.max(0,Math.floor(-Math.log(s)/Math.LN2)),a=Math.pow(2,o);return new gh(o,Math.floor((e+n)/2*a),Math.floor((i+r)/2*a))}(e),this.minzoom=this.maxzoom=this.tileID.z;const i=e.map((t=>this.tileID.getTilePoint(t)._round()));return this._boundsArray=new Qs,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,Jo,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,Jo),this._boundsArray.emplaceBack(i[2].x,i[2].y,Jo,Jo),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new st("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))}hasTransition(){return!1}}class Sh extends kh{constructor(t,e,i,n){super(t,e,i,n),this.load=()=>{this._loaded=!1;const t=this.options;this.urls=[];for(const e of t.urls)this.urls.push(this.map._requestManager.transformRequest(e,tt.Source).url);!function(t,e){const i=window.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let e=0;e<t.length;e++){const n=window.document.createElement("source");W(t[e])||(i.crossOrigin="Anonymous"),n.src=t[e],i.appendChild(n)}}(this.urls,((t,e)=>{this._loaded=!0,t?this.fire(new ot(t)):e&&(this.video=e,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))},this.prepare=()=>{if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const t=this.map.painter.context,e=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,wh.members)),this.boundsSegments||(this.boundsSegments=xo.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE),e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,this.video)):(this.texture=new Nu(t,this.video,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE));let i=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,i=!0)}i&&this.fire(new st("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=e}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const e=this.video.seekable;t<e.start(0)||t>e.end(0)?this.fire(new ot(new bt(`sources.${this.id}`,null,`Playback for this video can be set only between the ${e.start(0)} and ${e.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class Th extends kh{constructor(t,e,i,n){super(t,e,i,n),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new ot(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const e=this.map.painter.context,i=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,wh.members)),this.boundsSegments||(this.boundsSegments=xo.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Nu(e,this.canvas,i.RGBA,{premultiply:!0});let n=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,n=!0)}n&&this.fire(new st("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),e.coordinates?Array.isArray(e.coordinates)&&4===e.coordinates.length&&!e.coordinates.some((t=>!Array.isArray(t)||2!==t.length||t.some((t=>"number"!=typeof t))))||this.fire(new ot(new bt(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new ot(new bt(`sources.${t}`,null,'missing required property "coordinates"'))),e.animate&&"boolean"!=typeof e.animate&&this.fire(new ot(new bt(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),e.canvas?"string"==typeof e.canvas||e.canvas instanceof HTMLCanvasElement||this.fire(new ot(new bt(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new ot(new bt(`sources.${t}`,null,'missing required property "canvas"'))),this.options=e,this.animate=void 0===e.animate||e.animate}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const Ah={},Mh=t=>{switch(t){case"geojson":return bh;case"image":return kh;case"raster":return fh;case"raster-dem":return vh;case"vector":return ph;case"video":return Sh;case"canvas":return Th}return Ah[t]};function Ch(t,e){const i=Sa();return Ca(i,i,[1,1,0]),Ea(i,i,[.5*t.width,.5*t.height,1]),Ma(i,i,t.calculatePosMatrix(e.toUnwrapped()))}function Eh(t,e,i,n,r,s){const o=function(t,e,i){if(t)for(const n of t){const t=e[n];if(t&&t.source===i&&"fill-extrusion"===t.type)return!0}else for(const t in e){const n=e[t];if(n.source===i&&"fill-extrusion"===n.type)return!0}return!1}(r&&r.layers,e,t.id),a=s.maxPitchScaleFactor(),l=t.tilesIn(n,a,o);l.sort(Ih);const c=[];for(const n of l)c.push({wrappedTileID:n.tileID.wrapped().key,queryResults:n.tile.queryRenderedFeatures(e,i,t._state,n.queryGeometry,n.cameraQueryGeometry,n.scale,r,s,a,Ch(t.transform,n.tileID))});const u=function(t){const e={},i={};for(const n of t){const t=n.queryResults,r=n.wrappedTileID,s=i[r]=i[r]||{};for(const i in t){const n=t[i],r=s[i]=s[i]||{},o=e[i]=e[i]||[];for(const t of n)r[t.featureIndex]||(r[t.featureIndex]=!0,o.push(t))}}return e}(c);for(const e in u)u[e].forEach((e=>{const i=e.feature,n=t.getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=n}));return u}function Ih(t,e){const i=t.tileID,n=e.tileID;return i.overscaledZ-n.overscaledZ||i.canonical.y-n.canonical.y||i.wrap-n.wrap||i.canonical.x-n.canonical.x}class Dh{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const i=t[e];this._stringToNumber[i]=e,this._numberToString[e]=i}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class zh{constructor(t,e,i,n,r){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=i,t._y=n,this.properties=t.properties,this.id=r}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t}}function Ph(t,e,i,n,r){return b(t,((t,s)=>{const o=e instanceof is?e.get(s):null;return o&&o.evaluate?o.evaluate(i,n,r):o}))}function Lh(t){let e=1/0,i=1/0,n=-1/0,r=-1/0;for(const s of t)e=Math.min(e,s.x),i=Math.min(i,s.y),n=Math.max(n,s.x),r=Math.max(r,s.y);return{minX:e,minY:i,maxX:n,maxY:r}}function Fh(t,e){return e-t}Gn("FeatureIndex",class{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Zn(Jo,16,0),this.grid3D=new Zn(Jo,16,0),this.featureIndexArray=new Ys,this.promoteId=e}insert(t,e,i,n,r,s){const o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,n,r);const a=s?this.grid3D:this.grid;for(let t=0;t<e.length;t++){const i=e[t],n=[1/0,1/0,-1/0,-1/0];for(let t=0;t<i.length;t++){const e=i[t];n[0]=Math.min(n[0],e.x),n[1]=Math.min(n[1],e.y),n[2]=Math.max(n[2],e.x),n[3]=Math.max(n[3],e.y)}n[0]<Jo&&n[1]<Jo&&n[2]>=0&&n[3]>=0&&a.insert(o,n[0],n[1],n[2],n[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Zl.VectorTile(new ru(this.rawTileData)).layers,this.sourceLayerCoder=new Dh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,e,i,n){this.loadVTLayers();const r=t.params||{},o=Jo/t.tileSize/t.scale,a=rn(r.filter),l=t.queryGeometry,c=t.queryPadding*o,u=Lh(l),h=this.grid.query(u.minX-c,u.minY-c,u.maxX+c,u.maxY+c),d=Lh(t.cameraQueryGeometry),p=this.grid3D.query(d.minX-c,d.minY-c,d.maxX+c,d.maxY+c,((e,i,n,r)=>function(t,e,i,n,r){for(const s of t)if(e<=s.x&&i<=s.y&&n>=s.x&&r>=s.y)return!0;const o=[new s(e,i),new s(e,r),new s(n,r),new s(n,i)];if(t.length>2)for(const e of o)if(fa(t,e))return!0;for(let e=0;e<t.length-1;e++)if(ma(t[e],t[e+1],o))return!0;return!1}(t.cameraQueryGeometry,e-c,i-c,n+c,r+c)));for(const t of p)h.push(t);h.sort(Fh);const f={};let m;for(let s=0;s<h.length;s++){const c=h[s];if(c===m)continue;m=c;const u=this.featureIndexArray.get(c);let d=null;this.loadMatchingFeature(f,u.bucketIndex,u.sourceLayerIndex,u.featureIndex,a,r.layers,r.availableImages,e,i,n,((e,i,n)=>(d||(d=ea(e)),i.queryIntersectsFeature(l,e,n,d,this.z,t.transform,o,t.pixelPosMatrix))))}return f}loadMatchingFeature(t,e,i,n,r,s,o,a,l,c,u){const h=this.bucketLayerIDs[e];if(s&&!function(t,e){for(let i=0;i<t.length;i++)if(e.indexOf(t[i])>=0)return!0;return!1}(s,h))return;const d=this.sourceLayerCoder.decode(i),p=this.vtLayers[d].feature(n);if(r.needGeometry){const t=ia(p,!0);if(!r.filter(new Hr(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!r.filter(new Hr(this.tileID.overscaledZ),p))return;const f=this.getId(p,d);for(let e=0;e<h.length;e++){const i=h[e];if(s&&s.indexOf(i)<0)continue;const r=a[i];if(!r)continue;let d={};f&&c&&(d=c.getState(r.sourceLayer||"_geojsonTileLayer",f));const m=_({},l[i]);m.paint=Ph(m.paint,r.paint,p,d,o),m.layout=Ph(m.layout,r.layout,p,d,o);const g=!u||u(p,r,d);if(!g)continue;const y=new zh(p,this.z,this.x,this.y,f);y.layer=m;let x=t[i];void 0===x&&(x=t[i]=[]),x.push({featureIndex:n,feature:y,intersectionZ:g})}}lookupSymbolFeatures(t,e,i,n,r,s,o,a){const l={};this.loadVTLayers();const c=rn(r);for(const r of t)this.loadMatchingFeature(l,i,n,r,c,s,o,a,e);return l}hasLayer(t){for(const e of this.bucketLayerIDs)for(const i of e)if(t===i)return!0;return!1}getId(t,e){let i=t.id;return this.promoteId&&(i=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]],"boolean"==typeof i&&(i=Number(i))),i}},{omit:["rawTileData","sourceLayerCoder"]});class Rh{constructor(t,e){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=v(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const e=t+this.timeAdded;e<this.fadeEndTime||(this.fadeEndTime=e)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,e,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){const i={};if(!e)return i;for(const n of t){const t=n.layerIds.map((t=>e.getLayer(t))).filter(Boolean);if(0!==t.length){n.layers=t,n.stateDependentLayerIds&&(n.stateDependentLayers=n.stateDependentLayerIds.map((e=>t.filter((t=>t.id===e))[0])));for(const e of t)i[e.id]=n}}return i}(t.buckets,e.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const e=this.buckets[t];if(e instanceof Su){if(this.hasSymbolBuckets=!0,!i)break;e.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const e=this.buckets[t];if(e instanceof Su&&e.hasRTLText){this.hasRTLText=!0,Gr.isLoading()||Gr.isLoaded()||"deferred"!==Zr()||Wr();break}}this.queryPadding=0;for(const t in this.buckets){const i=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(t).queryRadius(i))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new Ns}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const e in this.buckets){const i=this.buckets[e];i.uploadPending()&&i.upload(t)}const e=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Nu(t,this.imageAtlas.image,e.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Nu(t,this.glyphAtlasImage,e.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,e,i,n,r,s,o,a,l,c){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:n,cameraQueryGeometry:r,scale:s,tileSize:this.tileSize,pixelPosMatrix:c,transform:a,params:o,queryPadding:this.queryPadding*l},t,e,i):{}}querySourceFeatures(t,e){const i=this.latestFeatureIndex;if(!i||!i.rawTileData)return;const n=i.loadVTLayers(),r=e&&e.sourceLayer?e.sourceLayer:"",s=n._geojsonTileLayer||n[r];if(!s)return;const o=rn(e&&e.filter),{z:a,x:l,y:c}=this.tileID.canonical,u={z:a,x:l,y:c};for(let e=0;e<s.length;e++){const n=s.feature(e);if(o.needGeometry){const t=ia(n,!0);if(!o.filter(new Hr(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!o.filter(new Hr(this.tileID.overscaledZ),n))continue;const h=i.getId(n,r),d=new zh(n,a,l,c,h);d.tile=u,t.push(d)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const e=this.expirationTime;if(t.cacheControl){const e=function(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((t,i,n,r)=>{const s=n||r;return e[i]=!s||s.toLowerCase(),""})),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t}return e}(t.cacheControl);e["max-age"]&&(this.expirationTime=Date.now()+1e3*e["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const t=Date.now();let i=!1;if(this.expirationTime>t)i=!1;else if(e)if(this.expirationTime<e)i=!0;else{const n=this.expirationTime-e;n?this.expirationTime=t+Math.max(n,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,e){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(t).length)return;const i=this.latestFeatureIndex.loadVTLayers();for(const n in this.buckets){if(!e.style.hasLayer(n))continue;const r=this.buckets[n],s=r.layers[0].sourceLayer||"_geojsonTileLayer",o=i[s],a=t[s];if(!o||!a||0===Object.keys(a).length)continue;r.update(a,o,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=e&&e.style&&e.style.getLayer(n);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(r)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<R.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=R.now()+t}setDependencies(t,e){const i={};for(const t of e)i[t]=!0;this.dependencies[t]=i}hasDependency(t,e){for(const i of t){const t=this.dependencies[i];if(t)for(const i of e)if(t[i])return!0}return!1}}class Oh{constructor(t,e){this.max=t,this.onRemove=e,this.reset()}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,i){const n=t.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);const r={value:e,timeout:void 0};if(void 0!==i&&(r.timeout=setTimeout((()=>{this.remove(t,r)}),i)),this.data[n].push(r),this.order.push(n),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const i=t.wrapped().key,n=void 0===e?0:this.data[i].indexOf(e),r=this.data[i][n];return this.data[i].splice(n,1),r.timeout&&clearTimeout(r.timeout),0===this.data[i].length&&delete this.data[i],this.onRemove(r.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(t){const e=[];for(const i in this.data)for(const n of this.data[i])t(n.value)||e.push(n);for(const t of e)this.remove(t.value.tileID,t)}}class Bh{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,e,i){const n=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][n]=this.stateChanges[t][n]||{},_(this.stateChanges[t][n],i),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==n&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][n]){this.deletedStates[t][n]={};for(const e in this.state[t][n])i[e]||(this.deletedStates[t][n][e]=null)}else for(const e in i)this.deletedStates[t]&&this.deletedStates[t][n]&&null===this.deletedStates[t][n][e]&&delete this.deletedStates[t][n][e]}removeFeatureState(t,e,i){if(null===this.deletedStates[t])return;const n=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},i&&void 0!==e)null!==this.deletedStates[t][n]&&(this.deletedStates[t][n]=this.deletedStates[t][n]||{},this.deletedStates[t][n][i]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][n])for(i in this.deletedStates[t][n]={},this.stateChanges[t][n])this.deletedStates[t][n][i]=null;else this.deletedStates[t][n]=null;else this.deletedStates[t]=null}getState(t,e){const i=String(e),n=_({},(this.state[t]||{})[i],(this.stateChanges[t]||{})[i]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const i=this.deletedStates[t][e];if(null===i)return{};for(const t in i)delete n[t]}return n}initializeTileState(t,e){t.setFeatureState(this.state,e)}coalesceChanges(t,e){const i={};for(const t in this.stateChanges){this.state[t]=this.state[t]||{};const e={};for(const i in this.stateChanges[t])this.state[t][i]||(this.state[t][i]={}),_(this.state[t][i],this.stateChanges[t][i]),e[i]=this.state[t][i];i[t]=e}for(const t in this.deletedStates){this.state[t]=this.state[t]||{};const e={};if(null===this.deletedStates[t])for(const i in this.state[t])e[i]={},this.state[t][i]={};else for(const i in this.deletedStates[t]){if(null===this.deletedStates[t][i])this.state[t][i]={};else for(const e of Object.keys(this.deletedStates[t][i]))delete this.state[t][i][e];e[i]=this.state[t][i]}i[t]=i[t]||{},_(i[t],e)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(i).length)for(const n in t)t[n].setFeatureState(i,e)}}class Vh extends at{constructor(t,e,i){super(),this.id=t,this.dispatcher=i,this.on("data",(t=>{"source"===t.dataType&&"metadata"===t.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)})),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((t,e,i,n)=>{const r=new(Mh(e.type))(t,e,i,n);if(r.id!==t)throw new Error(`Expected Source id to be ${t} instead of ${r.id}`);return r})(t,e,i,this),this._tiles={},this._cache=new Oh(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Bh,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,e){return this._source.loadTile(t,e)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,(()=>{}))}_abortTile(t){this._source.abortTile&&this._source.abortTile(t,(()=>{})),this._source.fire(new st("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const i=this._tiles[e];i.upload(t),i.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((t=>t.tileID)).sort(Nh).map((t=>t.key))}getRenderableIds(t){const e=[];for(const i in this._tiles)this._isIdRenderable(i,t)&&e.push(this._tiles[i]);return t?e.sort(((t,e)=>{const i=t.tileID,n=e.tileID,r=new s(i.canonical.x,i.canonical.y)._rotate(this.transform.angle),o=new s(n.canonical.x,n.canonical.y)._rotate(this.transform.angle);return i.overscaledZ-n.overscaledZ||o.y-r.y||o.x-r.x})).map((t=>t.tileID.key)):e.map((t=>t.tileID)).sort(Nh).map((t=>t.key))}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")}}_reloadTile(t,e){const i=this._tiles[t];i&&("loading"!==i.state&&(i.state=e),this._loadTile(i,this._tileLoaded.bind(this,i,t,e)))}_tileLoaded(t,e,i,n){if(n)return t.state="errored",void(404!==n.status?this._source.fire(new ot(n,{tile:t})):this.update(this.transform,this.terrain));t.timeAdded=R.now(),"expired"===i&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new st("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const e=this.getRenderableIds();for(let n=0;n<e.length;n++){const r=e[n];if(t.neighboringTiles&&t.neighboringTiles[r]){const e=this.getTileByID(r);i(t,e),i(e,t)}}function i(t,e){t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0;let i=e.tileID.canonical.x-t.tileID.canonical.x;const n=e.tileID.canonical.y-t.tileID.canonical.y,r=Math.pow(2,t.tileID.canonical.z),s=e.tileID.key;0===i&&0===n||Math.abs(n)>1||(Math.abs(i)>1&&(1===Math.abs(i+r)?i+=r:1===Math.abs(i-r)&&(i-=r)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,i,n),t.neighboringTiles&&t.neighboringTiles[s]&&(t.neighboringTiles[s].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e,i,n){for(const r in this._tiles){let s=this._tiles[r];if(n[r]||!s.hasData()||s.tileID.overscaledZ<=e||s.tileID.overscaledZ>i)continue;let o=s.tileID;for(;s&&s.tileID.overscaledZ>e+1;){const t=s.tileID.scaledTo(s.tileID.overscaledZ-1);s=this._tiles[t.key],s&&s.hasData()&&(o=t)}let a=o;for(;a.overscaledZ>e;)if(a=a.scaledTo(a.overscaledZ-1),t[a.key]){n[o.key]=o;break}}}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const i=this._loadedParentTiles[t.key];return i&&i.tileID.overscaledZ>=e?i:null}for(let i=t.overscaledZ-1;i>=e;i--){const e=t.scaledTo(i),n=this._getLoadedTile(e);if(n)return n}}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const e=Math.ceil(t.width/this._source.tileSize)+1,i=Math.ceil(t.height/this._source.tileSize)+1,n=Math.floor(e*i*(null===this._maxTileCacheZoomLevels?B.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),r="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,n):n;this._cache.setMaxSize(r)}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const i in this._tiles){const n=this._tiles[i];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+e),t[n.tileID.key]=n}this._tiles=t;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(t,this._tiles[t])}}update(t,e){if(this.transform=t,this.terrain=e,!this._sourceLoaded||this._paused)return;let i;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?i=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((t=>new yh(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y))):(i=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:e}),this._source.hasTile&&(i=i.filter((t=>this._source.hasTile(t))))):i=[];const n=t.coveringZoomLevel(this._source),r=Math.max(n-Vh.maxOverzooming,this._source.minzoom),s=Math.max(n+Vh.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const t={};for(const e of i)if(e.canonical.z>this._source.minzoom){const i=e.scaledTo(e.canonical.z-1);t[i.key]=i;const n=e.scaledTo(Math.max(this._source.minzoom,Math.min(e.canonical.z,5)));t[n.key]=n}i=i.concat(Object.values(t))}const o=0===i.length&&!this._updated&&this._didEmitContent;this._updated=!0,o&&this.fire(new st("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const a=this._updateRetainedTiles(i,n);if(qh(this._source.type)){const t={},o={},l=Object.keys(a),c=R.now();for(const e of l){const i=a[e],n=this._tiles[e];if(!n||0!==n.fadeEndTime&&n.fadeEndTime<=c)continue;const s=this.findLoadedParent(i,r);s&&(this._addTile(s.tileID),t[s.tileID.key]=s.tileID),o[e]=i}this._retainLoadedChildren(o,n,s,a);for(const e in t)a[e]||(this._coveredTiles[e]=!0,a[e]=t[e]);if(e){const t={},e={};for(const n of i)this._tiles[n.key].hasData()?t[n.key]=n:e[n.key]=n;for(const i in e){const n=e[i].children(this._source.maxzoom);this._tiles[n[0].key]&&this._tiles[n[1].key]&&this._tiles[n[2].key]&&this._tiles[n[3].key]&&(t[n[0].key]=a[n[0].key]=n[0],t[n[1].key]=a[n[1].key]=n[1],t[n[2].key]=a[n[2].key]=n[2],t[n[3].key]=a[n[3].key]=n[3],delete e[i])}for(const i in e){const n=this.findLoadedParent(e[i],this._source.minzoom);if(n){t[n.tileID.key]=a[n.tileID.key]=n.tileID;for(const e in t)t[e].isChildOf(n.tileID)&&delete t[e]}}for(const e in this._tiles)t[e]||(this._coveredTiles[e]=!0)}}for(const t in a)this._tiles[t].clearFadeHold();const l=function(t,e){const i=[];for(const n in t)n in e||i.push(n);return i}(this._tiles,a);for(const t of l){const e=this._tiles[t];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(t)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,e){const i={},n={},r=Math.max(e-Vh.maxOverzooming,this._source.minzoom),s=Math.max(e+Vh.maxUnderzooming,this._source.minzoom),o={};for(const n of t){const t=this._addTile(n);i[n.key]=n,t.hasData()||e<this._source.maxzoom&&(o[n.key]=n)}this._retainLoadedChildren(o,e,s,i);for(const s of t){let t=this._tiles[s.key];if(t.hasData())continue;if(e+1>this._source.maxzoom){const t=s.children(this._source.maxzoom)[0],e=this.getTile(t);if(e&&e.hasData()){i[t.key]=t;continue}}else{const t=s.children(this._source.maxzoom);if(i[t[0].key]&&i[t[1].key]&&i[t[2].key]&&i[t[3].key])continue}let o=t.wasRequested();for(let e=s.overscaledZ-1;e>=r;--e){const r=s.scaledTo(e);if(n[r.key])break;if(n[r.key]=!0,t=this.getTile(r),!t&&o&&(t=this._addTile(r)),t){const e=t.hasData();if((o||e)&&(i[r.key]=r),o=t.wasRequested(),e)break}}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let i,n=this._tiles[t].tileID;for(;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){i=this._loadedParentTiles[n.key];break}e.push(n.key);const t=n.scaledTo(n.overscaledZ-1);if(i=this._getLoadedTile(t),i)break;n=t}for(const t of e)this._loadedParentTiles[t]=i}}_addTile(t){let e=this._tiles[t.key];if(e)return e;e=this._cache.getAndRemove(t),e&&(this._setTileReloadTimer(t.key,e),e.tileID=t,this._state.initializeTileState(e,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,e)));const i=e;return e||(e=new Rh(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state))),e.uses++,this._tiles[t.key]=e,i||this._source.fire(new st("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const i=e.getExpiryTimeout();i&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),i))}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,e,i){const n=[],r=this.transform;if(!r)return n;const s=i?r.getCameraQueryGeometry(t):t,o=t.map((t=>r.pointCoordinate(t,this.terrain))),a=s.map((t=>r.pointCoordinate(t,this.terrain))),l=this.getIds();let c=1/0,u=1/0,h=-1/0,d=-1/0;for(const t of a)c=Math.min(c,t.x),u=Math.min(u,t.y),h=Math.max(h,t.x),d=Math.max(d,t.y);for(let t=0;t<l.length;t++){const i=this._tiles[l[t]];if(i.holdingForFade())continue;const s=i.tileID,p=Math.pow(2,r.zoom-i.tileID.overscaledZ),f=e*i.queryPadding*Jo/i.tileSize/p,m=[s.getTilePoint(new hh(c,u)),s.getTilePoint(new hh(h,d))];if(m[0].x-f<Jo&&m[0].y-f<Jo&&m[1].x+f>=0&&m[1].y+f>=0){const t=o.map((t=>s.getTilePoint(t))),e=a.map((t=>s.getTilePoint(t)));n.push({tile:i,tileID:s,queryGeometry:t,cameraQueryGeometry:e,scale:p})}}return n}getVisibleCoordinates(t){const e=this.getRenderableIds(t).map((t=>this._tiles[t].tileID));for(const t of e)t.posMatrix=this.transform.calculatePosMatrix(t.toUnwrapped());return e}hasTransition(){if(this._source.hasTransition())return!0;if(qh(this._source.type)){const t=R.now();for(const e in this._tiles)if(this._tiles[e].fadeEndTime>=t)return!0}return!1}setFeatureState(t,e,i){this._state.updateState(t=t||"_geojsonTileLayer",e,i)}removeFeatureState(t,e,i){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,i)}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,i){const n=this._tiles[t];n&&n.setDependencies(e,i)}reloadTilesForDependencies(t,e){for(const i in this._tiles)this._tiles[i].hasDependency(t,e)&&this._reloadTile(i,"reloading");this._cache.filter((i=>!i.hasDependency(t,e)))}}function Nh(t,e){const i=Math.abs(2*t.wrap)-+(t.wrap<0),n=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||n-i||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function qh(t){return"raster"===t||"image"===t||"video"===t}Vh.maxOverzooming=10,Vh.maxUnderzooming=3;const jh="mapboxgl_preloaded_worker_pool";class $h{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<$h.workerCount;)this.workers.push(new Worker(B.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((t=>{t.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[jh]}numActive(){return Object.keys(this.active).length}}const Uh=Math.floor(R.hardwareConcurrency/2);let Zh;function Wh(){return Zh||(Zh=new $h),Zh}$h.workerCount=D(globalThis)?Math.max(Math.min(Uh,3),1):1;class Gh{constructor(t,e){this.reset(t,e)}reset(t,e){this.points=t||[],this._distances=[0];for(let t=1;t<this.points.length;t++)this._distances[t]=this._distances[t-1]+this.points[t].dist(this.points[t-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=f(t,0,1);let e=1,i=this._distances[e];const n=t*this.paddedLength+this.padding;for(;i<n&&e<this._distances.length;)i=this._distances[++e];const r=e-1,s=this._distances[r],o=i-s,a=o>0?(n-s)/o:0;return this.points[r].mult(1-a).add(this.points[e].mult(a))}}function Hh(t,e){let i=!0;return"always"===t||"never"!==t&&"never"!==e||(i=!1),i}class Xh{constructor(t,e,i){const n=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(t/i),this.yCellCount=Math.ceil(e/i);for(let t=0;t<this.xCellCount*this.yCellCount;t++)n.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,i,n,r){this._forEachCell(e,i,n,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(r)}insertCircle(t,e,i,n){this._forEachCell(e-n,i-n,e+n,i+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(i),this.circles.push(n)}_insertBoxCell(t,e,i,n,r,s){this.boxCells[r].push(s)}_insertCircleCell(t,e,i,n,r,s){this.circleCells[r].push(s)}_query(t,e,i,n,r,s,o){if(i<0||t>this.width||n<0||e>this.height)return[];const a=[];if(t<=0&&e<=0&&this.width<=i&&this.height<=n){if(r)return[{key:null,x1:t,y1:e,x2:i,y2:n}];for(let t=0;t<this.boxKeys.length;t++)a.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],i=this.circles[3*t+1],n=this.circles[3*t+2];a.push({key:this.circleKeys[t],x1:e-n,y1:i-n,x2:e+n,y2:i+n})}}else this._forEachCell(t,e,i,n,this._queryCell,a,{hitTest:r,overlapMode:s,seenUids:{box:{},circle:{}}},o);return a}query(t,e,i,n){return this._query(t,e,i,n,!1,null)}hitTest(t,e,i,n,r,s){return this._query(t,e,i,n,!0,r,s).length>0}hitTestCircle(t,e,i,n,r){const s=t-i,o=t+i,a=e-i,l=e+i;if(o<0||s>this.width||l<0||a>this.height)return!1;const c=[];return this._forEachCell(s,a,o,l,this._queryCellCircle,c,{hitTest:!0,overlapMode:n,circle:{x:t,y:e,radius:i},seenUids:{box:{},circle:{}}},r),c.length>0}_queryCell(t,e,i,n,r,s,o,a){const{seenUids:l,hitTest:c,overlapMode:u}=o,h=this.boxCells[r];if(null!==h){const r=this.bboxes;for(const o of h)if(!l.box[o]){l.box[o]=!0;const h=4*o,d=this.boxKeys[o];if(t<=r[h+2]&&e<=r[h+3]&&i>=r[h+0]&&n>=r[h+1]&&(!a||a(d))&&(!c||!Hh(u,d.overlapMode))&&(s.push({key:d,x1:r[h],y1:r[h+1],x2:r[h+2],y2:r[h+3]}),c))return!0}}const d=this.circleCells[r];if(null!==d){const r=this.circles;for(const o of d)if(!l.circle[o]){l.circle[o]=!0;const h=3*o,d=this.circleKeys[o];if(this._circleAndRectCollide(r[h],r[h+1],r[h+2],t,e,i,n)&&(!a||a(d))&&(!c||!Hh(u,d.overlapMode))){const t=r[h],e=r[h+1],i=r[h+2];if(s.push({key:d,x1:t-i,y1:e-i,x2:t+i,y2:e+i}),c)return!0}}}return!1}_queryCellCircle(t,e,i,n,r,s,o,a){const{circle:l,seenUids:c,overlapMode:u}=o,h=this.boxCells[r];if(null!==h){const t=this.bboxes;for(const e of h)if(!c.box[e]){c.box[e]=!0;const i=4*e,n=this.boxKeys[e];if(this._circleAndRectCollide(l.x,l.y,l.radius,t[i+0],t[i+1],t[i+2],t[i+3])&&(!a||a(n))&&!Hh(u,n.overlapMode))return s.push(!0),!0}}const d=this.circleCells[r];if(null!==d){const t=this.circles;for(const e of d)if(!c.circle[e]){c.circle[e]=!0;const i=3*e,n=this.circleKeys[e];if(this._circlesCollide(t[i],t[i+1],t[i+2],l.x,l.y,l.radius)&&(!a||a(n))&&!Hh(u,n.overlapMode))return s.push(!0),!0}}}_forEachCell(t,e,i,n,r,s,o,a){const l=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),u=this._convertToXCellCoord(i),h=this._convertToYCellCoord(n);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++)if(r.call(this,t,e,i,n,this.xCellCount*l+d,s,o,a))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,i,n,r,s){const o=n-t,a=r-e,l=i+s;return l*l>o*o+a*a}_circleAndRectCollide(t,e,i,n,r,s,o){const a=(s-n)/2,l=Math.abs(t-(n+a));if(l>a+i)return!1;const c=(o-r)/2,u=Math.abs(e-(r+c));if(u>c+i)return!1;if(l<=a||u<=c)return!0;const h=l-a,d=u-c;return h*h+d*d<=i*i}}function Yh(t,e,i,n,r){const s=Sa();return e?(Ea(s,s,[1/r,1/r,1]),i||Ia(s,s,n.angle)):Ma(s,n.labelPlaneMatrix,t),s}function Kh(t,e,i,n,r){if(e){const e=function(t){var e=new ka(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}(t);return Ea(e,e,[r,r,1]),i||Ia(e,e,-n.angle),e}return n.glCoordMatrix}function Jh(t,e,i){let n;i?(n=[t.x,t.y,i(t.x,t.y),1],Ra(n,n,e)):(n=[t.x,t.y,0,1],dd(n,n,e));const r=n[3];return{point:new s(n[0]/r,n[1]/r),signedDistanceFromCamera:r}}function Qh(t,e){return.5+t/e*.5}function td(t,e){const i=t[0]/t[3],n=t[1]/t[3];return i>=-e[0]&&i<=e[0]&&n>=-e[1]&&n<=e[1]}function ed(t,e,i,n,r,o,a,l,c,u){const h=n?t.textSizeData:t.iconSizeData,d=mu(h,i.transform.zoom),p=[256/i.width*2+1,256/i.height*2+1],f=n?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;f.clear();const m=t.lineVertexArray,g=n?t.text.placedSymbolArray:t.icon.placedSymbolArray,_=i.transform.width/i.transform.height;let y=!1;for(let n=0;n<g.length;n++){const x=g.get(n);if(x.hidden||x.writingMode===uu.vertical&&!y){hd(x.numGlyphs,f);continue}let v;if(y=!1,u?(v=[x.anchorX,x.anchorY,u(x.anchorX,x.anchorY),1],Ra(v,v,e)):(v=[x.anchorX,x.anchorY,0,1],dd(v,v,e)),!td(v,p)){hd(x.numGlyphs,f);continue}const b=Qh(i.transform.cameraToCenterDistance,v[3]),w=fu(h,d,x),k=a?w/b:w*b,S=new s(x.anchorX,x.anchorY),T=Jh(S,r,u).point,A={projections:{},offsets:{}},M=rd(x,k,!1,l,e,r,o,t.glyphOffsetArray,m,f,T,S,A,_,c,u);y=M.useVertical,(M.notEnoughRoom||y||M.needsFlipping&&rd(x,k,!0,l,e,r,o,t.glyphOffsetArray,m,f,T,S,A,_,c,u).notEnoughRoom)&&hd(x.numGlyphs,f)}n?t.text.dynamicLayoutVertexBuffer.updateData(f):t.icon.dynamicLayoutVertexBuffer.updateData(f)}function id(t,e,i,n,r,s,o,a,l,c,u,h,d){const p=a.glyphStartIndex+a.numGlyphs,f=a.lineStartIndex,m=a.lineStartIndex+a.lineLength,g=e.getoffsetX(a.glyphStartIndex),_=e.getoffsetX(p-1),y=cd(t*g,i,n,r,s,o,a.segment,f,m,l,c,u,h,d);if(!y)return null;const x=cd(t*_,i,n,r,s,o,a.segment,f,m,l,c,u,h,d);return x?{first:y,last:x}:null}function nd(t,e,i,n){return t===uu.horizontal&&Math.abs(i.y-e.y)>Math.abs(i.x-e.x)*n?{useVertical:!0}:(t===uu.vertical?e.y<i.y:e.x>i.x)?{needsFlipping:!0}:null}function rd(t,e,i,n,r,o,a,l,c,u,h,d,p,f,m,g){const _=e/24,y=t.lineOffsetX*_,x=t.lineOffsetY*_;let v;if(t.numGlyphs>1){const e=t.glyphStartIndex+t.numGlyphs,r=t.lineStartIndex,s=t.lineStartIndex+t.lineLength,u=id(_,l,y,x,i,h,d,t,c,o,p,m,g);if(!u)return{notEnoughRoom:!0};const b=Jh(u.first.point,a,g).point,w=Jh(u.last.point,a,g).point;if(n&&!i){const e=nd(t.writingMode,b,w,f);if(e)return e}v=[u.first];for(let n=t.glyphStartIndex+1;n<e-1;n++)v.push(cd(_*l.getoffsetX(n),y,x,i,h,d,t.segment,r,s,c,o,p,m,g));v.push(u.last)}else{if(n&&!i){const e=Jh(d,r,g).point,i=t.lineStartIndex+t.segment+1,n=new s(c.getx(i),c.gety(i)),o=Jh(n,r,g),a=o.signedDistanceFromCamera>0?o.point:sd(d,n,e,1,r,g),l=nd(t.writingMode,e,a,f);if(l)return l}const e=cd(_*l.getoffsetX(t.glyphStartIndex),y,x,i,h,d,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,c,o,p,m,g);if(!e)return{notEnoughRoom:!0};v=[e]}for(const t of v)vu(u,t.point,t.angle);return{}}function sd(t,e,i,n,r,s){const o=Jh(t.add(t.sub(e)._unit()),r,s).point,a=i.sub(o);return i.add(a._mult(n/a.mag()))}function od(t,e){const{projectionCache:i,lineVertexArray:n,labelPlaneMatrix:r,tileAnchorPoint:o,distanceFromAnchor:a,getElevation:l,previousVertex:c,direction:u,absOffsetX:h}=e;if(i.projections[t])return i.projections[t];const d=new s(n.getx(t),n.gety(t)),p=Jh(d,r,l);if(p.signedDistanceFromCamera>0)return i.projections[t]=p.point,p.point;const f=t-u;return sd(0===a?o:new s(n.getx(f),n.gety(f)),d,c,h-a+1,r,l)}function ad(t,e,i){return t._unit()._perp()._mult(e*i)}function ld(t,e,i,n,r,o,a,l){const{projectionCache:c,direction:u}=l;if(c.offsets[t])return c.offsets[t];const h=i.add(e);if(t+u<n||t+u>=r)return c.offsets[t]=h,h;const d=od(t+u,l),p=ad(d.sub(i),a,u),f=i.add(p),m=d.add(p);return c.offsets[t]=function(t,e,i,n){const r=e.y-t.y,o=e.x-t.x,a=n.y-i.y,l=n.x-i.x,c=a*o-l*r;if(0===c)return null;const u=(l*(t.y-i.y)-a*(t.x-i.x))/c;return new s(t.x+u*o,t.y+u*r)}(o,h,f,m)||h,c.offsets[t]}function cd(t,e,i,n,r,s,o,a,l,c,u,h,d,p){const f=n?t-e:t+e;let m=f>0?1:-1,g=0;n&&(m*=-1,g=Math.PI),m<0&&(g+=Math.PI);let _,y,x=m>0?a+o:a+o+1,v=r,b=r,w=0,k=0;const S=Math.abs(f),T=[];let A;for(;w+k<=S;){if(x+=m,x<a||x>=l)return null;w+=k,b=v,y=_;const t={projectionCache:h,lineVertexArray:c,labelPlaneMatrix:u,tileAnchorPoint:s,distanceFromAnchor:w,getElevation:p,previousVertex:b,direction:m,absOffsetX:S};if(v=od(x,t),0===i)T.push(b),A=v.sub(b);else{let e;const n=v.sub(b);e=0===n.mag()?ad(od(x+m,t).sub(v),i,m):ad(n,i,m),y||(y=b.add(e)),_=ld(x,e,v,a,l,y,i,t),T.push(y),A=_.sub(y)}k=A.mag()}const M=A._mult((S-w)/k)._add(y||b),C=g+Math.atan2(v.y-b.y,v.x-b.x);return T.push(M),{point:M,angle:d?C:0,path:T}}const ud=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function hd(t,e){for(let i=0;i<t;i++){const t=e.length;e.resize(t+4),e.float32.set(ud,3*t)}}function dd(t,e,i){const n=e[0],r=e[1];return t[0]=i[0]*n+i[4]*r+i[12],t[1]=i[1]*n+i[5]*r+i[13],t[3]=i[3]*n+i[7]*r+i[15],t}const pd=100;class fd{constructor(t,e=new Xh(t.width+200,t.height+200,25),i=new Xh(t.width+200,t.height+200,25)){this.transform=t,this.grid=e,this.ignoredGrid=i,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+pd,this.screenBottomBoundary=t.height+pd,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,e,i,n,r,s){const o=this.projectAndGetPerspectiveRatio(n,t.anchorPointX,t.anchorPointY,s),a=i*o.perspectiveRatio,l=t.x1*a+o.point.x,c=t.y1*a+o.point.y,u=t.x2*a+o.point.x,h=t.y2*a+o.point.y;return!this.isInsideGrid(l,c,u,h)||"always"!==e&&this.grid.hitTest(l,c,u,h,e,r)||o.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[l,c,u,h],offscreen:this.isOffscreen(l,c,u,h)}}placeCollisionCircles(t,e,i,n,r,o,a,l,c,u,h,d,p,f){const m=[],g=new s(e.anchorX,e.anchorY),_=Jh(g,o,f),y=Qh(this.transform.cameraToCenterDistance,_.signedDistanceFromCamera),x=(u?r/y:r*y)/24,v=Jh(g,a,f).point,b=id(x,n,e.lineOffsetX*x,e.lineOffsetY*x,!1,v,g,e,i,a,{projections:{},offsets:{}},!1,f);let w=!1,k=!1,S=!0;if(b){const e=.5*d*y+p,i=new s(-100,-100),n=new s(this.screenRightBoundary,this.screenBottomBoundary),r=new Gh,o=b.first,a=b.last;let u=[];for(let t=o.path.length-1;t>=1;t--)u.push(o.path[t]);for(let t=1;t<a.path.length;t++)u.push(a.path[t]);const g=2.5*e;if(l){const t=u.map((t=>Jh(t,l,f)));u=t.some((t=>t.signedDistanceFromCamera<=0))?[]:t.map((t=>t.point))}let _=[];if(u.length>0){const t=u[0].clone(),e=u[0].clone();for(let i=1;i<u.length;i++)t.x=Math.min(t.x,u[i].x),t.y=Math.min(t.y,u[i].y),e.x=Math.max(e.x,u[i].x),e.y=Math.max(e.y,u[i].y);_=t.x>=i.x&&e.x<=n.x&&t.y>=i.y&&e.y<=n.y?[u]:e.x<i.x||t.x>n.x||e.y<i.y||t.y>n.y?[]:function(t,e,i,n,r){const o=[];for(let a=0;a<t.length;a++){const l=t[a];let c;for(let t=0;t<l.length-1;t++){let a=l[t],u=l[t+1];a.x<e&&u.x<e||(a.x<e?a=new s(e,a.y+(e-a.x)/(u.x-a.x)*(u.y-a.y))._round():u.x<e&&(u=new s(e,a.y+(e-a.x)/(u.x-a.x)*(u.y-a.y))._round()),a.y<i&&u.y<i||(a.y<i?a=new s(a.x+(i-a.y)/(u.y-a.y)*(u.x-a.x),i)._round():u.y<i&&(u=new s(a.x+(i-a.y)/(u.y-a.y)*(u.x-a.x),i)._round()),a.x>=n&&u.x>=n||(a.x>=n?a=new s(n,a.y+(n-a.x)/(u.x-a.x)*(u.y-a.y))._round():u.x>=n&&(u=new s(n,a.y+(n-a.x)/(u.x-a.x)*(u.y-a.y))._round()),a.y>=r&&u.y>=r||(a.y>=r?a=new s(a.x+(r-a.y)/(u.y-a.y)*(u.x-a.x),r)._round():u.y>=r&&(u=new s(a.x+(r-a.y)/(u.y-a.y)*(u.x-a.x),r)._round()),c&&a.equals(c[c.length-1])||(c=[a],o.push(c)),c.push(u)))))}}return o}([u],i.x,i.y,n.x,n.y)}for(const i of _){r.reset(i,.25*e);let n=0;n=r.length<=.5*e?1:Math.ceil(r.paddedLength/g)+1;for(let i=0;i<n;i++){const s=i/Math.max(n-1,1),o=r.lerp(s),a=o.x+pd,l=o.y+pd;m.push(a,l,e,0);const u=a-e,d=l-e,p=a+e,f=l+e;if(S=S&&this.isOffscreen(u,d,p,f),k=k||this.isInsideGrid(u,d,p,f),"always"!==t&&this.grid.hitTestCircle(a,l,e,t,h)&&(w=!0,!c))return{circles:[],offscreen:!1,collisionDetected:w}}}}return{circles:!c&&w||!k||y<this.perspectiveRatioCutoff?[]:m,offscreen:S,collisionDetected:w}}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const e=[];let i=1/0,n=1/0,r=-1/0,o=-1/0;for(const a of t){const t=new s(a.x+pd,a.y+pd);i=Math.min(i,t.x),n=Math.min(n,t.y),r=Math.max(r,t.x),o=Math.max(o,t.y),e.push(t)}const a=this.grid.query(i,n,r,o).concat(this.ignoredGrid.query(i,n,r,o)),l={},c={};for(const t of a){const i=t.key;void 0===l[i.bucketInstanceId]&&(l[i.bucketInstanceId]={}),l[i.bucketInstanceId][i.featureIndex]||sa(e,[new s(t.x1,t.y1),new s(t.x2,t.y1),new s(t.x2,t.y2),new s(t.x1,t.y2)])&&(l[i.bucketInstanceId][i.featureIndex]=!0,void 0===c[i.bucketInstanceId]&&(c[i.bucketInstanceId]=[]),c[i.bucketInstanceId].push(i.featureIndex))}return c}insertCollisionBox(t,e,i,n,r,s){(i?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:r,collisionGroupID:s,overlapMode:e},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,e,i,n,r,s){const o=i?this.ignoredGrid:this.grid,a={bucketInstanceId:n,featureIndex:r,collisionGroupID:s,overlapMode:e};for(let e=0;e<t.length;e+=4)o.insertCircle(a,t[e],t[e+1],t[e+2])}projectAndGetPerspectiveRatio(t,e,i,n){let r;return n?(r=[e,i,n(e,i),1],Ra(r,r,t)):(r=[e,i,0,1],dd(r,r,t)),{point:new s((r[0]/r[3]+1)/2*this.transform.width+pd,(-r[1]/r[3]+1)/2*this.transform.height+pd),perspectiveRatio:.5+this.transform.cameraToCenterDistance/r[3]*.5}}isOffscreen(t,e,i,n){return i<pd||t>=this.screenRightBoundary||n<pd||e>this.screenBottomBoundary}isInsideGrid(t,e,i,n){return i>=0&&t<this.gridRightBoundary&&n>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const t=Ta([]);return Ca(t,t,[-100,-100,0]),t}}class md extends s{constructor(t,e,i,n){super(t,e),this.angle=i,void 0!==n&&(this.segment=n)}clone(){return new md(this.x,this.y,this.angle,this.segment)}}var gd;function _d(t,e,i){return e*(Jo/(t.tileSize*Math.pow(2,i-t.tileID.overscaledZ)))}Gn("Anchor",md),function(t){t[t.center=1]="center",t[t.left=2]="left",t[t.right=3]="right",t[t.top=4]="top",t[t.bottom=5]="bottom",t[t["top-left"]=6]="top-left",t[t["top-right"]=7]="top-right",t[t["bottom-left"]=8]="bottom-left",t[t["bottom-right"]=9]="bottom-right"}(gd||(gd={}));class yd{constructor(t,e,i,n){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):n&&i?1:0,this.placed=i}isHidden(){return 0===this.opacity&&!this.placed}}class xd{constructor(t,e,i,n,r){this.text=new yd(t?t.text:null,e,i,r),this.icon=new yd(t?t.icon:null,e,n,r)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class vd{constructor(t,e,i){this.text=t,this.icon=e,this.skipFade=i}}class bd{constructor(){this.invProjMatrix=Sa(),this.viewportMatrix=Sa(),this.circles=[]}}class wd{constructor(t,e,i,n,r){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=i,this.bucketIndex=n,this.tileID=r}}class kd{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e}}return this.collisionGroups[t]}}function Sd(t,e,i,n,r){const{horizontalAlign:o,verticalAlign:a}=hu(t);return new s(-(o-.5)*e+n[0]*r,-(a-.5)*i+n[1]*r)}function Td(t,e,i,n,r,o){const{x1:a,x2:l,y1:c,y2:u,anchorPointX:h,anchorPointY:d}=t,p=new s(e,i);return n&&p._rotate(r?o:-o),{x1:a+p.x,y1:c+p.y,x2:l+p.x,y2:u+p.y,anchorPointX:h,anchorPointY:d}}class Ad{constructor(t,e,i,n,r){this.transform=t.clone(),this.terrain=e,this.collisionIndex=new fd(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=i,this.retainedQueryData={},this.collisionGroups=new kd(n),this.collisionCircleArrays={},this.prevPlacement=r,r&&(r.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,e,i,n){const r=i.getBucket(e),s=i.latestFeatureIndex;if(!r||!s||e.id!==r.layerIds[0])return;const o=i.collisionBoxArray,a=r.layers[0].layout,l=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),c=i.tileSize/Jo,u=this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),h="map"===a.get("text-pitch-alignment"),d="map"===a.get("text-rotation-alignment"),p=_d(i,1,this.transform.zoom),f=Yh(u,h,d,this.transform,p);let m=null;if(h){const t=Kh(u,h,d,this.transform,p);m=Ma([],this.transform.labelPlaneMatrix,t)}this.retainedQueryData[r.bucketInstanceId]=new wd(r.bucketInstanceId,s,r.sourceLayerIndex,r.index,i.tileID);const g={bucket:r,layout:a,posMatrix:u,textLabelPlaneMatrix:f,labelToScreenMatrix:m,scale:l,textPixelRatio:c,holdingForFade:i.holdingForFade(),collisionBoxArray:o,partiallyEvaluatedTextSize:mu(r.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(r.sourceID)};if(n)for(const e of r.sortKeyRanges){const{sortKey:i,symbolInstanceStart:n,symbolInstanceEnd:r}=e;t.push({sortKey:i,symbolInstanceStart:n,symbolInstanceEnd:r,parameters:g})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:r.symbolInstances.length,parameters:g})}attemptAnchorPlacement(t,e,i,n,r,s,o,a,l,c,u,h,d,p,f,m){const g=gd[t.textAnchor],_=[t.textOffset0,t.textOffset1],y=Sd(g,i,n,_,r),x=this.collisionIndex.placeCollisionBox(Td(e,y.x,y.y,s,o,this.transform.angle),u,a,l,c.predicate,m);if((!f||0!==this.collisionIndex.placeCollisionBox(Td(f,y.x,y.y,s,o,this.transform.angle),u,a,l,c.predicate,m).box.length)&&x.box.length>0){let t;if(this.prevPlacement&&this.prevPlacement.variableOffsets[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID].text&&(t=this.prevPlacement.variableOffsets[h.crossTileID].anchor),0===h.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[h.crossTileID]={textOffset:_,width:i,height:n,anchor:g,textBoxScale:r,prevAnchor:t},this.markUsedJustification(d,g,h,p),d.allowVerticalPlacement&&(this.markUsedOrientation(d,p,h),this.placedOrientations[h.crossTileID]=p),{shift:y,placedGlyphBoxes:x}}}placeLayerBucketPart(t,e,i){const{bucket:n,layout:r,posMatrix:s,textLabelPlaneMatrix:o,labelToScreenMatrix:a,textPixelRatio:l,holdingForFade:c,collisionBoxArray:u,partiallyEvaluatedTextSize:h,collisionGroup:d}=t.parameters,p=r.get("text-optional"),f=r.get("icon-optional"),m=gu(r,"text-overlap","text-allow-overlap"),g="always"===m,_=gu(r,"icon-overlap","icon-allow-overlap"),y="always"===_,x="map"===r.get("text-rotation-alignment"),v="map"===r.get("text-pitch-alignment"),b="none"!==r.get("icon-text-fit"),w="viewport-y"===r.get("symbol-z-order"),k=g&&(y||!n.hasIconData()||f),S=y&&(g||!n.hasTextData()||p);!n.collisionArrays&&u&&n.deserializeCollisionBoxes(u);const T=this.retainedQueryData[n.bucketInstanceId].tileID,M=this.terrain?(t,e)=>this.terrain.getElevation(T,t,e):null,C=(t,u)=>{var y,w;if(e[t.crossTileID])return;if(c)return void(this.placements[t.crossTileID]=new vd(!1,!1,!1));let T=!1,C=!1,E=!0,I=null,D={box:null,offscreen:null},z={box:null,offscreen:null},P=null,L=null,F=null,R=0,O=0,B=0;u.textFeatureIndex?R=u.textFeatureIndex:t.useRuntimeCollisionCircles&&(R=t.featureIndex),u.verticalTextFeatureIndex&&(O=u.verticalTextFeatureIndex);const V=u.textBox;if(V){const e=e=>{let i=uu.horizontal;if(n.allowVerticalPlacement&&!e&&this.prevPlacement){const e=this.prevPlacement.placedOrientations[t.crossTileID];e&&(this.placedOrientations[t.crossTileID]=e,i=e,this.markUsedOrientation(n,i,t))}return i},i=(e,i)=>{if(n.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&u.verticalTextBox){for(const t of n.writingModes)if(t===uu.vertical?(D=i(),z=D):D=e(),D&&D.box&&D.box.length)break}else D=e()},r=t.textAnchorOffsetStartIndex,o=t.textAnchorOffsetEndIndex;if(o===r){const r=(e,i)=>{const r=this.collisionIndex.placeCollisionBox(e,m,l,s,d.predicate,M);return r&&r.box&&r.box.length&&(this.markUsedOrientation(n,i,t),this.placedOrientations[t.crossTileID]=i),r};i((()=>r(V,uu.horizontal)),(()=>{const e=u.verticalTextBox;return n.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&e?r(e,uu.vertical):{box:null,offscreen:null}})),e(D&&D.box&&D.box.length)}else{let a=gd[null===(w=null===(y=this.prevPlacement)||void 0===y?void 0:y.variableOffsets[t.crossTileID])||void 0===w?void 0:w.anchor];const c=(e,i,c)=>{const u=e.x2-e.x1,h=e.y2-e.y1,p=t.textBoxScale,f=b&&"never"===_?i:null;let g={box:[],offscreen:!1},y="never"===m?1:2,w="never";a&&y++;for(let i=0;i<y;i++){for(let i=r;i<o;i++){const r=n.textAnchorOffsets.get(i);if(a&&r.textAnchor!==a)continue;const o=this.attemptAnchorPlacement(r,e,u,h,p,x,v,l,s,d,w,t,n,c,f,M);if(o&&(g=o.placedGlyphBoxes,g&&g.box&&g.box.length))return T=!0,I=o.shift,g}a?a=null:w=m}return g};i((()=>c(V,u.iconBox,uu.horizontal)),(()=>{const e=u.verticalTextBox;return n.allowVerticalPlacement&&!(D&&D.box&&D.box.length)&&t.numVerticalGlyphVertices>0&&e?c(e,u.verticalIconBox,uu.vertical):{box:null,offscreen:null}})),D&&(T=D.box,E=D.offscreen);const h=e(D&&D.box);if(!T&&this.prevPlacement){const e=this.prevPlacement.variableOffsets[t.crossTileID];e&&(this.variableOffsets[t.crossTileID]=e,this.markUsedJustification(n,e.anchor,t,h))}}}if(P=D,T=P&&P.box&&P.box.length>0,E=P&&P.offscreen,t.useRuntimeCollisionCircles){const e=n.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex),l=fu(n.textSizeData,h,e),c=r.get("text-padding");L=this.collisionIndex.placeCollisionCircles(m,e,n.lineVertexArray,n.glyphOffsetArray,l,s,o,a,i,v,d.predicate,t.collisionCircleDiameter,c,M),L.circles.length&&L.collisionDetected&&!i&&A("Collisions detected, but collision boxes are not shown"),T=g||L.circles.length>0&&!L.collisionDetected,E=E&&L.offscreen}if(u.iconFeatureIndex&&(B=u.iconFeatureIndex),u.iconBox){const t=t=>{const e=b&&I?Td(t,I.x,I.y,x,v,this.transform.angle):t;return this.collisionIndex.placeCollisionBox(e,_,l,s,d.predicate,M)};z&&z.box&&z.box.length&&u.verticalIconBox?(F=t(u.verticalIconBox),C=F.box.length>0):(F=t(u.iconBox),C=F.box.length>0),E=E&&F.offscreen}const N=p||0===t.numHorizontalGlyphVertices&&0===t.numVerticalGlyphVertices,q=f||0===t.numIconVertices;if(N||q?q?N||(C=C&&T):T=C&&T:C=T=C&&T,T&&P&&P.box&&this.collisionIndex.insertCollisionBox(P.box,m,r.get("text-ignore-placement"),n.bucketInstanceId,z&&z.box&&O?O:R,d.ID),C&&F&&this.collisionIndex.insertCollisionBox(F.box,_,r.get("icon-ignore-placement"),n.bucketInstanceId,B,d.ID),L&&(T&&this.collisionIndex.insertCollisionCircles(L.circles,m,r.get("text-ignore-placement"),n.bucketInstanceId,R,d.ID),i)){const t=n.bucketInstanceId;let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=new bd);for(let t=0;t<L.circles.length;t+=4)e.circles.push(L.circles[t+0]),e.circles.push(L.circles[t+1]),e.circles.push(L.circles[t+2]),e.circles.push(L.collisionDetected?1:0)}if(0===t.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===n.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[t.crossTileID]=new vd(T||k,C||S,E||n.justReloaded),e[t.crossTileID]=!0};if(w){if(0!==t.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const e=n.getSortedSymbolIndexes(this.transform.angle);for(let t=e.length-1;t>=0;--t){const i=e[t];C(n.symbolInstances.get(i),n.collisionArrays[i])}}else for(let e=t.symbolInstanceStart;e<t.symbolInstanceEnd;e++)C(n.symbolInstances.get(e),n.collisionArrays[e]);if(i&&n.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[n.bucketInstanceId];Aa(t.invProjMatrix,s),t.viewportMatrix=this.collisionIndex.getViewportMatrix()}n.justReloaded=!1}markUsedJustification(t,e,i,n){let r;r=n===uu.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[function(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}(e)];const s=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];for(const e of s)e>=0&&(t.text.placedSymbolArray.get(e).crossTileID=r>=0&&e!==r?0:i.crossTileID)}markUsedOrientation(t,e,i){const n=e===uu.horizontal||e===uu.horizontalOnly?e:0,r=e===uu.vertical?e:0,s=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];for(const e of s)t.text.placedSymbolArray.get(e).placedOrientation=n;i.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=r)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let i=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const n=e?e.symbolFadeChange(t):1,r=e?e.opacities:{},s=e?e.variableOffsets:{},o=e?e.placedOrientations:{};for(const t in this.placements){const e=this.placements[t],s=r[t];s?(this.opacities[t]=new xd(s,n,e.text,e.icon),i=i||e.text!==s.text.placed||e.icon!==s.icon.placed):(this.opacities[t]=new xd(null,n,e.text,e.icon,e.skipFade),i=i||e.text||e.icon)}for(const t in r){const e=r[t];if(!this.opacities[t]){const r=new xd(e,n,!1,!1);r.isHidden()||(this.opacities[t]=r,i=i||e.text.placed||e.icon.placed)}}for(const t in s)this.variableOffsets[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.variableOffsets[t]=s[t]);for(const t in o)this.placedOrientations[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.placedOrientations[t]=o[t]);if(e&&void 0===e.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");i?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}updateLayerOpacities(t,e){const i={};for(const n of e){const e=n.getBucket(t);e&&n.latestFeatureIndex&&t.id===e.layerIds[0]&&this.updateBucketOpacities(e,i,n.collisionBoxArray)}}updateBucketOpacities(t,e,i){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const n=t.layers[0],r=n.layout,o=new xd(null,0,!1,!1,!0),a=r.get("text-allow-overlap"),l=r.get("icon-allow-overlap"),c=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),u="map"===r.get("text-rotation-alignment"),h="map"===r.get("text-pitch-alignment"),d="none"!==r.get("icon-text-fit"),p=new xd(null,0,a&&(l||!t.hasIconData()||r.get("icon-optional")),l&&(a||!t.hasTextData()||r.get("text-optional")),!0);!t.collisionArrays&&i&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(i);const f=(t,e,i)=>{for(let n=0;n<e/4;n++)t.opacityVertexArray.emplaceBack(i);t.hasVisibleVertices=t.hasVisibleVertices||i!==Rd};for(let i=0;i<t.symbolInstances.length;i++){const n=t.symbolInstances.get(i),{numHorizontalGlyphVertices:r,numVerticalGlyphVertices:a,crossTileID:l}=n;let m=this.opacities[l];e[l]?m=o:m||(m=p,this.opacities[l]=m),e[l]=!0;const g=n.numIconVertices>0,_=this.placedOrientations[n.crossTileID],y=_===uu.vertical,x=_===uu.horizontal||_===uu.horizontalOnly;if(r>0||a>0){const e=Fd(m.text);f(t.text,r,y?Rd:e),f(t.text,a,x?Rd:e);const i=m.text.isHidden();[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((e=>{e>=0&&(t.text.placedSymbolArray.get(e).hidden=i||y?1:0)})),n.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).hidden=i||x?1:0);const s=this.variableOffsets[n.crossTileID];s&&this.markUsedJustification(t,s.anchor,n,_);const o=this.placedOrientations[n.crossTileID];o&&(this.markUsedJustification(t,"left",n,o),this.markUsedOrientation(t,o,n))}if(g){const e=Fd(m.icon),i=!(d&&n.verticalPlacedIconSymbolIndex&&y);n.placedIconSymbolIndex>=0&&(f(t.icon,n.numIconVertices,i?e:Rd),t.icon.placedSymbolArray.get(n.placedIconSymbolIndex).hidden=m.icon.isHidden()),n.verticalPlacedIconSymbolIndex>=0&&(f(t.icon,n.numVerticalIconVertices,i?Rd:e),t.icon.placedSymbolArray.get(n.verticalPlacedIconSymbolIndex).hidden=m.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const e=t.collisionArrays[i];if(e){let i=new s(0,0);if(e.textBox||e.verticalTextBox){let n=!0;if(c){const t=this.variableOffsets[l];t?(i=Sd(t.anchor,t.width,t.height,t.textOffset,t.textBoxScale),u&&i._rotate(h?this.transform.angle:-this.transform.angle)):n=!1}e.textBox&&Md(t.textCollisionBox.collisionVertexArray,m.text.placed,!n||y,i.x,i.y),e.verticalTextBox&&Md(t.textCollisionBox.collisionVertexArray,m.text.placed,!n||x,i.x,i.y)}const n=Boolean(!x&&e.verticalIconBox);e.iconBox&&Md(t.iconCollisionBox.collisionVertexArray,m.icon.placed,n,d?i.x:0,d?i.y:0),e.verticalIconBox&&Md(t.iconCollisionBox.collisionVertexArray,m.icon.placed,!n,d?i.x:0,d?i.y:0)}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=e.invProjMatrix,t.placementViewportMatrix=e.viewportMatrix,t.collisionCircleArray=e.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const i=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*i>t}setStale(){this.stale=!0}}function Md(t,e,i,n,r){t.emplaceBack(e?1:0,i?1:0,n||0,r||0),t.emplaceBack(e?1:0,i?1:0,n||0,r||0),t.emplaceBack(e?1:0,i?1:0,n||0,r||0),t.emplaceBack(e?1:0,i?1:0,n||0,r||0)}const Cd=Math.pow(2,25),Ed=Math.pow(2,24),Id=Math.pow(2,17),Dd=Math.pow(2,16),zd=Math.pow(2,9),Pd=Math.pow(2,8),Ld=Math.pow(2,1);function Fd(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,i=Math.floor(127*t.opacity);return i*Cd+e*Ed+i*Id+e*Dd+i*zd+e*Pd+i*Ld+e}const Rd=0;class Od{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,e,i,n,r){const s=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(s,n,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,s.sort(((t,e)=>t.sortKey-e.sortKey)));this._currentPartIndex<s.length;)if(e.placeLayerBucketPart(s[this._currentPartIndex],this._seenCrossTileIDs,i),this._currentPartIndex++,r())return!0;return!1}}class Bd{constructor(t,e,i,n,r,s,o,a){this.placement=new Ad(t,e,s,o,a),this._currentPlacementIndex=i.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=r,this._done=!1}isDone(){return this._done}continuePlacement(t,e,i){const n=R.now(),r=()=>!this._forceFullPlacement&&R.now()-n>2;for(;this._currentPlacementIndex>=0;){const n=e[t[this._currentPlacementIndex]],s=this.placement.collisionIndex.transform.zoom;if("symbol"===n.type&&(!n.minzoom||n.minzoom<=s)&&(!n.maxzoom||n.maxzoom>s)){if(this._inProgressLayer||(this._inProgressLayer=new Od(n)),this._inProgressLayer.continuePlacement(i[n.source],this.placement,this._showCollisionBoxes,n,r))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Vd=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Nd{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,i]=new Uint8Array(t,0,2);if(219!==e)throw new Error("Data does not appear to be in a KDBush format.");const n=i>>4;if(1!==n)throw new Error(`Got v${n} data when expected v1.`);const r=Vd[15&i];if(!r)throw new Error("Unrecognized array type.");const[s]=new Uint16Array(t,2,1),[o]=new Uint32Array(t,4,1);return new Nd(o,s,r,t)}constructor(t,e=64,i=Float64Array,n){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=i,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const r=Vd.indexOf(this.ArrayType),s=2*t*this.ArrayType.BYTES_PER_ELEMENT,o=t*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-o%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${i}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+o+a,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+s+o+a),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+o+a,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+r]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=t,this.coords[this._pos++]=e,i}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return qd(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,i,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:s,nodeSize:o}=this,a=[0,r.length-1,0],l=[];for(;a.length;){const c=a.pop()||0,u=a.pop()||0,h=a.pop()||0;if(u-h<=o){for(let o=h;o<=u;o++){const a=s[2*o],c=s[2*o+1];a>=t&&a<=i&&c>=e&&c<=n&&l.push(r[o])}continue}const d=h+u>>1,p=s[2*d],f=s[2*d+1];p>=t&&p<=i&&f>=e&&f<=n&&l.push(r[d]),(0===c?t<=p:e<=f)&&(a.push(h),a.push(d-1),a.push(1-c)),(0===c?i>=p:n>=f)&&(a.push(d+1),a.push(u),a.push(1-c))}return l}within(t,e,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:r,nodeSize:s}=this,o=[0,n.length-1,0],a=[],l=i*i;for(;o.length;){const c=o.pop()||0,u=o.pop()||0,h=o.pop()||0;if(u-h<=s){for(let i=h;i<=u;i++)Zd(r[2*i],r[2*i+1],t,e)<=l&&a.push(n[i]);continue}const d=h+u>>1,p=r[2*d],f=r[2*d+1];Zd(p,f,t,e)<=l&&a.push(n[d]),(0===c?t-i<=p:e-i<=f)&&(o.push(h),o.push(d-1),o.push(1-c)),(0===c?t+i>=p:e+i>=f)&&(o.push(d+1),o.push(u),o.push(1-c))}return a}}function qd(t,e,i,n,r,s){if(r-n<=i)return;const o=n+r>>1;jd(t,e,o,n,r,s),qd(t,e,i,n,o-1,1-s),qd(t,e,i,o+1,r,1-s)}function jd(t,e,i,n,r,s){for(;r>n;){if(r-n>600){const o=r-n+1,a=i-n+1,l=Math.log(o),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(o-c)/o)*(a-o/2<0?-1:1);jd(t,e,i,Math.max(n,Math.floor(i-a*c/o+u)),Math.min(r,Math.floor(i+(o-a)*c/o+u)),s)}const o=e[2*i+s];let a=n,l=r;for($d(t,e,n,i),e[2*r+s]>o&&$d(t,e,n,r);a<l;){for($d(t,e,a,l),a++,l--;e[2*a+s]<o;)a++;for(;e[2*l+s]>o;)l--}e[2*n+s]===o?$d(t,e,n,l):(l++,$d(t,e,l,r)),l<=i&&(n=l+1),i<=l&&(r=l-1)}}function $d(t,e,i,n){Ud(t,i,n),Ud(e,2*i,2*n),Ud(e,2*i+1,2*n+1)}function Ud(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}function Zd(t,e,i,n){const r=t-i,s=e-n;return r*r+s*s}const Wd=.03125;class Gd{constructor(t,e,i){this.tileID=t,this.bucketInstanceId=i,this._symbolsByKey={};const n=new Map;for(let t=0;t<e.length;t++){const i=e.get(t),r=i.key,s=n.get(r);s?s.push(i):n.set(r,[i])}for(const[t,e]of n){const i={positions:e.map((t=>({x:Math.floor(t.anchorX*Wd),y:Math.floor(t.anchorY*Wd)}))),crossTileIDs:e.map((t=>t.crossTileID))};if(i.positions.length>128){const t=new Nd(i.positions.length,16,Uint16Array);for(const{x:e,y:n}of i.positions)t.add(e,n);t.finish(),delete i.positions,i.index=t}this._symbolsByKey[t]=i}}getScaledCoordinates(t,e){const{x:i,y:n,z:r}=this.tileID.canonical,{x:s,y:o,z:a}=e.canonical,l=Wd/Math.pow(2,a-r),c=(o*Jo+t.anchorY)*l,u=n*Jo*Wd;return{x:Math.floor((s*Jo+t.anchorX)*l-i*Jo*Wd),y:Math.floor(c-u)}}findMatches(t,e,i){const n=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z);for(let r=0;r<t.length;r++){const s=t.get(r);if(s.crossTileID)continue;const o=this._symbolsByKey[s.key];if(!o)continue;const a=this.getScaledCoordinates(s,e);if(o.index){const t=o.index.range(a.x-n,a.y-n,a.x+n,a.y+n).sort();for(const e of t){const t=o.crossTileIDs[e];if(!i[t]){i[t]=!0,s.crossTileID=t;break}}}else if(o.positions)for(let t=0;t<o.positions.length;t++){const e=o.positions[t],r=o.crossTileIDs[t];if(Math.abs(e.x-a.x)<=n&&Math.abs(e.y-a.y)<=n&&!i[r]){i[r]=!0,s.crossTileID=r;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class Hd{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Xd{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const t in this.indexes){const i=this.indexes[t],n={};for(const t in i){const r=i[t];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),n[r.tileID.key]=r}this.indexes[t]=n}this.lng=t}addBucket(t,e,i){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let t=0;t<e.symbolInstances.length;t++)e.symbolInstances.get(t).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const n=this.usedCrossTileIDs[t.overscaledZ];for(const i in this.indexes){const r=this.indexes[i];if(Number(i)>t.overscaledZ)for(const i in r){const s=r[i];s.tileID.isChildOf(t)&&s.findMatches(e.symbolInstances,t,n)}else{const s=r[t.scaledTo(Number(i)).key];s&&s.findMatches(e.symbolInstances,t,n)}}for(let t=0;t<e.symbolInstances.length;t++){const r=e.symbolInstances.get(t);r.crossTileID||(r.crossTileID=i.generate(),n[r.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Gd(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const i of e.getCrossTileIDsLists())for(const e of i)delete this.usedCrossTileIDs[t][e]}removeStaleBuckets(t){let e=!1;for(const i in this.indexes){const n=this.indexes[i];for(const r in n)t[n[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,n[r]),delete n[r],e=!0)}return e}}class Yd{constructor(){this.layerIndexes={},this.crossTileIDs=new Hd,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,e,i){let n=this.layerIndexes[t.id];void 0===n&&(n=this.layerIndexes[t.id]=new Xd);let r=!1;const s={};n.handleWrapJump(i);for(const i of e){const e=i.getBucket(t);e&&t.id===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(i.tileID,e,this.crossTileIDs)&&(r=!0),s[e.bucketInstanceId]=!0)}return n.removeStaleBuckets(s)&&(r=!0),r}pruneUnusedLayers(t){const e={};t.forEach((t=>{e[t]=!0}));for(const t in this.layerIndexes)e[t]||delete this.layerIndexes[t]}}const Kd=(t,e)=>Un(t,e&&e.filter((t=>"source.canvas"!==t.identifier))),Jd=y(pt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Qd=y(pt,["setCenter","setZoom","setBearing","setPitch"]),tp=function(){const t={},e=lt.$version;for(const i in lt.$root){const n=lt.$root[i];if(n.required){let r=null;r="version"===i?e:"array"===n.type?[]:{},null!=r&&(t[i]=r)}}return t}();class ep extends at{constructor(t,e={}){super(),this.map=t,this.dispatcher=new Qu(Wh(),this,t._getMapId()),this.imageManager=new ju,this.imageManager.setEventedParent(this),this.glyphManager=new Wu(t._requestManager,e.localIdeographFontFamily),this.lineAtlas=new Yu(256,512),this.crossTileSymbolIndex=new Yd,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new Kn,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",N());const i=this;this._rtlTextPluginCallback=ep.registerForPluginStateChange((t=>{i.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},((t,e)=>{if(jr(t),e&&e.every((t=>t)))for(const t in i.sourceCaches){const e=i.sourceCaches[t].getSource().type;"vector"!==e&&"geojson"!==e||i.sourceCaches[t].reload()}}))})),this.on("data",(t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.sourceCaches[t.sourceId];if(!e)return;const i=e.getSource();if(i&&i.vectorLayerIds)for(const t in this._layers){const e=this._layers[t];e.source===i.id&&this._validateLayer(e)}}))}loadURL(t,e={},i){this.fire(new st("dataloading",{dataType:"style"})),e.validate="boolean"!=typeof e.validate||e.validate;const n=this.map._requestManager.transformRequest(t,tt.Style);this._request=U(n,((t,n)=>{this._request=null,t?this.fire(new ot(t)):n&&this._load(n,e,i)}))}loadJSON(t,e={},i){this.fire(new st("dataloading",{dataType:"style"})),this._request=R.frame((()=>{this._request=null,e.validate=!1!==e.validate,this._load(t,e,i)}))}loadEmpty(){this.fire(new st("dataloading",{dataType:"style"})),this._load(tp,{validate:!1})}_load(t,e,i){var n;const r=e.transformStyle?e.transformStyle(i,t):t;if(!e.validate||!Kd(this,Nn(r))){this._loaded=!0,this.stylesheet=r;for(const t in r.sources)this.addSource(t,r.sources[t],{validate:!1});r.sprite?this._loadSprite(r.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(r.glyphs),this._createLayers(),this.light=new Xu(this.stylesheet.light),this.map.setTerrain(null!==(n=this.stylesheet.terrain)&&void 0!==n?n:null),this.fire(new st("data",{dataType:"style"})),this.fire(new st("style.load"))}}_createLayers(){const t=ht(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",t),this._order=t.map((t=>t.id)),this._layers={},this._serializedLayers=null;for(const e of t){const t=Ou(e);t.setEventedParent(this,{layer:{id:e.id}}),this._layers[e.id]=t}}_loadSprite(t,e=!1,i){this.imageManager.setLoaded(!1),this._spriteRequest=function(t,e,i,n){const r=Bu(t),s=r.length,o=i>1?"@2x":"",a={},l={},c={};for(const{id:t,url:i}of r){const r=e.transformRequest(e.normalizeSpriteURL(i,o,".json"),tt.SpriteJSON),u=`${t}_${r.url}`;a[u]=U(r,((e,i)=>{delete a[u],l[t]=i,Vu(n,l,c,e,s)}));const h=e.transformRequest(e.normalizeSpriteURL(i,o,".png"),tt.SpriteImage),d=`${t}_${h.url}`;a[d]=Q.getImage(h,((e,i)=>{delete a[d],c[t]=i,Vu(n,l,c,e,s)}))}return{cancel(){for(const t of Object.values(a))t.cancel()}}}(t,this.map._requestManager,this.map.getPixelRatio(),((t,n)=>{if(this._spriteRequest=null,t)this.fire(new ot(t));else if(n)for(const t in n){this._spritesImagesIds[t]=[];const i=this._spritesImagesIds[t]?this._spritesImagesIds[t].filter((t=>!(t in n))):[];for(const t of i)this.imageManager.removeImage(t),this._changedImages[t]=!0;for(const i in n[t]){const r="default"===t?i:`${t}:${i}`;this._spritesImagesIds[t].push(r),r in this.imageManager.images?this.imageManager.updateImage(r,n[t][i],!1):this.imageManager.addImage(r,n[t][i]),e&&(this._changedImages[r]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),e&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new st("data",{dataType:"style"})),i&&i(t)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new st("data",{dataType:"style"}))}_validateLayer(t){const e=this.sourceCaches[t.source];if(!e)return;const i=t.sourceLayer;if(!i)return;const n=e.getSource();("geojson"===n.type||n.vectorLayerIds&&-1===n.vectorLayerIds.indexOf(i))&&this.fire(new ot(new Error(`Source layer "${i}" does not exist on source "${n.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t){const e=this._serializedAllLayers();if(!t||0===t.length)return Object.values(e);const i=[];for(const n of t)e[n]&&i.push(e[n]);return i}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const e=Object.keys(this._layers);for(const i of e){const e=this._layers[i];"custom"!==e.type&&(t[i]=e.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const e=this._changed;if(this._changed){const e=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);(e.length||i.length)&&this._updateWorkerLayers(e,i);for(const t in this._updatedSources){const e=this._updatedSources[t];if("reload"===e)this._reloadSource(t);else{if("clear"!==e)throw new Error(`Invalid action ${e}`);this._clearSource(t)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const e in this._updatedPaintProps)this._layers[e].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}const i={};for(const t in this.sourceCaches){const e=this.sourceCaches[t];i[t]=e.used,e.used=!1}for(const e of this._order){const i=this._layers[e];i.recalculate(t,this._availableImages),!i.isHidden(t.zoom)&&i.source&&(this.sourceCaches[i.source].used=!0)}for(const t in i){const e=this.sourceCaches[t];i[t]!==e.used&&e.fire(new st("data",{sourceDataType:"visibility",dataType:"source",sourceId:t}))}this.light.recalculate(t),this.z=t.zoom,e&&this.fire(new st("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(t),removedIds:e})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,e={}){this._checkLoaded();const i=this.serialize();if(t=e.transformStyle?e.transformStyle(i,t):t,Kd(this,Nn(t)))return!1;(t=S(t)).layers=ht(t.layers);const n=function(t,e){if(!t)return[{command:pt.setStyle,args:[e]}];let i=[];try{if(!dt(t.version,e.version))return[{command:pt.setStyle,args:[e]}];dt(t.center,e.center)||i.push({command:pt.setCenter,args:[e.center]}),dt(t.zoom,e.zoom)||i.push({command:pt.setZoom,args:[e.zoom]}),dt(t.bearing,e.bearing)||i.push({command:pt.setBearing,args:[e.bearing]}),dt(t.pitch,e.pitch)||i.push({command:pt.setPitch,args:[e.pitch]}),dt(t.sprite,e.sprite)||i.push({command:pt.setSprite,args:[e.sprite]}),dt(t.glyphs,e.glyphs)||i.push({command:pt.setGlyphs,args:[e.glyphs]}),dt(t.transition,e.transition)||i.push({command:pt.setTransition,args:[e.transition]}),dt(t.light,e.light)||i.push({command:pt.setLight,args:[e.light]});const n={},r=[];!function(t,e,i,n){let r;for(r in e=e||{},t=t||{})Object.prototype.hasOwnProperty.call(t,r)&&(Object.prototype.hasOwnProperty.call(e,r)||mt(r,i,n));for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Object.prototype.hasOwnProperty.call(t,r)?dt(t[r],e[r])||("geojson"===t[r].type&&"geojson"===e[r].type&&_t(t,e,r)?i.push({command:pt.setGeoJSONSourceData,args:[r,e[r].data]}):gt(r,e,i,n)):ft(r,e,i))}(t.sources,e.sources,r,n);const s=[];t.layers&&t.layers.forEach((t=>{n[t.source]?i.push({command:pt.removeLayer,args:[t.id]}):s.push(t)})),i=i.concat(r),function(t,e,i){e=e||[];const n=(t=t||[]).map(xt),r=e.map(xt),s=t.reduce(vt,{}),o=e.reduce(vt,{}),a=n.slice(),l=Object.create(null);let c,u,h,d,p,f,m;for(c=0,u=0;c<n.length;c++)h=n[c],Object.prototype.hasOwnProperty.call(o,h)?u++:(i.push({command:pt.removeLayer,args:[h]}),a.splice(a.indexOf(h,u),1));for(c=0,u=0;c<r.length;c++)h=r[r.length-1-c],a[a.length-1-c]!==h&&(Object.prototype.hasOwnProperty.call(s,h)?(i.push({command:pt.removeLayer,args:[h]}),a.splice(a.lastIndexOf(h,a.length-u),1)):u++,f=a[a.length-c],i.push({command:pt.addLayer,args:[o[h],f]}),a.splice(a.length-c,0,h),l[h]=!0);for(c=0;c<r.length;c++)if(h=r[c],d=s[h],p=o[h],!l[h]&&!dt(d,p))if(dt(d.source,p.source)&&dt(d["source-layer"],p["source-layer"])&&dt(d.type,p.type)){for(m in yt(d.layout,p.layout,i,h,null,pt.setLayoutProperty),yt(d.paint,p.paint,i,h,null,pt.setPaintProperty),dt(d.filter,p.filter)||i.push({command:pt.setFilter,args:[h,p.filter]}),dt(d.minzoom,p.minzoom)&&dt(d.maxzoom,p.maxzoom)||i.push({command:pt.setLayerZoomRange,args:[h,p.minzoom,p.maxzoom]}),d)Object.prototype.hasOwnProperty.call(d,m)&&"layout"!==m&&"paint"!==m&&"filter"!==m&&"metadata"!==m&&"minzoom"!==m&&"maxzoom"!==m&&(0===m.indexOf("paint.")?yt(d[m],p[m],i,h,m.slice(6),pt.setPaintProperty):dt(d[m],p[m])||i.push({command:pt.setLayerProperty,args:[h,m,p[m]]}));for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&!Object.prototype.hasOwnProperty.call(d,m)&&"layout"!==m&&"paint"!==m&&"filter"!==m&&"metadata"!==m&&"minzoom"!==m&&"maxzoom"!==m&&(0===m.indexOf("paint.")?yt(d[m],p[m],i,h,m.slice(6),pt.setPaintProperty):dt(d[m],p[m])||i.push({command:pt.setLayerProperty,args:[h,m,p[m]]}))}else i.push({command:pt.removeLayer,args:[h]}),f=a[a.lastIndexOf(h)+1],i.push({command:pt.addLayer,args:[p,f]})}(s,e.layers,i)}catch(t){console.warn("Unable to compute style diff:",t),i=[{command:pt.setStyle,args:[e]}]}return i}(i,t).filter((t=>!(t.command in Qd)));if(0===n.length)return!1;const r=n.filter((t=>!(t.command in Jd)));if(r.length>0)throw new Error(`Unimplemented: ${r.map((t=>t.command)).join(", ")}.`);for(const t of n)"setTransition"!==t.command&&this[t.command].apply(this,t.args);return this.stylesheet=t,this._serializedLayers=null,!0}addImage(t,e){if(this.getImage(t))return this.fire(new ot(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,e),this._afterImageUpdated(t)}updateImage(t,e){this.imageManager.updateImage(t,e)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new ot(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new st("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,e,i={}){if(this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error(`Source "${t}" already exists.`);if(!e.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(e).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(e.type)>=0&&this._validate(Nn.source,`sources.${t}`,e,null,i))return;this.map&&this.map._collectResourceTiming&&(e.collectResourceTiming=!0);const n=this.sourceCaches[t]=new Vh(t,e,this.dispatcher);n.style=this,n.setEventedParent(this,(()=>({isSourceLoaded:n.loaded(),source:n.serialize(),sourceId:t}))),n.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(const e in this._layers)if(this._layers[e].source===t)return this.fire(new ot(new Error(`Source "${t}" cannot be removed while layer "${e}" is using it.`)));const e=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],e.fire(new st("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),e.setEventedParent(null),e.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,e){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error(`There is no source with this ID=${t}`);const i=this.sourceCaches[t].getSource();if("geojson"!==i.type)throw new Error(`geojsonSource.type is ${i.type}, which is !== 'geojson`);i.setData(e),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,e,i={}){this._checkLoaded();const n=t.id;if(this.getLayer(n))return void this.fire(new ot(new Error(`Layer "${n}" already exists on this map.`)));let r;if("custom"===t.type){if(Kd(this,function(t){const e=[],i=t.id;return void 0===i&&e.push({message:`layers.${i}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${i}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e}(t)))return;r=Ou(t)}else{if("source"in t&&"object"==typeof t.source&&(this.addSource(n,t.source),t=_(t=S(t),{source:n})),this._validate(Nn.layer,`layers.${n}`,t,{arrayIndex:-1},i))return;r=Ou(t),this._validateLayer(r),r.setEventedParent(this,{layer:{id:n}})}const s=e?this._order.indexOf(e):this._order.length;if(e&&-1===s)this.fire(new ot(new Error(`Cannot add layer "${n}" before non-existing layer "${e}".`)));else{if(this._order.splice(s,0,n),this._layerOrderChanged=!0,this._layers[n]=r,this._removedLayers[n]&&r.source&&"custom"!==r.type){const t=this._removedLayers[n];delete this._removedLayers[n],t.type!==r.type?this._updatedSources[r.source]="clear":(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause())}this._updateLayer(r),r.onAdd&&r.onAdd(this.map)}}moveLayer(t,e){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new ot(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===e)return;const i=this._order.indexOf(t);this._order.splice(i,1);const n=e?this._order.indexOf(e):this._order.length;e&&-1===n?this.fire(new ot(new Error(`Cannot move layer "${t}" before non-existing layer "${e}".`))):(this._order.splice(n,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const e=this._layers[t];if(!e)return void this.fire(new ot(new Error(`Cannot remove non-existing layer "${t}".`)));e.setEventedParent(null);const i=this._order.indexOf(t);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=e,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],e.onRemove&&e.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,e,i){this._checkLoaded();const n=this.getLayer(t);n?n.minzoom===e&&n.maxzoom===i||(null!=e&&(n.minzoom=e),null!=i&&(n.maxzoom=i),this._updateLayer(n)):this.fire(new ot(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,e,i={}){this._checkLoaded();const n=this.getLayer(t);if(n){if(!k(n.filter,e))return null==e?(n.filter=void 0,void this._updateLayer(n)):void(this._validate(Nn.filter,`layers.${n.id}.filter`,e,null,i)||(n.filter=S(e),this._updateLayer(n)))}else this.fire(new ot(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return S(this.getLayer(t).filter)}setLayoutProperty(t,e,i,n={}){this._checkLoaded();const r=this.getLayer(t);r?k(r.getLayoutProperty(e),i)||(r.setLayoutProperty(e,i,n),this._updateLayer(r)):this.fire(new ot(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,e){const i=this.getLayer(t);if(i)return i.getLayoutProperty(e);this.fire(new ot(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,e,i,n={}){this._checkLoaded();const r=this.getLayer(t);r?k(r.getPaintProperty(e),i)||(r.setPaintProperty(e,i,n)&&this._updateLayer(r),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new ot(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,e){return this.getLayer(t).getPaintProperty(e)}setFeatureState(t,e){this._checkLoaded();const i=t.source,n=t.sourceLayer,r=this.sourceCaches[i];if(void 0===r)return void this.fire(new ot(new Error(`The source '${i}' does not exist in the map's style.`)));const s=r.getSource().type;"geojson"===s&&n?this.fire(new ot(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==s||n?(void 0===t.id&&this.fire(new ot(new Error("The feature id parameter must be provided."))),r.setFeatureState(n,t.id,e)):this.fire(new ot(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,e){this._checkLoaded();const i=t.source,n=this.sourceCaches[i];if(void 0===n)return void this.fire(new ot(new Error(`The source '${i}' does not exist in the map's style.`)));const r=n.getSource().type,s="vector"===r?t.sourceLayer:void 0;"vector"!==r||s?e&&"string"!=typeof t.id&&"number"!=typeof t.id?this.fire(new ot(new Error("A feature id is required to remove its specific state property."))):n.removeFeatureState(s,t.id,e):this.fire(new ot(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const e=t.source,i=t.sourceLayer,n=this.sourceCaches[e];if(void 0!==n)return"vector"!==n.getSource().type||i?(void 0===t.id&&this.fire(new ot(new Error("The feature id parameter must be provided."))),n.getFeatureState(i,t.id)):void this.fire(new ot(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new ot(new Error(`The source '${e}' does not exist in the map's style.`)))}getTransition(){return _({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=b(this.sourceCaches,(t=>t.serialize())),e=this._serializeByIds(this._order),i=this.map.getTerrain()||void 0,n=this.stylesheet;return w({version:n.version,name:n.name,metadata:n.metadata,light:n.light,center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch,sprite:n.sprite,glyphs:n.glyphs,transition:n.transition,sources:t,layers:e,terrain:i},(t=>void 0!==t))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._layers[t].type,i={},n=[];for(let r=this._order.length-1;r>=0;r--){const s=this._order[r];if(e(s)){i[s]=r;for(const e of t){const t=e[s];if(t)for(const e of t)n.push(e)}}}n.sort(((t,e)=>e.intersectionZ-t.intersectionZ));const r=[];for(let s=this._order.length-1;s>=0;s--){const o=this._order[s];if(e(o))for(let t=n.length-1;t>=0;t--){const e=n[t].feature;if(i[e.layer.id]<s)break;r.push(e),n.pop()}else for(const e of t){const t=e[o];if(t)for(const e of t)r.push(e.feature)}}return r}queryRenderedFeatures(t,e,i){e&&e.filter&&this._validate(Nn.filter,"queryRenderedFeatures.filter",e.filter,null,e);const n={};if(e&&e.layers){if(!Array.isArray(e.layers))return this.fire(new ot(new Error("parameters.layers must be an Array."))),[];for(const t of e.layers){const e=this._layers[t];if(!e)return this.fire(new ot(new Error(`The layer '${t}' does not exist in the map's style and cannot be queried for features.`))),[];n[e.source]=!0}}const r=[];e.availableImages=this._availableImages;const s=this._serializedAllLayers();for(const o in this.sourceCaches)e.layers&&!n[o]||r.push(Eh(this.sourceCaches[o],this._layers,s,t,e,i));return this.placement&&r.push(function(t,e,i,n,r,s,o){const a={},l=s.queryRenderedSymbols(n),c=[];for(const t of Object.keys(l).map(Number))c.push(o[t]);c.sort(Ih);for(const i of c){const n=i.featureIndex.lookupSymbolFeatures(l[i.bucketInstanceId],e,i.bucketIndex,i.sourceLayerIndex,r.filter,r.layers,r.availableImages,t);for(const t in n){const e=a[t]=a[t]||[],r=n[t];r.sort(((t,e)=>{const n=i.featureSortOrder;if(n){const i=n.indexOf(t.featureIndex);return n.indexOf(e.featureIndex)-i}return e.featureIndex-t.featureIndex}));for(const t of r)e.push(t)}}for(const e in a)a[e].forEach((n=>{const r=n.feature,s=i[t[e].source].getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=s}));return a}(this._layers,s,this.sourceCaches,t,e,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(r)}querySourceFeatures(t,e){e&&e.filter&&this._validate(Nn.filter,"querySourceFeatures.filter",e.filter,null,e);const i=this.sourceCaches[t];return i?function(t,e){const i=t.getRenderableIds().map((e=>t.getTileByID(e))),n=[],r={};for(let t=0;t<i.length;t++){const s=i[t],o=s.tileID.canonical.key;r[o]||(r[o]=!0,s.querySourceFeatures(n,e))}return n}(i,e):[]}addSourceType(t,e,i){return Mh(t)?i(new Error(`A source type called "${t}" already exists.`)):(((t,e)=>{Ah[t]=e})(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},i):i(null,null))}getLight(){return this.light.getLight()}setLight(t,e={}){this._checkLoaded();const i=this.light.getLight();let n=!1;for(const e in t)if(!k(t[e],i[e])){n=!0;break}if(!n)return;const r={now:R.now(),transition:_({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,e),this.light.updateTransitions(r)}_validate(t,e,i,n,r={}){return(!r||!1!==r.validate)&&Kd(this,t.call(Nn,_({key:e,style:this.serialize(),value:i,styleSpec:lt},n)))}_remove(t=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),Ur.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this.sourceCaches){const e=this.sourceCaches[t];e.setEventedParent(null),e.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const e in this.sourceCaches)this.sourceCaches[e].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,e,i,n,r=!1){let s=!1,o=!1;const a={};for(const e of this._order){const i=this._layers[e];if("symbol"!==i.type)continue;if(!a[i.source]){const t=this.sourceCaches[i.source];a[i.source]=t.getRenderableIds(!0).map((e=>t.getTileByID(e))).sort(((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)))}const n=this.crossTileSymbolIndex.addLayer(i,a[i.source],t.center.lng);s=s||n}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((r=r||this._layerOrderChanged||0===i)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(R.now(),t.zoom))&&(this.pauseablePlacement=new Bd(t,this.map.terrain,this._order,r,e,i,n,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,a),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(R.now()),o=!0),s&&this.pauseablePlacement.placement.setStale()),o||s)for(const t of this._order){const e=this._layers[t];"symbol"===e.type&&this.placement.updateLayerOpacities(e,a[e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(R.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,e,i){this.imageManager.getImages(e.icons,i),this._updateTilesForChangedImages();const n=this.sourceCaches[e.source];n&&n.setDependencies(e.tileID.key,e.type,e.icons)}getGlyphs(t,e,i){this.glyphManager.getGlyphs(e.stacks,i);const n=this.sourceCaches[e.source];n&&n.setDependencies(e.tileID.key,e.type,[""])}getResource(t,e,i){return $(e,i)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,e={}){this._checkLoaded(),t&&this._validate(Nn.glyphs,"glyphs",t,null,e)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,e,i={},n){this._checkLoaded();const r=[{id:t,url:e}],s=[...Bu(this.stylesheet.sprite),...r];this._validate(Nn.sprite,"sprite",s,null,i)||(this.stylesheet.sprite=s,this._loadSprite(r,!0,n))}removeSprite(t){this._checkLoaded();const e=Bu(this.stylesheet.sprite);if(e.find((e=>e.id===t))){if(this._spritesImagesIds[t])for(const e of this._spritesImagesIds[t])this.imageManager.removeImage(e),this._changedImages[e]=!0;e.splice(e.findIndex((e=>e.id===t)),1),this.stylesheet.sprite=e.length>0?e:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new st("data",{dataType:"style"}))}else this.fire(new ot(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return Bu(this.stylesheet.sprite)}setSprite(t,e={},i){this._checkLoaded(),t&&this._validate(Nn.sprite,"sprite",t,null,e)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,i):(this._unloadSprite(),i&&i(null)))}}ep.registerForPluginStateChange=function(t){return t({pluginStatus:Nr,pluginURL:qr}),Ur.on("pluginStateChange",t),t};var ip=fs([{name:"a_pos",type:"Int16",components:2}]),np="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const rp={prelude:sp("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:sp("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:sp("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:sp("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:sp("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:sp("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:sp("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:sp("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:sp("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:sp("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:sp("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:sp("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:sp("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:sp("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:sp("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:sp("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:sp("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:sp("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:sp("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:sp("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:sp("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:sp("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:sp("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:sp("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:sp("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:sp("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:sp("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",np),terrainDepth:sp("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",np),terrainCoords:sp("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",np)};function sp(t,e){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,n=e.match(/attribute ([\w]+) ([\w]+)/g),r=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),s=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=s?s.concat(r):r,a={};return{fragmentSource:t=t.replace(i,((t,e,i,n,r)=>(a[r]=!0,"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nvarying ${i} ${n} ${r};\n#else\nuniform ${i} ${n} u_${r};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${r}\n    ${i} ${n} ${r} = u_${r};\n#endif\n`))),vertexSource:e=e.replace(i,((t,e,i,n,r)=>{const s="float"===n?"vec2":"vec4",o=r.match(/color/)?"color":s;return a[r]?"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${i} ${s} a_${r};\nvarying ${i} ${n} ${r};\n#else\nuniform ${i} ${n} u_${r};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = a_${r};\n#else\n    ${i} ${n} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = unpack_mix_${o}(a_${r}, u_${r}_t);\n#else\n    ${i} ${n} ${r} = u_${r};\n#endif\n`:"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${i} ${s} a_${r};\n#else\nuniform ${i} ${n} u_${r};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${i} ${n} ${r} = a_${r};\n#else\n    ${i} ${n} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${i} ${n} ${r} = unpack_mix_${o}(a_${r}, u_${r}_t);\n#else\n    ${i} ${n} ${r} = u_${r};\n#endif\n`})),staticAttributes:n,staticUniforms:o}}class op{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,e,i,n,r,s,o,a,l){this.context=t;let c=this.boundPaintVertexBuffers.length!==n.length;for(let t=0;!c&&t<n.length;t++)this.boundPaintVertexBuffers[t]!==n[t]&&(c=!0);!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==i||c||this.boundIndexBuffer!==r||this.boundVertexOffset!==s||this.boundDynamicVertexBuffer!==o||this.boundDynamicVertexBuffer2!==a||this.boundDynamicVertexBuffer3!==l?this.freshBind(e,i,n,r,s,o,a,l):(t.bindVertexArray.set(this.vao),o&&o.bind(),r&&r.dynamicDraw&&r.bind(),a&&a.bind(),l&&l.bind())}freshBind(t,e,i,n,r,s,o,a){const l=t.numAttributes,c=this.context,u=c.gl;this.vao&&this.destroy(),this.vao=c.createVertexArray(),c.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=n,this.boundVertexOffset=r,this.boundDynamicVertexBuffer=s,this.boundDynamicVertexBuffer2=o,this.boundDynamicVertexBuffer3=a,e.enableAttributes(u,t);for(const e of i)e.enableAttributes(u,t);s&&s.enableAttributes(u,t),o&&o.enableAttributes(u,t),a&&a.enableAttributes(u,t),e.bind(),e.setVertexAttribPointers(u,t,r);for(const e of i)e.bind(),e.setVertexAttribPointers(u,t,r);s&&(s.bind(),s.setVertexAttribPointers(u,t,r)),n&&n.bind(),o&&(o.bind(),o.setVertexAttribPointers(u,t,r)),a&&(a.bind(),a.setVertexAttribPointers(u,t,r)),c.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function ap(t){const e=[];for(let i=0;i<t.length;i++){if(null===t[i])continue;const n=t[i].split(" ");e.push(n.pop())}return e}class lp{constructor(t,e,i,n,r,s){const o=t.gl;this.program=o.createProgram();const a=ap(e.staticAttributes),l=i?i.getBinderAttributes():[],c=a.concat(l),u=rp.prelude.staticUniforms?ap(rp.prelude.staticUniforms):[],h=e.staticUniforms?ap(e.staticUniforms):[],d=i?i.getBinderUniforms():[],p=u.concat(h).concat(d),f=[];for(const t of p)f.indexOf(t)<0&&f.push(t);const m=i?i.defines():[];r&&m.push("#define OVERDRAW_INSPECTOR;"),s&&m.push("#define TERRAIN3D;");const g=m.concat(rp.prelude.fragmentSource,e.fragmentSource).join("\n"),_=m.concat(rp.prelude.vertexSource,e.vertexSource).join("\n"),y=o.createShader(o.FRAGMENT_SHADER);if(o.isContextLost())return void(this.failedToCreate=!0);if(o.shaderSource(y,g),o.compileShader(y),!o.getShaderParameter(y,o.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${o.getShaderInfoLog(y)}`);o.attachShader(this.program,y);const x=o.createShader(o.VERTEX_SHADER);if(o.isContextLost())return void(this.failedToCreate=!0);if(o.shaderSource(x,_),o.compileShader(x),!o.getShaderParameter(x,o.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${o.getShaderInfoLog(x)}`);o.attachShader(this.program,x),this.attributes={};const v={};this.numAttributes=c.length;for(let t=0;t<this.numAttributes;t++)c[t]&&(o.bindAttribLocation(this.program,t,c[t]),this.attributes[c[t]]=t);if(o.linkProgram(this.program),!o.getProgramParameter(this.program,o.LINK_STATUS))throw new Error(`Program failed to link: ${o.getProgramInfoLog(this.program)}`);o.deleteShader(x),o.deleteShader(y);for(let t=0;t<f.length;t++){const e=f[t];if(e&&!v[e]){const t=o.getUniformLocation(this.program,e);t&&(v[e]=t)}}this.fixedUniforms=n(t,v),this.terrainUniforms=((t,e)=>({u_depth:new Lo(t,e.u_depth),u_terrain:new Lo(t,e.u_terrain),u_terrain_dim:new Fo(t,e.u_terrain_dim),u_terrain_matrix:new qo(t,e.u_terrain_matrix),u_terrain_unpack:new Bo(t,e.u_terrain_unpack),u_terrain_exaggeration:new Fo(t,e.u_terrain_exaggeration)}))(t,v),this.binderUniforms=i?i.getUniforms(t,v):[]}draw(t,e,i,n,r,s,o,a,l,c,u,h,d,p,f,m,g,_){const y=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(i),t.setStencilMode(n),t.setColorMode(r),t.setCullFace(s),a){t.activeTexture.set(y.TEXTURE2),y.bindTexture(y.TEXTURE_2D,a.depthTexture),t.activeTexture.set(y.TEXTURE3),y.bindTexture(y.TEXTURE_2D,a.texture);for(const t in this.terrainUniforms)this.terrainUniforms[t].set(a[t])}for(const t in this.fixedUniforms)this.fixedUniforms[t].set(o[t]);f&&f.setUniforms(t,this.binderUniforms,d,{zoom:p});let x=0;switch(e){case y.LINES:x=2;break;case y.TRIANGLES:x=3;break;case y.LINE_STRIP:x=1}for(const i of h.get()){const n=i.vaos||(i.vaos={});(n[l]||(n[l]=new op)).bind(t,this,c,f?f.getPaintVertexBuffers():[],u,i.vertexOffset,m,g,_),y.drawElements(e,i.primitiveLength*x,y.UNSIGNED_SHORT,i.primitiveOffset*x*2)}}}function cp(t,e,i){const n=1/_d(i,1,e.transform.tileZoom),r=Math.pow(2,i.tileID.overscaledZ),s=i.tileSize*Math.pow(2,e.transform.tileZoom)/r,o=s*(i.tileID.canonical.x+i.tileID.wrap*r),a=s*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[n,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[o>>16,a>>16],u_pixel_coord_lower:[65535&o,65535&a]}}const up=(t,e,i,n)=>{const r=e.style.light,s=r.properties.get("position"),o=[s.x,s.y,s.z],a=function(){var t=new ka(9);return ka!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}();"viewport"===r.properties.get("anchor")&&function(t,e){var i=Math.sin(e),n=Math.cos(e);t[0]=n,t[1]=i,t[2]=0,t[3]=-i,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1}(a,-e.transform.angle),function(t,e,i){var n=e[0],r=e[1],s=e[2];t[0]=n*i[0]+r*i[3]+s*i[6],t[1]=n*i[1]+r*i[4]+s*i[7],t[2]=n*i[2]+r*i[5]+s*i[8]}(o,o,a);const l=r.properties.get("color");return{u_matrix:t,u_lightpos:o,u_lightintensity:r.properties.get("intensity"),u_lightcolor:[l.r,l.g,l.b],u_vertical_gradient:+i,u_opacity:n}},hp=(t,e,i,n,r,s,o)=>_(up(t,e,i,n),cp(s,e,o),{u_height_factor:-Math.pow(2,r.overscaledZ)/o.tileSize/8}),dp=t=>({u_matrix:t}),pp=(t,e,i,n)=>_(dp(t),cp(i,e,n)),fp=(t,e)=>({u_matrix:t,u_world:e}),mp=(t,e,i,n,r)=>_(pp(t,e,i,n),{u_world:r}),gp=(t,e,i,n)=>{const r=t.transform;let s,o;if("map"===n.paint.get("circle-pitch-alignment")){const t=_d(i,1,r.zoom);s=!0,o=[t,t]}else s=!1,o=r.pixelsToGLUnits;return{u_camera_to_center_distance:r.cameraToCenterDistance,u_scale_with_map:+("map"===n.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(e.posMatrix,i,n.paint.get("circle-translate"),n.paint.get("circle-translate-anchor")),u_pitch_with_map:+s,u_device_pixel_ratio:t.pixelRatio,u_extrude_scale:o}},_p=(t,e,i)=>{const n=_d(i,1,e.zoom),r=Math.pow(2,e.zoom-i.tileID.overscaledZ),s=i.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:n,u_extrude_scale:[e.pixelsToGLUnits[0]/(n*r),e.pixelsToGLUnits[1]/(n*r)],u_overscale_factor:s}},yp=(t,e,i=1)=>({u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:i}),xp=t=>({u_matrix:t}),vp=(t,e,i,n)=>({u_matrix:t,u_extrude_scale:_d(e,1,i),u_intensity:n});function bp(t,e){const i=Math.pow(2,e.canonical.z),n=e.canonical.y;return[new hh(0,n/i).toLngLat().lat,new hh(0,(n+1)/i).toLngLat().lat]}const wp=(t,e,i,n)=>{const r=t.transform;return{u_matrix:Mp(t,e,i,n),u_ratio:1/_d(e,1,r.zoom),u_device_pixel_ratio:t.pixelRatio,u_units_to_pixels:[1/r.pixelsToGLUnits[0],1/r.pixelsToGLUnits[1]]}},kp=(t,e,i,n,r)=>_(wp(t,e,i,r),{u_image:0,u_image_height:n}),Sp=(t,e,i,n,r)=>{const s=t.transform,o=Ap(e,s);return{u_matrix:Mp(t,e,i,r),u_texsize:e.imageAtlasTexture.size,u_ratio:1/_d(e,1,s.zoom),u_device_pixel_ratio:t.pixelRatio,u_image:0,u_scale:[o,n.fromScale,n.toScale],u_fade:n.t,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]]}},Tp=(t,e,i,n,r,s)=>{const o=t.lineAtlas,a=Ap(e,t.transform),l="round"===i.layout.get("line-cap"),c=o.getDash(n.from,l),u=o.getDash(n.to,l),h=c.width*r.fromScale,d=u.width*r.toScale;return _(wp(t,e,i,s),{u_patternscale_a:[a/h,-c.height/2],u_patternscale_b:[a/d,-u.height/2],u_sdfgamma:o.width/(256*Math.min(h,d)*t.pixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:u.y,u_mix:r.t})};function Ap(t,e){return 1/_d(t,1,e.tileZoom)}function Mp(t,e,i,n){return t.translatePosMatrix(n?n.posMatrix:e.tileID.posMatrix,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const Cp=(t,e,i,n,r)=>{return{u_matrix:t,u_tl_parent:e,u_scale_parent:i,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(o=r.paint.get("raster-saturation"),o>0?1-1/(1.001-o):-o),u_contrast_factor:(s=r.paint.get("raster-contrast"),s>0?1/(1-s):1+s),u_spin_weights:Ep(r.paint.get("raster-hue-rotate"))};var s,o};function Ep(t){t*=Math.PI/180;const e=Math.sin(t),i=Math.cos(t);return[(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}const Ip=(t,e,i,n,r,s,o,a,l,c)=>{const u=r.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:u.cameraToCenterDistance,u_pitch:u.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:u.width/u.height,u_fade_change:r.options.fadeDuration?r.symbolFadeChange:1,u_matrix:s,u_label_plane_matrix:o,u_coord_matrix:a,u_is_text:+l,u_pitch_with_map:+n,u_texsize:c,u_texture:0}},Dp=(t,e,i,n,r,s,o,a,l,c,u)=>{const h=r.transform;return _(Ip(t,e,i,n,r,s,o,a,l,c),{u_gamma_scale:n?Math.cos(h._pitch)*h.cameraToCenterDistance:1,u_device_pixel_ratio:r.pixelRatio,u_is_halo:+u})},zp=(t,e,i,n,r,s,o,a,l,c)=>_(Dp(t,e,i,n,r,s,o,a,!0,l,!0),{u_texsize_icon:c,u_texture_icon:1}),Pp=(t,e,i)=>({u_matrix:t,u_opacity:e,u_color:i}),Lp=(t,e,i,n,r,s)=>_(function(t,e,i,n){const r=i.imageManager.getPattern(t.from.toString()),s=i.imageManager.getPattern(t.to.toString()),{width:o,height:a}=i.imageManager.getPixelSize(),l=Math.pow(2,n.tileID.overscaledZ),c=n.tileSize*Math.pow(2,i.transform.tileZoom)/l,u=c*(n.tileID.canonical.x+n.tileID.wrap*l),h=c*n.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:r.tl,u_pattern_br_a:r.br,u_pattern_tl_b:s.tl,u_pattern_br_b:s.br,u_texsize:[o,a],u_mix:e.t,u_pattern_size_a:r.displaySize,u_pattern_size_b:s.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/_d(n,1,i.transform.tileZoom),u_pixel_coord_upper:[u>>16,h>>16],u_pixel_coord_lower:[65535&u,65535&h]}}(n,s,i,r),{u_matrix:t,u_opacity:e}),Fp={fillExtrusion:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_lightpos:new Oo(t,e.u_lightpos),u_lightintensity:new Fo(t,e.u_lightintensity),u_lightcolor:new Oo(t,e.u_lightcolor),u_vertical_gradient:new Fo(t,e.u_vertical_gradient),u_opacity:new Fo(t,e.u_opacity)}),fillExtrusionPattern:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_lightpos:new Oo(t,e.u_lightpos),u_lightintensity:new Fo(t,e.u_lightintensity),u_lightcolor:new Oo(t,e.u_lightcolor),u_vertical_gradient:new Fo(t,e.u_vertical_gradient),u_height_factor:new Fo(t,e.u_height_factor),u_image:new Lo(t,e.u_image),u_texsize:new Ro(t,e.u_texsize),u_pixel_coord_upper:new Ro(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new Ro(t,e.u_pixel_coord_lower),u_scale:new Oo(t,e.u_scale),u_fade:new Fo(t,e.u_fade),u_opacity:new Fo(t,e.u_opacity)}),fill:(t,e)=>({u_matrix:new qo(t,e.u_matrix)}),fillPattern:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_image:new Lo(t,e.u_image),u_texsize:new Ro(t,e.u_texsize),u_pixel_coord_upper:new Ro(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new Ro(t,e.u_pixel_coord_lower),u_scale:new Oo(t,e.u_scale),u_fade:new Fo(t,e.u_fade)}),fillOutline:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_world:new Ro(t,e.u_world)}),fillOutlinePattern:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_world:new Ro(t,e.u_world),u_image:new Lo(t,e.u_image),u_texsize:new Ro(t,e.u_texsize),u_pixel_coord_upper:new Ro(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new Ro(t,e.u_pixel_coord_lower),u_scale:new Oo(t,e.u_scale),u_fade:new Fo(t,e.u_fade)}),circle:(t,e)=>({u_camera_to_center_distance:new Fo(t,e.u_camera_to_center_distance),u_scale_with_map:new Lo(t,e.u_scale_with_map),u_pitch_with_map:new Lo(t,e.u_pitch_with_map),u_extrude_scale:new Ro(t,e.u_extrude_scale),u_device_pixel_ratio:new Fo(t,e.u_device_pixel_ratio),u_matrix:new qo(t,e.u_matrix)}),collisionBox:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_camera_to_center_distance:new Fo(t,e.u_camera_to_center_distance),u_pixels_to_tile_units:new Fo(t,e.u_pixels_to_tile_units),u_extrude_scale:new Ro(t,e.u_extrude_scale),u_overscale_factor:new Fo(t,e.u_overscale_factor)}),collisionCircle:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_inv_matrix:new qo(t,e.u_inv_matrix),u_camera_to_center_distance:new Fo(t,e.u_camera_to_center_distance),u_viewport_size:new Ro(t,e.u_viewport_size)}),debug:(t,e)=>({u_color:new Vo(t,e.u_color),u_matrix:new qo(t,e.u_matrix),u_overlay:new Lo(t,e.u_overlay),u_overlay_scale:new Fo(t,e.u_overlay_scale)}),clippingMask:(t,e)=>({u_matrix:new qo(t,e.u_matrix)}),heatmap:(t,e)=>({u_extrude_scale:new Fo(t,e.u_extrude_scale),u_intensity:new Fo(t,e.u_intensity),u_matrix:new qo(t,e.u_matrix)}),heatmapTexture:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_world:new Ro(t,e.u_world),u_image:new Lo(t,e.u_image),u_color_ramp:new Lo(t,e.u_color_ramp),u_opacity:new Fo(t,e.u_opacity)}),hillshade:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_image:new Lo(t,e.u_image),u_latrange:new Ro(t,e.u_latrange),u_light:new Ro(t,e.u_light),u_shadow:new Vo(t,e.u_shadow),u_highlight:new Vo(t,e.u_highlight),u_accent:new Vo(t,e.u_accent)}),hillshadePrepare:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_image:new Lo(t,e.u_image),u_dimension:new Ro(t,e.u_dimension),u_zoom:new Fo(t,e.u_zoom),u_unpack:new Bo(t,e.u_unpack)}),line:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_ratio:new Fo(t,e.u_ratio),u_device_pixel_ratio:new Fo(t,e.u_device_pixel_ratio),u_units_to_pixels:new Ro(t,e.u_units_to_pixels)}),lineGradient:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_ratio:new Fo(t,e.u_ratio),u_device_pixel_ratio:new Fo(t,e.u_device_pixel_ratio),u_units_to_pixels:new Ro(t,e.u_units_to_pixels),u_image:new Lo(t,e.u_image),u_image_height:new Fo(t,e.u_image_height)}),linePattern:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_texsize:new Ro(t,e.u_texsize),u_ratio:new Fo(t,e.u_ratio),u_device_pixel_ratio:new Fo(t,e.u_device_pixel_ratio),u_image:new Lo(t,e.u_image),u_units_to_pixels:new Ro(t,e.u_units_to_pixels),u_scale:new Oo(t,e.u_scale),u_fade:new Fo(t,e.u_fade)}),lineSDF:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_ratio:new Fo(t,e.u_ratio),u_device_pixel_ratio:new Fo(t,e.u_device_pixel_ratio),u_units_to_pixels:new Ro(t,e.u_units_to_pixels),u_patternscale_a:new Ro(t,e.u_patternscale_a),u_patternscale_b:new Ro(t,e.u_patternscale_b),u_sdfgamma:new Fo(t,e.u_sdfgamma),u_image:new Lo(t,e.u_image),u_tex_y_a:new Fo(t,e.u_tex_y_a),u_tex_y_b:new Fo(t,e.u_tex_y_b),u_mix:new Fo(t,e.u_mix)}),raster:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_tl_parent:new Ro(t,e.u_tl_parent),u_scale_parent:new Fo(t,e.u_scale_parent),u_buffer_scale:new Fo(t,e.u_buffer_scale),u_fade_t:new Fo(t,e.u_fade_t),u_opacity:new Fo(t,e.u_opacity),u_image0:new Lo(t,e.u_image0),u_image1:new Lo(t,e.u_image1),u_brightness_low:new Fo(t,e.u_brightness_low),u_brightness_high:new Fo(t,e.u_brightness_high),u_saturation_factor:new Fo(t,e.u_saturation_factor),u_contrast_factor:new Fo(t,e.u_contrast_factor),u_spin_weights:new Oo(t,e.u_spin_weights)}),symbolIcon:(t,e)=>({u_is_size_zoom_constant:new Lo(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new Lo(t,e.u_is_size_feature_constant),u_size_t:new Fo(t,e.u_size_t),u_size:new Fo(t,e.u_size),u_camera_to_center_distance:new Fo(t,e.u_camera_to_center_distance),u_pitch:new Fo(t,e.u_pitch),u_rotate_symbol:new Lo(t,e.u_rotate_symbol),u_aspect_ratio:new Fo(t,e.u_aspect_ratio),u_fade_change:new Fo(t,e.u_fade_change),u_matrix:new qo(t,e.u_matrix),u_label_plane_matrix:new qo(t,e.u_label_plane_matrix),u_coord_matrix:new qo(t,e.u_coord_matrix),u_is_text:new Lo(t,e.u_is_text),u_pitch_with_map:new Lo(t,e.u_pitch_with_map),u_texsize:new Ro(t,e.u_texsize),u_texture:new Lo(t,e.u_texture)}),symbolSDF:(t,e)=>({u_is_size_zoom_constant:new Lo(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new Lo(t,e.u_is_size_feature_constant),u_size_t:new Fo(t,e.u_size_t),u_size:new Fo(t,e.u_size),u_camera_to_center_distance:new Fo(t,e.u_camera_to_center_distance),u_pitch:new Fo(t,e.u_pitch),u_rotate_symbol:new Lo(t,e.u_rotate_symbol),u_aspect_ratio:new Fo(t,e.u_aspect_ratio),u_fade_change:new Fo(t,e.u_fade_change),u_matrix:new qo(t,e.u_matrix),u_label_plane_matrix:new qo(t,e.u_label_plane_matrix),u_coord_matrix:new qo(t,e.u_coord_matrix),u_is_text:new Lo(t,e.u_is_text),u_pitch_with_map:new Lo(t,e.u_pitch_with_map),u_texsize:new Ro(t,e.u_texsize),u_texture:new Lo(t,e.u_texture),u_gamma_scale:new Fo(t,e.u_gamma_scale),u_device_pixel_ratio:new Fo(t,e.u_device_pixel_ratio),u_is_halo:new Lo(t,e.u_is_halo)}),symbolTextAndIcon:(t,e)=>({u_is_size_zoom_constant:new Lo(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new Lo(t,e.u_is_size_feature_constant),u_size_t:new Fo(t,e.u_size_t),u_size:new Fo(t,e.u_size),u_camera_to_center_distance:new Fo(t,e.u_camera_to_center_distance),u_pitch:new Fo(t,e.u_pitch),u_rotate_symbol:new Lo(t,e.u_rotate_symbol),u_aspect_ratio:new Fo(t,e.u_aspect_ratio),u_fade_change:new Fo(t,e.u_fade_change),u_matrix:new qo(t,e.u_matrix),u_label_plane_matrix:new qo(t,e.u_label_plane_matrix),u_coord_matrix:new qo(t,e.u_coord_matrix),u_is_text:new Lo(t,e.u_is_text),u_pitch_with_map:new Lo(t,e.u_pitch_with_map),u_texsize:new Ro(t,e.u_texsize),u_texsize_icon:new Ro(t,e.u_texsize_icon),u_texture:new Lo(t,e.u_texture),u_texture_icon:new Lo(t,e.u_texture_icon),u_gamma_scale:new Fo(t,e.u_gamma_scale),u_device_pixel_ratio:new Fo(t,e.u_device_pixel_ratio),u_is_halo:new Lo(t,e.u_is_halo)}),background:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_opacity:new Fo(t,e.u_opacity),u_color:new Vo(t,e.u_color)}),backgroundPattern:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_opacity:new Fo(t,e.u_opacity),u_image:new Lo(t,e.u_image),u_pattern_tl_a:new Ro(t,e.u_pattern_tl_a),u_pattern_br_a:new Ro(t,e.u_pattern_br_a),u_pattern_tl_b:new Ro(t,e.u_pattern_tl_b),u_pattern_br_b:new Ro(t,e.u_pattern_br_b),u_texsize:new Ro(t,e.u_texsize),u_mix:new Fo(t,e.u_mix),u_pattern_size_a:new Ro(t,e.u_pattern_size_a),u_pattern_size_b:new Ro(t,e.u_pattern_size_b),u_scale_a:new Fo(t,e.u_scale_a),u_scale_b:new Fo(t,e.u_scale_b),u_pixel_coord_upper:new Ro(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new Ro(t,e.u_pixel_coord_lower),u_tile_units_to_pixels:new Fo(t,e.u_tile_units_to_pixels)}),terrain:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_texture:new Lo(t,e.u_texture),u_ele_delta:new Fo(t,e.u_ele_delta)}),terrainDepth:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_ele_delta:new Fo(t,e.u_ele_delta)}),terrainCoords:(t,e)=>({u_matrix:new qo(t,e.u_matrix),u_texture:new Lo(t,e.u_texture),u_terrain_coords_id:new Fo(t,e.u_terrain_coords_id),u_ele_delta:new Fo(t,e.u_ele_delta)})};class Rp{constructor(t,e,i){this.context=t;const n=t.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Op={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Bp{constructor(t,e,i,n){this.length=e.length,this.attributes=i,this.itemSize=e.bytesPerElement,this.dynamicDraw=n,this.context=t;const r=t.gl;this.buffer=r.createBuffer(),t.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,e){for(let i=0;i<this.attributes.length;i++){const n=e.attributes[this.attributes[i].name];void 0!==n&&t.enableVertexAttribArray(n)}}setVertexAttribPointers(t,e,i){for(let n=0;n<this.attributes.length;n++){const r=this.attributes[n],s=e.attributes[r.name];void 0!==s&&t.vertexAttribPointer(s,r.components,t[Op[r.type]],!1,this.itemSize,r.offset+this.itemSize*(i||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Vp=new WeakMap;function Np(t){var e;if(Vp.has(t))return Vp.get(t);{const i=null===(e=t.getParameter(t.VERSION))||void 0===e?void 0:e.startsWith("WebGL 2.0");return Vp.set(t,i),i}}class qp{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class jp extends qp{getDefault(){return ce.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class $p extends qp{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Up extends qp{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Zp extends qp{getDefault(){return[!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Wp extends qp{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Gp extends qp{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Hp extends qp{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Xp extends qp{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Yp extends qp{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}class Kp extends qp{getDefault(){return[0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Jp extends qp{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}class Qp extends qp{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class tf extends qp{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}class ef extends qp{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class nf extends qp{getDefault(){return ce.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class rf extends qp{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class sf extends qp{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}class of extends qp{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class af extends qp{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class lf extends qp{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class cf extends qp{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class uf extends qp{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class hf extends qp{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class df extends qp{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class pf extends qp{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class ff extends qp{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class mf extends qp{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class gf extends qp{getDefault(){return null}set(t){var e;if(t===this.current&&!this.dirty)return;const i=this.gl;Np(i)?i.bindVertexArray(t):null===(e=i.getExtension("OES_vertex_array_object"))||void 0===e||e.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class _f extends qp{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class yf extends qp{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class xf extends qp{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class vf extends qp{constructor(t,e){super(t),this.context=t,this.parent=e}getDefault(){return null}}class bf extends vf{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class wf extends vf{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class kf extends vf{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Sf{constructor(t,e,i,n,r){this.context=t,this.width=e,this.height=i;const s=t.gl,o=this.framebuffer=s.createFramebuffer();if(this.colorAttachment=new bf(t,o),n)this.depthAttachment=r?new kf(t,o):new wf(t,o);else if(r)throw new Error("Stencil cannot be setted without depth");if(s.checkFramebufferStatus(s.FRAMEBUFFER)!==s.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e)}t.deleteFramebuffer(this.framebuffer)}}class Tf{constructor(t,e,i){this.blendFunction=t,this.blendColor=e,this.mask=i}}Tf.Replace=[1,0],Tf.disabled=new Tf(Tf.Replace,ce.transparent,[!1,!1,!1,!1]),Tf.unblended=new Tf(Tf.Replace,ce.transparent,[!0,!0,!0,!0]),Tf.alphaBlended=new Tf([1,771],ce.transparent,[!0,!0,!0,!0]);class Af{constructor(t){var e,i;if(this.gl=t,this.clearColor=new jp(this),this.clearDepth=new $p(this),this.clearStencil=new Up(this),this.colorMask=new Zp(this),this.depthMask=new Wp(this),this.stencilMask=new Gp(this),this.stencilFunc=new Hp(this),this.stencilOp=new Xp(this),this.stencilTest=new Yp(this),this.depthRange=new Kp(this),this.depthTest=new Jp(this),this.depthFunc=new Qp(this),this.blend=new tf(this),this.blendFunc=new ef(this),this.blendColor=new nf(this),this.blendEquation=new rf(this),this.cullFace=new sf(this),this.cullFaceSide=new of(this),this.frontFace=new af(this),this.program=new lf(this),this.activeTexture=new cf(this),this.viewport=new uf(this),this.bindFramebuffer=new hf(this),this.bindRenderbuffer=new df(this),this.bindTexture=new pf(this),this.bindVertexBuffer=new ff(this),this.bindElementBuffer=new mf(this),this.bindVertexArray=new gf(this),this.pixelStoreUnpack=new _f(this),this.pixelStoreUnpackPremultiplyAlpha=new yf(this),this.pixelStoreUnpackFlipY=new xf(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),Np(t)){this.HALF_FLOAT=t.HALF_FLOAT;const n=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(e=t.RGBA16F)&&void 0!==e?e:null==n?void 0:n.RGBA16F_EXT,this.RGB16F=null!==(i=t.RGB16F)&&void 0!==i?i:null==n?void 0:n.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const e=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=null==e?void 0:e.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,e){return new Rp(this,t,e)}createVertexBuffer(t,e,i){return new Bp(this,t,e,i)}createRenderbuffer(t,e,i){const n=this.gl,r=n.createRenderbuffer();return this.bindRenderbuffer.set(r),n.renderbufferStorage(n.RENDERBUFFER,t,e,i),this.bindRenderbuffer.set(null),r}createFramebuffer(t,e,i,n){return new Sf(this,t,e,i,n)}clear({color:t,depth:e,stencil:i}){const n=this.gl;let r=0;t&&(r|=n.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==e&&(r|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),void 0!==i&&(r|=n.STENCIL_BUFFER_BIT,this.clearStencil.set(i),this.stencilMask.set(255)),n.clear(r)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){k(t.blendFunction,Tf.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return Np(this.gl)?this.gl.createVertexArray():null===(t=this.gl.getExtension("OES_vertex_array_object"))||void 0===t?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var e;return Np(this.gl)?this.gl.deleteVertexArray(t):null===(e=this.gl.getExtension("OES_vertex_array_object"))||void 0===e?void 0:e.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}class Mf{constructor(t,e,i){this.func=t,this.mask=e,this.range=i}}Mf.ReadOnly=!1,Mf.ReadWrite=!0,Mf.disabled=new Mf(519,Mf.ReadOnly,[0,1]);const Cf=7680;class Ef{constructor(t,e,i,n,r,s){this.test=t,this.ref=e,this.mask=i,this.fail=n,this.depthFail=r,this.pass=s}}Ef.disabled=new Ef({func:519,mask:0},0,0,Cf,Cf,Cf);class If{constructor(t,e,i){this.enable=t,this.mode=e,this.frontFace=i}}let Df;function zf(t,e,i,n,r,s,o){const a=t.context,l=a.gl,c=t.useProgram("collisionBox"),u=[];let h=0,d=0;for(let p=0;p<n.length;p++){const f=n[p],m=e.getTile(f),g=m.getBucket(i);if(!g)continue;let _=f.posMatrix;0===r[0]&&0===r[1]||(_=t.translatePosMatrix(f.posMatrix,m,r,s));const y=o?g.textCollisionBox:g.iconCollisionBox,x=g.collisionCircleArray;if(x.length>0){const e=Sa(),i=_;za(e,g.placementInvProjMatrix,t.transform.glCoordMatrix),za(e,e,g.placementViewportMatrix),u.push({circleArray:x,circleOffset:d,transform:i,invTransform:e,coord:f}),h+=x.length/4,d=h}y&&c.draw(a,l.LINES,Mf.disabled,Ef.disabled,t.colorModeForRenderPass(),If.disabled,_p(_,t.transform,m),t.style.map.terrain&&t.style.map.terrain.getTerrainData(f),i.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,null,t.transform.zoom,null,null,y.collisionVertexBuffer)}if(!o||!u.length)return;const p=t.useProgram("collisionCircle"),f=new uo;f.resize(4*h),f._trim();let m=0;for(const t of u)for(let e=0;e<t.circleArray.length/4;e++){const i=4*e,n=t.circleArray[i+0],r=t.circleArray[i+1],s=t.circleArray[i+2],o=t.circleArray[i+3];f.emplace(m++,n,r,s,o,0),f.emplace(m++,n,r,s,o,1),f.emplace(m++,n,r,s,o,2),f.emplace(m++,n,r,s,o,3)}(!Df||Df.length<2*h)&&(Df=function(t){const e=2*t,i=new po;i.resize(e),i._trim();for(let t=0;t<e;t++){const e=6*t;i.uint16[e+0]=4*t+0,i.uint16[e+1]=4*t+1,i.uint16[e+2]=4*t+2,i.uint16[e+3]=4*t+2,i.uint16[e+4]=4*t+3,i.uint16[e+5]=4*t+0}return i}(h));const g=a.createIndexBuffer(Df,!0),_=a.createVertexBuffer(f,Pc.members,!0);for(const e of u){const n={u_matrix:e.transform,u_inv_matrix:e.invTransform,u_camera_to_center_distance:(y=t.transform).cameraToCenterDistance,u_viewport_size:[y.width,y.height]};p.draw(a,l.TRIANGLES,Mf.disabled,Ef.disabled,t.colorModeForRenderPass(),If.disabled,n,t.style.map.terrain&&t.style.map.terrain.getTerrainData(e.coord),i.id,_,g,xo.simpleSegment(0,2*e.circleOffset,e.circleArray.length,e.circleArray.length/2),null,t.transform.zoom,null,null,null)}var y;_.destroy(),g.destroy()}If.disabled=new If(!1,1029,2305),If.backCCW=new If(!0,1029,2305);const Pf=Ta(new Float32Array(16));function Lf(t,e,i,n,r,o){const{horizontalAlign:a,verticalAlign:l}=hu(t);return new s((-(a-.5)*e/r+n[0])*o,(-(l-.5)*i/r+n[1])*o)}function Ff(t,e,i,n,r,o,a,l,c,u,h){const d=t.text.placedSymbolArray,p=t.text.dynamicLayoutVertexArray,f=t.icon.dynamicLayoutVertexArray,m={};p.clear();for(let f=0;f<d.length;f++){const g=d.get(f),_=g.hidden||!g.crossTileID||t.allowVerticalPlacement&&!g.placedOrientation?null:n[g.crossTileID];if(_){const n=new s(g.anchorX,g.anchorY),d=Jh(n,i?a:o,h),f=Qh(r.cameraToCenterDistance,d.signedDistanceFromCamera);let y=fu(t.textSizeData,c,g)*f/24;i&&(y*=t.tilePixelRatio/l);const{width:x,height:v,anchor:b,textOffset:w,textBoxScale:k}=_,S=Lf(b,x,v,w,k,y),T=i?Jh(n.add(S),o,h).point:d.point.add(e?S.rotate(-r.angle):S),A=t.allowVerticalPlacement&&g.placedOrientation===uu.vertical?Math.PI/2:0;for(let t=0;t<g.numGlyphs;t++)vu(p,T,A);u&&g.associatedIconIndex>=0&&(m[g.associatedIconIndex]={shiftedAnchor:T,angle:A})}else hd(g.numGlyphs,p)}if(u){f.clear();const e=t.icon.placedSymbolArray;for(let t=0;t<e.length;t++){const i=e.get(t);if(i.hidden)hd(i.numGlyphs,f);else{const e=m[t];if(e)for(let t=0;t<i.numGlyphs;t++)vu(f,e.shiftedAnchor,e.angle);else hd(i.numGlyphs,f)}}t.icon.dynamicLayoutVertexBuffer.updateData(f)}t.text.dynamicLayoutVertexBuffer.updateData(p)}function Rf(t,e,i){return i.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function Of(t,e,i,n,r,s,o,a,l,c,u,h){const d=t.context,p=d.gl,f=t.transform,m="map"===a,g="map"===l,_="viewport"!==a&&"point"!==i.layout.get("symbol-placement"),y=m&&!g&&!_,x=!i.layout.get("symbol-sort-key").isConstant();let v=!1;const b=t.depthModeForSublayer(0,Mf.ReadOnly),w=i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"),k=[];for(const a of n){const n=e.getTile(a),l=n.getBucket(i);if(!l)continue;const u=r?l.text:l.icon;if(!u||!u.segments.get().length||!u.hasVisibleVertices)continue;const h=u.programConfigurations.get(i.id),d=r||l.sdfIcons,b=r?l.textSizeData:l.iconSizeData,S=g||0!==f.pitch,T=t.useProgram(Rf(d,r,l),h),A=mu(b,f.zoom),M=t.style.map.terrain&&t.style.map.terrain.getTerrainData(a);let C,E,I,D,z=[0,0],P=null;if(r)E=n.glyphAtlasTexture,I=p.LINEAR,C=n.glyphAtlasTexture.size,l.iconsInText&&(z=n.imageAtlasTexture.size,P=n.imageAtlasTexture,D=S||t.options.rotating||t.options.zooming||"composite"===b.kind||"camera"===b.kind?p.LINEAR:p.NEAREST);else{const e=1!==i.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;E=n.imageAtlasTexture,I=d||t.options.rotating||t.options.zooming||e||S?p.LINEAR:p.NEAREST,C=n.imageAtlasTexture.size}const L=_d(n,1,t.transform.zoom),F=Yh(a.posMatrix,g,m,t.transform,L),R=Kh(a.posMatrix,g,m,t.transform,L),O=w&&l.hasTextData(),B="none"!==i.layout.get("icon-text-fit")&&O&&l.hasIconData();if(_){const e=t.style.map.terrain?(e,i)=>t.style.map.terrain.getElevation(a,e,i):null,n="map"===i.layout.get("text-rotation-alignment");ed(l,a.posMatrix,t,r,F,R,g,c,n,e)}const V=t.translatePosMatrix(a.posMatrix,n,s,o),N=_||r&&w||B?Pf:F,q=t.translatePosMatrix(R,n,s,o,!0),j=d&&0!==i.paint.get(r?"text-halo-width":"icon-halo-width").constantOr(1);let $;$=d?l.iconsInText?zp(b.kind,A,y,g,t,V,N,q,C,z):Dp(b.kind,A,y,g,t,V,N,q,r,C,!0):Ip(b.kind,A,y,g,t,V,N,q,r,C);const U={program:T,buffers:u,uniformValues:$,atlasTexture:E,atlasTextureIcon:P,atlasInterpolation:I,atlasInterpolationIcon:D,isSDF:d,hasHalo:j};if(x&&l.canOverlap){v=!0;const t=u.segments.get();for(const e of t)k.push({segments:new xo([e]),sortKey:e.sortKey,state:U,terrainData:M})}else k.push({segments:u.segments,sortKey:0,state:U,terrainData:M})}v&&k.sort(((t,e)=>t.sortKey-e.sortKey));for(const e of k){const n=e.state;if(d.activeTexture.set(p.TEXTURE0),n.atlasTexture.bind(n.atlasInterpolation,p.CLAMP_TO_EDGE),n.atlasTextureIcon&&(d.activeTexture.set(p.TEXTURE1),n.atlasTextureIcon&&n.atlasTextureIcon.bind(n.atlasInterpolationIcon,p.CLAMP_TO_EDGE)),n.isSDF){const r=n.uniformValues;n.hasHalo&&(r.u_is_halo=1,Bf(n.buffers,e.segments,i,t,n.program,b,u,h,r,e.terrainData)),r.u_is_halo=0}Bf(n.buffers,e.segments,i,t,n.program,b,u,h,n.uniformValues,e.terrainData)}}function Bf(t,e,i,n,r,s,o,a,l,c){const u=n.context;r.draw(u,u.gl.TRIANGLES,s,o,a,If.disabled,l,c,i.id,t.layoutVertexBuffer,t.indexBuffer,e,i.paint,n.transform.zoom,t.programConfigurations.get(i.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function Vf(t,e,i,n,r){if(!i||!n||!n.imageAtlas)return;const s=n.imageAtlas.patternPositions;let o=s[i.to.toString()],a=s[i.from.toString()];if(!o&&a&&(o=a),!a&&o&&(a=o),!o||!a){const t=r.getPaintProperty(e);o=s[t],a=s[t]}o&&a&&t.setConstantPatternPositions(o,a)}function Nf(t,e,i,n,r,s,o){const a=t.context.gl,l="fill-pattern",c=i.paint.get(l),u=c&&c.constantOr(1),h=i.getCrossfadeParameters();let d,p,f,m,g;o?(p=u&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",d=a.LINES):(p=u?"fillPattern":"fill",d=a.TRIANGLES);const _=c.constantOr(null);for(const c of n){const n=e.getTile(c);if(u&&!n.patternsLoaded())continue;const y=n.getBucket(i);if(!y)continue;const x=y.programConfigurations.get(i.id),v=t.useProgram(p,x),b=t.style.map.terrain&&t.style.map.terrain.getTerrainData(c);u&&(t.context.activeTexture.set(a.TEXTURE0),n.imageAtlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE),x.updatePaintBuffers(h)),Vf(x,l,_,n,i);const w=b?c:null,k=t.translatePosMatrix(w?w.posMatrix:c.posMatrix,n,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(o){m=y.indexBuffer2,g=y.segments2;const e=[a.drawingBufferWidth,a.drawingBufferHeight];f="fillOutlinePattern"===p&&u?mp(k,t,h,n,e):fp(k,e)}else m=y.indexBuffer,g=y.segments,f=u?pp(k,t,h,n):dp(k);v.draw(t.context,d,r,t.stencilModeForClipping(c),s,If.disabled,f,b,i.id,y.layoutVertexBuffer,m,g,i.paint,t.transform.zoom,x)}}function qf(t,e,i,n,r,s,o){const a=t.context,l=a.gl,c="fill-extrusion-pattern",u=i.paint.get(c),h=u.constantOr(1),d=i.getCrossfadeParameters(),p=i.paint.get("fill-extrusion-opacity"),f=u.constantOr(null);for(const u of n){const n=e.getTile(u),m=n.getBucket(i);if(!m)continue;const g=t.style.map.terrain&&t.style.map.terrain.getTerrainData(u),_=m.programConfigurations.get(i.id),y=t.useProgram(h?"fillExtrusionPattern":"fillExtrusion",_);h&&(t.context.activeTexture.set(l.TEXTURE0),n.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),_.updatePaintBuffers(d)),Vf(_,c,f,n,i);const x=t.translatePosMatrix(u.posMatrix,n,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),v=i.paint.get("fill-extrusion-vertical-gradient"),b=h?hp(x,t,v,p,u,d,n):up(x,t,v,p);y.draw(a,a.gl.TRIANGLES,r,s,o,If.backCCW,b,g,i.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,i.paint,t.transform.zoom,_,t.style.map.terrain&&m.centroidVertexBuffer)}}function jf(t,e,i,n,r,s,o){const a=t.context,l=a.gl,c=i.fbo;if(!c)return;const u=t.useProgram("hillshade"),h=t.style.map.terrain&&t.style.map.terrain.getTerrainData(e);a.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,c.colorAttachment.get()),u.draw(a,l.TRIANGLES,r,s,o,If.disabled,((t,e,i,n)=>{const r=i.paint.get("hillshade-shadow-color"),s=i.paint.get("hillshade-highlight-color"),o=i.paint.get("hillshade-accent-color");let a=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(a-=t.transform.angle);const l=!t.options.moving;return{u_matrix:n?n.posMatrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped(),l),u_image:0,u_latrange:bp(0,e.tileID),u_light:[i.paint.get("hillshade-exaggeration"),a],u_shadow:r,u_highlight:s,u_accent:o}})(t,i,n,h?e:null),h,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}function $f(t,e,i,n,r,s){const o=t.context,a=o.gl,l=e.dem;if(l&&l.data){const c=l.dim,u=l.stride,h=l.getPixels();if(o.activeTexture.set(a.TEXTURE1),o.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||t.getTileTexture(u),e.demTexture){const t=e.demTexture;t.update(h,{premultiply:!1}),t.bind(a.NEAREST,a.CLAMP_TO_EDGE)}else e.demTexture=new Nu(o,h,a.RGBA,{premultiply:!1}),e.demTexture.bind(a.NEAREST,a.CLAMP_TO_EDGE);o.activeTexture.set(a.TEXTURE0);let d=e.fbo;if(!d){const t=new Nu(o,{width:c,height:c,data:null},a.RGBA);t.bind(a.LINEAR,a.CLAMP_TO_EDGE),d=e.fbo=o.createFramebuffer(c,c,!0,!1),d.colorAttachment.set(t.texture)}o.bindFramebuffer.set(d.framebuffer),o.viewport.set([0,0,c,c]),t.useProgram("hillshadePrepare").draw(o,a.TRIANGLES,n,r,s,If.disabled,((t,e)=>{const i=e.stride,n=Sa();return Da(n,0,Jo,-Jo,0,0,1),Ca(n,n,[0,-Jo,0]),{u_matrix:n,u_image:1,u_dimension:[i,i],u_zoom:t.overscaledZ,u_unpack:e.getUnpackVector()}})(e.tileID,l),null,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),e.needsHillshadePrepare=!1}}function Uf(t,e,i,n,r,s){const o=n.paint.get("raster-fade-duration");if(!s&&o>0){const n=R.now(),s=(n-t.timeAdded)/o,a=e?(n-e.timeAdded)/o:-1,l=i.getSource(),c=r.coveringZoomLevel({tileSize:l.tileSize,roundZoom:l.roundZoom}),u=!e||Math.abs(e.tileID.overscaledZ-c)>Math.abs(t.tileID.overscaledZ-c),h=u&&t.refreshedUponExpiration?1:f(u?s:1-a,0,1);return t.refreshedUponExpiration&&s>=1&&(t.refreshedUponExpiration=!1),e?{opacity:1,mix:1-h}:{opacity:h,mix:0}}return{opacity:1,mix:0}}const Zf=new ce(1,0,0,1),Wf=new ce(0,1,0,1),Gf=new ce(0,0,1,1),Hf=new ce(1,0,1,1),Xf=new ce(0,1,1,1);function Yf(t,e,i,n){Jf(t,0,e+i/2,t.transform.width,i,n)}function Kf(t,e,i,n){Jf(t,e-i/2,0,i,t.transform.height,n)}function Jf(t,e,i,n,r,s){const o=t.context,a=o.gl;a.enable(a.SCISSOR_TEST),a.scissor(e*t.pixelRatio,i*t.pixelRatio,n*t.pixelRatio,r*t.pixelRatio),o.clear({color:s}),a.disable(a.SCISSOR_TEST)}function Qf(t,e,i){const n=t.context,r=n.gl,s=i.posMatrix,o=t.useProgram("debug"),a=Mf.disabled,l=Ef.disabled,c=t.colorModeForRenderPass(),u="$debug",h=t.style.map.terrain&&t.style.map.terrain.getTerrainData(i);n.activeTexture.set(r.TEXTURE0);const d=e.getTileByID(i.key).latestRawTileData,p=Math.floor((d&&d.byteLength||0)/1024),f=e.getTile(i).tileSize,m=512/Math.min(f,512)*(i.overscaledZ/t.transform.zoom)*.5;let g=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(g+=` => ${i.overscaledZ}`),function(t,e){t.initDebugOverlayCanvas();const i=t.debugOverlayCanvas,n=t.context.gl,r=t.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,i.width,i.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(e,5,5),r.strokeText(e,5,5),t.debugOverlayTexture.update(i),t.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}(t,`${g} ${p}kB`),o.draw(n,r.TRIANGLES,a,l,Tf.alphaBlended,If.disabled,yp(s,ce.transparent,m),null,u,t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments),o.draw(n,r.LINE_STRIP,a,l,c,If.disabled,yp(s,ce.red),h,u,t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments)}function tm(t,e,i){const n=t.context,r=n.gl,s=t.colorModeForRenderPass(),o=new Mf(r.LEQUAL,Mf.ReadWrite,t.depthRangeFor3D),a=t.useProgram("terrain"),l=e.getTerrainMesh();n.bindFramebuffer.set(null),n.viewport.set([0,0,t.width,t.height]);for(const c of i){const i=t.renderToTexture.getTexture(c),u=e.getTerrainData(c.tileID);n.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,i.texture);const h={u_matrix:t.transform.calculatePosMatrix(c.tileID.toUnwrapped()),u_texture:0,u_ele_delta:e.getMeshFrameDelta(t.transform.zoom)};a.draw(n,r.TRIANGLES,o,Ef.disabled,s,If.backCCW,h,u,"terrain",l.vertexBuffer,l.indexBuffer,l.segments)}}class em{constructor(t,e){this.context=new Af(t),this.transform=e,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:Sa(),renderTime:0},this.setup(),this.numSublayers=Vh.maxUnderzooming+Vh.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Yd}resize(t,e,i){if(this.width=Math.floor(t*i),this.height=Math.floor(e*i),this.pixelRatio=i,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const t of this.style._order)this.style._layers[t].resize()}setup(){const t=this.context,e=new Ks;e.emplaceBack(0,0),e.emplaceBack(Jo,0),e.emplaceBack(0,Jo),e.emplaceBack(Jo,Jo),this.tileExtentBuffer=t.createVertexBuffer(e,ip.members),this.tileExtentSegments=xo.simpleSegment(0,0,4,2);const i=new Ks;i.emplaceBack(0,0),i.emplaceBack(Jo,0),i.emplaceBack(0,Jo),i.emplaceBack(Jo,Jo),this.debugBuffer=t.createVertexBuffer(i,ip.members),this.debugSegments=xo.simpleSegment(0,0,4,5);const n=new Qs;n.emplaceBack(0,0,0,0),n.emplaceBack(Jo,0,Jo,0),n.emplaceBack(0,Jo,0,Jo),n.emplaceBack(Jo,Jo,Jo,Jo),this.rasterBoundsBuffer=t.createVertexBuffer(n,wh.members),this.rasterBoundsSegments=xo.simpleSegment(0,0,4,2);const r=new Ks;r.emplaceBack(0,0),r.emplaceBack(1,0),r.emplaceBack(0,1),r.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(r,ip.members),this.viewportSegments=xo.simpleSegment(0,0,4,2);const s=new go;s.emplaceBack(0),s.emplaceBack(1),s.emplaceBack(3),s.emplaceBack(2),s.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(s);const o=new fo;o.emplaceBack(0,1,2),o.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(o);const a=this.context.gl;this.stencilClearMode=new Ef({func:a.ALWAYS,mask:0},0,255,a.ZERO,a.ZERO,a.ZERO)}clearStencil(){const t=this.context,e=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const i=Sa();Da(i,0,this.width,this.height,0,0,1),Ea(i,i,[e.drawingBufferWidth,e.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,e.TRIANGLES,Mf.disabled,this.stencilClearMode,Tf.disabled,If.disabled,xp(i),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,e){if(this.currentStencilSource===t.source||!t.isTileClipped()||!e||!e.length)return;this.currentStencilSource=t.source;const i=this.context,n=i.gl;this.nextStencilID+e.length>256&&this.clearStencil(),i.setColorMode(Tf.disabled),i.setDepthMode(Mf.disabled);const r=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const t of e){const e=this._tileClippingMaskIDs[t.key]=this.nextStencilID++,s=this.style.map.terrain&&this.style.map.terrain.getTerrainData(t);r.draw(i,n.TRIANGLES,Mf.disabled,new Ef({func:n.ALWAYS,mask:0},e,255,n.KEEP,n.KEEP,n.REPLACE),Tf.disabled,If.disabled,xp(t.posMatrix),s,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,e=this.context.gl;return new Ef({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)}stencilModeForClipping(t){const e=this.context.gl;return new Ef({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)}stencilConfigForOverlap(t){const e=this.context.gl,i=t.sort(((t,e)=>e.overscaledZ-t.overscaledZ)),n=i[i.length-1].overscaledZ,r=i[0].overscaledZ-n+1;if(r>1){this.currentStencilSource=void 0,this.nextStencilID+r>256&&this.clearStencil();const t={};for(let i=0;i<r;i++)t[i+n]=new Ef({func:e.GEQUAL,mask:255},i+this.nextStencilID,255,e.KEEP,e.KEEP,e.REPLACE);return this.nextStencilID+=r,[t,i]}return[{[n]:Ef.disabled},i]}colorModeForRenderPass(){const t=this.context.gl;if(this._showOverdrawInspector){const e=1/8;return new Tf([t.CONSTANT_COLOR,t.ONE],new ce(e,e,e,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Tf.unblended:Tf.alphaBlended}depthModeForSublayer(t,e,i){if(!this.opaquePassEnabledForLayer())return Mf.disabled;const n=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Mf(i||this.context.gl.LEQUAL,e,[n,n])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,e){this.style=t,this.options=e,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(R.now()),this.imageManager.beginFrame();const i=this.style._order,n=this.style.sourceCaches,r={},s={},o={};for(const t in n){const e=n[t];e.used&&e.prepare(this.context),r[t]=e.getVisibleCoordinates(),s[t]=r[t].slice().reverse(),o[t]=e.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<i.length;t++)if(this.style._layers[i[t]].is3D()){this.opaquePassCutoff=t;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const t=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);!this.terrainFacilitator.dirty&&(c=(a=this.terrainFacilitator.matrix)[0],u=a[1],h=a[2],d=a[3],p=a[4],f=a[5],m=a[6],g=a[7],_=a[8],y=a[9],x=a[10],v=a[11],b=a[12],w=a[13],k=a[14],S=a[15],T=(l=this.transform.projMatrix)[0],A=l[1],M=l[2],C=l[3],E=l[4],I=l[5],D=l[6],z=l[7],P=l[8],L=l[9],F=l[10],O=l[11],B=l[12],V=l[13],N=l[14],q=l[15],Math.abs(c-T)<=wa*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(u-A)<=wa*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(h-M)<=wa*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(d-C)<=wa*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(p-E)<=wa*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(f-I)<=wa*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(m-D)<=wa*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(g-z)<=wa*Math.max(1,Math.abs(g),Math.abs(z))&&Math.abs(_-P)<=wa*Math.max(1,Math.abs(_),Math.abs(P))&&Math.abs(y-L)<=wa*Math.max(1,Math.abs(y),Math.abs(L))&&Math.abs(x-F)<=wa*Math.max(1,Math.abs(x),Math.abs(F))&&Math.abs(v-O)<=wa*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(b-B)<=wa*Math.max(1,Math.abs(b),Math.abs(B))&&Math.abs(w-V)<=wa*Math.max(1,Math.abs(w),Math.abs(V))&&Math.abs(k-N)<=wa*Math.max(1,Math.abs(k),Math.abs(N))&&Math.abs(S-q)<=wa*Math.max(1,Math.abs(S),Math.abs(q)))&&!t.length||(function(t,e){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(t,e){const i=t.context,n=i.gl,r=Tf.unblended,s=new Mf(n.LEQUAL,Mf.ReadWrite,[0,1]),o=e.getTerrainMesh(),a=e.sourceCache.getRenderableTiles(),l=t.useProgram("terrainDepth");i.bindFramebuffer.set(e.getFramebuffer("depth").framebuffer),i.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),i.clear({color:ce.transparent,depth:1});for(const c of a){const a=e.getTerrainData(c.tileID),u={u_matrix:t.transform.calculatePosMatrix(c.tileID.toUnwrapped()),u_ele_delta:e.getMeshFrameDelta(t.transform.zoom)};l.draw(i,n.TRIANGLES,s,Ef.disabled,r,If.backCCW,u,a,"terrain",o.vertexBuffer,o.indexBuffer,o.segments)}i.bindFramebuffer.set(null),i.viewport.set([0,0,t.width,t.height])}(this,this.style.map.terrain),function(t,e){const i=t.context,n=i.gl,r=Tf.unblended,s=new Mf(n.LEQUAL,Mf.ReadWrite,[0,1]),o=e.getTerrainMesh(),a=e.getCoordsTexture(),l=e.sourceCache.getRenderableTiles(),c=t.useProgram("terrainCoords");i.bindFramebuffer.set(e.getFramebuffer("coords").framebuffer),i.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),i.clear({color:ce.transparent,depth:1}),e.coordsIndex=[];for(const u of l){const l=e.getTerrainData(u.tileID);i.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,a.texture);const h={u_matrix:t.transform.calculatePosMatrix(u.tileID.toUnwrapped()),u_terrain_coords_id:(255-e.coordsIndex.length)/255,u_texture:0,u_ele_delta:e.getMeshFrameDelta(t.transform.zoom)};c.draw(i,n.TRIANGLES,s,Ef.disabled,r,If.backCCW,h,l,"terrain",o.vertexBuffer,o.indexBuffer,o.segments),e.coordsIndex.push(u.tileID.key)}i.bindFramebuffer.set(null),i.viewport.set([0,0,t.width,t.height])}(this,this.style.map.terrain))}var a,l,c,u,h,d,p,f,m,g,_,y,x,v,b,w,k,S,T,A,M,C,E,I,D,z,P,L,F,O,B,V,N,q;this.renderPass="offscreen";for(const t of i){const e=this.style._layers[t];if(!e.hasOffscreenPass()||e.isHidden(this.transform.zoom))continue;const i=s[e.source];("custom"===e.type||i.length)&&this.renderLayer(this,n[e.source],e,i)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:e.showOverdrawInspector?ce.black:ce.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=e.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){const t=this.style._layers[i[this.currentLayer]],e=n[t.source],s=r[t.source];this._renderTileClippingMasks(t,s),this.renderLayer(this,e,t,s)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){const t=this.style._layers[i[this.currentLayer]],e=n[t.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(t))continue;const a=("symbol"===t.type?o:s)[t.source];this._renderTileClippingMasks(t,r[t.source]),this.renderLayer(this,e,t,a)}if(this.options.showTileBoundaries){const t=function(t,e){let i=null;const n=Object.values(t._layers).flatMap((i=>i.source&&!i.isHidden(e)?[t.sourceCaches[i.source]]:[])),r=n.filter((t=>"vector"===t.getSource().type)),s=n.filter((t=>"vector"!==t.getSource().type)),o=t=>{(!i||i.getSource().maxzoom<t.getSource().maxzoom)&&(i=t)};return r.forEach((t=>o(t))),i||s.forEach((t=>o(t))),i}(this.style,this.transform.zoom);t&&function(t,e,i){for(let n=0;n<i.length;n++)Qf(t,e,i[n])}(this,t,t.getVisibleCoordinates())}this.options.showPadding&&function(t){const e=t.transform.padding;Yf(t,t.transform.height-(e.top||0),3,Zf),Yf(t,e.bottom||0,3,Wf),Kf(t,e.left||0,3,Gf),Kf(t,t.transform.width-(e.right||0),3,Hf);const i=t.transform.centerPoint;!function(t,e,i,n){Jf(t,e-1,i-10,2,20,n),Jf(t,e-10,i-1,20,2,n)}(t,i.x,t.transform.height-i.y,Xf)}(this),this.context.setDefault()}renderLayer(t,e,i,n){if(!i.isHidden(this.transform.zoom)&&("background"===i.type||"custom"===i.type||(n||[]).length))switch(this.id=i.id,i.type){case"symbol":!function(t,e,i,n,r){if("translucent"!==t.renderPass)return;const s=Ef.disabled,o=t.colorModeForRenderPass();(i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(t,e,i,n,r,s,o){const a=e.transform,l="map"===r,c="map"===s;for(const r of t){const t=n.getTile(r),s=t.getBucket(i);if(!s||!s.text||!s.text.segments.get().length)continue;const u=mu(s.textSizeData,a.zoom),h=_d(t,1,e.transform.zoom),d=Yh(r.posMatrix,c,l,e.transform,h),p="none"!==i.layout.get("icon-text-fit")&&s.hasIconData();if(u){const i=Math.pow(2,a.zoom-t.tileID.overscaledZ);Ff(s,l,c,o,a,d,r.posMatrix,i,u,p,e.style.map.terrain?(t,i)=>e.style.map.terrain.getElevation(r,t,i):null)}}}(n,t,i,e,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),r),0!==i.paint.get("icon-opacity").constantOr(1)&&Of(t,e,i,n,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),s,o),0!==i.paint.get("text-opacity").constantOr(1)&&Of(t,e,i,n,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),s,o),e.map.showCollisionBoxes&&(zf(t,e,i,n,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),zf(t,e,i,n,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))}(t,e,i,n,this.style.placement.variableOffsets);break;case"circle":!function(t,e,i,n){if("translucent"!==t.renderPass)return;const r=i.paint.get("circle-opacity"),s=i.paint.get("circle-stroke-width"),o=i.paint.get("circle-stroke-opacity"),a=!i.layout.get("circle-sort-key").isConstant();if(0===r.constantOr(1)&&(0===s.constantOr(1)||0===o.constantOr(1)))return;const l=t.context,c=l.gl,u=t.depthModeForSublayer(0,Mf.ReadOnly),h=Ef.disabled,d=t.colorModeForRenderPass(),p=[];for(let r=0;r<n.length;r++){const s=n[r],o=e.getTile(s),l=o.getBucket(i);if(!l)continue;const c=l.programConfigurations.get(i.id),u=t.useProgram("circle",c),h=l.layoutVertexBuffer,d=l.indexBuffer,f=t.style.map.terrain&&t.style.map.terrain.getTerrainData(s),m={programConfiguration:c,program:u,layoutVertexBuffer:h,indexBuffer:d,uniformValues:gp(t,s,o,i),terrainData:f};if(a){const t=l.segments.get();for(const e of t)p.push({segments:new xo([e]),sortKey:e.sortKey,state:m})}else p.push({segments:l.segments,sortKey:0,state:m})}a&&p.sort(((t,e)=>t.sortKey-e.sortKey));for(const e of p){const{programConfiguration:n,program:r,layoutVertexBuffer:s,indexBuffer:o,uniformValues:a,terrainData:p}=e.state;r.draw(l,c.TRIANGLES,u,h,d,If.disabled,a,p,i.id,s,o,e.segments,i.paint,t.transform.zoom,n)}}(t,e,i,n);break;case"heatmap":!function(t,e,i,n){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){const r=t.context,s=r.gl,o=Ef.disabled,a=new Tf([s.ONE,s.ONE],ce.transparent,[!0,!0,!0,!0]);!function(t,e,i){const n=t.gl;t.activeTexture.set(n.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);let r=i.heatmapFbo;if(r)n.bindTexture(n.TEXTURE_2D,r.colorAttachment.get()),t.bindFramebuffer.set(r.framebuffer);else{const s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),r=i.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1,!1),function(t,e,i,n){var r,s;const o=t.gl,a=null!==(r=t.HALF_FLOAT)&&void 0!==r?r:o.UNSIGNED_BYTE,l=null!==(s=t.RGBA16F)&&void 0!==s?s:o.RGBA;o.texImage2D(o.TEXTURE_2D,0,l,e.width/4,e.height/4,0,o.RGBA,a,null),n.colorAttachment.set(i)}(t,e,s,r)}}(r,t,i),r.clear({color:ce.transparent});for(let l=0;l<n.length;l++){const c=n[l];if(e.hasRenderableParent(c))continue;const u=e.getTile(c),h=u.getBucket(i);if(!h)continue;const d=h.programConfigurations.get(i.id),p=t.useProgram("heatmap",d),{zoom:f}=t.transform;p.draw(r,s.TRIANGLES,Mf.disabled,o,a,If.disabled,vp(c.posMatrix,u,f,i.paint.get("heatmap-intensity")),null,i.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,i.paint,t.transform.zoom,d)}r.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,e){const i=t.context,n=i.gl,r=e.heatmapFbo;if(!r)return;i.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,r.colorAttachment.get()),i.activeTexture.set(n.TEXTURE1);let s=e.colorRampTexture;s||(s=e.colorRampTexture=new Nu(i,e.colorRamp,n.RGBA)),s.bind(n.LINEAR,n.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(i,n.TRIANGLES,Mf.disabled,Ef.disabled,t.colorModeForRenderPass(),If.disabled,((t,e,i,n)=>{const r=Sa();Da(r,0,t.width,t.height,0,0,1);const s=t.context.gl;return{u_matrix:r,u_world:[s.drawingBufferWidth,s.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:e.paint.get("heatmap-opacity")}})(t,e),null,e.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,e.paint,t.transform.zoom)}(t,i))}(t,e,i,n);break;case"line":!function(t,e,i,n){if("translucent"!==t.renderPass)return;const r=i.paint.get("line-opacity"),s=i.paint.get("line-width");if(0===r.constantOr(1)||0===s.constantOr(1))return;const o=t.depthModeForSublayer(0,Mf.ReadOnly),a=t.colorModeForRenderPass(),l=i.paint.get("line-dasharray"),c=i.paint.get("line-pattern"),u=c.constantOr(1),h=i.paint.get("line-gradient"),d=i.getCrossfadeParameters(),p=u?"linePattern":l?"lineSDF":h?"lineGradient":"line",m=t.context,g=m.gl;let _=!0;for(const r of n){const n=e.getTile(r);if(u&&!n.patternsLoaded())continue;const s=n.getBucket(i);if(!s)continue;const x=s.programConfigurations.get(i.id),v=t.context.program.get(),b=t.useProgram(p,x),w=_||b.program!==v,k=t.style.map.terrain&&t.style.map.terrain.getTerrainData(r),S=c.constantOr(null);if(S&&n.imageAtlas){const t=n.imageAtlas,e=t.patternPositions[S.to.toString()],i=t.patternPositions[S.from.toString()];e&&i&&x.setConstantPatternPositions(e,i)}const T=k?r:null,A=u?Sp(t,n,i,d,T):l?Tp(t,n,i,l,d,T):h?kp(t,n,i,s.lineClipsArray.length,T):wp(t,n,i,T);if(u)m.activeTexture.set(g.TEXTURE0),n.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),x.updatePaintBuffers(d);else if(l&&(w||t.lineAtlas.dirty))m.activeTexture.set(g.TEXTURE0),t.lineAtlas.bind(m);else if(h){const n=s.gradients[i.id];let o=n.texture;if(i.gradientVersion!==n.version){let a=256;if(i.stepInterpolant){const i=e.getSource().maxzoom,n=r.canonical.z===i?Math.ceil(1<<t.transform.maxZoom-r.canonical.z):1;a=f((y=s.maxLineLength/Jo*1024*n)<=1?1:Math.pow(2,Math.ceil(Math.log(y)/Math.LN2)),256,m.maxTextureSize)}n.gradient=Ha({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:a,image:n.gradient||void 0,clips:s.lineClipsArray}),n.texture?n.texture.update(n.gradient):n.texture=new Nu(m,n.gradient,g.RGBA),n.version=i.gradientVersion,o=n.texture}m.activeTexture.set(g.TEXTURE0),o.bind(i.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE)}b.draw(m,g.TRIANGLES,o,t.stencilModeForClipping(r),a,If.disabled,A,k,i.id,s.layoutVertexBuffer,s.indexBuffer,s.segments,i.paint,t.transform.zoom,x,s.layoutVertexBuffer2),_=!1}var y}(t,e,i,n);break;case"fill":!function(t,e,i,n){const r=i.paint.get("fill-color"),s=i.paint.get("fill-opacity");if(0===s.constantOr(1))return;const o=t.colorModeForRenderPass(),a=i.paint.get("fill-pattern"),l=t.opaquePassEnabledForLayer()&&!a.constantOr(1)&&1===r.constantOr(ce.transparent).a&&1===s.constantOr(0)?"opaque":"translucent";if(t.renderPass===l){const r=t.depthModeForSublayer(1,"opaque"===t.renderPass?Mf.ReadWrite:Mf.ReadOnly);Nf(t,e,i,n,r,o,!1)}if("translucent"===t.renderPass&&i.paint.get("fill-antialias")){const r=t.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,Mf.ReadOnly);Nf(t,e,i,n,r,o,!0)}}(t,e,i,n);break;case"fill-extrusion":!function(t,e,i,n){const r=i.paint.get("fill-extrusion-opacity");if(0!==r&&"translucent"===t.renderPass){const s=new Mf(t.context.gl.LEQUAL,Mf.ReadWrite,t.depthRangeFor3D);if(1!==r||i.paint.get("fill-extrusion-pattern").constantOr(1))qf(t,e,i,n,s,Ef.disabled,Tf.disabled),qf(t,e,i,n,s,t.stencilModeFor3D(),t.colorModeForRenderPass());else{const r=t.colorModeForRenderPass();qf(t,e,i,n,s,Ef.disabled,r)}}}(t,e,i,n);break;case"hillshade":!function(t,e,i,n){if("offscreen"!==t.renderPass&&"translucent"!==t.renderPass)return;const r=t.context,s=t.depthModeForSublayer(0,Mf.ReadOnly),o=t.colorModeForRenderPass(),[a,l]="translucent"===t.renderPass?t.stencilConfigForOverlap(n):[{},n];for(const n of l){const r=e.getTile(n);void 0!==r.needsHillshadePrepare&&r.needsHillshadePrepare&&"offscreen"===t.renderPass?$f(t,r,i,s,Ef.disabled,o):"translucent"===t.renderPass&&jf(t,n,r,i,s,a[n.overscaledZ],o)}r.viewport.set([0,0,t.width,t.height])}(t,e,i,n);break;case"raster":!function(t,e,i,n){if("translucent"!==t.renderPass)return;if(0===i.paint.get("raster-opacity"))return;if(!n.length)return;const r=t.context,s=r.gl,o=e.getSource(),a=t.useProgram("raster"),l=t.colorModeForRenderPass(),[c,u]=o instanceof kh?[{},n]:t.stencilConfigForOverlap(n),h=u[u.length-1].overscaledZ,d=!t.options.moving;for(const n of u){const u=t.depthModeForSublayer(n.overscaledZ-h,1===i.paint.get("raster-opacity")?Mf.ReadWrite:Mf.ReadOnly,s.LESS),p=e.getTile(n);p.registerFadeDuration(i.paint.get("raster-fade-duration"));const f=e.findLoadedParent(n,0),m=Uf(p,f,e,i,t.transform,t.style.map.terrain);let g,_;const y="nearest"===i.paint.get("raster-resampling")?s.NEAREST:s.LINEAR;r.activeTexture.set(s.TEXTURE0),p.texture.bind(y,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),r.activeTexture.set(s.TEXTURE1),f?(f.texture.bind(y,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),g=Math.pow(2,f.tileID.overscaledZ-p.tileID.overscaledZ),_=[p.tileID.canonical.x*g%1,p.tileID.canonical.y*g%1]):p.texture.bind(y,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST);const x=t.style.map.terrain&&t.style.map.terrain.getTerrainData(n),v=x?n:null,b=v?v.posMatrix:t.transform.calculatePosMatrix(n.toUnwrapped(),d),w=Cp(b,_||[0,0],g||1,m,i);o instanceof kh?a.draw(r,s.TRIANGLES,u,Ef.disabled,l,If.disabled,w,x,i.id,o.boundsBuffer,t.quadTriangleIndexBuffer,o.boundsSegments):a.draw(r,s.TRIANGLES,u,c[n.overscaledZ],l,If.disabled,w,x,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}(t,e,i,n);break;case"background":!function(t,e,i,n){const r=i.paint.get("background-color"),s=i.paint.get("background-opacity");if(0===s)return;const o=t.context,a=o.gl,l=t.transform,c=l.tileSize,u=i.paint.get("background-pattern");if(t.isPatternMissing(u))return;const h=!u&&1===r.a&&1===s&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==h)return;const d=Ef.disabled,p=t.depthModeForSublayer(0,"opaque"===h?Mf.ReadWrite:Mf.ReadOnly),f=t.colorModeForRenderPass(),m=t.useProgram(u?"backgroundPattern":"background"),g=n||l.coveringTiles({tileSize:c,terrain:t.style.map.terrain});u&&(o.activeTexture.set(a.TEXTURE0),t.imageManager.bind(t.context));const _=i.getCrossfadeParameters();for(const e of g){const l=n?e.posMatrix:t.transform.calculatePosMatrix(e.toUnwrapped()),h=u?Lp(l,s,t,u,{tileID:e,tileSize:c},_):Pp(l,s,r),g=t.style.map.terrain&&t.style.map.terrain.getTerrainData(e);m.draw(o,a.TRIANGLES,p,d,f,If.disabled,h,g,i.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}(t,0,i,n);break;case"custom":!function(t,e,i){const n=t.context,r=i.implementation;if("offscreen"===t.renderPass){const e=r.prerender;e&&(t.setCustomLayerDefaults(),n.setColorMode(t.colorModeForRenderPass()),e.call(r,n.gl,t.transform.customLayerMatrix()),n.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),n.setColorMode(t.colorModeForRenderPass()),n.setStencilMode(Ef.disabled);const e="3d"===r.renderingMode?new Mf(t.context.gl.LEQUAL,Mf.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,Mf.ReadOnly);n.setDepthMode(e),r.render(n.gl,t.transform.customLayerMatrix()),n.setDirty(),t.setBaseState(),n.bindFramebuffer.set(null)}}(t,0,i)}}translatePosMatrix(t,e,i,n,r){if(!i[0]&&!i[1])return t;const s=r?"map"===n?this.transform.angle:0:"viewport"===n?-this.transform.angle:0;if(s){const t=Math.sin(s),e=Math.cos(s);i=[i[0]*e-i[1]*t,i[0]*t+i[1]*e]}const o=[r?i[0]:_d(e,i[0],this.transform.zoom),r?i[1]:_d(e,i[1],this.transform.zoom),0],a=new Float32Array(16);return Ca(a,t,o),a}saveTileTexture(t){const e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const e=this.imageManager.getPattern(t.from.toString()),i=this.imageManager.getPattern(t.to.toString());return!e||!i}useProgram(t,e){this.cache=this.cache||{};const i=t+(e?e.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[i]||(this.cache[i]=new lp(this.context,rp[t],e,Fp[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[i]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Nu(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:e}=this.context.gl;return this.width!==t||this.height!==e}}class im{constructor(t,e){this.points=t,this.planes=e}static fromInvProjectionMatrix(t,e,i){const n=Math.pow(2,i),r=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((i=>{const r=1/(i=Ra([],i,t))[3]/e*n;return function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t}(i,i,[r,r,1/i[3],r])})),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((t=>{const e=function(t,e){var i=e[0],n=e[1],r=e[2],s=i*i+n*n+r*r;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}([],function(t,e,i){var n=e[0],r=e[1],s=e[2],o=i[0],a=i[1],l=i[2];return t[0]=r*l-s*a,t[1]=s*o-n*l,t[2]=n*a-r*o,t}([],Fa([],r[t[0]],r[t[1]]),Fa([],r[t[2]],r[t[1]]))),i=-((n=e)[0]*(s=r[t[1]])[0]+n[1]*s[1]+n[2]*s[2]);var n,s;return e.concat(i)}));return new im(r,s)}}class nm{constructor(t,e){this.min=t,this.max=e,this.center=function(t,e,i){return t[0]=.5*e[0],t[1]=.5*e[1],t[2]=.5*e[2],t}([],function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}([],this.min,this.max))}quadrant(t){const e=[t%2==0,t<2],i=Pa(this.min),n=Pa(this.max);for(let t=0;t<e.length;t++)i[t]=e[t]?this.min[t]:this.center[t],n[t]=e[t]?this.center[t]:this.max[t];return n[2]=this.max[2],new nm(i,n)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const e=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let i=!0;for(let s=0;s<t.planes.length;s++){const o=t.planes[s];let a=0;for(let t=0;t<e.length;t++)(n=o)[0]*(r=e[t])[0]+n[1]*r[1]+n[2]*r[2]+n[3]*r[3]>=0&&a++;if(0===a)return 0;a!==e.length&&(i=!1)}var n,r;if(i)return 2;for(let e=0;e<3;e++){let i=Number.MAX_VALUE,n=-Number.MAX_VALUE;for(let r=0;r<t.points.length;r++){const s=t.points[r][e]-this.min[e];i=Math.min(i,s),n=Math.max(n,s)}if(n<0||i>this.max[e]-this.min[e])return 0}return 1}}class rm{constructor(t=0,e=0,i=0,n=0){if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(i)||i<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=i,this.right=n}interpolate(t,e,i){return null!=e.top&&null!=t.top&&(this.top=ri.number(t.top,e.top,i)),null!=e.bottom&&null!=t.bottom&&(this.bottom=ri.number(t.bottom,e.bottom,i)),null!=e.left&&null!=t.left&&(this.left=ri.number(t.left,e.left,i)),null!=e.right&&null!=t.right&&(this.right=ri.number(t.right,e.right,i)),this}getCenter(t,e){const i=f((this.left+t-this.right)/2,0,t),n=f((this.top+e-this.bottom)/2,0,e);return new s(i,n)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new rm(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class sm{constructor(t,e,i,n,r){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===r||!!r,this._minZoom=t||0,this._maxZoom=e||22,this._minPitch=null==i?0:i,this._maxPitch=null==n?60:n,this.setMaxBounds(),this.width=0,this.height=0,this._center=new ih(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new rm,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const t=new sm(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this._minEleveationForCurrentTile=t._minEleveationForCurrentTile,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const e=-m(t,-180,180)*Math.PI/180;this.angle!==e&&(this._unmodified=!1,this.angle=e,this._calcMatrices(),this.rotationMatrix=function(){var t=new ka(4);return ka!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}(),function(t,e,i){var n=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(i),l=Math.cos(i);t[0]=n*l+s*a,t[1]=r*l+o*a,t[2]=n*-a+s*l,t[3]=r*-a+o*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const e=f(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==e&&(this._unmodified=!1,this._pitch=e,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.tileZoom=Math.max(0,Math.floor(e)),this.scale=this.zoomScale(e),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,i){this._unmodified=!1,this._edgeInsets.interpolate(t,e,i),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}getVisibleUnwrappedCoordinates(t){const e=[new _h(0,t)];if(this._renderWorldCopies){const i=this.pointCoordinate(new s(0,0)),n=this.pointCoordinate(new s(this.width,0)),r=this.pointCoordinate(new s(this.width,this.height)),o=this.pointCoordinate(new s(0,this.height)),a=Math.floor(Math.min(i.x,n.x,r.x,o.x)),l=Math.floor(Math.max(i.x,n.x,r.x,o.x)),c=1;for(let i=a-c;i<=l+c;i++)0!==i&&e.push(new _h(i,t))}return e}coveringTiles(t){var e,i;let n=this.coveringZoomLevel(t);const r=n;if(void 0!==t.minzoom&&n<t.minzoom)return[];void 0!==t.maxzoom&&n>t.maxzoom&&(n=t.maxzoom);const s=this.pointCoordinate(this.getCameraPoint()),o=hh.fromLngLat(this.center),a=Math.pow(2,n),l=[a*s.x,a*s.y,0],c=[a*o.x,a*o.y,0],u=im.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n);let h=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(h=n);const d=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,p=t=>({aabb:new nm([t*a,0,0],[(t+1)*a,a,0]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}),f=[],m=[],g=n,_=t.reparseOverscaled?r:n;if(this._renderWorldCopies)for(let t=1;t<=3;t++)f.push(p(-t)),f.push(p(t));for(f.push(p(0));f.length>0;){const n=f.pop(),r=n.x,s=n.y;let o=n.fullyVisible;if(!o){const t=n.aabb.intersects(u);if(0===t)continue;o=2===t}const a=t.terrain?l:c,p=n.aabb.distanceX(a),y=n.aabb.distanceY(a),x=Math.max(Math.abs(p),Math.abs(y));if(n.zoom===g||x>d+(1<<g-n.zoom)-2&&n.zoom>=h){const t=g-n.zoom,e=l[0]-.5-(r<<t),i=l[1]-.5-(s<<t);m.push({tileID:new yh(n.zoom===g?_:n.zoom,n.wrap,n.zoom,r,s),distanceSq:Oa([c[0]-.5-r,c[1]-.5-s]),tileDistanceToCamera:Math.sqrt(e*e+i*i)})}else for(let a=0;a<4;a++){const l=(r<<1)+a%2,c=(s<<1)+(a>>1),u=n.zoom+1;let h=n.aabb.quadrant(a);if(t.terrain){const r=new yh(u,n.wrap,u,l,c),s=t.terrain.getMinMaxElevation(r),o=null!==(e=s.minElevation)&&void 0!==e?e:this.elevation,a=null!==(i=s.maxElevation)&&void 0!==i?i:this.elevation;h=new nm([h.min[0],h.min[1],o],[h.max[0],h.max[1],a])}f.push({aabb:h,zoom:u,x:l,y:c,wrap:n.wrap,fullyVisible:o})}}return m.sort(((t,e)=>t.distanceSq-e.distanceSq)).map((t=>t.tileID))}resize(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const e=f(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new s(oh(t.lng)*this.worldSize,ah(e)*this.worldSize)}unproject(t){return new hh(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const e=this.pointLocation(this.centerPoint,t),i=t.getElevationForLngLatZoom(e,this.tileZoom);if(!(this.elevation-i))return;const n=this.getCameraPosition(),r=hh.fromLngLat(n.lngLat,n.altitude),s=hh.fromLngLat(e,i),o=r.x-s.x,a=r.y-s.y,l=r.z-s.z,c=Math.sqrt(o*o+a*a+l*l),u=this.scaleZoom(this.cameraToCenterDistance/c/this.tileSize);this._elevation=i,this._center=e,this.zoom=u}setLocationAtPoint(t,e){const i=this.pointCoordinate(e),n=this.pointCoordinate(this.centerPoint),r=this.locationCoordinate(t),s=new hh(r.x-(i.x-n.x),r.y-(i.y-n.y));this.center=this.coordinateLocation(s),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,e){return e?this.coordinatePoint(this.locationCoordinate(t),e.getElevationForLngLatZoom(t,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,e){return this.coordinateLocation(this.pointCoordinate(t,e))}locationCoordinate(t){return hh.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,e){if(e){const i=e.pointCoordinate(t);if(null!=i)return i}const i=[t.x,t.y,0,1],n=[t.x,t.y,1,1];Ra(i,i,this.pixelMatrixInverse),Ra(n,n,this.pixelMatrixInverse);const r=i[3],s=n[3],o=i[1]/r,a=n[1]/s,l=i[2]/r,c=n[2]/s,u=l===c?0:(0-l)/(c-l);return new hh(ri.number(i[0]/r,n[0]/s,u)/this.worldSize,ri.number(o,a,u)/this.worldSize)}coordinatePoint(t,e=0,i=this.pixelMatrix){const n=[t.x*this.worldSize,t.y*this.worldSize,e,1];return Ra(n,n,i),new s(n[0]/n[3],n[1]/n[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return(new nh).extend(this.pointLocation(new s(0,t))).extend(this.pointLocation(new s(this.width,t))).extend(this.pointLocation(new s(this.width,this.height))).extend(this.pointLocation(new s(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new nh([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(t,e=!1){const i=t.key,n=e?this._alignedPosMatrixCache:this._posMatrixCache;if(n[i])return n[i];const r=t.canonical,s=this.worldSize/this.zoomScale(r.z),o=r.x+Math.pow(2,r.z)*t.wrap,a=Ta(new Float64Array(16));return Ca(a,a,[o*s,r.y*s,0]),Ea(a,a,[s/Jo,s/Jo,1]),Ma(a,e?this.alignedProjMatrix:this.projMatrix,a),n[i]=new Float32Array(a),n[i]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let t,e,i,n,r=-90,o=90,a=-180,l=180;const c=this.size,u=this._unmodified;if(this.latRange){const e=this.latRange;r=ah(e[1])*this.worldSize,o=ah(e[0])*this.worldSize,t=o-r<c.y?c.y/(o-r):0}if(this.lngRange){const t=this.lngRange;a=m(oh(t[0])*this.worldSize,0,this.worldSize),l=m(oh(t[1])*this.worldSize,0,this.worldSize),l<a&&(l+=this.worldSize),e=l-a<c.x?c.x/(l-a):0}const h=this.point,d=Math.max(e||0,t||0);if(d)return this.center=this.unproject(new s(e?(l+a)/2:h.x,t?(o+r)/2:h.y)),this.zoom+=this.scaleZoom(d),this._unmodified=u,void(this._constraining=!1);if(this.latRange){const t=h.y,e=c.y/2;t-e<r&&(n=r+e),t+e>o&&(n=o-e)}if(this.lngRange){const t=(a+l)/2,e=m(h.x,t-this.worldSize/2,t+this.worldSize/2),n=c.x/2;e-n<a&&(i=a+n),e+n>l&&(i=l-n)}void 0===i&&void 0===n||(this.center=this.unproject(new s(void 0!==i?i:h.x,void 0!==n?n:h.y)).wrap()),this._unmodified=u,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,e=this.point.x,i=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=lh(1,this.center.lat)*this.worldSize;let n=Ta(new Float64Array(16));Ea(n,n,[this.width/2,-this.height/2,1]),Ca(n,n,[1,-1,0]),this.labelPlaneMatrix=n,n=Ta(new Float64Array(16)),Ea(n,n,[1,-1,1]),Ca(n,n,[-1,-1,0]),Ea(n,n,[2/this.width,2/this.height,1]),this.glCoordMatrix=n;const r=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),s=Math.min(this.elevation,this._minEleveationForCurrentTile),o=r-s*this._pixelPerMeter/Math.cos(this._pitch),a=s<0?o:r,l=Math.PI/2+this._pitch,c=this._fov*(.5+t.y/this.height),u=Math.sin(c)*a/Math.sin(f(Math.PI-l-c,.01,Math.PI-.01)),h=this.getHorizon(),d=2*Math.atan(h/this.cameraToCenterDistance)*(.5+t.y/(2*h)),p=Math.sin(d)*a/Math.sin(f(Math.PI-l-d,.01,Math.PI-.01)),m=Math.min(u,p),g=1.01*(Math.cos(Math.PI/2-this._pitch)*m+a),_=this.height/50;n=new Float64Array(16),function(t,e,i,n,r){var s,o=1/Math.tan(e/2);t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(t[10]=(r+n)*(s=1/(n-r)),t[14]=2*r*n*s):(t[10]=-1,t[14]=-2*n)}(n,this._fov,this.width/this.height,_,g),n[8]=2*-t.x/this.width,n[9]=2*t.y/this.height,Ea(n,n,[1,-1,1]),Ca(n,n,[0,0,-this.cameraToCenterDistance]),function(t,e,i){var n=Math.sin(i),r=Math.cos(i),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*r+c*n,t[5]=o*r+u*n,t[6]=a*r+h*n,t[7]=l*r+d*n,t[8]=c*r-s*n,t[9]=u*r-o*n,t[10]=h*r-a*n,t[11]=d*r-l*n}(n,n,this._pitch),Ia(n,n,this.angle),Ca(n,n,[-e,-i,0]),this.mercatorMatrix=Ea([],n,[this.worldSize,this.worldSize,this.worldSize]),Ea(n,n,[1,1,this._pixelPerMeter]),this.pixelMatrix=Ma(new Float64Array(16),this.labelPlaneMatrix,n),Ca(n,n,[0,0,-this.elevation]),this.projMatrix=n,this.invProjMatrix=Aa([],n),this.pixelMatrix3D=Ma(new Float64Array(16),this.labelPlaneMatrix,n);const y=this.width%2/2,x=this.height%2/2,v=Math.cos(this.angle),b=Math.sin(this.angle),w=e-Math.round(e)+v*y+b*x,k=i-Math.round(i)+v*x+b*y,S=new Float64Array(n);if(Ca(S,S,[w>.5?w-1:w,k>.5?k-1:k,0]),this.alignedProjMatrix=S,n=Aa(new Float64Array(16),this.pixelMatrix),!n)throw new Error("failed to invert matrix");this.pixelMatrixInverse=n,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new s(0,0)),e=[t.x*this.worldSize,t.y*this.worldSize,0,1];return Ra(e,e,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s(0,t))}getCameraQueryGeometry(t){const e=this.getCameraPoint();if(1===t.length)return[t[0],e];{let i=e.x,n=e.y,r=e.x,o=e.y;for(const e of t)i=Math.min(i,e.x),n=Math.min(n,e.y),r=Math.max(r,e.x),o=Math.max(o,e.y);return[new s(i,n),new s(r,n),new s(r,o),new s(i,o),new s(i,n)]}}}function om(t,e){let i,n=!1,r=null,s=null;const o=()=>{r=null,n&&(t.apply(s,i),r=setTimeout(o,e),n=!1)};return(...t)=>(n=!0,s=this,i=t,r||o(),r)}class am{constructor(t){this._getCurrentHash=()=>{const t=window.location.hash.replace("#","");if(this._hashName){let e;return t.split("&").map((t=>t.split("="))).forEach((t=>{t[0]===this._hashName&&(e=t)})),(e&&e[1]||"").split("/")}return t.split("/")},this._onHashChange=()=>{const t=this._getCurrentHash();if(t.length>=3&&!t.some((t=>isNaN(t)))){const e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const t=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,t)}catch(t){}},this._updateHash=om(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(t){const e=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,n=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),r=Math.pow(10,n),s=Math.round(e.lng*r)/r,o=Math.round(e.lat*r)/r,a=this._map.getBearing(),l=this._map.getPitch();let c="";if(c+=t?`/${s}/${o}/${i}`:`${i}/${o}/${s}`,(a||l)&&(c+="/"+Math.round(10*a)/10),l&&(c+=`/${Math.round(l)}`),this._hashName){const t=this._hashName;let e=!1;const i=window.location.hash.slice(1).split("&").map((i=>{const n=i.split("=")[0];return n===t?(e=!0,`${n}=${c}`):i})).filter((t=>t));return e||i.push(`${t}=${c}`),`#${i.join("&")}`}return`#${c}`}}const lm={linearity:.3,easing:d(0,0,.3,1)},cm=_({deceleration:2500,maxSpeed:1400},lm),um=_({deceleration:20,maxSpeed:1400},lm),hm=_({deceleration:1e3,maxSpeed:360},lm),dm=_({deceleration:1e3,maxSpeed:90},lm);class pm{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:R.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,e=R.now();for(;t.length>0&&e-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const e={zoom:0,bearing:0,pitch:0,pan:new s(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)e.zoom+=t.zoomDelta||0,e.bearing+=t.bearingDelta||0,e.pitch+=t.pitchDelta||0,t.panDelta&&e.pan._add(t.panDelta),t.around&&(e.around=t.around),t.pinchAround&&(e.pinchAround=t.pinchAround);const i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,n={};if(e.pan.mag()){const r=mm(e.pan.mag(),i,_({},cm,t||{}));n.offset=e.pan.mult(r.amount/e.pan.mag()),n.center=this._map.transform.center,fm(n,r)}if(e.zoom){const t=mm(e.zoom,i,um);n.zoom=this._map.transform.zoom+t.amount,fm(n,t)}if(e.bearing){const t=mm(e.bearing,i,hm);n.bearing=this._map.transform.bearing+f(t.amount,-179,179),fm(n,t)}if(e.pitch){const t=mm(e.pitch,i,dm);n.pitch=this._map.transform.pitch+t.amount,fm(n,t)}if(n.zoom||n.bearing){const t=void 0===e.pinchAround?e.around:e.pinchAround;n.around=t?this._map.unproject(t):this._map.getCenter()}return this.clear(),_(n,{noMoveStart:!0})}}function fm(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function mm(t,e,i){const{maxSpeed:n,linearity:r,deceleration:s}=i,o=f(t*r/(e/1e3),-n,n),a=Math.abs(o)/(s*r);return{easing:i.easing,duration:1e3*a,amount:o*(a/2)}}class gm extends st{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,i,n={}){const r=O.mousePos(e.getCanvasContainer(),i);super(t,_({point:r,lngLat:e.unproject(r),originalEvent:i},n)),this._defaultPrevented=!1,this.target=e}}class _m extends st{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,i){const n="touchend"===t?i.changedTouches:i.touches,r=O.touchPos(e.getCanvasContainer(),n),o=r.map((t=>e.unproject(t))),a=r.reduce(((t,e,i,n)=>t.add(e.div(n.length))),new s(0,0));super(t,{points:r,point:a,lngLats:o,lngLat:e.unproject(a),originalEvent:i}),this._defaultPrevented=!1}}class ym extends st{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,i){super(t,{originalEvent:i}),this._defaultPrevented=!1}}class xm{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new ym(t.type,this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new gm(t.type,this._map,t))}mouseup(t){this._map.fire(new gm(t.type,this._map,t))}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new gm(t.type,this._map,t))}dblclick(t){return this._firePreventable(new gm(t.type,this._map,t))}mouseover(t){this._map.fire(new gm(t.type,this._map,t))}mouseout(t){this._map.fire(new gm(t.type,this._map,t))}touchstart(t){return this._firePreventable(new _m(t.type,this._map,t))}touchmove(t){this._map.fire(new _m(t.type,this._map,t))}touchend(t){this._map.fire(new _m(t.type,this._map,t))}touchcancel(t){this._map.fire(new _m(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vm{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new gm(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new gm("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new gm(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bm{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(s.convert(t),this._map.terrain)}}class wm{constructor(t,e){this._map=t,this._tr=new bm(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(O.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;const i=e;if(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)return;const n=this._startPos;this._lastPos=i,this._box||(this._box=O.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const r=Math.min(n.x,i.x),s=Math.max(n.x,i.x),o=Math.min(n.y,i.y),a=Math.max(n.y,i.y);O.setTransform(this._box,`translate(${r}px,${o}px)`),this._box.style.width=s-r+"px",this._box.style.height=a-o+"px"}mouseupWindow(t,e){if(!this._active)return;if(0!==t.button)return;const i=this._startPos,n=e;if(this.reset(),O.suppressClick(),i.x!==n.x||i.y!==n.y)return this._map.fire(new st("boxzoomend",{originalEvent:t})),{cameraAnimation:t=>t.fitScreenCoordinates(i,n,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(O.remove(this._box),this._box=null),O.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,e){return this._map.fire(new st(t,{originalEvent:e}))}}function km(t,e){if(t.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${t.length}, points ${e.length}`);const i={};for(let n=0;n<t.length;n++)i[t[n].identifier]=e[n];return i}class Sm{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,e,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=t.timeStamp),i.length===this.numTouches&&(this.centroid=function(t){const e=new s(0,0);for(const i of t)e._add(i);return e.div(t.length)}(e),this.touches=km(i,e)))}touchmove(t,e,i){if(this.aborted||!this.centroid)return;const n=km(i,e);for(const t in this.touches){const e=n[t];(!e||e.dist(this.touches[t])>30)&&(this.aborted=!0)}}touchend(t,e,i){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===i.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class Tm{constructor(t){this.singleTap=new Sm(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,e,i){this.singleTap.touchstart(t,e,i)}touchmove(t,e,i){this.singleTap.touchmove(t,e,i)}touchend(t,e,i){const n=this.singleTap.touchend(t,e,i);if(n){const e=t.timeStamp-this.lastTime<500,i=!this.lastTap||this.lastTap.dist(n)<30;if(e&&i||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}}class Am{constructor(t){this._tr=new bm(t),this._zoomIn=new Tm({numTouches:1,numTaps:2}),this._zoomOut=new Tm({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,e,i){this._zoomIn.touchstart(t,e,i),this._zoomOut.touchstart(t,e,i)}touchmove(t,e,i){this._zoomIn.touchmove(t,e,i),this._zoomOut.touchmove(t,e,i)}touchend(t,e,i){const n=this._zoomIn.touchend(t,e,i),r=this._zoomOut.touchend(t,e,i),s=this._tr;return n?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:s.zoom+1,around:s.unproject(n)},{originalEvent:t})}):r?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:s.zoom-1,around:s.unproject(r)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Mm{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const e=this._moveFunction(...t);if(e.bearingDelta||e.pitchDelta||e.around||e.panDelta)return this._active=!0,e}dragStart(t,e){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=e.length?e[0]:e,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,e){if(!this.isEnabled())return;const i=this._lastPoint;if(!i)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const n=e.length?e[0]:e;return!this._moved&&n.dist(i)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=n,this._move(i,n))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&O.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Cm={0:1,2:2};class Em{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const e=O.mouseButton(t);this._eventButton=e}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(t,e){const i=Cm[e];return void 0===t.buttons||(t.buttons&i)!==i}(t,this._eventButton)}isValidEndEvent(t){return O.mouseButton(t)===this._eventButton}}class Im{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return 1===t.targetTouches.length}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const Dm=t=>{t.mousedown=t.dragStart,t.mousemoveWindow=t.dragMove,t.mouseup=t.dragEnd,t.contextmenu=function(t){t.preventDefault()}},zm=({enable:t,clickTolerance:e,bearingDegreesPerPixelMoved:i=.8})=>{const n=new Em({checkCorrectEvent:t=>0===O.mouseButton(t)&&t.ctrlKey||2===O.mouseButton(t)});return new Mm({clickTolerance:e,move:(t,e)=>({bearingDelta:(e.x-t.x)*i}),moveStateManager:n,enable:t,assignEvents:Dm})},Pm=({enable:t,clickTolerance:e,pitchDegreesPerPixelMoved:i=-.5})=>{const n=new Em({checkCorrectEvent:t=>0===O.mouseButton(t)&&t.ctrlKey||2===O.mouseButton(t)});return new Mm({clickTolerance:e,move:(t,e)=>({pitchDelta:(e.y-t.y)*i}),moveStateManager:n,enable:t,assignEvents:Dm})};class Lm{constructor(t,e){this._minTouches=t.cooperativeGestures?2:1,this._clickTolerance=t.clickTolerance||1,this._map=e,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s(0,0),setTimeout((()=>{this._cancelCooperativeMessage=!1}),200)}touchstart(t,e,i){return this._calculateTransform(t,e,i)}touchmove(t,e,i){if(this._map._cooperativeGestures&&(2===this._minTouches&&i.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(t,!1,i.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(i.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,e,i)}touchend(t,e,i){this._calculateTransform(t,e,i),this._active&&i.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,e,i){i.length>0&&(this._active=!0);const n=km(i,e),r=new s(0,0),o=new s(0,0);let a=0;for(const t in n){const e=n[t],i=this._touches[t];i&&(r._add(e),o._add(e.sub(i)),a++,n[t]=e)}if(this._touches=n,a<this._minTouches||!o.mag())return;const l=o.div(a);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:r.div(a),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fm{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,e,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,i){if(!this._firstTwoTouches)return;t.preventDefault();const[n,r]=this._firstTwoTouches,s=Rm(i,e,n),o=Rm(i,e,r);if(!s||!o)return;const a=this._aroundCenter?null:s.add(o).div(2);return this._move([s,o],a,t)}touchend(t,e,i){if(!this._firstTwoTouches)return;const[n,r]=this._firstTwoTouches,s=Rm(i,e,n),o=Rm(i,e,r);s&&o||(this._active&&O.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Rm(t,e,i){for(let n=0;n<t.length;n++)if(t[n].identifier===i)return e[n]}function Om(t,e){return Math.log(t/e)/Math.LN2}class Bm extends Fm{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){const i=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Om(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Om(this._distance,i),pinchAround:e}}}function Vm(t,e){return 180*t.angleWith(e)/Math.PI}class Nm extends Fm{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e){const i=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Vm(this._vector,i),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,i=Vm(t,this._startVector);return Math.abs(i)<e}}function qm(t){return Math.abs(t.y)>Math.abs(t.x)}class jm extends Fm{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,e,i){super.touchstart(t,e,i),this._currentTouchCount=i.length}_start(t){this._lastPoints=t,qm(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,e,i){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const n=t[0].sub(this._lastPoints[0]),r=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(n,r,i.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(n.y+r.y)/2*-.5}):void 0}gestureBeginsVertically(t,e,i){if(void 0!==this._valid)return this._valid;const n=t.mag()>=2,r=e.mag()>=2;if(!n&&!r)return;if(!n||!r)return void 0===this._firstMove&&(this._firstMove=i),i-this._firstMove<100&&void 0;const s=t.y>0==e.y>0;return qm(t)&&qm(e)&&s}}const $m={panStep:100,bearingStep:15,pitchStep:10};class Um{constructor(t){this._tr=new bm(t);const e=$m;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,i=0,n=0,r=0,s=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?i=-1:(t.preventDefault(),r=-1);break;case 39:t.shiftKey?i=1:(t.preventDefault(),r=1);break;case 38:t.shiftKey?n=1:(t.preventDefault(),s=-1);break;case 40:t.shiftKey?n=-1:(t.preventDefault(),s=1);break;default:return}return this._rotationDisabled&&(i=0,n=0),{cameraAnimation:o=>{const a=this._tr;o.easeTo({duration:300,easeId:"keyboardHandler",easing:Zm,zoom:e?Math.round(a.zoom)+e*(t.shiftKey?2:1):a.zoom,bearing:a.bearing+i*this._bearingStep,pitch:a.pitch+n*this._pitchStep,offset:[-r*this._panStep,-s*this._panStep],center:a.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Zm(t){return t*(2-t)}const Wm=4.000244140625;class Gm{constructor(t,e){this._onTimeout=t=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)},this._map=t,this._tr=new bm(t),this._el=t.getCanvasContainer(),this._triggerRenderFrame=e,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!t[this._map._metaKey])return;t.preventDefault()}let e=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const i=R.now(),n=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==e&&e%Wm==0?this._type="wheel":0!==e&&Math.abs(e)<4?this._type="trackpad":n>400?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(n*e)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&(this._lastWheelEvent=t,this._delta-=e,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const e=O.mousePos(this._el,t),i=this._tr;this._around=ih.convert(this._aroundCenter?i.center:i.unproject(e)),this._aroundPoint=i.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const t=this._tr.transform;if(0!==this._delta){const e="wheel"===this._type&&Math.abs(this._delta)>Wm?this._wheelZoomRate:this._defaultZoomRate;let i=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==i&&(i=1/i);const n="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(n*i))),"wheel"===this._type&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const e="number"==typeof this._targetZoom?this._targetZoom:t.zoom,i=this._startZoom,n=this._easing;let r,s=!1;if("wheel"===this._type&&i&&n){const t=Math.min((R.now()-this._lastWheelEventTime)/200,1),o=n(t);r=ri.number(i,e,o),t<1?this._frameId||(this._frameId=!0):s=!0}else r=e,s=!0;return this._active=!0,s&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!s,zoomDelta:r-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let e=p;if(this._prevEase){const t=this._prevEase,i=(R.now()-t.start)/t.duration,n=t.easing(i+.01)-t.easing(i),r=.27/Math.sqrt(n*n+1e-4)*.01;e=d(r,Math.sqrt(.0729-r*r),.25,1)}return this._prevEase={start:R.now(),duration:t,easing:e},e}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Hm{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Xm{constructor(t){this._tr=new bm(t),this.reset()}reset(){this._active=!1}dblclick(t,e){return t.preventDefault(),{cameraAnimation:i=>{i.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(e)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ym{constructor(){this._tap=new Tm({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,e,i){if(!this._swipePoint)if(this._tapTime){const n=e[0],r=t.timeStamp-this._tapTime<500,s=this._tapPoint.dist(n)<30;r&&s?i.length>0&&(this._swipePoint=n,this._swipeTouch=i[0].identifier):this.reset()}else this._tap.touchstart(t,e,i)}touchmove(t,e,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;const n=e[0],r=n.y-this._swipePoint.y;return this._swipePoint=n,t.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(t,e,i)}touchend(t,e,i){if(this._tapTime)this._swipePoint&&0===i.length&&this.reset();else{const n=this._tap.touchend(t,e,i);n&&(this._tapTime=t.timeStamp,this._tapPoint=n)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Km{constructor(t,e,i){this._el=t,this._mousePan=e,this._touchPan=i}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Jm{constructor(t,e,i){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=i}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Qm{constructor(t,e,i,n){this._el=t,this._touchZoom=e,this._touchRotate=i,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const tg=t=>t.zoom||t.drag||t.pitch||t.rotate;class eg extends st{}function ig(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class ng{constructor(t,e){this.handleWindowEvent=t=>{this.handleEvent(t,`${t.type}Window`)},this.handleEvent=(t,e)=>{if("blur"===t.type)return void this.stop(!0);this._updatingCamera=!0;const i="renderFrame"===t.type?void 0:t,n={needsRenderFrame:!1},r={},s={},o=t.touches,a=o?this._getMapTouches(o):void 0,l=a?O.touchPos(this._el,a):O.mousePos(this._el,t);for(const{handlerName:o,handler:c,allowed:u}of this._handlers){if(!c.isEnabled())continue;let h;this._blockedByActive(s,u,o)?c.reset():c[e||t.type]&&(h=c[e||t.type](t,l,a),this.mergeHandlerResult(n,r,h,o,i),h&&h.needsRenderFrame&&this._triggerRenderFrame()),(h||c.isActive())&&(s[o]=c)}const c={};for(const t in this._previousActiveHandlers)s[t]||(c[t]=i);this._previousActiveHandlers=s,(Object.keys(c).length||ig(n))&&(this._changes.push([n,r,c]),this._triggerRenderFrame()),(Object.keys(s).length||ig(n))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:u}=n;u&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],u(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new pm(t),this._bearingSnap=e.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(e);const i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[window,"blur",void 0]];for(const[t,e,i]of this._listeners)O.addEventListener(t,e,t===document?this.handleWindowEvent:this.handleEvent,i)}destroy(){for(const[t,e,i]of this._listeners)O.removeEventListener(t,e,t===document?this.handleWindowEvent:this.handleEvent,i)}_addDefaultHandlers(t){const e=this._map,i=e.getCanvasContainer();this._add("mapEvent",new xm(e,t));const n=e.boxZoom=new wm(e,t);this._add("boxZoom",n),t.interactive&&t.boxZoom&&n.enable();const r=new Am(e),s=new Xm(e);e.doubleClickZoom=new Hm(s,r),this._add("tapZoom",r),this._add("clickZoom",s),t.interactive&&t.doubleClickZoom&&e.doubleClickZoom.enable();const o=new Ym;this._add("tapDragZoom",o);const a=e.touchPitch=new jm(e);this._add("touchPitch",a),t.interactive&&t.touchPitch&&e.touchPitch.enable(t.touchPitch);const l=zm(t),c=Pm(t);e.dragRotate=new Jm(t,l,c),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]),t.interactive&&t.dragRotate&&e.dragRotate.enable();const u=(({enable:t,clickTolerance:e})=>{const i=new Em({checkCorrectEvent:t=>0===O.mouseButton(t)&&!t.ctrlKey});return new Mm({clickTolerance:e,move:(t,e)=>({around:e,panDelta:e.sub(t)}),activateOnStart:!0,moveStateManager:i,enable:t,assignEvents:Dm})})(t),h=new Lm(t,e);e.dragPan=new Km(i,u,h),this._add("mousePan",u),this._add("touchPan",h,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&e.dragPan.enable(t.dragPan);const d=new Nm,p=new Bm;e.touchZoomRotate=new Qm(i,p,d,o),this._add("touchRotate",d,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&e.touchZoomRotate.enable(t.touchZoomRotate);const f=e.scrollZoom=new Gm(e,(()=>this._triggerRenderFrame()));this._add("scrollZoom",f,["mousePan"]),t.interactive&&t.scrollZoom&&e.scrollZoom.enable(t.scrollZoom);const m=e.keyboard=new Um(e);this._add("keyboard",m),t.interactive&&t.keyboard&&e.keyboard.enable(),this._add("blockableMapEvent",new vm(e))}_add(t,e,i){this._handlers.push({handlerName:t,handler:e,allowed:i}),this._handlersById[t]=e}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(tg(this._eventsInProgress))||this.isZooming()}_blockedByActive(t,e,i){for(const n in t)if(n!==i&&(!e||e.indexOf(n)<0))return!0;return!1}_getMapTouches(t){const e=[];for(const i of t)this._el.contains(i.target)&&e.push(i);return e}mergeHandlerResult(t,e,i,n,r){if(!i)return;_(t,i);const s={handlerName:n,originalEvent:i.originalEvent||r};void 0!==i.zoomDelta&&(e.zoom=s),void 0!==i.panDelta&&(e.drag=s),void 0!==i.pitchDelta&&(e.pitch=s),void 0!==i.bearingDelta&&(e.rotate=s)}_applyChanges(){const t={},e={},i={};for(const[n,r,o]of this._changes)n.panDelta&&(t.panDelta=(t.panDelta||new s(0,0))._add(n.panDelta)),n.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+n.zoomDelta),n.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+n.bearingDelta),n.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+n.pitchDelta),void 0!==n.around&&(t.around=n.around),void 0!==n.pinchAround&&(t.pinchAround=n.pinchAround),n.noInertia&&(t.noInertia=n.noInertia),_(e,r),_(i,o);this._updateMapTransform(t,e,i),this._changes=[]}_updateMapTransform(t,e,i){const n=this._map,r=n._getTransformForUpdate(),s=n.terrain;if(!(ig(t)||s&&this._terrainMovement))return this._fireEvents(e,i,!0);let{panDelta:o,zoomDelta:a,bearingDelta:l,pitchDelta:c,around:u,pinchAround:h}=t;void 0!==h&&(u=h),n._stop(!0),u=u||n.transform.centerPoint;const d=r.pointLocation(o?u.sub(o):u);l&&(r.bearing+=l),c&&(r.pitch+=c),a&&(r.zoom+=a),s?this._terrainMovement||!e.drag&&!e.zoom?e.drag&&this._terrainMovement?r.center=r.pointLocation(r.centerPoint.sub(o)):r.setLocationAtPoint(d,u):(this._terrainMovement=!0,this._map._elevationFreeze=!0,r.setLocationAtPoint(d,u),this._map.once("moveend",(()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,r.recalculateZoom(n.terrain)}))):r.setLocationAtPoint(d,u),n._applyUpdatedTransform(r),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(e,i,!0)}_fireEvents(t,e,i){const n=tg(this._eventsInProgress),r=tg(t),s={};for(const e in t){const{originalEvent:i}=t[e];this._eventsInProgress[e]||(s[`${e}start`]=i),this._eventsInProgress[e]=t[e]}!n&&r&&this._fireEvent("movestart",r.originalEvent);for(const t in s)this._fireEvent(t,s[t]);r&&this._fireEvent("move",r.originalEvent);for(const e in t){const{originalEvent:i}=t[e];this._fireEvent(e,i)}const o={};let a;for(const t in this._eventsInProgress){const{handlerName:i,originalEvent:n}=this._eventsInProgress[t];this._handlersById[i].isActive()||(delete this._eventsInProgress[t],a=e[i]||n,o[`${t}end`]=a)}for(const t in o)this._fireEvent(t,o[t]);const l=tg(this._eventsInProgress);if(i&&(n||r)&&!l){this._updatingCamera=!0;const t=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),e=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;!t||!t.essential&&R.prefersReducedMotion?(this._map.fire(new st("moveend",{originalEvent:a})),e(this._map.getBearing())&&this._map.resetNorth()):(e(t.bearing||this._map.getBearing())&&(t.bearing=0),t.freezeElevation=!0,this._map.easeTo(t,{originalEvent:a})),this._updatingCamera=!1}}_fireEvent(t,e){this._map.fire(new st(t,e?{originalEvent:e}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new eg("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class rg extends at{constructor(t,e){super(),this._renderFrameCallback=()=>{const t=Math.min((R.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=e.bearingSnap,this.on("moveend",(()=>{delete this._requestedCameraState}))}getCenter(){return new ih(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}panBy(t,e,i){return t=s.convert(t).mult(-1),this.panTo(this.transform.center,_({offset:t},e),i)}panTo(t,e,i){return this.easeTo(_({center:t},e),i)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(t,e,i){return this.easeTo(_({zoom:t},e),i)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(t,e,i){return this.easeTo(_({bearing:t},e),i)}resetNorth(t,e){return this.rotateTo(0,_({duration:1e3},t),e),this}resetNorthPitch(t,e){return this.easeTo(_({bearing:0,pitch:0,duration:1e3},t),e),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}cameraForBounds(t,e){t=nh.convert(t);const i=e&&e.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),i,e)}_cameraForBoxAndBearing(t,e,i,n){const r={top:0,bottom:0,right:0,left:0};if("number"==typeof(n=_({padding:r,offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding){const t=n.padding;n.padding={top:t,bottom:t,right:t,left:t}}n.padding=_(r,n.padding);const o=this.transform,a=o.padding,l=o.project(ih.convert(t)),c=o.project(ih.convert(e)),u=l.rotate(-i*Math.PI/180),h=c.rotate(-i*Math.PI/180),d=new s(Math.max(u.x,h.x),Math.max(u.y,h.y)),p=new s(Math.min(u.x,h.x),Math.min(u.y,h.y)),f=d.sub(p),m=(o.width-(a.left+a.right+n.padding.left+n.padding.right))/f.x,g=(o.height-(a.top+a.bottom+n.padding.top+n.padding.bottom))/f.y;if(g<0||m<0)return void A("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const y=Math.min(o.scaleZoom(o.scale*Math.min(m,g)),n.maxZoom),x=s.convert(n.offset),v=new s((n.padding.left-n.padding.right)/2,(n.padding.top-n.padding.bottom)/2).rotate(i*Math.PI/180),b=x.add(v).mult(o.scale/o.zoomScale(y));return{center:o.unproject(l.add(c).div(2).sub(b)),zoom:y,bearing:i}}fitBounds(t,e,i){return this._fitInternal(this.cameraForBounds(t,e),e,i)}fitScreenCoordinates(t,e,i,n,r){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(s.convert(t)),this.transform.pointLocation(s.convert(e)),i,n),n,r)}_fitInternal(t,e,i){return t?(delete(e=_(t,e)).padding,e.linear?this.easeTo(e,i):this.flyTo(e,i)):this}jumpTo(t,e){this.stop();const i=this._getTransformForUpdate();let n=!1,r=!1,s=!1;return"zoom"in t&&i.zoom!==+t.zoom&&(n=!0,i.zoom=+t.zoom),void 0!==t.center&&(i.center=ih.convert(t.center)),"bearing"in t&&i.bearing!==+t.bearing&&(r=!0,i.bearing=+t.bearing),"pitch"in t&&i.pitch!==+t.pitch&&(s=!0,i.pitch=+t.pitch),null==t.padding||i.isPaddingEqual(t.padding)||(i.padding=t.padding),this._applyUpdatedTransform(i),this.fire(new st("movestart",e)).fire(new st("move",e)),n&&this.fire(new st("zoomstart",e)).fire(new st("zoom",e)).fire(new st("zoomend",e)),r&&this.fire(new st("rotatestart",e)).fire(new st("rotate",e)).fire(new st("rotateend",e)),s&&this.fire(new st("pitchstart",e)).fire(new st("pitch",e)).fire(new st("pitchend",e)),this.fire(new st("moveend",e))}calculateCameraOptionsFromTo(t,e,i,n=0){const r=hh.fromLngLat(t,e),s=hh.fromLngLat(i,n),o=s.x-r.x,a=s.y-r.y,l=s.z-r.z,c=Math.hypot(o,a,l);if(0===c)throw new Error("Can't calculate camera options with same From and To");const u=Math.hypot(o,a),h=this.transform.scaleZoom(this.transform.cameraToCenterDistance/c/this.transform.tileSize),d=180*Math.atan2(o,-a)/Math.PI;let p=180*Math.acos(u/c)/Math.PI;return p=l<0?90-p:90+p,{center:s.toLngLat(),zoom:h,pitch:p,bearing:d}}easeTo(t,e){this._stop(!1,t.easeId),(!1===(t=_({offset:[0,0],duration:500,easing:p},t)).animate||!t.essential&&R.prefersReducedMotion)&&(t.duration=0);const i=this._getTransformForUpdate(),n=this.getZoom(),r=this.getBearing(),o=this.getPitch(),a=this.getPadding(),l="zoom"in t?+t.zoom:n,c="bearing"in t?this._normalizeBearing(t.bearing,r):r,u="pitch"in t?+t.pitch:o,h="padding"in t?t.padding:i.padding,d=s.convert(t.offset);let f=i.centerPoint.add(d);const m=i.pointLocation(f),g=ih.convert(t.center||m);this._normalizeCenter(g);const y=i.project(m),x=i.project(g).sub(y),v=i.zoomScale(l-n);let b,w;t.around&&(b=ih.convert(t.around),w=i.locationPoint(b));const k={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||l!==n,this._rotating=this._rotating||r!==c,this._pitching=this._pitching||u!==o,this._padding=!i.isPaddingEqual(h),this._easeId=t.easeId,this._prepareEase(e,t.noMoveStart,k),this.terrain&&this._prepareElevation(g),this._ease((s=>{if(this._zooming&&(i.zoom=ri.number(n,l,s)),this._rotating&&(i.bearing=ri.number(r,c,s)),this._pitching&&(i.pitch=ri.number(o,u,s)),this._padding&&(i.interpolatePadding(a,h,s),f=i.centerPoint.add(d)),this.terrain&&!t.freezeElevation&&this._updateElevation(s),b)i.setLocationAtPoint(b,w);else{const t=i.zoomScale(i.zoom-n),e=l>n?Math.min(2,v):Math.max(.5,v),r=Math.pow(e,1-s),o=i.unproject(y.add(x.mult(s*r)).mult(t));i.setLocationAtPoint(i.renderWorldCopies?o.wrap():o,f)}this._applyUpdatedTransform(i),this._fireMoveEvents(e)}),(t=>{this.terrain&&this._finalizeElevation(),this._afterEase(e,t)}),t),this}_prepareEase(t,e,i={}){this._moving=!0,e||i.moving||this.fire(new st("movestart",t)),this._zooming&&!i.zooming&&this.fire(new st("zoomstart",t)),this._rotating&&!i.rotating&&this.fire(new st("rotatestart",t)),this._pitching&&!i.pitching&&this.fire(new st("pitchstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const e=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&e!==this._elevationTarget){const i=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(i-(e-(i*t+this._elevationStart))/(1-t)),this._elevationTarget=e}this.transform.elevation=ri.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(t){if(!this.transformCameraUpdate)return;const e=t.clone(),{center:i,zoom:n,pitch:r,bearing:s,elevation:o}=this.transformCameraUpdate(e);i&&(e.center=i),void 0!==n&&(e.zoom=n),void 0!==r&&(e.pitch=r),void 0!==s&&(e.bearing=s),void 0!==o&&(e.elevation=o),this.transform.apply(e)}_fireMoveEvents(t){this.fire(new st("move",t)),this._zooming&&this.fire(new st("zoom",t)),this._rotating&&this.fire(new st("rotate",t)),this._pitching&&this.fire(new st("pitch",t))}_afterEase(t,e){if(this._easeId&&e&&this._easeId===e)return;delete this._easeId;const i=this._zooming,n=this._rotating,r=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new st("zoomend",t)),n&&this.fire(new st("rotateend",t)),r&&this.fire(new st("pitchend",t)),this.fire(new st("moveend",t))}flyTo(t,e){if(!t.essential&&R.prefersReducedMotion){const i=y(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(i,e)}this.stop(),t=_({offset:[0,0],speed:1.2,curve:1.42,easing:p},t);const i=this._getTransformForUpdate(),n=this.getZoom(),r=this.getBearing(),o=this.getPitch(),a=this.getPadding(),l="zoom"in t?f(+t.zoom,i.minZoom,i.maxZoom):n,c="bearing"in t?this._normalizeBearing(t.bearing,r):r,u="pitch"in t?+t.pitch:o,h="padding"in t?t.padding:i.padding,d=i.zoomScale(l-n),m=s.convert(t.offset);let g=i.centerPoint.add(m);const x=i.pointLocation(g),v=ih.convert(t.center||x);this._normalizeCenter(v);const b=i.project(x),w=i.project(v).sub(b);let k=t.curve;const S=Math.max(i.width,i.height),T=S/d,A=w.mag();if("minZoom"in t){const e=f(Math.min(t.minZoom,n,l),i.minZoom,i.maxZoom),r=S/i.zoomScale(e-n);k=Math.sqrt(r/A*2)}const M=k*k;function C(t){const e=(T*T-S*S+(t?-1:1)*M*M*A*A)/(2*(t?T:S)*M*A);return Math.log(Math.sqrt(e*e+1)-e)}function E(t){return(Math.exp(t)-Math.exp(-t))/2}function I(t){return(Math.exp(t)+Math.exp(-t))/2}const D=C(!1);let z=function(t){return I(D)/I(D+k*t)},P=function(t){return S*((I(D)*(E(e=D+k*t)/I(e))-E(D))/M)/A;var e},L=(C(!0)-D)/k;if(Math.abs(A)<1e-6||!isFinite(L)){if(Math.abs(S-T)<1e-6)return this.easeTo(t,e);const i=T<S?-1:1;L=Math.abs(Math.log(T/S))/k,P=function(){return 0},z=function(t){return Math.exp(i*k*t)}}return t.duration="duration"in t?+t.duration:1e3*L/("screenSpeed"in t?+t.screenSpeed/k:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=r!==c,this._pitching=u!==o,this._padding=!i.isPaddingEqual(h),this._prepareEase(e,!1),this.terrain&&this._prepareElevation(v),this._ease((s=>{const d=s*L,p=1/z(d);i.zoom=1===s?l:n+i.scaleZoom(p),this._rotating&&(i.bearing=ri.number(r,c,s)),this._pitching&&(i.pitch=ri.number(o,u,s)),this._padding&&(i.interpolatePadding(a,h,s),g=i.centerPoint.add(m)),this.terrain&&!t.freezeElevation&&this._updateElevation(s);const f=1===s?v:i.unproject(b.add(w.mult(P(d))).mult(p));i.setLocationAtPoint(i.renderWorldCopies?f.wrap():f,g),this._applyUpdatedTransform(i),this._fireMoveEvents(e)}),(()=>{this.terrain&&this._finalizeElevation(),this._afterEase(e)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const t=this._onEaseEnd;delete this._onEaseEnd,t.call(this,e)}if(!t){const t=this.handlers;t&&t.stop(!1)}return this}_ease(t,e,i){!1===i.animate||0===i.duration?(t(1),e()):(this._easeStart=R.now(),this._easeOptions=i,this._onEaseFrame=t,this._onEaseEnd=e,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,e){t=m(t,-180,180);const i=Math.abs(t-e);return Math.abs(t-360-e)<i&&(t-=360),Math.abs(t+360-e)<i&&(t+=360),t}_normalizeCenter(t){const e=this.transform;if(!e.renderWorldCopies||e.lngRange)return;const i=t.lng-e.center.lng;t.lng+=i>180?-360:i<-180?360:0}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(ih.convert(t),this.transform.tileZoom)-this.transform.elevation:null}}class sg{constructor(t={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=t=>{!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType&&"terrain"!==t.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options&&this.options.compact,this._container=O.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=O.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=O.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){O.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,e){const i=this._map._getUIString(`AttributionControl.${e}`);t.title=i,t.setAttribute("aria-label",i)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((t=>"string"!=typeof t?"":t))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}const e=this._map.style.sourceCaches;for(const i in e){const n=e[i];if(n.used||n.usedForTerrain){const e=n.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution)}}t=t.filter((t=>String(t).trim())),t.sort(((t,e)=>t.length-e.length)),t=t.filter(((e,i)=>{for(let n=i+1;n<t.length;n++)if(t[n].indexOf(e)>=0)return!1;return!0}));const i=t.join(" | ");i!==this._attribHTML&&(this._attribHTML=i,t.length?(this._innerContainer.innerHTML=i,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class og{constructor(t={}){this._updateCompact=()=>{const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&e.classList.add("maplibregl-compact"):e.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=O.create("div","maplibregl-ctrl");const e=O.create("a","maplibregl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://maplibre.org/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){O.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ag{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,i=e?this._queue.concat(e):this._queue;for(const e of i)if(e.id===t)return void(e.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const e=this._currentlyRunning=this._queue;this._queue=[];for(const i of e)if(!i.cancelled&&(i.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var lg;!function(t){t.create="create",t.load="load",t.fullLoad="fullLoad"}(lg||(lg={}));let cg=null,ug=[];const hg=1e3/60,dg="loadTime",pg="fullLoadTime",fg={mark(t){performance.mark(t)},frame(t){const e=t;null!=cg&&ug.push(e-cg),cg=e},clearMetrics(){cg=null,ug=[],performance.clearMeasures(dg),performance.clearMeasures(pg);for(const t in lg)performance.clearMarks(lg[t])},getPerformanceMetrics(){performance.measure(dg,lg.create,lg.load),performance.measure(pg,lg.create,lg.fullLoad);const t=performance.getEntriesByName(dg)[0].duration,e=performance.getEntriesByName(pg)[0].duration,i=ug.length,n=1/(ug.reduce(((t,e)=>t+e),0)/i/1e3),r=ug.filter((t=>t>hg)).reduce(((t,e)=>t+(e-hg)/hg),0);return{loadTime:t,fullLoadTime:e,fps:n,percentDroppedFrames:r/(i+r)*100,totalFrames:i}}},mg={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var gg=fs([{name:"a_pos3d",type:"Int16",components:3}]);class _g extends at{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,e){this.sourceCache.update(t,e),this._renderableTilesKeys=[];const i={};for(const n of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:e}))i[n.key]=!0,this._renderableTilesKeys.push(n.key),this._tiles[n.key]||(n.posMatrix=new Float64Array(16),Da(n.posMatrix,0,Jo,0,Jo,0,1),this._tiles[n.key]=new Rh(n,this.tileSize));for(const t in this._tiles)i[t]||delete this._tiles[t]}freeRtt(t){for(const e in this._tiles){const i=this._tiles[e];(!t||i.tileID.equals(t)||i.tileID.isChildOf(t)||t.isChildOf(i.tileID))&&(i.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const e={};for(const i of this._renderableTilesKeys){const n=this._tiles[i].tileID;if(n.canonical.equals(t.canonical)){const n=t.clone();n.posMatrix=new Float64Array(16),Da(n.posMatrix,0,Jo,0,Jo,0,1),e[i]=n}else if(n.canonical.isChildOf(t.canonical)){const r=t.clone();r.posMatrix=new Float64Array(16);const s=n.canonical.z-t.canonical.z,o=n.canonical.x-(n.canonical.x>>s<<s),a=n.canonical.y-(n.canonical.y>>s<<s),l=Jo>>s;Da(r.posMatrix,0,l,0,l,0,1),Ca(r.posMatrix,r.posMatrix,[-o*l,-a*l,0]),e[i]=r}else if(t.canonical.isChildOf(n.canonical)){const r=t.clone();r.posMatrix=new Float64Array(16);const s=t.canonical.z-n.canonical.z,o=t.canonical.x-(t.canonical.x>>s<<s),a=t.canonical.y-(t.canonical.y>>s<<s),l=Jo>>s;Da(r.posMatrix,0,Jo,0,Jo,0,1),Ca(r.posMatrix,r.posMatrix,[o*l,a*l,0]),Ea(r.posMatrix,r.posMatrix,[1/2**s,1/2**s,0]),e[i]=r}}return e}getSourceTile(t,e){const i=this.sourceCache._source;let n=t.overscaledZ-this.deltaZoom;if(n>i.maxzoom&&(n=i.maxzoom),n<i.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(n).key);let r=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!r||!r.dem)&&e)for(;n>=i.minzoom&&(!r||!r.dem);)r=this.sourceCache.getTileByID(t.scaledTo(n--).key);return r}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter((e=>e.timeAdded>=t))}}class yg{constructor(t,e,i){this.painter=t,this.sourceCache=new _g(e),this.options=i,this.exaggeration="number"==typeof i.exaggeration?i.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,e,i,n=Jo){var r;if(!(e>=0&&e<n&&i>=0&&i<n))return 0;const s=this.getTerrainData(t),o=null===(r=s.tile)||void 0===r?void 0:r.dem;if(!o)return 0;const a=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[4]*r+i[12],t[1]=i[1]*n+i[5]*r+i[13],t}([],[e/n*Jo,i/n*Jo],s.u_terrain_matrix),l=[a[0]*o.dim,a[1]*o.dim],c=Math.floor(l[0]),u=Math.floor(l[1]),h=l[0]-c,d=l[1]-u;return o.get(c,u)*(1-h)*(1-d)+o.get(c+1,u)*h*(1-d)+o.get(c,u+1)*(1-h)*d+o.get(c+1,u+1)*h*d}getElevationForLngLatZoom(t,e){const{tileID:i,mercatorX:n,mercatorY:r}=this._getOverscaledTileIDFromLngLatZoom(t,e);return this.getElevation(i,n%Jo,r%Jo,Jo)}getElevation(t,e,i,n=Jo){return this.getDEMElevation(t,e,i,n)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const t=this.painter.context,e=new Ga({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Nu(t,e,t.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Nu(t,new Ga({width:1,height:1}),t.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=Ta([])}const e=this.sourceCache.getSourceTile(t,!0);if(e&&e.dem&&(!e.demTexture||e.needsTerrainPrepare)){const t=this.painter.context;e.demTexture=this.painter.getTileTexture(e.dem.stride),e.demTexture?e.demTexture.update(e.dem.getPixels(),{premultiply:!1}):e.demTexture=new Nu(t,e.dem.getPixels(),t.gl.RGBA,{premultiply:!1}),e.demTexture.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),e.needsTerrainPrepare=!1}const i=e&&e+e.tileID.key+t.key;if(i&&!this._demMatrixCache[i]){const i=this.sourceCache.sourceCache._source.maxzoom;let n=t.canonical.z-e.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=i?n=t.canonical.z-i:A("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const r=t.canonical.x-(t.canonical.x>>n<<n),s=t.canonical.y-(t.canonical.y>>n<<n),o=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(new Float64Array(16),[1/(Jo<<n),1/(Jo<<n),0]);Ca(o,o,[r*Jo,s*Jo,0]),this._demMatrixCache[t.key]={matrix:o,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:e&&e.dem&&e.dem.dim||1,u_terrain_matrix:i?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:e&&e.dem&&e.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(e&&e.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:e}}getFramebuffer(t){const e=this.painter,i=e.width/devicePixelRatio,n=e.height/devicePixelRatio;return!this._fbo||this._fbo.width===i&&this._fbo.height===n||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Nu(e.context,{width:i,height:n,data:null},e.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(e.context.gl.NEAREST,e.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Nu(e.context,{width:i,height:n,data:null},e.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(e.context.gl.NEAREST,e.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=e.context.createFramebuffer(i,n,!0,!1),this._fbo.depthAttachment.set(e.context.createRenderbuffer(e.context.gl.DEPTH_COMPONENT16,i,n))),this._fbo.colorAttachment.set("coords"===t?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const e=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let t=0,i=0;t<this._coordsTextureSize;t++)for(let n=0;n<this._coordsTextureSize;n++,i+=4)e[i+0]=255&n,e[i+1]=255&t,e[i+2]=n>>8<<4|t>>8,e[i+3]=0;const i=new Ga({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(e.buffer)),n=new Nu(t,i,t.gl.RGBA,{premultiply:!1});return n.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=n,n}pointCoordinate(t){const e=new Uint8Array(4),i=this.painter.context,n=i.gl;i.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),n.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,n.RGBA,n.UNSIGNED_BYTE,e),i.bindFramebuffer.set(null);const r=e[0]+(e[2]>>4<<8),s=e[1]+((15&e[2])<<8),o=this.coordsIndex[255-e[3]],a=o&&this.sourceCache.getTileByID(o);if(!a)return null;const l=this._coordsTextureSize,c=(1<<a.tileID.canonical.z)*l;return new hh(this._allowMercatorOverflow(t,(a.tileID.canonical.x*l+r)/c),(a.tileID.canonical.y*l+s)/c,this.getElevation(a.tileID,r,s,l))}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,e=new Js,i=new fo,n=this.meshSize,r=Jo/n,s=n*n;for(let t=0;t<=n;t++)for(let i=0;i<=n;i++)e.emplaceBack(i*r,t*r,0);for(let t=0;t<s;t+=n+1)for(let e=0;e<n;e++)i.emplaceBack(e+t,n+e+t+1,n+e+t+2),i.emplaceBack(e+t,n+e+t+2,e+t+1);const o=e.length,a=o+2*(n+1);for(const t of[0,1])for(let i=0;i<=n;i++)for(const n of[0,1])e.emplaceBack(i*r,t*Jo,n);for(let t=0;t<2*n;t+=2)i.emplaceBack(a+t,a+t+1,a+t+3),i.emplaceBack(a+t,a+t+3,a+t+2),i.emplaceBack(o+t,o+t+3,o+t+1),i.emplaceBack(o+t,o+t+2,o+t+3);const l=e.length,c=l+2*(n+1);for(const t of[0,1])for(let i=0;i<=n;i++)for(const n of[0,1])e.emplaceBack(t*Jo,i*r,n);for(let t=0;t<2*n;t+=2)i.emplaceBack(l+t,l+t+1,l+t+3),i.emplaceBack(l+t,l+t+3,l+t+2),i.emplaceBack(c+t,c+t+3,c+t+1),i.emplaceBack(c+t,c+t+2,c+t+3);return this._mesh={indexBuffer:t.createIndexBuffer(i),vertexBuffer:t.createVertexBuffer(e,gg.members),segments:xo.simpleSegment(0,0,e.length,i.length)},this._mesh}getMeshFrameDelta(t){return 2*Math.PI*eh/Math.pow(2,t)/5}getMinTileElevationForLngLatZoom(t,e){var i;const{tileID:n}=this._getOverscaledTileIDFromLngLatZoom(t,e);return null!==(i=this.getMinMaxElevation(n).minElevation)&&void 0!==i?i:0}getMinMaxElevation(t){const e=this.getTerrainData(t).tile,i={minElevation:null,maxElevation:null};return e&&e.dem&&(i.minElevation=e.dem.min*this.exaggeration,i.maxElevation=e.dem.max*this.exaggeration),i}_getOverscaledTileIDFromLngLatZoom(t,e){const i=hh.fromLngLat(t.wrap()),n=(1<<e)*Jo,r=i.x*n,s=i.y*n,o=Math.floor(r/Jo),a=Math.floor(s/Jo);return{tileID:new yh(e,0,e,o,a),mercatorX:r,mercatorY:s}}_allowMercatorOverflow(t,e){const i=t.x<this.painter.width/2;let n=ch(e);const r=this.painter.transform.center.lng;return i&&Math.sign(n)>0&&Math.sign(r)<0||!i&&Math.sign(n)<0&&Math.sign(r)>0?(n=360*Math.sign(r)+n,oh(n)):e}}class xg{constructor(t,e,i){this._context=t,this._size=e,this._tileSize=i,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const e=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),i=new Nu(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return i.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),e.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),e.colorAttachment.set(i.texture),{id:t,fbo:e,texture:i,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((e=>t.id!==e)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const t of this._recentlyUsed)if(!this._objects[t].inUse)return this._objects[t];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some((t=>!t.inUse))}}const vg={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class bg{constructor(t,e){this.painter=t,this.terrain=e,this.pool=new xg(t.context,30,e.sourceCache.tileSize*e.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,e){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter((i=>!t._layers[i].isHidden(e))),this._coordsDescendingInv={};for(const e in t.sourceCaches){this._coordsDescendingInv[e]={};const i=t.sourceCaches[e].getVisibleCoordinates();for(const t of i){const i=this.terrain.sourceCache.getTerrainCoords(t);for(const t in i)this._coordsDescendingInv[e][t]||(this._coordsDescendingInv[e][t]=[]),this._coordsDescendingInv[e][t].push(i[t])}}this._coordsDescendingInvStr={};for(const e of t._order){const i=t._layers[e],n=i.source;if(vg[i.type]&&!this._coordsDescendingInvStr[n]){this._coordsDescendingInvStr[n]={};for(const t in this._coordsDescendingInv[n])this._coordsDescendingInvStr[n][t]=this._coordsDescendingInv[n][t].map((t=>t.key)).sort().join()}}for(const t of this._renderableTiles)for(const e in this._coordsDescendingInvStr){const i=this._coordsDescendingInvStr[e][t.tileID.key];i&&i!==t.rttCoords[e]&&(t.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const e=t.type,i=this.painter,n=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(vg[e]&&(this._prevType&&vg[this._prevType]||this._stacks.push([]),this._prevType=e,this._stacks[this._stacks.length-1].push(t.id),!n))return!0;if(vg[this._prevType]||vg[e]&&n){this._prevType=e;const t=this._stacks.length-1,n=this._stacks[t]||[];for(const e of this._renderableTiles){if(this.pool.isFull()&&(tm(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(e),e.rtt[t]){const i=this.pool.getObjectForId(e.rtt[t].id);if(i.stamp===e.rtt[t].stamp){this.pool.useObject(i);continue}}const r=this.pool.getOrCreateFreeObject();this.pool.useObject(r),this.pool.stampObject(r),e.rtt[t]={id:r.id,stamp:r.stamp},i.context.bindFramebuffer.set(r.fbo.framebuffer),i.context.clear({color:ce.transparent,stencil:0}),i.currentStencilSource=void 0;for(let t=0;t<n.length;t++){const s=i.style._layers[n[t]],o=s.source?this._coordsDescendingInv[s.source][e.tileID.key]:[e.tileID];i.context.viewport.set([0,0,r.fbo.width,r.fbo.height]),i._renderTileClippingMasks(s,o),i.renderLayer(i,i.style.sourceCaches[s.source],s,o),s.source&&(e.rttCoords[s.source]=this._coordsDescendingInvStr[s.source][e.tileID.key])}}return tm(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),vg[e]}return!1}}const wg=t,kg={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:B.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Sg=t=>{t.touchstart=t.dragStart,t.touchmoveWindow=t.dragMove,t.touchend=t.dragEnd},Tg={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ag{constructor(t,e,i=!1){this.mousedown=t=>{this.startMouse(_({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),O.mousePos(this.element,t)),O.addEventListener(window,"mousemove",this.mousemove),O.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=t=>{this.moveMouse(t,O.mousePos(this.element,t))},this.mouseup=t=>{this.mouseRotate.dragEnd(t),this.mousePitch&&this.mousePitch.dragEnd(t),this.offTemp()},this.touchstart=t=>{1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=O.touchPos(this.element,t.targetTouches)[0],this.startTouch(t,this._startPos),O.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),O.addEventListener(window,"touchend",this.touchend))},this.touchmove=t=>{1!==t.targetTouches.length?this.reset():(this._lastPos=O.touchPos(this.element,t.targetTouches)[0],this.moveTouch(t,this._lastPos))},this.touchend=t=>{0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const n=t.dragRotate._mouseRotate.getClickTolerance(),r=t.dragRotate._mousePitch.getClickTolerance();this.element=e,this.mouseRotate=zm({clickTolerance:n,enable:!0}),this.touchRotate=(({enable:t,clickTolerance:e,bearingDegreesPerPixelMoved:i=.8})=>{const n=new Im;return new Mm({clickTolerance:e,move:(t,e)=>({bearingDelta:(e.x-t.x)*i}),moveStateManager:n,enable:t,assignEvents:Sg})})({clickTolerance:n,enable:!0}),this.map=t,i&&(this.mousePitch=Pm({clickTolerance:r,enable:!0}),this.touchPitch=(({enable:t,clickTolerance:e,pitchDegreesPerPixelMoved:i=-.5})=>{const n=new Im;return new Mm({clickTolerance:e,move:(t,e)=>({pitchDelta:(e.y-t.y)*i}),moveStateManager:n,enable:t,assignEvents:Sg})})({clickTolerance:r,enable:!0})),O.addEventListener(e,"mousedown",this.mousedown),O.addEventListener(e,"touchstart",this.touchstart,{passive:!1}),O.addEventListener(e,"touchcancel",this.reset)}startMouse(t,e){this.mouseRotate.dragStart(t,e),this.mousePitch&&this.mousePitch.dragStart(t,e),O.disableDrag()}startTouch(t,e){this.touchRotate.dragStart(t,e),this.touchPitch&&this.touchPitch.dragStart(t,e),O.disableDrag()}moveMouse(t,e){const i=this.map,{bearingDelta:n}=this.mouseRotate.dragMove(t,e)||{};if(n&&i.setBearing(i.getBearing()+n),this.mousePitch){const{pitchDelta:n}=this.mousePitch.dragMove(t,e)||{};n&&i.setPitch(i.getPitch()+n)}}moveTouch(t,e){const i=this.map,{bearingDelta:n}=this.touchRotate.dragMove(t,e)||{};if(n&&i.setBearing(i.getBearing()+n),this.touchPitch){const{pitchDelta:n}=this.touchPitch.dragMove(t,e)||{};n&&i.setPitch(i.getPitch()+n)}}off(){const t=this.element;O.removeEventListener(t,"mousedown",this.mousedown),O.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),O.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),O.removeEventListener(window,"touchend",this.touchend),O.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){O.enableDrag(),O.removeEventListener(window,"mousemove",this.mousemove),O.removeEventListener(window,"mouseup",this.mouseup),O.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),O.removeEventListener(window,"touchend",this.touchend)}}let Mg;function Cg(t,e,i){if(t=new ih(t.lng,t.lat),e){const n=new ih(t.lng-360,t.lat),r=new ih(t.lng+360,t.lat),s=i.locationPoint(t).distSqr(e);i.locationPoint(n).distSqr(e)<s?t=n:i.locationPoint(r).distSqr(e)<s&&(t=r)}for(;Math.abs(t.lng-i.center.lng)>180;){const e=i.locationPoint(t);if(e.x>=0&&e.y>=0&&e.x<=i.width&&e.y<=i.height)break;t.lng>i.center.lng?t.lng-=360:t.lng+=360}return t}const Eg={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ig(t,e,i){const n=t.classList;for(const t in Eg)n.remove(`maplibregl-${i}-anchor-${t}`);n.add(`maplibregl-${i}-anchor-${e}`)}class Dg extends at{constructor(t){if(super(),this._onKeyPress=t=>{const e=t.code,i=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==i&&13!==i||this.togglePopup()},this._onMapClick=t=>{const e=t.originalEvent.target,i=this._element;this._popup&&(e===i||i.contains(e))&&this.togglePopup()},this._update=t=>{if(!this._map)return;const e=this._map.loaded()&&!this._map.isMoving();("terrain"===(null==t?void 0:t.type)||"render"===(null==t?void 0:t.type)&&!e)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=Cg(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let i="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?i=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(i=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let n="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?n="rotateX(0deg)":"map"===this._pitchAlignment&&(n=`rotateX(${this._map.getPitch()}deg)`),t&&"moveend"!==t.type||(this._pos=this._pos.round()),O.setTransform(this._element,`${Eg[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${n} ${i}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout((()=>{const t=this._map.unproject(this._pos),e=40075016.686*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=t.distanceTo(this._lngLat)>20*e?"0.2":"1.0",this._opacityTimeout=null}),100))},this._onMove=t=>{if(!this._isDragging){const e=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=e}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new st("dragstart"))),this.fire(new st("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new st("dragend")),this._state="inactive"},this._addDragHandler=t=>{this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&"auto"!==t.pitchAlignment?t.pitchAlignment:this._rotationAlignment,t&&t.element)this._element=t.element,this._offset=s.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=O.create("div"),this._element.setAttribute("aria-label","Map marker");const e=O.createNS("http://www.w3.org/2000/svg","svg"),i=41,n=27;e.setAttributeNS(null,"display","block"),e.setAttributeNS(null,"height",`${i}px`),e.setAttributeNS(null,"width",`${n}px`),e.setAttributeNS(null,"viewBox",`0 0 ${n} ${i}`);const r=O.createNS("http://www.w3.org/2000/svg","g");r.setAttributeNS(null,"stroke","none"),r.setAttributeNS(null,"stroke-width","1"),r.setAttributeNS(null,"fill","none"),r.setAttributeNS(null,"fill-rule","evenodd");const o=O.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"fill-rule","nonzero");const a=O.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"transform","translate(3.0, 29.0)"),a.setAttributeNS(null,"fill","#000000");const l=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const t of l){const e=O.createNS("http://www.w3.org/2000/svg","ellipse");e.setAttributeNS(null,"opacity","0.04"),e.setAttributeNS(null,"cx","10.5"),e.setAttributeNS(null,"cy","5.80029008"),e.setAttributeNS(null,"rx",t.rx),e.setAttributeNS(null,"ry",t.ry),a.appendChild(e)}const c=O.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"fill",this._color);const u=O.createNS("http://www.w3.org/2000/svg","path");u.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),c.appendChild(u);const h=O.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"opacity","0.25"),h.setAttributeNS(null,"fill","#000000");const d=O.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),h.appendChild(d);const p=O.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"transform","translate(6.0, 7.0)"),p.setAttributeNS(null,"fill","#FFFFFF");const f=O.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(8.0, 8.0)");const m=O.createNS("http://www.w3.org/2000/svg","circle");m.setAttributeNS(null,"fill","#000000"),m.setAttributeNS(null,"opacity","0.25"),m.setAttributeNS(null,"cx","5.5"),m.setAttributeNS(null,"cy","5.5"),m.setAttributeNS(null,"r","5.4999962");const g=O.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#FFFFFF"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962"),f.appendChild(m),f.appendChild(g),o.appendChild(a),o.appendChild(c),o.appendChild(h),o.appendChild(p),o.appendChild(f),e.appendChild(o),e.setAttributeNS(null,"height",i*this._scale+"px"),e.setAttributeNS(null,"width",n*this._scale+"px"),this._element.appendChild(e),this._offset=s.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(t=>{t.preventDefault()})),this._element.addEventListener("mousedown",(t=>{t.preventDefault()})),Ig(this._element,this._anchor,"marker"),t&&t.className)for(const e of t.className.split(" "))this._element.classList.add(e);this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),O.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=ih.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,i=13.5,n=Math.abs(i)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[n,-1*(e-i+n)],"bottom-right":[-n,-1*(e-i+n)],left:[i,-1*(e-i)],right:[-i,-1*(e-i)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(t){return this._offset=s.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const zg={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Pg=0,Lg=!1;const Fg={maxWidth:100,unit:"metric"};function Rg(t,e,i){const n=i&&i.maxWidth||100,r=t._container.clientHeight/2,s=t.unproject([0,r]),o=t.unproject([n,r]),a=s.distanceTo(o);if(i&&"imperial"===i.unit){const i=3.2808*a;i>5280?Og(e,n,i/5280,t._getUIString("ScaleControl.Miles")):Og(e,n,i,t._getUIString("ScaleControl.Feet"))}else i&&"nautical"===i.unit?Og(e,n,a/1852,t._getUIString("ScaleControl.NauticalMiles")):a>=1e3?Og(e,n,a/1e3,t._getUIString("ScaleControl.Kilometers")):Og(e,n,a,t._getUIString("ScaleControl.Meters"))}function Og(t,e,i,n){const r=function(t){const e=Math.pow(10,`${Math.floor(t)}`.length-1);let i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(i),e*i}(i);t.style.width=e*(r/i)+"px",t.innerHTML=`${r}&nbsp;${n}`}const Bg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Vg=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ng(t){if(t){if("number"==typeof t){const e=Math.round(Math.abs(t)/Math.SQRT2);return{center:new s(0,0),top:new s(0,t),"top-left":new s(e,e),"top-right":new s(-e,e),bottom:new s(0,-t),"bottom-left":new s(e,-e),"bottom-right":new s(-e,-e),left:new s(t,0),right:new s(-t,0)}}if(t instanceof s||Array.isArray(t)){const e=s.convert(t);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:s.convert(t.center||[0,0]),top:s.convert(t.top||[0,0]),"top-left":s.convert(t["top-left"]||[0,0]),"top-right":s.convert(t["top-right"]||[0,0]),bottom:s.convert(t.bottom||[0,0]),"bottom-left":s.convert(t["bottom-left"]||[0,0]),"bottom-right":s.convert(t["bottom-right"]||[0,0]),left:s.convert(t.left||[0,0]),right:s.convert(t.right||[0,0])}}return Ng(new s(0,0))}const qg={extend:(t,...e)=>_(t,...e),run(t){t()},logToElement(t,e=!1,i="log"){const n=window.document.getElementById(i);n&&(e&&(n.innerHTML=""),n.innerHTML+=`<br>${t}`)}},jg=t;class $g{static get version(){return jg}static get workerCount(){return $h.workerCount}static set workerCount(t){$h.workerCount=t}static get maxParallelImageRequests(){return B.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(t){B.MAX_PARALLEL_IMAGE_REQUESTS=t}static get workerUrl(){return B.WORKER_URL}static set workerUrl(t){B.WORKER_URL=t}static addProtocol(t,e){B.REGISTERED_PROTOCOLS[t]=e}static removeProtocol(t){delete B.REGISTERED_PROTOCOLS[t]}}return $g.Map=class extends rg{constructor(t){if(fg.mark(lg.create),null!=(t=_({},kg,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new sm(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),{bearingSnap:t.bearingSnap}),this._cooperativeGesturesOnWheel=t=>{this._onCooperativeGesture(t,t[this._metaKey],1)},this._contextLost=t=>{t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new st("webglcontextlost",{originalEvent:t}))},this._contextRestored=t=>{this._setupPainter(),this.resize(),this._update(),this.fire(new st("webglcontextrestored",{originalEvent:t}))},this._onMapScroll=t=>{if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=t.interactive,this._cooperativeGestures=t.cooperativeGestures,this._metaKey=0===navigator.platform.indexOf("Mac")?"metaKey":"ctrlKey",this._maxTileCacheSize=t.maxTileCacheSize,this._maxTileCacheZoomLevels=t.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=t.collectResourceTiming,this._renderTaskQueue=new ag,this._controls=[],this._mapId=v(),this._locale=_({},mg,t.locale),this._clickTolerance=t.clickTolerance,this._overridePixelRatio=t.pixelRatio,this._maxCanvasSize=t.maxCanvasSize,this.transformCameraUpdate=t.transformCameraUpdate,this._imageQueueHandle=Q.addThrottleControl((()=>this.isMoving())),this._requestManager=new et(t.transformRequest),"string"==typeof t.container){if(this._container=document.getElementById(t.container),!this._container)throw new Error(`Container '${t.container}' not found.`)}else{if(!(t.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(t.maxBounds&&this.setMaxBounds(t.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),"undefined"!=typeof window){addEventListener("online",this._onWindowOnline,!1);let t=!1;const e=om((t=>{this._trackResize&&!this._removed&&this.resize(t)._update()}),50);this._resizeObserver=new ResizeObserver((i=>{t?e(i):t=!0})),this._resizeObserver.observe(this._container)}this.handlers=new ng(this,t),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=t.hash&&new am("string"==typeof t.hash&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,_({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,this._validateStyle=t.validateStyle,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new sg({customAttribution:t.customAttribution})),t.maplibreLogo&&this.addControl(new og,t.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(t=>{this._update("style"===t.dataType),this.fire(new st(`${t.dataType}data`,t))})),this.on("dataloading",(t=>{this.fire(new st(`${t.dataType}dataloading`,t))})),this.on("dataabort",(t=>{this.fire(new st("sourcedataabort",t))}))}_getMapId(){return this._mapId}addControl(t,e){if(void 0===e&&(e=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new ot(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=t.onAdd(this);this._controls.push(t);const n=this._controlPositions[e];return-1!==e.indexOf("bottom")?n.insertBefore(i,n.firstChild):n.appendChild(i),this}removeControl(t){if(!t||!t.onRemove)return this.fire(new ot(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(t);return e>-1&&this._controls.splice(e,1),t.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}calculateCameraOptionsFromTo(t,e,i,n){return null==n&&this.terrain&&(n=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(t,e,i,n)}resize(t){var e;const i=this._containerDimensions(),n=i[0],r=i[1],s=this._getClampedPixelRatio(n,r);if(this._resizeCanvas(n,r,s),this.painter.resize(n,r,s),this.painter.overLimit()){const t=this.painter.context.gl;this._maxCanvasSize=[t.drawingBufferWidth,t.drawingBufferHeight];const e=this._getClampedPixelRatio(n,r);this._resizeCanvas(n,r,e),this.painter.resize(n,r,e)}this.transform.resize(n,r),null===(e=this._requestedCameraState)||void 0===e||e.resize(n,r);const o=!this._moving;return o&&(this.stop(),this.fire(new st("movestart",t)).fire(new st("move",t))),this.fire(new st("resize",t)),o&&this.fire(new st("moveend",t)),this}_getClampedPixelRatio(t,e){const{0:i,1:n}=this._maxCanvasSize,r=this.getPixelRatio(),s=t*r,o=e*r;return Math.min(s>i?i/s:1,o>n?n/o:1)*r}getPixelRatio(){var t;return null!==(t=this._overridePixelRatio)&&void 0!==t?t:devicePixelRatio}setPixelRatio(t){this._overridePixelRatio=t,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(t){return this.transform.setMaxBounds(nh.convert(t)),this._update()}setMinZoom(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=null==t?60:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(t){return this._cooperativeGestures=t,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(t){return this.transform.locationPoint(ih.convert(t),this.style&&this.terrain)}unproject(t){return this.transform.pointLocation(s.convert(t),this.terrain)}isMoving(){var t;return this._moving||(null===(t=this.handlers)||void 0===t?void 0:t.isMoving())}isZooming(){var t;return this._zooming||(null===(t=this.handlers)||void 0===t?void 0:t.isZooming())}isRotating(){var t;return this._rotating||(null===(t=this.handlers)||void 0===t?void 0:t.isRotating())}_createDelegatedListener(t,e,i){if("mouseenter"===t||"mouseover"===t){let n=!1;const r=r=>{const s=this.getLayer(e)?this.queryRenderedFeatures(r.point,{layers:[e]}):[];s.length?n||(n=!0,i.call(this,new gm(t,this,r.originalEvent,{features:s}))):n=!1};return{layer:e,listener:i,delegates:{mousemove:r,mouseout:()=>{n=!1}}}}if("mouseleave"===t||"mouseout"===t){let n=!1;const r=r=>{(this.getLayer(e)?this.queryRenderedFeatures(r.point,{layers:[e]}):[]).length?n=!0:n&&(n=!1,i.call(this,new gm(t,this,r.originalEvent)))},s=e=>{n&&(n=!1,i.call(this,new gm(t,this,e.originalEvent)))};return{layer:e,listener:i,delegates:{mousemove:r,mouseout:s}}}{const n=t=>{const n=this.getLayer(e)?this.queryRenderedFeatures(t.point,{layers:[e]}):[];n.length&&(t.features=n,i.call(this,t),delete t.features)};return{layer:e,listener:i,delegates:{[t]:n}}}}on(t,e,i){if(void 0===i)return super.on(t,e);const n=this._createDelegatedListener(t,e,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(n);for(const t in n.delegates)this.on(t,n.delegates[t]);return this}once(t,e,i){if(void 0===i)return super.once(t,e);const n=this._createDelegatedListener(t,e,i);for(const t in n.delegates)this.once(t,n.delegates[t]);return this}off(t,e,i){return void 0===i?super.off(t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&(n=>{const r=this._delegatedListeners[t];for(let t=0;t<r.length;t++){const n=r[t];if(n.layer===e&&n.listener===i){for(const t in n.delegates)this.off(t,n.delegates[t]);return r.splice(t,1),this}}})(),this)}queryRenderedFeatures(t,e){if(!this.style)return[];let i;const n=t instanceof s||Array.isArray(t),r=n?t:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(n?{}:t)||{},r instanceof s||"number"==typeof r[0])i=[s.convert(r)];else{const t=s.convert(r[0]),e=s.convert(r[1]);i=[t,new s(e.x,t.y),e,new s(t.x,e.y),t]}return this.style.queryRenderedFeatures(i,e,this.transform)}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}setStyle(t,e){return!1!==(e=_({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&t?(this._diffStyle(t,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(t,e))}setTransformRequest(t){return this._requestManager.setTransformRequest(t),this}_getUIString(t){const e=this._locale[t];if(null==e)throw new Error(`Missing UI string '${t}'`);return e}_updateStyle(t,e){if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(t,e)));const i=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!t)),t?(this.style=new ep(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t,e,i):this.style.loadJSON(t,e,i),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ep(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(t,e){if("string"==typeof t){const i=this._requestManager.transformRequest(t,tt.Style);U(i,((t,i)=>{t?this.fire(new ot(t)):i&&this._updateDiff(i,e)}))}else"object"==typeof t&&this._updateDiff(t,e)}_updateDiff(t,e){try{this.style.setState(t,e)&&this._update(!0)}catch(i){A(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(t,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():A("There is no style added to the map.")}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(t){const e=this.style&&this.style.sourceCaches[t];if(void 0!==e)return e.loaded();this.fire(new ot(new Error(`There is no source with ID '${t}'`)))}setTerrain(t){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),t){const e=this.style.sourceCaches[t.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${t.source}`);for(const e in this.style._layers){const i=this.style._layers[e];"hillshade"===i.type&&i.source===t.source&&A("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new yg(this.painter,e,t),this.painter.renderToTexture=new bg(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=e=>{"style"===e.dataType?this.terrain.sourceCache.freeRtt():"source"===e.dataType&&e.tile&&(e.sourceId!==t.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(e.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new st("terrain",{terrain:t})),this}getTerrain(){var t,e;return null!==(e=null===(t=this.terrain)||void 0===t?void 0:t.options)&&void 0!==e?e:null}areTilesLoaded(){const t=this.style&&this.style.sourceCaches;for(const e in t){const i=t[e]._tiles;for(const t in i){const e=i[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0}addSourceType(t,e,i){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,i)}removeSource(t){return this.style.removeSource(t),this._update(!0)}getSource(t){return this.style.getSource(t)}addImage(t,e,i={}){const{pixelRatio:n=1,sdf:r=!1,stretchX:s,stretchY:o,content:a}=i;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||z(e))){if(void 0===e.width||void 0===e.height)return this.fire(new ot(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:i,height:l,data:c}=e,u=e;return this.style.addImage(t,{data:new Ga({width:i,height:l},new Uint8Array(c)),pixelRatio:n,stretchX:s,stretchY:o,content:a,sdf:r,version:0,userImage:u}),u.onAdd&&u.onAdd(this,t),this}}{const{width:i,height:l,data:c}=R.getImageData(e);this.style.addImage(t,{data:new Ga({width:i,height:l},c),pixelRatio:n,stretchX:s,stretchY:o,content:a,sdf:r,version:0})}}updateImage(t,e){const i=this.style.getImage(t);if(!i)return this.fire(new ot(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const n=e instanceof HTMLImageElement||z(e)?R.getImageData(e):e,{width:r,height:s,data:o}=n;if(void 0===r||void 0===s)return this.fire(new ot(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(r!==i.data.width||s!==i.data.height)return this.fire(new ot(new Error("The width and height of the updated image must be that same as the previous version of the image")));const a=!(e instanceof HTMLImageElement||z(e));return i.data.replace(o,a),this.style.updateImage(t,i),this}getImage(t){return this.style.getImage(t)}hasImage(t){return t?!!this.style.getImage(t):(this.fire(new ot(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(t,e){Q.getImage(this._requestManager.transformRequest(t,tt.Image),e)}listImages(){return this.style.listImages()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}getLayer(t){return this.style.getLayer(t)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(t,e,i){return this.style.setLayerZoomRange(t,e,i),this._update(!0)}setFilter(t,e,i={}){return this.style.setFilter(t,e,i),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,i,n={}){return this.style.setPaintProperty(t,e,i,n),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,i,n={}){return this.style.setLayoutProperty(t,e,i,n),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setGlyphs(t,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(t,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(t,e,i={}){return this._lazyInitEmptyStyle(),this.style.addSprite(t,e,i,(t=>{t||this._update(!0)})),this}removeSprite(t){return this._lazyInitEmptyStyle(),this.style.removeSprite(t),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(t,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(t,e,(t=>{t||this._update(!0)})),this}setLight(t,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]}_setupContainer(){const t=this._container;t.classList.add("maplibregl-map");const e=this._canvasContainer=O.create("div","maplibregl-canvas-container",t);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=O.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const i=this._containerDimensions(),n=this._getClampedPixelRatio(i[0],i[1]);this._resizeCanvas(i[0],i[1],n);const r=this._controlContainer=O.create("div","maplibregl-control-container",t),s=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((t=>{s[t]=O.create("div",`maplibregl-ctrl-${t} `,r)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=O.create("div","maplibregl-cooperative-gesture-screen",this._container);let t="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";0===navigator.platform.indexOf("Mac")&&(t="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`\n            <div class="maplibregl-desktop-message">${t}</div>\n            <div class="maplibregl-mobile-message">${"boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>\n        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){O.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(t,e,i){this._canvas.width=Math.floor(i*t),this._canvas.height=Math.floor(i*e),this._canvas.style.width=`${t}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const t={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let e=null;this._canvas.addEventListener("webglcontextcreationerror",(i=>{e={requestedAttributes:t},i&&(e.statusMessage=i.statusMessage,e.type=i.type)}),{once:!0});const i=this._canvas.getContext("webgl2",t)||this._canvas.getContext("webgl",t);if(!i){const t="Failed to initialize WebGL";throw e?(e.message=t,new Error(JSON.stringify(e))):new Error(t)}this.painter=new em(i,this.transform),G.testSupport(i)}_onCooperativeGesture(t,e,i){return!e&&i<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout((()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")}),100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_render(t){const e=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(t),this._removed)return;let i=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const t=this.transform.zoom,n=R.now();this.style.zoomHistory.update(t,n);const r=new Hr(t,{now:n,fadeDuration:e,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),s=r.crossFadingFactor();1===s&&s===this._crossFadingFactor||(i=!0,this._crossFadingFactor=s),this.style.update(r)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,e,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:e,showPadding:this.showPadding}),this.fire(new st("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,fg.mark(lg.load),this.fire(new st("load"))),this.style&&(this.style.hasTransitions()||i)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const n=this._sourcesDirty||this._styleDirty||this._placementDirty;return n||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new st("idle")),!this._loaded||this._fullyLoaded||n||(this._fullyLoaded=!0,fg.mark(lg.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var t;this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&removeEventListener("online",this._onWindowOnline,!1),Q.removeThrottleControl(this._imageQueueHandle),null===(t=this._resizeObserver)||void 0===t||t.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),O.remove(this._canvasContainer),O.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),fg.clearMetrics(),this._removed=!0,this.fire(new st("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=R.frame((t=>{fg.frame(t),this._frame=null,this._render(t)})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}get version(){return wg}getCameraTargetElevation(){return this.transform.elevation}},$g.NavigationControl=class{constructor(t){this._updateZoomButtons=()=>{const t=this._map.getZoom(),e=t===this._map.getMaxZoom(),i=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())},this._rotateCompassArrow=()=>{const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,e)=>{const i=this._map._getUIString(`NavigationControl.${e}`);t.title=i,t.setAttribute("aria-label",i)},this.options=_({},Tg,t),this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),O.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),O.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=O.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ag(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){O.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(t,e){const i=O.create("button",t,this._container);return i.type="button",i.addEventListener("click",e),i}},$g.GeolocateControl=class extends at{constructor(t){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new st("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new st("geolocate",t)),this._finish()}},this._updateCamera=t=>{const e=new ih(t.coords.longitude,t.coords.latitude),i=t.coords.accuracy,n=_({bearing:this._map.getBearing()},this.options.fitBoundsOptions),r=nh.fromLngLat(e,i);this._map.fitBounds(r,n,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const e=new ih(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(e).addTo(this._map),this._userLocationDotMarker.setLngLat(e).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&Lg)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new st("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=t=>{if(this._map){if(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=O.create("button","maplibregl-ctrl-geolocate",this._container),O.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){A("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=O.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Dg({element:this._dotElement}),this._circleElement=O.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Dg({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new st("trackuserlocationend")))}))}},this.options=_({},zg,t)}onAdd(t){return this._map=t,this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(t,e=!1){void 0===Mg||e?void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((e=>{Mg="denied"!==e.state,t(Mg)})).catch((()=>{Mg=!!window.navigator.geolocation,t(Mg)})):(Mg=!!window.navigator.geolocation,t(Mg)):t(Mg)}(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),O.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Pg=0,Lg=!1}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),i=t.coords;return e&&(i.longitude<e.getWest()||i.longitude>e.getEast()||i.latitude<e.getSouth()||i.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const t=this._map.getBounds(),e=t.getSouthEast(),i=t.getNorthEast(),n=e.distanceTo(i),r=Math.ceil(this._accuracy/(n/this._map._container.clientHeight)*2);this._circleElement.style.width=`${r}px`,this._circleElement.style.height=`${r}px`}trigger(){if(!this._setup)return A("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new st("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Pg--,Lg=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new st("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new st("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let t;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Pg++,Pg>1?(t={maximumAge:6e5,timeout:0},Lg=!0):(t=this.options.positionOptions,Lg=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,t)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},$g.AttributionControl=sg,$g.LogoControl=og,$g.ScaleControl=class{constructor(t){this._onMove=()=>{Rg(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,Rg(this._map,this._container,this.options)},this.options=_({},Fg,t)}getDefaultPosition(){return"bottom-left"}onAdd(t){return this._map=t,this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){O.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},$g.FullscreenControl=class extends at{constructor(t={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,t&&t.container&&(t.container instanceof HTMLElement?this._container=t.container:A("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){O.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const t=this._fullscreenButton=O.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);O.create("span","maplibregl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new st("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new st("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},$g.TerrainControl=class{constructor(t){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=t}onAdd(t){return this._map=t,this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=O.create("button","maplibregl-ctrl-terrain",this._container),O.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){O.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},$g.Popup=class extends at{constructor(t){super(),this.remove=()=>(this._content&&O.remove(this._content),this._container&&(O.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new st("close")),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=O.create("div","maplibregl-popup",this._map.getContainer()),this._tip=O.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const t of this.options.className.split(" "))this._container.classList.add(t);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Cg(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!t)return;const e=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);let i=this.options.anchor;const n=Ng(this.options.offset);if(!i){const t=this._container.offsetWidth,r=this._container.offsetHeight;let s;s=e.y+n.bottom.y<r?["top"]:e.y>this._map.transform.height-r?["bottom"]:[],e.x<t/2?s.push("left"):e.x>this._map.transform.width-t/2&&s.push("right"),i=0===s.length?"bottom":s.join("-")}const r=e.add(n[i]).round();O.setTransform(this._container,`${Eg[i]} translate(${r.x}px,${r.y}px)`),Ig(this._container,i,"popup")},this._onClose=()=>{this.remove()},this.options=_(Object.create(Bg),t)}addTo(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new st("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=ih.convert(t),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(t){return this.setDOMContent(document.createTextNode(t))}setHTML(t){const e=document.createDocumentFragment(),i=document.createElement("body");let n;for(i.innerHTML=t;n=i.firstChild,n;)e.appendChild(n);return this.setDOMContent(e)}getMaxWidth(){var t;return null===(t=this._container)||void 0===t?void 0:t.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=O.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(t),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(t){this._container&&this._container.classList.add(t)}removeClassName(t){this._container&&this._container.classList.remove(t)}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){if(this._container)return this._container.classList.toggle(t)}_createCloseButton(){this.options.closeButton&&(this._closeButton=O.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(Vg);t&&t.focus()}},$g.Marker=Dg,$g.Style=ep,$g.LngLat=ih,$g.LngLatBounds=nh,$g.Point=s,$g.MercatorCoordinate=hh,$g.Evented=at,$g.AJAXError=V,$g.config=B,$g.CanvasSource=Th,$g.GeoJSONSource=bh,$g.ImageSource=kh,$g.RasterDEMTileSource=vh,$g.RasterTileSource=fh,$g.VectorTileSource=ph,$g.VideoSource=Sh,$g.setRTLTextPlugin=function(t,e,i=!1){if(Nr===Rr||Nr===Or||Nr===Br)throw new Error("setRTLTextPlugin cannot be called multiple times.");qr=R.resolveURL(t),Nr=Rr,Vr=e,$r(),i||Wr()},$g.getRTLTextPluginStatus=Zr,$g.prewarm=function(){Wh().acquire(jh)},$g.clearPrewarmedResources=function(){const t=Zh;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(jh),Zh=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},qg.extend($g,{isSafari:D,getPerformanceMetrics:fg.getPerformanceMetrics}),$g}()},63641:function(t,e,i){"use strict";i.d(e,{R:function(){return a}});const n=Math.PI/180,r=180/Math.PI,s={};class o{constructor({size:t=256,antimeridian:e=!1}={}){if(this.size=t,this.expansion=!0===e?2:1,!s[this.size]){let t=this.size,e={Bc:[],Cc:[],zc:[],Ac:[]};s[this.size]=e;for(let i=0;i<30;i++)e.Bc.push(t/360),e.Cc.push(t/(2*Math.PI)),e.zc.push(t/2),e.Ac.push(t),t*=2}this.Bc=s[this.size].Bc,this.Cc=s[this.size].Cc,this.zc=s[this.size].zc,this.Ac=s[this.size].Ac}px(t,e){if(Number.isInteger(e)){let i=this.zc[e],r=Math.min(Math.max(Math.sin(n*t[1]),-.9999),.9999),s=Math.round(i+t[0]*this.Bc[e]),o=Math.round(i+.5*Math.log((1+r)/(1-r))*-this.Cc[e]);return s>this.Ac[e]*this.expansion&&(s=this.Ac[e]*this.expansion),o>this.Ac[e]&&(o=this.Ac[e]),[s,o]}{let i=this.size*Math.pow(2,e),r=i/2,s=i/360,o=i/(2*Math.PI),a=i,l=Math.min(Math.max(Math.sin(n*t[1]),-.9999),.9999),c=r+t[0]*s,u=r+.5*Math.log((1+l)/(1-l))*-o;return c>a*this.expansion&&(c=a*this.expansion),u>a&&(u=a),[c,u]}}ll(t,e){if(Number.isInteger(e)){let i=(t[1]-this.zc[e])/-this.Cc[e];return[(t[0]-this.zc[e])/this.Bc[e],r*(2*Math.atan(Math.exp(i))-.5*Math.PI)]}{let i=this.size*Math.pow(2,e),n=i/360,s=i/(2*Math.PI),o=i/2,a=(t[1]-o)/-s;return[(t[0]-o)/n,r*(2*Math.atan(Math.exp(a))-.5*Math.PI)]}}}function a(t,e,{minzoom:i=0,maxzoom:n=20,tileSize:r=256,allowFloat:s=!1,allowAntiMeridian:a=!1}={}){const l=new o({size:r,antimeridian:a}),c=n,u=l.px([t[0],t[1]],c),h=l.px([t[2],t[3]],c),d=h[0]-u[0],p=u[1]-h[1],f=u[0]+d/2,m=h[1]+p/2,g=function(t,e,i){const n=Math.min(t-Math.log(e[0])/Math.log(2),t-Math.log(e[1])/Math.log(2));return i?n:Math.floor(n)}(c,[d/e[0],p/e[1]],s);return{center:l.ll([f,m],c),zoom:Math.max(i,Math.min(n,g))}}},61131:function(t,e,i){"use strict";function n(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function r(t,e,i){void 0===i&&(i={});for(var r=0,s=t;r<s.length;r++){var o=s[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,i)}function s(t,e,i){if(void 0===i&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,i)}function o(t,e,i){return void 0===i&&(i={}),n({type:"MultiLineString",coordinates:t},e,i)}function a(t,e,i){return void 0===i&&(i={}),n({type:"MultiPolygon",coordinates:t},e,i)}i.d(e,{NU:function(){return o},g5:function(){return a},n1:function(){return r},wi:function(){return s}})},68518:function(t,e,i){"use strict";i.d(e,{$L:function(){return Wi},Bs:function(){return oe},E8:function(){return we},FN:function(){return ge},Hg:function(){return _t},ij:function(){return F},n:function(){return b},t1:function(){return ie},u5:function(){return Et}});var n=i(9006);class r{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,i,n){const r=e.listeners[n],s=e.duration;r.forEach((n=>n({chart:t,initial:e.initial,numSteps:s,currentStep:Math.min(i-e.start,s)})))}_refresh(){this._request||(this._running=!0,this._request=n.r.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(t=Date.now()){let e=0;this._charts.forEach(((i,n)=>{if(!i.running||!i.items.length)return;const r=i.items;let s,o=r.length-1,a=!1;for(;o>=0;--o)s=r[o],s._active?(s._total>i.duration&&(i.duration=s._total),s.tick(t),a=!0):(r[o]=r[r.length-1],r.pop());a&&(n.draw(),this._notify(n,i,t,"progress")),r.length||(i.running=!1,this._notify(n,i,t,"complete"),i.initial=!1),e+=r.length})),this._lastDate=t,0===e&&(this._running=!1)}_getAnims(t){const e=this._charts;let i=e.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,i)),i}listen(t,e,i){this._getAnims(t).listeners[e].push(i)}add(t,e){e&&e.length&&this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce(((t,e)=>Math.max(t,e._duration)),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!!(e&&e.running&&e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const i=e.items;let n=i.length-1;for(;n>=0;--n)i[n].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var s=new r;const o="transparent",a={boolean(t,e,i){return i>.5?e:t},color(t,e,i){const r=(0,n.c)(t||o),s=r.valid&&(0,n.c)(e||o);return s&&s.valid?s.mix(r,i).hexString():e},number(t,e,i){return t+(e-t)*i}};class l{constructor(t,e,i,r){const s=e[i];r=(0,n.a)([t.to,r,s,t.from]);const o=(0,n.a)([t.from,s,r]);this._active=!0,this._fn=t.fn||a[t.type||typeof o],this._easing=n.e[t.easing]||n.e.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=i,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(t,e,i){if(this._active){this._notify(!1);const r=this._target[this._prop],s=i-this._start,o=this._duration-s;this._start=i,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=s,this._loop=!!t.loop,this._to=(0,n.a)([t.to,e,r,t.from]),this._from=(0,n.a)([t.from,r,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,i=this._duration,n=this._prop,r=this._from,s=this._loop,o=this._to;let a;if(this._active=r!==o&&(s||e<i),!this._active)return this._target[n]=o,void this._notify(!0);e<0?this._target[n]=r:(a=e/i%2,a=s&&a>1?2-a:a,a=this._easing(Math.min(1,Math.max(0,a))),this._target[n]=this._fn(r,o,a))}wait(){const t=this._promises||(this._promises=[]);return new Promise(((e,i)=>{t.push({res:e,rej:i})}))}_notify(t){const e=t?"res":"rej",i=this._promises||[];for(let t=0;t<i.length;t++)i[t][e]()}}class c{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!(0,n.i)(t))return;const e=Object.keys(n.d.animation),i=this._properties;Object.getOwnPropertyNames(t).forEach((r=>{const s=t[r];if(!(0,n.i)(s))return;const o={};for(const t of e)o[t]=s[t];((0,n.b)(s.properties)&&s.properties||[r]).forEach((t=>{t!==r&&i.has(t)||i.set(t,o)}))}))}_animateOptions(t,e){const i=e.options,n=function(t,e){if(!e)return;let i=t.options;if(i)return i.$shared&&(t.options=i=Object.assign({},i,{$shared:!1,$animations:{}})),i;t.options=e}(t,i);if(!n)return[];const r=this._createAnimations(n,i);return i.$shared&&function(t,e){const i=[],n=Object.keys(e);for(let e=0;e<n.length;e++){const r=t[n[e]];r&&r.active()&&i.push(r.wait())}return Promise.all(i)}(t.options.$animations,i).then((()=>{t.options=i}),(()=>{})),r}_createAnimations(t,e){const i=this._properties,n=[],r=t.$animations||(t.$animations={}),s=Object.keys(e),o=Date.now();let a;for(a=s.length-1;a>=0;--a){const c=s[a];if("$"===c.charAt(0))continue;if("options"===c){n.push(...this._animateOptions(t,e));continue}const u=e[c];let h=r[c];const d=i.get(c);if(h){if(d&&h.active()){h.update(d,u,o);continue}h.cancel()}d&&d.duration?(r[c]=h=new l(d,t,c,u),n.push(h)):t[c]=u}return n}update(t,e){if(0===this._properties.size)return void Object.assign(t,e);const i=this._createAnimations(t,e);return i.length?(s.add(this._chart,i),!0):void 0}}function u(t,e){const i=t&&t.options||{},n=i.reverse,r=void 0===i.min?e:0,s=void 0===i.max?e:0;return{start:n?s:r,end:n?r:s}}function h(t,e){const i=[],n=t._getSortedDatasetMetas(e);let r,s;for(r=0,s=n.length;r<s;++r)i.push(n[r].index);return i}function d(t,e,i,r={}){const s=t.keys,o="single"===r.mode;let a,l,c,u;if(null!==e){for(a=0,l=s.length;a<l;++a){if(c=+s[a],c===i){if(r.all)continue;break}u=t.values[c],(0,n.g)(u)&&(o||0===e||(0,n.s)(e)===(0,n.s)(u))&&(e+=u)}return e}}function p(t,e){const i=t&&t.options.stacked;return i||void 0===i&&void 0!==e.stack}function f(t,e,i){const n=t[e]||(t[e]={});return n[i]||(n[i]={})}function m(t,e,i,n){for(const r of e.getMatchingVisibleMetas(n).reverse()){const e=t[r.index];if(i&&e>0||!i&&e<0)return r.index}return null}function g(t,e){const{chart:i,_cachedMeta:n}=t,r=i._stacks||(i._stacks={}),{iScale:s,vScale:o,index:a}=n,l=s.axis,c=o.axis,u=function(t,e,i){return`${t.id}.${e.id}.${i.stack||i.type}`}(s,o,n),h=e.length;let d;for(let t=0;t<h;++t){const i=e[t],{[l]:s,[c]:h}=i;d=(i._stacks||(i._stacks={}))[c]=f(r,u,s),d[a]=h,d._top=m(d,o,!0,n.type),d._bottom=m(d,o,!1,n.type),(d._visualValues||(d._visualValues={}))[a]=h}}function _(t,e){const i=t.scales;return Object.keys(i).filter((t=>i[t].axis===e)).shift()}function y(t,e){const i=t.controller.index,n=t.vScale&&t.vScale.axis;if(n){e=e||t._parsed;for(const t of e){const e=t._stacks;if(!e||void 0===e[n]||void 0===e[n][i])return;delete e[n][i],void 0!==e[n]._visualValues&&void 0!==e[n]._visualValues[i]&&delete e[n]._visualValues[i]}}}const x=t=>"reset"===t||"none"===t,v=(t,e)=>e?t:Object.assign({},t);class b{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=p(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&y(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,i=this.getDataset(),r=(t,e,i,n)=>"x"===t?e:"r"===t?n:i,s=e.xAxisID=(0,n.v)(i.xAxisID,_(t,"x")),o=e.yAxisID=(0,n.v)(i.yAxisID,_(t,"y")),a=e.rAxisID=(0,n.v)(i.rAxisID,_(t,"r")),l=e.indexAxis,c=e.iAxisID=r(l,s,o,a),u=e.vAxisID=r(l,o,s,a);e.xScale=this.getScaleForId(s),e.yScale=this.getScaleForId(o),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(c),e.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&(0,n.u)(this._data,this),t._stacked&&y(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),i=this._data;if((0,n.i)(e))this._data=function(t){const e=Object.keys(t),i=new Array(e.length);let n,r,s;for(n=0,r=e.length;n<r;++n)s=e[n],i[n]={x:s,y:t[s]};return i}(e);else if(i!==e){if(i){(0,n.u)(i,this);const t=this._cachedMeta;y(t),t._parsed=[]}e&&Object.isExtensible(e)&&(0,n.l)(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,i=this.getDataset();let n=!1;this._dataCheck();const r=e._stacked;e._stacked=p(e.vScale,e),e.stack!==i.stack&&(n=!0,y(e),e.stack=i.stack),this._resyncElements(t),(n||r!==e._stacked)&&g(this,e._parsed)}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:i,_data:r}=this,{iScale:s,_stacked:o}=i,a=s.axis;let l,c,u,h=0===t&&e===r.length||i._sorted,d=t>0&&i._parsed[t-1];if(!1===this._parsing)i._parsed=r,i._sorted=!0,u=r;else{u=(0,n.b)(r[t])?this.parseArrayData(i,r,t,e):(0,n.i)(r[t])?this.parseObjectData(i,r,t,e):this.parsePrimitiveData(i,r,t,e);const s=()=>null===c[a]||d&&c[a]<d[a];for(l=0;l<e;++l)i._parsed[l+t]=c=u[l],h&&(s()&&(h=!1),d=c);i._sorted=h}o&&g(this,u)}parsePrimitiveData(t,e,i,n){const{iScale:r,vScale:s}=t,o=r.axis,a=s.axis,l=r.getLabels(),c=r===s,u=new Array(n);let h,d,p;for(h=0,d=n;h<d;++h)p=h+i,u[h]={[o]:c||r.parse(l[p],p),[a]:s.parse(e[p],p)};return u}parseArrayData(t,e,i,n){const{xScale:r,yScale:s}=t,o=new Array(n);let a,l,c,u;for(a=0,l=n;a<l;++a)c=a+i,u=e[c],o[a]={x:r.parse(u[0],c),y:s.parse(u[1],c)};return o}parseObjectData(t,e,i,r){const{xScale:s,yScale:o}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(r);let u,h,d,p;for(u=0,h=r;u<h;++u)d=u+i,p=e[d],c[u]={x:s.parse((0,n.f)(p,a),d),y:o.parse((0,n.f)(p,l),d)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,i){const n=this.chart,r=this._cachedMeta,s=e[t.axis];return d({keys:h(n,!0),values:e._stacks[t.axis]._visualValues},s,r.index,{mode:i})}updateRangeFromParsed(t,e,i,n){const r=i[e.axis];let s=null===r?NaN:r;const o=n&&i._stacks[e.axis];n&&o&&(n.values=o,s=d(n,r,this._cachedMeta.index)),t.min=Math.min(t.min,s),t.max=Math.max(t.max,s)}getMinMax(t,e){const i=this._cachedMeta,r=i._parsed,s=i._sorted&&t===i.iScale,o=r.length,a=this._getOtherScale(t),l=((t,e,i)=>t&&!e.hidden&&e._stacked&&{keys:h(i,!0),values:null})(e,i,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:d}=function(t){const{min:e,max:i,minDefined:n,maxDefined:r}=t.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:r?i:Number.POSITIVE_INFINITY}}(a);let p,f;function m(){f=r[p];const e=f[a.axis];return!(0,n.g)(f[t.axis])||u>e||d<e}for(p=0;p<o&&(m()||(this.updateRangeFromParsed(c,t,f,l),!s));++p);if(s)for(p=o-1;p>=0;--p)if(!m()){this.updateRangeFromParsed(c,t,f,l);break}return c}getAllParsedValues(t){const e=this._cachedMeta._parsed,i=[];let r,s,o;for(r=0,s=e.length;r<s;++r)o=e[r][t.axis],(0,n.g)(o)&&i.push(o);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,i=e.iScale,n=e.vScale,r=this.getParsed(t);return{label:i?""+i.getLabelForValue(r[i.axis]):"",value:n?""+n.getLabelForValue(r[n.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=function(t){let e,i,r,s;return(0,n.i)(t)?(e=t.top,i=t.right,r=t.bottom,s=t.left):e=i=r=s=t,{top:e,right:i,bottom:r,left:s,disabled:!1===t}}((0,n.v)(this.options.clip,function(t,e,i){if(!1===i)return!1;const n=u(t,i),r=u(e,i);return{top:r.end,right:n.end,bottom:r.start,left:n.start}}(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,i=this._cachedMeta,n=i.data||[],r=e.chartArea,s=[],o=this._drawStart||0,a=this._drawCount||n.length-o,l=this.options.drawActiveElementsOnTop;let c;for(i.dataset&&i.dataset.draw(t,r,o,a),c=o;c<o+a;++c){const e=n[c];e.hidden||(e.active&&l?s.push(e):e.draw(t,r))}for(c=0;c<s.length;++c)s[c].draw(t,r)}getStyle(t,e){const i=e?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,e,i){const r=this.getDataset();let s;if(t>=0&&t<this._cachedMeta.data.length){const e=this._cachedMeta.data[t];s=e.$context||(e.$context=function(t,e,i){return(0,n.j)(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:i,index:e,mode:"default",type:"data"})}(this.getContext(),t,e)),s.parsed=this.getParsed(t),s.raw=r.data[t],s.index=s.dataIndex=t}else s=this.$context||(this.$context=function(t,e){return(0,n.j)(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),s.dataset=r,s.index=s.datasetIndex=this.index;return s.active=!!e,s.mode=i,s}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",i){const r="active"===e,s=this._cachedDataOpts,o=t+"-"+e,a=s[o],l=this.enableOptionSharing&&(0,n.h)(i);if(a)return v(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,t),h=r?[`${t}Hover`,"hover",t,""]:[t,""],d=c.getOptionScopes(this.getDataset(),u),p=Object.keys(n.d.elements[t]),f=c.resolveNamedOptions(d,p,(()=>this.getContext(i,r,e)),h);return f.$shared&&(f.$shared=l,s[o]=Object.freeze(v(f,l))),f}_resolveAnimations(t,e,i){const n=this.chart,r=this._cachedDataOpts,s=`animation-${e}`,o=r[s];if(o)return o;let a;if(!1!==n.options.animation){const n=this.chart.config,r=n.datasetAnimationScopeKeys(this._type,e),s=n.getOptionScopes(this.getDataset(),r);a=n.createResolver(s,this.getContext(t,i,e))}const l=new c(n,a&&a.animations);return a&&a._cacheable&&(r[s]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||x(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const i=this.resolveDataElementOptions(t,e),n=this._sharedOptions,r=this.getSharedOptions(i),s=this.includeOptions(e,r)||r!==n;return this.updateSharedOptions(r,e,i),{sharedOptions:r,includeOptions:s}}updateElement(t,e,i,n){x(n)?Object.assign(t,i):this._resolveAnimations(e,n).update(t,i)}updateSharedOptions(t,e,i){t&&!x(e)&&this._resolveAnimations(void 0,e).update(t,i)}_setStyle(t,e,i,n){t.active=n;const r=this.getStyle(e,n);this._resolveAnimations(e,i,n).update(t,{options:!n&&this.getSharedOptions(r)||r})}removeHoverStyle(t,e,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,e,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,i=this._cachedMeta.data;for(const[t,e,i]of this._syncList)this[t](e,i);this._syncList=[];const n=i.length,r=e.length,s=Math.min(r,n);s&&this.parse(0,s),r>n?this._insertElements(n,r-n,t):r<n&&this._removeElements(r,n-r)}_insertElements(t,e,i=!0){const n=this._cachedMeta,r=n.data,s=t+e;let o;const a=t=>{for(t.length+=e,o=t.length-1;o>=s;o--)t[o]=t[o-e]};for(a(r),o=t;o<s;++o)r[o]=new this.dataElementType;this._parsing&&a(n._parsed),this.parse(t,e),i&&this.updateElements(r,t,e,"reset")}updateElements(t,e,i,n){}_removeElements(t,e){const i=this._cachedMeta;if(this._parsing){const n=i._parsed.splice(t,e);i._stacked&&y(i,n)}i.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,i,n]=t;this[e](i,n)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function w(t){const e=t.iScale,i=function(t,e){if(!t._cache.$bar){const i=t.getMatchingVisibleMetas(e);let r=[];for(let e=0,n=i.length;e<n;e++)r=r.concat(i[e].controller.getAllParsedValues(t));t._cache.$bar=(0,n._)(r.sort(((t,e)=>t-e)))}return t._cache.$bar}(e,t.type);let r,s,o,a,l=e._length;const c=()=>{32767!==o&&-32768!==o&&((0,n.h)(a)&&(l=Math.min(l,Math.abs(o-a)||l)),a=o)};for(r=0,s=i.length;r<s;++r)o=e.getPixelForValue(i[r]),c();for(a=void 0,r=0,s=e.ticks.length;r<s;++r)o=e.getPixelForTick(r),c();return l}function k(t,e,i,r){return(0,n.b)(t)?function(t,e,i,n){const r=i.parse(t[0],n),s=i.parse(t[1],n),o=Math.min(r,s),a=Math.max(r,s);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),e[i.axis]=c,e._custom={barStart:l,barEnd:c,start:r,end:s,min:o,max:a}}(t,e,i,r):e[i.axis]=i.parse(t,r),e}function S(t,e,i,n){const r=t.iScale,s=t.vScale,o=r.getLabels(),a=r===s,l=[];let c,u,h,d;for(c=i,u=i+n;c<u;++c)d=e[c],h={},h[r.axis]=a||r.parse(o[c],c),l.push(k(d,h,s,c));return l}function T(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}function A(t,e,i,n){let r=e.borderSkipped;const s={};if(!r)return void(t.borderSkipped=s);if(!0===r)return void(t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:o,end:a,reverse:l,top:c,bottom:u}=function(t){let e,i,n,r,s;return t.horizontal?(e=t.base>t.x,i="left",n="right"):(e=t.base<t.y,i="bottom",n="top"),e?(r="end",s="start"):(r="start",s="end"),{start:i,end:n,reverse:e,top:r,bottom:s}}(t);"middle"===r&&i&&(t.enableBorderRadius=!0,(i._top||0)===n?r=c:(i._bottom||0)===n?r=u:(s[M(u,o,a,l)]=!0,r=c)),s[M(r,o,a,l)]=!0,t.borderSkipped=s}function M(t,e,i,n){var r,s,o;return n?(o=i,t=C(t=(r=t)===(s=e)?o:r===o?s:r,i,e)):t=C(t,e,i),t}function C(t,e,i){return"start"===t?e:"end"===t?i:t}function E(t,{inflateAmount:e},i){t.inflateAmount="auto"===e?1===i?.33:0:e}class I extends b{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>"spacing"!==t,_indexable:t=>"spacing"!==t&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:i,color:n}}=t.legend.options;return e.labels.map(((e,r)=>{const s=t.getDatasetMeta(0).controller.getStyle(r);return{text:e,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:n,lineWidth:s.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(r),index:r}}))}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}}};constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const i=this.getDataset().data,r=this._cachedMeta;if(!1===this._parsing)r._parsed=i;else{let s,o,a=t=>+i[t];if((0,n.i)(i[t])){const{key:t="value"}=this._parsing;a=e=>+(0,n.f)(i[e],t)}for(s=t,o=t+e;s<o;++s)r._parsed[s]=a(s)}}_getRotation(){return(0,n.t)(this.options.rotation-90)}_getCircumference(){return(0,n.t)(this.options.circumference)}_getRotationExtents(){let t=n.T,e=-n.T;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const n=this.chart.getDatasetMeta(i).controller,r=n._getRotation(),s=n._getCircumference();t=Math.min(t,r),e=Math.max(e,r+s)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:i}=e,r=this._cachedMeta,s=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,a=Math.max((Math.min(i.width,i.height)-o)/2,0),l=Math.min((0,n.m)(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:d,ratioY:p,offsetX:f,offsetY:m}=function(t,e,i){let r=1,s=1,o=0,a=0;if(e<n.T){const l=t,c=l+e,u=Math.cos(l),h=Math.sin(l),d=Math.cos(c),p=Math.sin(c),f=(t,e,r)=>(0,n.p)(t,l,c,!0)?1:Math.max(e,e*i,r,r*i),m=(t,e,r)=>(0,n.p)(t,l,c,!0)?-1:Math.min(e,e*i,r,r*i),g=f(0,u,d),_=f(n.H,h,p),y=m(n.P,u,d),x=m(n.P+n.H,h,p);r=(g-y)/2,s=(_-x)/2,o=-(g+y)/2,a=-(_+x)/2}return{ratioX:r,ratioY:s,offsetX:o,offsetY:a}}(h,u,l),g=(i.width-o)/d,_=(i.height-o)/p,y=Math.max(Math.min(g,_)/2,0),x=(0,n.n)(this.options.radius,y),v=(x-Math.max(x*l,0))/this._getVisibleDatasetWeightTotal();this.offsetX=f*x,this.offsetY=m*x,r.total=this.calculateTotal(),this.outerRadius=x-v*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-v*c,0),this.updateElements(s,0,s.length,t)}_circumference(t,e){const i=this.options,r=this._cachedMeta,s=this._getCircumference();return e&&i.animation.animateRotate||!this.chart.getDataVisibility(t)||null===r._parsed[t]||r.data[t].hidden?0:this.calculateCircumference(r._parsed[t]*s/n.T)}updateElements(t,e,i,n){const r="reset"===n,s=this.chart,o=s.chartArea,a=s.options.animation,l=(o.left+o.right)/2,c=(o.top+o.bottom)/2,u=r&&a.animateScale,h=u?0:this.innerRadius,d=u?0:this.outerRadius,{sharedOptions:p,includeOptions:f}=this._getSharedOptions(e,n);let m,g=this._getRotation();for(m=0;m<e;++m)g+=this._circumference(m,r);for(m=e;m<e+i;++m){const e=this._circumference(m,r),i=t[m],s={x:l+this.offsetX,y:c+this.offsetY,startAngle:g,endAngle:g+e,circumference:e,outerRadius:d,innerRadius:h};f&&(s.options=p||this.resolveDataElementOptions(m,i.active?"active":n)),g+=e,this.updateElement(i,m,s,n)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let i,n=0;for(i=0;i<e.length;i++){const r=t._parsed[i];null===r||isNaN(r)||!this.chart.getDataVisibility(i)||e[i].hidden||(n+=Math.abs(r))}return n}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?n.T*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=(0,n.o)(e._parsed[t],i.options.locale);return{label:r[t]||"",value:s}}getMaxBorderWidth(t){let e=0;const i=this.chart;let n,r,s,o,a;if(!t)for(n=0,r=i.data.datasets.length;n<r;++n)if(i.isDatasetVisible(n)){s=i.getDatasetMeta(n),t=s.data,o=s.controller;break}if(!t)return 0;for(n=0,r=t.length;n<r;++n)a=o.resolveDataElementOptions(n),"inner"!==a.borderAlign&&(e=Math.max(e,a.borderWidth||0,a.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let i=0,n=t.length;i<n;++i){const t=this.resolveDataElementOptions(i);e=Math.max(e,t.offset||0,t.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(e+=this._getRingWeight(i));return e}_getRingWeight(t){return Math.max((0,n.v)(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class D extends b{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:i,color:n}}=t.legend.options;return e.labels.map(((e,r)=>{const s=t.getDatasetMeta(0).controller.getStyle(r);return{text:e,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:n,lineWidth:s.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(r),index:r}}))}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=(0,n.o)(e._parsed[t].r,i.options.locale);return{label:r[t]||"",value:s}}parseObjectData(t,e,i,r){return n.y.bind(this)(t,e,i,r)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach(((t,i)=>{const n=this.getParsed(i).r;!isNaN(n)&&this.chart.getDataVisibility(i)&&(n<e.min&&(e.min=n),n>e.max&&(e.max=n))})),e}_updateRadius(){const t=this.chart,e=t.chartArea,i=t.options,n=Math.min(e.right-e.left,e.bottom-e.top),r=Math.max(n/2,0),s=(r-Math.max(i.cutoutPercentage?r/100*i.cutoutPercentage:1,0))/t.getVisibleDatasetCount();this.outerRadius=r-s*this.index,this.innerRadius=this.outerRadius-s}updateElements(t,e,i,r){const s="reset"===r,o=this.chart,a=o.options.animation,l=this._cachedMeta.rScale,c=l.xCenter,u=l.yCenter,h=l.getIndexAngle(0)-.5*n.P;let d,p=h;const f=360/this.countVisibleElements();for(d=0;d<e;++d)p+=this._computeAngle(d,r,f);for(d=e;d<e+i;d++){const e=t[d];let i=p,n=p+this._computeAngle(d,r,f),m=o.getDataVisibility(d)?l.getDistanceFromCenterForValue(this.getParsed(d).r):0;p=n,s&&(a.animateScale&&(m=0),a.animateRotate&&(i=n=h));const g={x:c,y:u,innerRadius:0,outerRadius:m,startAngle:i,endAngle:n,options:this.resolveDataElementOptions(d,e.active?"active":r)};this.updateElement(e,d,g,r)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach(((t,i)=>{!isNaN(this.getParsed(i).r)&&this.chart.getDataVisibility(i)&&e++})),e}_computeAngle(t,e,i){return this.chart.getDataVisibility(t)?(0,n.t)(this.resolveDataElementOptions(t,e).angle||i):0}}var z=Object.freeze({__proto__:null,BarController:class extends b{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,e,i,n){return S(t,e,i,n)}parseArrayData(t,e,i,n){return S(t,e,i,n)}parseObjectData(t,e,i,r){const{iScale:s,vScale:o}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c="x"===s.axis?a:l,u="x"===o.axis?a:l,h=[];let d,p,f,m;for(d=i,p=i+r;d<p;++d)m=e[d],f={},f[s.axis]=s.parse((0,n.f)(m,c),d),h.push(k((0,n.f)(m,u),f,o,d));return h}updateRangeFromParsed(t,e,i,n){super.updateRangeFromParsed(t,e,i,n);const r=i._custom;r&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:i,vScale:n}=e,r=this.getParsed(t),s=r._custom,o=T(s)?"["+s.start+", "+s.end+"]":""+n.getLabelForValue(r[n.axis]);return{label:""+i.getLabelForValue(r[i.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,i,r){const s="reset"===r,{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),u=this._getRuler(),{sharedOptions:h,includeOptions:d}=this._getSharedOptions(e,r);for(let p=e;p<e+i;p++){const e=this.getParsed(p),i=s||(0,n.k)(e[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(p),f=this._calculateBarIndexPixels(p,u),m=(e._stacks||{})[a.axis],g={horizontal:c,base:i.base,enableBorderRadius:!m||T(e._custom)||o===m._top||o===m._bottom,x:c?i.head:f.center,y:c?f.center:i.head,height:c?f.size:Math.abs(i.size),width:c?Math.abs(i.size):f.size};d&&(g.options=h||this.resolveDataElementOptions(p,t[p].active?"active":r));const _=g.options||t[p].options;A(g,_,m,o),E(g,_,u.ratio),this.updateElement(t[p],p,g,r)}}_getStacks(t,e){const{iScale:i}=this._cachedMeta,r=i.getMatchingVisibleMetas(this._type).filter((t=>t.controller.options.grouped)),s=i.options.stacked,o=[],a=t=>{const i=t.controller.getParsed(e),r=i&&i[t.vScale.axis];if((0,n.k)(r)||isNaN(r))return!0};for(const i of r)if((void 0===e||!a(i))&&((!1===s||-1===o.indexOf(i.stack)||void 0===s&&void 0===i.stack)&&o.push(i.stack),i.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,i){const n=this._getStacks(t,i),r=void 0!==e?n.indexOf(e):-1;return-1===r?n.length-1:r}_getRuler(){const t=this.options,e=this._cachedMeta,i=e.iScale,n=[];let r,s;for(r=0,s=e.data.length;r<s;++r)n.push(i.getPixelForValue(this.getParsed(r)[i.axis],r));const o=t.barThickness;return{min:o||w(e),pixels:n,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:o?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:i,index:r},options:{base:s,minBarLength:o}}=this,a=s||0,l=this.getParsed(t),c=l._custom,u=T(c);let h,d,p=l[e.axis],f=0,m=i?this.applyStack(e,l,i):p;m!==p&&(f=m-p,m=p),u&&(p=c.barStart,m=c.barEnd-c.barStart,0!==p&&(0,n.s)(p)!==(0,n.s)(c.barEnd)&&(f=0),f+=p);const g=(0,n.k)(s)||u?f:s;let _=e.getPixelForValue(g);if(h=this.chart.getDataVisibility(t)?e.getPixelForValue(f+m):_,d=h-_,Math.abs(d)<o){d=function(t,e,i){return 0!==t?(0,n.s)(t):(e.isHorizontal()?1:-1)*(e.min>=i?1:-1)}(d,e,a)*o,p===a&&(_-=d/2);const t=e.getPixelForDecimal(0),s=e.getPixelForDecimal(1),c=Math.min(t,s),f=Math.max(t,s);_=Math.max(Math.min(_,f),c),h=_+d,i&&!u&&(l._stacks[e.axis]._visualValues[r]=e.getValueForPixel(h)-e.getValueForPixel(_))}if(_===e.getPixelForValue(a)){const t=(0,n.s)(d)*e.getLineWidthForValue(a)/2;_+=t,d-=t}return{size:d,base:_,head:h,center:h+d/2}}_calculateBarIndexPixels(t,e){const i=e.scale,r=this.options,s=r.skipNull,o=(0,n.v)(r.maxBarThickness,1/0);let a,l;if(e.grouped){const i=s?this._getStackCount(t):e.stackCount,c="flex"===r.barThickness?function(t,e,i,n){const r=e.pixels,s=r[t];let o=t>0?r[t-1]:null,a=t<r.length-1?r[t+1]:null;const l=i.categoryPercentage;null===o&&(o=s-(null===a?e.end-e.start:a-s)),null===a&&(a=s+s-o);const c=s-(s-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/n,ratio:i.barPercentage,start:c}}(t,e,r,i):function(t,e,i,r){const s=i.barThickness;let o,a;return(0,n.k)(s)?(o=e.min*i.categoryPercentage,a=i.barPercentage):(o=s*r,a=1),{chunk:o/r,ratio:a,start:e.pixels[t]-o/2}}(t,e,r,i),u=this._getStackIndex(this.index,this._cachedMeta.stack,s?t:void 0);a=c.start+c.chunk*u+c.chunk/2,l=Math.min(o,c.chunk*c.ratio)}else a=i.getPixelForValue(this.getParsed(t)[i.axis],t),l=Math.min(o,e.min*e.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const t=this._cachedMeta,e=t.vScale,i=t.data,n=i.length;let r=0;for(;r<n;++r)null!==this.getParsed(r)[e.axis]&&i[r].draw(this._ctx)}},BubbleController:class extends b{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,i,n){const r=super.parsePrimitiveData(t,e,i,n);for(let t=0;t<r.length;t++)r[t]._custom=this.resolveDataElementOptions(t+i).radius;return r}parseArrayData(t,e,i,r){const s=super.parseArrayData(t,e,i,r);for(let t=0;t<s.length;t++){const r=e[i+t];s[t]._custom=(0,n.v)(r[2],this.resolveDataElementOptions(t+i).radius)}return s}parseObjectData(t,e,i,r){const s=super.parseObjectData(t,e,i,r);for(let t=0;t<s.length;t++){const r=e[i+t];s[t]._custom=(0,n.v)(r&&r.r&&+r.r,this.resolveDataElementOptions(t+i).radius)}return s}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let i=t.length-1;i>=0;--i)e=Math.max(e,t[i].size(this.resolveDataElementOptions(i))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart.data.labels||[],{xScale:n,yScale:r}=e,s=this.getParsed(t),o=n.getLabelForValue(s.x),a=r.getLabelForValue(s.y),l=s._custom;return{label:i[t]||"",value:"("+o+", "+a+(l?", "+l:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,i,n){const r="reset"===n,{iScale:s,vScale:o}=this._cachedMeta,{sharedOptions:a,includeOptions:l}=this._getSharedOptions(e,n),c=s.axis,u=o.axis;for(let h=e;h<e+i;h++){const e=t[h],i=!r&&this.getParsed(h),d={},p=d[c]=r?s.getPixelForDecimal(.5):s.getPixelForValue(i[c]),f=d[u]=r?o.getBasePixel():o.getPixelForValue(i[u]);d.skip=isNaN(p)||isNaN(f),l&&(d.options=a||this.resolveDataElementOptions(h,e.active?"active":n),r&&(d.options.radius=0)),this.updateElement(e,h,d,n)}}resolveDataElementOptions(t,e){const i=this.getParsed(t);let r=super.resolveDataElementOptions(t,e);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const s=r.radius;return"active"!==e&&(r.radius=0),r.radius+=(0,n.v)(i&&i._custom,s),r}},DoughnutController:I,LineController:class extends b{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:i,data:r=[],_dataset:s}=e,o=this.chart._animationsDisabled;let{start:a,count:l}=(0,n.q)(e,r,o);this._drawStart=a,this._drawCount=l,(0,n.w)(e)&&(a=0,l=r.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!s._decimated,i.points=r;const c=this.resolveDatasetElementOptions(t);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(i,void 0,{animated:!o,options:c},t),this.updateElements(r,a,l,t)}updateElements(t,e,i,r){const s="reset"===r,{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:h}=this._getSharedOptions(e,r),d=o.axis,p=a.axis,{spanGaps:f,segment:m}=this.options,g=(0,n.x)(f)?f:Number.POSITIVE_INFINITY,_=this.chart._animationsDisabled||s||"none"===r,y=e+i,x=t.length;let v=e>0&&this.getParsed(e-1);for(let i=0;i<x;++i){const f=t[i],x=_?f:{};if(i<e||i>=y){x.skip=!0;continue}const b=this.getParsed(i),w=(0,n.k)(b[p]),k=x[d]=o.getPixelForValue(b[d],i),S=x[p]=s||w?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,b,l):b[p],i);x.skip=isNaN(k)||isNaN(S)||w,x.stop=i>0&&Math.abs(b[d]-v[d])>g,m&&(x.parsed=b,x.raw=c.data[i]),h&&(x.options=u||this.resolveDataElementOptions(i,f.active?"active":r)),_||this.updateElement(f,i,x,r),v=b}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,i=e.options&&e.options.borderWidth||0,n=t.data||[];if(!n.length)return i;const r=n[0].size(this.resolveDataElementOptions(0)),s=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(i,r,s)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}},PieController:class extends I{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}},PolarAreaController:D,RadarController:class extends b{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(t){const e=this._cachedMeta.vScale,i=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(i[e.axis])}}parseObjectData(t,e,i,r){return n.y.bind(this)(t,e,i,r)}update(t){const e=this._cachedMeta,i=e.dataset,n=e.data||[],r=e.iScale.getLabels();if(i.points=n,"resize"!==t){const e=this.resolveDatasetElementOptions(t);this.options.showLine||(e.borderWidth=0);const s={_loop:!0,_fullLoop:r.length===n.length,options:e};this.updateElement(i,void 0,s,t)}this.updateElements(n,0,n.length,t)}updateElements(t,e,i,n){const r=this._cachedMeta.rScale,s="reset"===n;for(let o=e;o<e+i;o++){const e=t[o],i=this.resolveDataElementOptions(o,e.active?"active":n),a=r.getPointPositionForValue(o,this.getParsed(o).r),l=s?r.xCenter:a.x,c=s?r.yCenter:a.y,u={x:l,y:c,angle:a.angle,skip:isNaN(l)||isNaN(c),options:i};this.updateElement(e,o,u,n)}}},ScatterController:class extends b{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(t){const e=this._cachedMeta,i=this.chart.data.labels||[],{xScale:n,yScale:r}=e,s=this.getParsed(t),o=n.getLabelForValue(s.x),a=r.getLabelForValue(s.y);return{label:i[t]||"",value:"("+o+", "+a+")"}}update(t){const e=this._cachedMeta,{data:i=[]}=e,r=this.chart._animationsDisabled;let{start:s,count:o}=(0,n.q)(e,i,r);if(this._drawStart=s,this._drawCount=o,(0,n.w)(e)&&(s=0,o=i.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:n,_dataset:s}=e;n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!s._decimated,n.points=i;const o=this.resolveDatasetElementOptions(t);o.segment=this.options.segment,this.updateElement(n,void 0,{animated:!r,options:o},t)}else this.datasetElementType&&(delete e.dataset,this.datasetElementType=!1);this.updateElements(i,s,o,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,i,r){const s="reset"===r,{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,u=this.resolveDataElementOptions(e,r),h=this.getSharedOptions(u),d=this.includeOptions(r,h),p=o.axis,f=a.axis,{spanGaps:m,segment:g}=this.options,_=(0,n.x)(m)?m:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||s||"none"===r;let x=e>0&&this.getParsed(e-1);for(let u=e;u<e+i;++u){const e=t[u],i=this.getParsed(u),m=y?e:{},v=(0,n.k)(i[f]),b=m[p]=o.getPixelForValue(i[p],u),w=m[f]=s||v?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,i,l):i[f],u);m.skip=isNaN(b)||isNaN(w)||v,m.stop=u>0&&Math.abs(i[p]-x[p])>_,g&&(m.parsed=i,m.raw=c.data[u]),d&&(m.options=h||this.resolveDataElementOptions(u,e.active?"active":r)),y||this.updateElement(e,u,m,r),x=i}this.updateSharedOptions(h,r,u)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let t=0;for(let i=e.length-1;i>=0;--i)t=Math.max(t,e[i].size(this.resolveDataElementOptions(i))/2);return t>0&&t}const i=t.dataset,n=i.options&&i.options.borderWidth||0;if(!e.length)return n;const r=e[0].size(this.resolveDataElementOptions(0)),s=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(n,r,s)/2}}});function P(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class L{static override(t){Object.assign(L.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return P()}parse(){return P()}format(){return P()}add(){return P()}diff(){return P()}startOf(){return P()}endOf(){return P()}}var F={_date:L};function R(t,e,i,r){const{controller:s,data:o,_sorted:a}=t,l=s._cachedMeta.iScale;if(l&&e===l.axis&&"r"!==e&&a&&o.length){const t=l._reversePixels?n.A:n.B;if(!r)return t(o,e,i);if(s._sharedOptions){const n=o[0],r="function"==typeof n.getRange&&n.getRange(e);if(r){const n=t(o,e,i-r),s=t(o,e,i+r);return{lo:n.lo,hi:s.hi}}}}return{lo:0,hi:o.length-1}}function O(t,e,i,n,r){const s=t.getSortedVisibleDatasetMetas(),o=i[e];for(let t=0,i=s.length;t<i;++t){const{index:i,data:a}=s[t],{lo:l,hi:c}=R(s[t],e,o,r);for(let t=l;t<=c;++t){const e=a[t];e.skip||n(e,i,t)}}}function B(t,e,i,r,s){const o=[];return s||t.isPointInArea(e)?(O(t,i,e,(function(i,a,l){(s||(0,n.C)(i,t.chartArea,0))&&i.inRange(e.x,e.y,r)&&o.push({element:i,datasetIndex:a,index:l})}),!0),o):o}function V(t,e,i,r,s,o){return o||t.isPointInArea(e)?"r"!==i||r?function(t,e,i,n,r,s){let o=[];const a=function(t){const e=-1!==t.indexOf("x"),i=-1!==t.indexOf("y");return function(t,n){const r=e?Math.abs(t.x-n.x):0,s=i?Math.abs(t.y-n.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(s,2))}}(i);let l=Number.POSITIVE_INFINITY;return O(t,i,e,(function(i,c,u){const h=i.inRange(e.x,e.y,r);if(n&&!h)return;const d=i.getCenterPoint(r);if(!s&&!t.isPointInArea(d)&&!h)return;const p=a(e,d);p<l?(o=[{element:i,datasetIndex:c,index:u}],l=p):p===l&&o.push({element:i,datasetIndex:c,index:u})})),o}(t,e,i,r,s,o):function(t,e,i,r){let s=[];return O(t,i,e,(function(t,i,o){const{startAngle:a,endAngle:l}=t.getProps(["startAngle","endAngle"],r),{angle:c}=(0,n.D)(t,{x:e.x,y:e.y});(0,n.p)(c,a,l)&&s.push({element:t,datasetIndex:i,index:o})})),s}(t,e,i,s):[]}function N(t,e,i,n,r){const s=[],o="x"===i?"inXRange":"inYRange";let a=!1;return O(t,i,e,((t,n,l)=>{t[o](e[i],r)&&(s.push({element:t,datasetIndex:n,index:l}),a=a||t.inRange(e.x,e.y,r))})),n&&!a?[]:s}var q={evaluateInteractionItems:O,modes:{index(t,e,i,r){const s=(0,n.z)(e,t),o=i.axis||"x",a=i.includeInvisible||!1,l=i.intersect?B(t,s,o,r,a):V(t,s,o,!1,r,a),c=[];return l.length?(t.getSortedVisibleDatasetMetas().forEach((t=>{const e=l[0].index,i=t.data[e];i&&!i.skip&&c.push({element:i,datasetIndex:t.index,index:e})})),c):[]},dataset(t,e,i,r){const s=(0,n.z)(e,t),o=i.axis||"xy",a=i.includeInvisible||!1;let l=i.intersect?B(t,s,o,r,a):V(t,s,o,!1,r,a);if(l.length>0){const e=l[0].datasetIndex,i=t.getDatasetMeta(e).data;l=[];for(let t=0;t<i.length;++t)l.push({element:i[t],datasetIndex:e,index:t})}return l},point(t,e,i,r){return B(t,(0,n.z)(e,t),i.axis||"xy",r,i.includeInvisible||!1)},nearest(t,e,i,r){const s=(0,n.z)(e,t),o=i.axis||"xy",a=i.includeInvisible||!1;return V(t,s,o,i.intersect,r,a)},x(t,e,i,r){return N(t,(0,n.z)(e,t),"x",i.intersect,r)},y(t,e,i,r){return N(t,(0,n.z)(e,t),"y",i.intersect,r)}}};const j=["left","top","right","bottom"];function $(t,e){return t.filter((t=>t.pos===e))}function U(t,e){return t.filter((t=>-1===j.indexOf(t.pos)&&t.box.axis===e))}function Z(t,e){return t.sort(((t,i)=>{const n=e?i:t,r=e?t:i;return n.weight===r.weight?n.index-r.index:n.weight-r.weight}))}function W(t,e,i,n){return Math.max(t[i],e[i])+Math.max(t[n],e[n])}function G(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function H(t,e,i,r){const{pos:s,box:o}=i,a=t.maxPadding;if(!(0,n.i)(s)){i.size&&(t[s]-=i.size);const e=r[i.stack]||{size:0,count:1};e.size=Math.max(e.size,i.horizontal?o.height:o.width),i.size=e.size/e.count,t[s]+=i.size}o.getPadding&&G(a,o.getPadding());const l=Math.max(0,e.outerWidth-W(a,t,"left","right")),c=Math.max(0,e.outerHeight-W(a,t,"top","bottom")),u=l!==t.w,h=c!==t.h;return t.w=l,t.h=c,i.horizontal?{same:u,other:h}:{same:h,other:u}}function X(t,e){const i=e.maxPadding;return function(t){const n={left:0,top:0,right:0,bottom:0};return t.forEach((t=>{n[t]=Math.max(e[t],i[t])})),n}(t?["left","right"]:["top","bottom"])}function Y(t,e,i,n){const r=[];let s,o,a,l,c,u;for(s=0,o=t.length,c=0;s<o;++s){a=t[s],l=a.box,l.update(a.width||e.w,a.height||e.h,X(a.horizontal,e));const{same:o,other:h}=H(e,i,a,n);c|=o&&r.length,u=u||h,l.fullSize||r.push(a)}return c&&Y(r,e,i,n)||u}function K(t,e,i,n,r){t.top=i,t.left=e,t.right=e+n,t.bottom=i+r,t.width=n,t.height=r}function J(t,e,i,r){const s=i.padding;let{x:o,y:a}=e;for(const l of t){const t=l.box,c=r[l.stack]||{count:1,placed:0,weight:1},u=l.stackWeight/c.weight||1;if(l.horizontal){const r=e.w*u,o=c.size||t.height;(0,n.h)(c.start)&&(a=c.start),t.fullSize?K(t,s.left,a,i.outerWidth-s.right-s.left,o):K(t,e.left+c.placed,a,r,o),c.start=a,c.placed+=r,a=t.bottom}else{const r=e.h*u,a=c.size||t.width;(0,n.h)(c.start)&&(o=c.start),t.fullSize?K(t,o,s.top,a,i.outerHeight-s.bottom-s.top):K(t,o,e.top+c.placed,a,r),c.start=o,c.placed+=r,o=t.right}}e.x=o,e.y=a}var Q={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},t.boxes.push(e)},removeBox(t,e){const i=t.boxes?t.boxes.indexOf(e):-1;-1!==i&&t.boxes.splice(i,1)},configure(t,e,i){e.fullSize=i.fullSize,e.position=i.position,e.weight=i.weight},update(t,e,i,r){if(!t)return;const s=(0,n.E)(t.options.layout.padding),o=Math.max(e-s.width,0),a=Math.max(i-s.height,0),l=function(t){const e=function(t){const e=[];let i,n,r,s,o,a;for(i=0,n=(t||[]).length;i<n;++i)r=t[i],({position:s,options:{stack:o,stackWeight:a=1}}=r),e.push({index:i,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&s+o,stackWeight:a});return e}(t),i=Z(e.filter((t=>t.box.fullSize)),!0),n=Z($(e,"left"),!0),r=Z($(e,"right")),s=Z($(e,"top"),!0),o=Z($(e,"bottom")),a=U(e,"x"),l=U(e,"y");return{fullSize:i,leftAndTop:n.concat(s),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:$(e,"chartArea"),vertical:n.concat(r).concat(l),horizontal:s.concat(o).concat(a)}}(t.boxes),c=l.vertical,u=l.horizontal;(0,n.F)(t.boxes,(t=>{"function"==typeof t.beforeLayout&&t.beforeLayout()}));const h=c.reduce(((t,e)=>e.box.options&&!1===e.box.options.display?t:t+1),0)||1,d=Object.freeze({outerWidth:e,outerHeight:i,padding:s,availableWidth:o,availableHeight:a,vBoxMaxWidth:o/2/h,hBoxMaxHeight:a/2}),p=Object.assign({},s);G(p,(0,n.E)(r));const f=Object.assign({maxPadding:p,w:o,h:a,x:s.left,y:s.top},s),m=function(t,e){const i=function(t){const e={};for(const i of t){const{stack:t,pos:n,stackWeight:r}=i;if(!t||!j.includes(n))continue;const s=e[t]||(e[t]={count:0,placed:0,weight:0,size:0});s.count++,s.weight+=r}return e}(t),{vBoxMaxWidth:n,hBoxMaxHeight:r}=e;let s,o,a;for(s=0,o=t.length;s<o;++s){a=t[s];const{fullSize:o}=a.box,l=i[a.stack],c=l&&a.stackWeight/l.weight;a.horizontal?(a.width=c?c*n:o&&e.availableWidth,a.height=r):(a.width=n,a.height=c?c*r:o&&e.availableHeight)}return i}(c.concat(u),d);Y(l.fullSize,f,d,m),Y(c,f,d,m),Y(u,f,d,m)&&Y(c,f,d,m),function(t){const e=t.maxPadding;function i(i){const n=Math.max(e[i]-t[i],0);return t[i]+=n,n}t.y+=i("top"),t.x+=i("left"),i("right"),i("bottom")}(f),J(l.leftAndTop,f,d,m),f.x+=f.w,f.y+=f.h,J(l.rightAndBottom,f,d,m),t.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},(0,n.F)(l.chartArea,(e=>{const i=e.box;Object.assign(i,t.chartArea),i.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})}))}};class tt{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,i){}removeEventListener(t,e,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,i,n){return e=Math.max(0,e||t.width),i=i||t.height,{width:e,height:Math.max(0,n?Math.floor(e/n):i)}}isAttached(t){return!0}updateConfig(t){}}class et extends tt{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const it="$chartjs",nt={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},rt=t=>null===t||""===t,st=!!n.K&&{passive:!0};function ot(t,e,i){t&&t.canvas&&t.canvas.removeEventListener(e,i,st)}function at(t,e){for(const i of t)if(i===e||i.contains(e))return!0}function lt(t,e,i){const n=t.canvas,r=new MutationObserver((t=>{let e=!1;for(const i of t)e=e||at(i.addedNodes,n),e=e&&!at(i.removedNodes,n);e&&i()}));return r.observe(document,{childList:!0,subtree:!0}),r}function ct(t,e,i){const n=t.canvas,r=new MutationObserver((t=>{let e=!1;for(const i of t)e=e||at(i.removedNodes,n),e=e&&!at(i.addedNodes,n);e&&i()}));return r.observe(document,{childList:!0,subtree:!0}),r}const ut=new Map;let ht=0;function dt(){const t=window.devicePixelRatio;t!==ht&&(ht=t,ut.forEach(((e,i)=>{i.currentDevicePixelRatio!==t&&e()})))}function pt(t,e,i){const r=t.canvas,s=r&&(0,n.I)(r);if(!s)return;const o=(0,n.L)(((t,e)=>{const n=s.clientWidth;i(t,e),n<s.clientWidth&&i()}),window),a=new ResizeObserver((t=>{const e=t[0],i=e.contentRect.width,n=e.contentRect.height;0===i&&0===n||o(i,n)}));return a.observe(s),function(t,e){ut.size||window.addEventListener("resize",dt),ut.set(t,e)}(t,o),a}function ft(t,e,i){i&&i.disconnect(),"resize"===e&&function(t){ut.delete(t),ut.size||window.removeEventListener("resize",dt)}(t)}function mt(t,e,i){const r=t.canvas,s=(0,n.L)((e=>{null!==t.ctx&&i(function(t,e){const i=nt[t.type]||t.type,{x:r,y:s}=(0,n.z)(t,e);return{type:i,chart:e,native:t,x:void 0!==r?r:null,y:void 0!==s?s:null}}(e,t))}),t);return function(t,e,i){t&&t.addEventListener(e,i,st)}(r,e,s),s}class gt extends tt{acquireContext(t,e){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(function(t,e){const i=t.style,r=t.getAttribute("height"),s=t.getAttribute("width");if(t[it]={initial:{height:r,width:s,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",rt(s)){const e=(0,n.J)(t,"width");void 0!==e&&(t.width=e)}if(rt(r))if(""===t.style.height)t.height=t.width/(e||2);else{const e=(0,n.J)(t,"height");void 0!==e&&(t.height=e)}}(t,e),i):null}releaseContext(t){const e=t.canvas;if(!e[it])return!1;const i=e[it].initial;["height","width"].forEach((t=>{const r=i[t];(0,n.k)(r)?e.removeAttribute(t):e.setAttribute(t,r)}));const r=i.style||{};return Object.keys(r).forEach((t=>{e.style[t]=r[t]})),e.width=e.width,delete e[it],!0}addEventListener(t,e,i){this.removeEventListener(t,e);const n=t.$proxies||(t.$proxies={}),r={attach:lt,detach:ct,resize:pt}[e]||mt;n[e]=r(t,e,i)}removeEventListener(t,e){const i=t.$proxies||(t.$proxies={}),n=i[e];n&&(({attach:ft,detach:ft,resize:ft}[e]||ot)(t,e,n),i[e]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,i,r){return(0,n.G)(t,e,i,r)}isAttached(t){const e=(0,n.I)(t);return!(!e||!e.isConnected)}}class _t{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}hasValue(){return(0,n.x)(this.x)&&(0,n.x)(this.y)}getProps(t,e){const i=this.$animations;if(!e||!i)return this;const n={};return t.forEach((t=>{n[t]=i[t]&&i[t].active()?i[t]._to:this[t]})),n}}function yt(t,e,i,r,s){const o=(0,n.v)(r,0),a=Math.min((0,n.v)(s,t.length),t.length);let l,c,u,h=0;for(i=Math.ceil(i),s&&(l=s-r,i=l/Math.floor(l/i)),u=o;u<0;)h++,u=Math.round(o+h*i);for(c=Math.max(o,0);c<a;c++)c===u&&(e.push(t[c]),h++,u=Math.round(o+h*i))}const xt=(t,e,i)=>"top"===e||"left"===e?t[e]+i:t[e]-i,vt=(t,e)=>Math.min(e||t,t);function bt(t,e){const i=[],n=t.length/e,r=t.length;let s=0;for(;s<r;s+=n)i.push(t[Math.floor(s)]);return i}function wt(t,e,i){const n=t.ticks.length,r=Math.min(e,n-1),s=t._startPixel,o=t._endPixel,a=1e-6;let l,c=t.getPixelForTick(r);if(!(i&&(l=1===n?Math.max(c-s,o-c):0===e?(t.getPixelForTick(1)-c)/2:(c-t.getPixelForTick(r-1))/2,c+=r<e?l:-l,c<s-a||c>o+a)))return c}function kt(t){return t.drawTicks?t.tickLength:0}function St(t,e){if(!t.display)return 0;const i=(0,n.a0)(t.font,e),r=(0,n.E)(t.padding);return((0,n.b)(t.text)?t.text.length:1)*i.lineHeight+r.height}function Tt(t,e,i){let r=(0,n.a1)(t);return(i&&"right"!==e||!i&&"right"===e)&&(r=(t=>"left"===t?"right":"right"===t?"left":t)(r)),r}class At extends _t{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:i,_suggestedMax:r}=this;return t=(0,n.O)(t,Number.POSITIVE_INFINITY),e=(0,n.O)(e,Number.NEGATIVE_INFINITY),i=(0,n.O)(i,Number.POSITIVE_INFINITY),r=(0,n.O)(r,Number.NEGATIVE_INFINITY),{min:(0,n.O)(t,i),max:(0,n.O)(e,r),minDefined:(0,n.g)(t),maxDefined:(0,n.g)(e)}}getMinMax(t){let e,{min:i,max:r,minDefined:s,maxDefined:o}=this.getUserBounds();if(s&&o)return{min:i,max:r};const a=this.getMatchingVisibleMetas();for(let n=0,l=a.length;n<l;++n)e=a[n].controller.getMinMax(this,t),s||(i=Math.min(i,e.min)),o||(r=Math.max(r,e.max));return i=o&&i>r?r:i,r=s&&i>r?i:r,{min:(0,n.O)(i,(0,n.O)(r,i)),max:(0,n.O)(r,(0,n.O)(i,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){(0,n.Q)(this.options.beforeUpdate,[this])}update(t,e,i){const{beginAtZero:r,grace:s,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=(0,n.R)(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?bt(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||"auto"===o.source)&&(this.ticks=function(t,e){const i=t.options.ticks,r=function(t){const e=t.options.offset,i=t._tickSize(),n=t._length/i+(e?0:1),r=t._maxLength/i;return Math.floor(Math.min(n,r))}(t),s=Math.min(i.maxTicksLimit||r,r),o=i.major.enabled?function(t){const e=[];let i,n;for(i=0,n=t.length;i<n;i++)t[i].major&&e.push(i);return e}(e):[],a=o.length,l=o[0],c=o[a-1],u=[];if(a>s)return function(t,e,i,n){let r,s=0,o=i[0];for(n=Math.ceil(n),r=0;r<t.length;r++)r===o&&(e.push(t[r]),s++,o=i[s*n])}(e,u,o,a/s),u;const h=function(t,e,i){const r=function(t){const e=t.length;let i,n;if(e<2)return!1;for(n=t[0],i=1;i<e;++i)if(t[i]-t[i-1]!==n)return!1;return n}(t),s=e.length/i;if(!r)return Math.max(s,1);const o=(0,n.N)(r);for(let t=0,e=o.length-1;t<e;t++){const e=o[t];if(e>s)return e}return Math.max(s,1)}(o,e,s);if(a>0){let t,i;const r=a>1?Math.round((c-l)/(a-1)):null;for(yt(e,u,h,(0,n.k)(r)?0:l-r,l),t=0,i=a-1;t<i;t++)yt(e,u,h,o[t],o[t+1]);return yt(e,u,h,c,(0,n.k)(r)?e.length:c+r),u}return yt(e,u,h),u}(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t,e,i=this.options.reverse;this.isHorizontal()?(t=this.left,e=this.right):(t=this.top,e=this.bottom,i=!i),this._startPixel=t,this._endPixel=e,this._reversePixels=i,this._length=e-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){(0,n.Q)(this.options.afterUpdate,[this])}beforeSetDimensions(){(0,n.Q)(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){(0,n.Q)(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),(0,n.Q)(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){(0,n.Q)(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let i,r,s;for(i=0,r=t.length;i<r;i++)s=t[i],s.label=(0,n.Q)(e.callback,[s.value,i,t],this)}afterTickToLabelConversion(){(0,n.Q)(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){(0,n.Q)(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,i=vt(this.ticks.length,t.ticks.maxTicksLimit),r=e.minRotation||0,s=e.maxRotation;let o,a,l,c=r;if(!this._isVisible()||!e.display||r>=s||i<=1||!this.isHorizontal())return void(this.labelRotation=r);const u=this._getLabelSizes(),h=u.widest.width,d=u.highest.height,p=(0,n.S)(this.chart.width-h,0,this.maxWidth);o=t.offset?this.maxWidth/i:p/(i-1),h+6>o&&(o=p/(i-(t.offset?.5:1)),a=this.maxHeight-kt(t.grid)-e.padding-St(t.title,this.chart.options.font),l=Math.sqrt(h*h+d*d),c=(0,n.U)(Math.min(Math.asin((0,n.S)((u.highest.height+6)/o,-1,1)),Math.asin((0,n.S)(a/l,-1,1))-Math.asin((0,n.S)(d/l,-1,1)))),c=Math.max(r,Math.min(s,c))),this.labelRotation=c}afterCalculateLabelRotation(){(0,n.Q)(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){(0,n.Q)(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:i,title:r,grid:s}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const o=St(r,e.options.font);if(a?(t.width=this.maxWidth,t.height=kt(s)+o):(t.height=this.maxHeight,t.width=kt(s)+o),i.display&&this.ticks.length){const{first:e,last:r,widest:s,highest:o}=this._getLabelSizes(),l=2*i.padding,c=(0,n.t)(this.labelRotation),u=Math.cos(c),h=Math.sin(c);if(a){const e=i.mirror?0:h*s.width+u*o.height;t.height=Math.min(this.maxHeight,t.height+e+l)}else{const e=i.mirror?0:u*s.width+h*o.height;t.width=Math.min(this.maxWidth,t.width+e+l)}this._calculatePadding(e,r,h,u)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,i,n){const{ticks:{align:r,padding:s},position:o}=this.options,a=0!==this.labelRotation,l="top"!==o&&"x"===this.axis;if(this.isHorizontal()){const o=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let u=0,h=0;a?l?(u=n*t.width,h=i*e.height):(u=i*t.height,h=n*e.width):"start"===r?h=e.width:"end"===r?u=t.width:"inner"!==r&&(u=t.width/2,h=e.width/2),this.paddingLeft=Math.max((u-o+s)*this.width/(this.width-o),0),this.paddingRight=Math.max((h-c+s)*this.width/(this.width-c),0)}else{let i=e.height/2,n=t.height/2;"start"===r?(i=0,n=t.height):"end"===r&&(i=e.height,n=0),this.paddingTop=i+s,this.paddingBottom=n+s}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){(0,n.Q)(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return"top"===e||"bottom"===e||"x"===t}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){let e,i;for(this.beforeTickToLabelConversion(),this.generateTickLabels(t),e=0,i=t.length;e<i;e++)(0,n.k)(t[e].label)&&(t.splice(e,1),i--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let i=this.ticks;e<i.length&&(i=bt(i,e)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,i){const{ctx:r,_longestTextCache:s}=this,o=[],a=[],l=Math.floor(e/vt(e,i));let c,u,h,d,p,f,m,g,_,y,x,v=0,b=0;for(c=0;c<e;c+=l){if(d=t[c].label,p=this._resolveTickFontOptions(c),r.font=f=p.string,m=s[f]=s[f]||{data:{},gc:[]},g=p.lineHeight,_=y=0,(0,n.k)(d)||(0,n.b)(d)){if((0,n.b)(d))for(u=0,h=d.length;u<h;++u)x=d[u],(0,n.k)(x)||(0,n.b)(x)||(_=(0,n.V)(r,m.data,m.gc,_,x),y+=g)}else _=(0,n.V)(r,m.data,m.gc,_,d),y=g;o.push(_),a.push(y),v=Math.max(_,v),b=Math.max(y,b)}!function(t,e){(0,n.F)(t,(t=>{const i=t.gc,n=i.length/2;let r;if(n>e){for(r=0;r<n;++r)delete t.data[i[r]];i.splice(0,n)}}))}(s,e);const w=o.indexOf(v),k=a.indexOf(b),S=t=>({width:o[t]||0,height:a[t]||0});return{first:S(0),last:S(e-1),widest:S(w),highest:S(k),widths:o,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return(0,n.W)(this._alignToPixels?(0,n.X)(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const i=e[t];return i.$context||(i.$context=function(t,e,i){return(0,n.j)(t,{tick:i,index:e,type:"tick"})}(this.getContext(),t,i))}return this.$context||(this.$context=(i=this.chart.getContext(),this,(0,n.j)(i,{scale:this,type:"scale"})));var i}_tickSize(){const t=this.options.ticks,e=(0,n.t)(this.labelRotation),i=Math.abs(Math.cos(e)),r=Math.abs(Math.sin(e)),s=this._getLabelSizes(),o=t.autoSkipPadding||0,a=s?s.widest.width+o:0,l=s?s.highest.height+o:0;return this.isHorizontal()?l*i>a*r?a/i:l/r:l*r<a*i?l/i:a/r}_isVisible(){const t=this.options.display;return"auto"!==t?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,i=this.chart,r=this.options,{grid:s,position:o,border:a}=r,l=s.offset,c=this.isHorizontal(),u=this.ticks.length+(l?1:0),h=kt(s),d=[],p=a.setContext(this.getContext()),f=p.display?p.width:0,m=f/2,g=function(t){return(0,n.X)(i,t,f)};let _,y,x,v,b,w,k,S,T,A,M,C;if("top"===o)_=g(this.bottom),w=this.bottom-h,S=_-m,A=g(t.top)+m,C=t.bottom;else if("bottom"===o)_=g(this.top),A=t.top,C=g(t.bottom)-m,w=_+m,S=this.top+h;else if("left"===o)_=g(this.right),b=this.right-h,k=_-m,T=g(t.left)+m,M=t.right;else if("right"===o)_=g(this.left),T=t.left,M=g(t.right)-m,b=_+m,k=this.left+h;else if("x"===e){if("center"===o)_=g((t.top+t.bottom)/2+.5);else if((0,n.i)(o)){const t=Object.keys(o)[0],e=o[t];_=g(this.chart.scales[t].getPixelForValue(e))}A=t.top,C=t.bottom,w=_+m,S=w+h}else if("y"===e){if("center"===o)_=g((t.left+t.right)/2);else if((0,n.i)(o)){const t=Object.keys(o)[0],e=o[t];_=g(this.chart.scales[t].getPixelForValue(e))}b=_-m,k=b-h,T=t.left,M=t.right}const E=(0,n.v)(r.ticks.maxTicksLimit,u),I=Math.max(1,Math.ceil(u/E));for(y=0;y<u;y+=I){const t=this.getContext(y),e=s.setContext(t),r=a.setContext(t),o=e.lineWidth,u=e.color,h=r.dash||[],p=r.dashOffset,f=e.tickWidth,m=e.tickColor,g=e.tickBorderDash||[],_=e.tickBorderDashOffset;x=wt(this,y,l),void 0!==x&&(v=(0,n.X)(i,x,o),c?b=k=T=M=v:w=S=A=C=v,d.push({tx1:b,ty1:w,tx2:k,ty2:S,x1:T,y1:A,x2:M,y2:C,width:o,color:u,borderDash:h,borderDashOffset:p,tickWidth:f,tickColor:m,tickBorderDash:g,tickBorderDashOffset:_}))}return this._ticksLength=u,this._borderValue=_,d}_computeLabelItems(t){const e=this.axis,i=this.options,{position:r,ticks:s}=i,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:h}=s,d=kt(i.grid),p=d+u,f=h?-u:p,m=-(0,n.t)(this.labelRotation),g=[];let _,y,x,v,b,w,k,S,T,A,M,C,E="middle";if("top"===r)w=this.bottom-f,k=this._getXAxisLabelAlignment();else if("bottom"===r)w=this.top+f,k=this._getXAxisLabelAlignment();else if("left"===r){const t=this._getYAxisLabelAlignment(d);k=t.textAlign,b=t.x}else if("right"===r){const t=this._getYAxisLabelAlignment(d);k=t.textAlign,b=t.x}else if("x"===e){if("center"===r)w=(t.top+t.bottom)/2+p;else if((0,n.i)(r)){const t=Object.keys(r)[0],e=r[t];w=this.chart.scales[t].getPixelForValue(e)+p}k=this._getXAxisLabelAlignment()}else if("y"===e){if("center"===r)b=(t.left+t.right)/2-p;else if((0,n.i)(r)){const t=Object.keys(r)[0],e=r[t];b=this.chart.scales[t].getPixelForValue(e)}k=this._getYAxisLabelAlignment(d).textAlign}"y"===e&&("start"===l?E="top":"end"===l&&(E="bottom"));const I=this._getLabelSizes();for(_=0,y=a.length;_<y;++_){x=a[_],v=x.label;const t=s.setContext(this.getContext(_));S=this.getPixelForTick(_)+s.labelOffset,T=this._resolveTickFontOptions(_),A=T.lineHeight,M=(0,n.b)(v)?v.length:1;const e=M/2,i=t.color,l=t.textStrokeColor,u=t.textStrokeWidth;let d,p=k;if(o?(b=S,"inner"===k&&(p=_===y-1?this.options.reverse?"left":"right":0===_?this.options.reverse?"right":"left":"center"),C="top"===r?"near"===c||0!==m?-M*A+A/2:"center"===c?-I.highest.height/2-e*A+A:-I.highest.height+A/2:"near"===c||0!==m?A/2:"center"===c?I.highest.height/2-e*A:I.highest.height-M*A,h&&(C*=-1),0===m||t.showLabelBackdrop||(b+=A/2*Math.sin(m))):(w=S,C=(1-M)*A/2),t.showLabelBackdrop){const e=(0,n.E)(t.backdropPadding),i=I.heights[_],r=I.widths[_];let s=C-e.top,o=0-e.left;switch(E){case"middle":s-=i/2;break;case"bottom":s-=i}switch(k){case"center":o-=r/2;break;case"right":o-=r;break;case"inner":_===y-1?o-=r:_>0&&(o-=r/2)}d={left:o,top:s,width:r+e.width,height:i+e.height,color:t.backdropColor}}g.push({label:v,font:T,textOffset:C,options:{rotation:m,color:i,strokeColor:l,strokeWidth:u,textAlign:p,textBaseline:E,translation:[b,w],backdrop:d}})}return g}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-(0,n.t)(this.labelRotation))return"top"===t?"left":"right";let i="center";return"start"===e.align?i="left":"end"===e.align?i="right":"inner"===e.align&&(i="inner"),i}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:i,mirror:n,padding:r}}=this.options,s=t+r,o=this._getLabelSizes().widest.width;let a,l;return"left"===e?n?(l=this.right+r,"near"===i?a="left":"center"===i?(a="center",l+=o/2):(a="right",l+=o)):(l=this.right-s,"near"===i?a="right":"center"===i?(a="center",l-=o/2):(a="left",l=this.left)):"right"===e?n?(l=this.left+r,"near"===i?a="right":"center"===i?(a="center",l-=o/2):(a="left",l-=o)):(l=this.left+s,"near"===i?a="left":"center"===i?(a="center",l+=o/2):(a="right",l=this.right)):a="right",{textAlign:a,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:t.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:t.width}:void 0}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:i,top:n,width:r,height:s}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(i,n,r,s),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const i=this.ticks.findIndex((e=>e.value===t));return i>=0?e.setContext(this.getContext(i)).lineWidth:0}drawGrid(t){const e=this.options.grid,i=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let r,s;const o=(t,e,n)=>{n.width&&n.color&&(i.save(),i.lineWidth=n.width,i.strokeStyle=n.color,i.setLineDash(n.borderDash||[]),i.lineDashOffset=n.borderDashOffset,i.beginPath(),i.moveTo(t.x,t.y),i.lineTo(e.x,e.y),i.stroke(),i.restore())};if(e.display)for(r=0,s=n.length;r<s;++r){const t=n[r];e.drawOnChartArea&&o({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t),e.drawTicks&&o({x:t.tx1,y:t.ty1},{x:t.tx2,y:t.ty2},{color:t.tickColor,width:t.tickWidth,borderDash:t.tickBorderDash,borderDashOffset:t.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:i,grid:r}}=this,s=i.setContext(this.getContext()),o=i.display?s.width:0;if(!o)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,h,d;this.isHorizontal()?(c=(0,n.X)(t,this.left,o)-o/2,u=(0,n.X)(t,this.right,a)+a/2,h=d=l):(h=(0,n.X)(t,this.top,o)-o/2,d=(0,n.X)(t,this.bottom,a)+a/2,c=u=l),e.save(),e.lineWidth=s.width,e.strokeStyle=s.color,e.beginPath(),e.moveTo(c,h),e.lineTo(u,d),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const e=this.ctx,i=this._computeLabelArea();i&&(0,n.Y)(e,i);const r=this.getLabelItems(t);for(const t of r){const i=t.options,r=t.font,s=t.label,o=t.textOffset;(0,n.Z)(e,s,0,o,r,i)}i&&(0,n.$)(e)}drawTitle(){const{ctx:t,options:{position:e,title:i,reverse:r}}=this;if(!i.display)return;const s=(0,n.a0)(i.font),o=(0,n.E)(i.padding),a=i.align;let l=s.lineHeight/2;"bottom"===e||"center"===e||(0,n.i)(e)?(l+=o.bottom,(0,n.b)(i.text)&&(l+=s.lineHeight*(i.text.length-1))):l+=o.top;const{titleX:c,titleY:u,maxWidth:h,rotation:d}=function(t,e,i,r){const{top:s,left:o,bottom:a,right:l,chart:c}=t,{chartArea:u,scales:h}=c;let d,p,f,m=0;const g=a-s,_=l-o;if(t.isHorizontal()){if(p=(0,n.a2)(r,o,l),(0,n.i)(i)){const t=Object.keys(i)[0],n=i[t];f=h[t].getPixelForValue(n)+g-e}else f="center"===i?(u.bottom+u.top)/2+g-e:xt(t,i,e);d=l-o}else{if((0,n.i)(i)){const t=Object.keys(i)[0],n=i[t];p=h[t].getPixelForValue(n)-_+e}else p="center"===i?(u.left+u.right)/2-_+e:xt(t,i,e);f=(0,n.a2)(r,a,s),m="left"===i?-n.H:n.H}return{titleX:p,titleY:f,maxWidth:d,rotation:m}}(this,l,e,a);(0,n.Z)(t,i.text,0,0,s,{color:i.color,maxWidth:h,rotation:d,textAlign:Tt(a,e,r),textBaseline:"middle",translation:[c,u]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,i=(0,n.v)(t.grid&&t.grid.z,-1),r=(0,n.v)(t.border&&t.border.z,0);return this._isVisible()&&this.draw===At.prototype.draw?[{z:i,draw:t=>{this.drawBackground(),this.drawGrid(t),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:e,draw:t=>{this.drawLabels(t)}}]:[{z:e,draw:t=>{this.draw(t)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",n=[];let r,s;for(r=0,s=e.length;r<s;++r){const s=e[r];s[i]!==this.id||t&&s.type!==t||n.push(s)}return n}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return(0,n.a0)(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Mt{constructor(t,e,i){this.type=t,this.scope=e,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let i;(function(t){return"id"in t&&"defaults"in t})(e)&&(i=this.register(e));const r=this.items,s=t.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+t);return s in r||(r[s]=t,function(t,e,i){const r=(0,n.a4)(Object.create(null),[i?n.d.get(i):{},n.d.get(e),t.defaults]);n.d.set(e,r),t.defaultRoutes&&function(t,e){Object.keys(e).forEach((i=>{const r=i.split("."),s=r.pop(),o=[t].concat(r).join("."),a=e[i].split("."),l=a.pop(),c=a.join(".");n.d.route(o,s,c,l)}))}(e,t.defaultRoutes),t.descriptors&&n.d.describe(e,t.descriptors)}(t,o,i),this.override&&n.d.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const e=this.items,i=t.id,r=this.scope;i in e&&delete e[i],r&&i in n.d[r]&&(delete n.d[r][i],this.override&&delete n.a3[i])}}class Ct{constructor(){this.controllers=new Mt(b,"datasets",!0),this.elements=new Mt(_t,"elements"),this.plugins=new Mt(Object,"plugins"),this.scales=new Mt(At,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,i){[...e].forEach((e=>{const r=i||this._getRegistryForType(e);i||r.isForType(e)||r===this.plugins&&e.id?this._exec(t,r,e):(0,n.F)(e,(e=>{const n=i||this._getRegistryForType(e);this._exec(t,n,e)}))}))}_exec(t,e,i){const r=(0,n.a5)(t);(0,n.Q)(i["before"+r],[],i),e[t](i),(0,n.Q)(i["after"+r],[],i)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const i=this._typedRegistries[e];if(i.isForType(t))return i}return this.plugins}_get(t,e,i){const n=e.get(t);if(void 0===n)throw new Error('"'+t+'" is not a registered '+i+".");return n}}var Et=new Ct;class It{constructor(){this._init=[]}notify(t,e,i,n){"beforeInit"===e&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const r=n?this._descriptors(t).filter(n):this._descriptors(t),s=this._notify(r,t,e,i);return"afterDestroy"===e&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall")),s}_notify(t,e,i,r){r=r||{};for(const s of t){const t=s.plugin,o=t[i],a=[e,r,s.options];if(!1===(0,n.Q)(o,a,t)&&r.cancelable)return!1}return!0}invalidate(){(0,n.k)(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const i=t&&t.config,r=(0,n.v)(i.options&&i.options.plugins,{}),s=function(t){const e={},i=[],n=Object.keys(Et.plugins.items);for(let t=0;t<n.length;t++)i.push(Et.getPlugin(n[t]));const r=t.plugins||[];for(let t=0;t<r.length;t++){const n=r[t];-1===i.indexOf(n)&&(i.push(n),e[n.id]=!0)}return{plugins:i,localIds:e}}(i);return!1!==r||e?function(t,{plugins:e,localIds:i},n,r){const s=[],o=t.getContext();for(const a of e){const e=a.id,l=Dt(n[e],r);null!==l&&s.push({plugin:a,options:zt(t.config,{plugin:a,local:i[e]},l,o)})}return s}(t,s,r,e):[]}_notifyStateChanges(t){const e=this._oldCache||[],i=this._cache,n=(t,e)=>t.filter((t=>!e.some((e=>t.plugin.id===e.plugin.id))));this._notify(n(e,i),t,"stop"),this._notify(n(i,e),t,"start")}}function Dt(t,e){return e||!1!==t?!0===t?{}:t:null}function zt(t,{plugin:e,local:i},n,r){const s=t.pluginScopeKeys(e),o=t.getOptionScopes(n,s);return i&&e.defaults&&o.push(e.defaults),t.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Pt(t,e){const i=n.d.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||i.indexAxis||"x"}function Lt(t){if("x"===t||"y"===t||"r"===t)return t}function Ft(t,...e){if(Lt(t))return t;for(const n of e){const e=n.axis||("top"===(i=n.position)||"bottom"===i?"x":"left"===i||"right"===i?"y":void 0)||t.length>1&&Lt(t[0].toLowerCase());if(e)return e}var i;throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function Rt(t,e,i){if(i[e+"AxisID"]===t)return{axis:e}}function Ot(t){const e=t.options||(t.options={});e.plugins=(0,n.v)(e.plugins,{}),e.scales=function(t,e){const i=n.a3[t.type]||{scales:{}},r=e.scales||{},s=Pt(t.type,e),o=Object.create(null);return Object.keys(r).forEach((e=>{const a=r[e];if(!(0,n.i)(a))return console.error(`Invalid scale configuration for scale: ${e}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${e}`);const l=Ft(e,a,function(t,e){if(e.data&&e.data.datasets){const i=e.data.datasets.filter((e=>e.xAxisID===t||e.yAxisID===t));if(i.length)return Rt(t,"x",i[0])||Rt(t,"y",i[0])}return{}}(e,t),n.d.scales[a.type]),c=function(t,e){return t===e?"_index_":"_value_"}(l,s),u=i.scales||{};o[e]=(0,n.ab)(Object.create(null),[{axis:l},a,u[l],u[c]])})),t.data.datasets.forEach((i=>{const s=i.type||t.type,a=i.indexAxis||Pt(s,e),l=(n.a3[s]||{}).scales||{};Object.keys(l).forEach((t=>{const e=function(t,e){let i=t;return"_index_"===t?i=e:"_value_"===t&&(i="x"===e?"y":"x"),i}(t,a),s=i[e+"AxisID"]||e;o[s]=o[s]||Object.create(null),(0,n.ab)(o[s],[{axis:e},r[s],l[t]])}))})),Object.keys(o).forEach((t=>{const e=o[t];(0,n.ab)(e,[n.d.scales[e.type],n.d.scale])})),o}(t,e)}function Bt(t){return(t=t||{}).datasets=t.datasets||[],t.labels=t.labels||[],t}const Vt=new Map,Nt=new Set;function qt(t,e){let i=Vt.get(t);return i||(i=e(),Vt.set(t,i),Nt.add(i)),i}const jt=(t,e,i)=>{const r=(0,n.f)(e,i);void 0!==r&&t.add(r)};class $t{constructor(t){this._config=function(t){return(t=t||{}).data=Bt(t.data),Ot(t),t}(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=Bt(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),Ot(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return qt(t,(()=>[[`datasets.${t}`,""]]))}datasetAnimationScopeKeys(t,e){return qt(`${t}.transition.${e}`,(()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]]))}datasetElementScopeKeys(t,e){return qt(`${t}-${e}`,(()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]]))}pluginScopeKeys(t){const e=t.id;return qt(`${this.type}-plugin-${e}`,(()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]]))}_cachedScopes(t,e){const i=this._scopeCache;let n=i.get(t);return n&&!e||(n=new Map,i.set(t,n)),n}getOptionScopes(t,e,i){const{options:r,type:s}=this,o=this._cachedScopes(t,i),a=o.get(e);if(a)return a;const l=new Set;e.forEach((e=>{t&&(l.add(t),e.forEach((e=>jt(l,t,e)))),e.forEach((t=>jt(l,r,t))),e.forEach((t=>jt(l,n.a3[s]||{},t))),e.forEach((t=>jt(l,n.d,t))),e.forEach((t=>jt(l,n.a6,t)))}));const c=Array.from(l);return 0===c.length&&c.push(Object.create(null)),Nt.has(e)&&o.set(e,c),c}chartOptionScopes(){const{options:t,type:e}=this;return[t,n.a3[e]||{},n.d.datasets[e]||{},{type:e},n.d,n.a6]}resolveNamedOptions(t,e,i,r=[""]){const s={$shared:!0},{resolver:o,subPrefixes:a}=Ut(this._resolverCache,t,r);let l=o;if(function(t,e){const{isScriptable:i,isIndexable:r}=(0,n.aa)(t);for(const s of e){const e=i(s),o=r(s),a=(o||e)&&t[s];if(e&&((0,n.a7)(a)||Zt(a))||o&&(0,n.b)(a))return!0}return!1}(o,e)){s.$shared=!1,i=(0,n.a7)(i)?i():i;const e=this.createResolver(t,i,a);l=(0,n.a8)(o,i,e)}for(const t of e)s[t]=l[t];return s}createResolver(t,e,i=[""],r){const{resolver:s}=Ut(this._resolverCache,t,i);return(0,n.i)(e)?(0,n.a8)(s,e,void 0,r):s}}function Ut(t,e,i){let r=t.get(e);r||(r=new Map,t.set(e,r));const s=i.join();let o=r.get(s);return o||(o={resolver:(0,n.a9)(e,i),subPrefixes:i.filter((t=>!t.toLowerCase().includes("hover")))},r.set(s,o)),o}const Zt=t=>(0,n.i)(t)&&Object.getOwnPropertyNames(t).some((e=>(0,n.a7)(t[e]))),Wt=["top","bottom","left","right","chartArea"];function Gt(t,e){return"top"===t||"bottom"===t||-1===Wt.indexOf(t)&&"x"===e}function Ht(t,e){return function(i,n){return i[t]===n[t]?i[e]-n[e]:i[t]-n[t]}}function Xt(t){const e=t.chart,i=e.options.animation;e.notifyPlugins("afterRender"),(0,n.Q)(i&&i.onComplete,[t],e)}function Yt(t){const e=t.chart,i=e.options.animation;(0,n.Q)(i&&i.onProgress,[t],e)}function Kt(t){return(0,n.M)()&&"string"==typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Jt={},Qt=t=>{const e=Kt(t);return Object.values(Jt).filter((t=>t.canvas===e)).pop()};function te(t,e,i){const n=Object.keys(t);for(const r of n){const n=+r;if(n>=e){const s=t[r];delete t[r],(i>0||n>e)&&(t[n+i]=s)}}}function ee(t,e,i){return t.options.clip?t[i]:e[i]}class ie{static defaults=n.d;static instances=Jt;static overrides=n.a3;static registry=Et;static version="4.4.2";static getChart=Qt;static register(...t){Et.add(...t),ne()}static unregister(...t){Et.remove(...t),ne()}constructor(t,e){const i=this.config=new $t(e),r=Kt(t),o=Qt(r);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const a=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||function(t){return!(0,n.M)()||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas?et:gt}(r)),this.platform.updateConfig(i);const l=this.platform.acquireContext(r,a.aspectRatio),c=l&&l.canvas,u=c&&c.height,h=c&&c.width;this.id=(0,n.ac)(),this.ctx=l,this.canvas=c,this.width=h,this.height=u,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new It,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=(0,n.ad)((t=>this.update(t)),a.resizeDelay||0),this._dataChanges=[],Jt[this.id]=this,l&&c?(s.listen(this,"complete",Xt),s.listen(this,"progress",Yt),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:i,height:r,_aspectRatio:s}=this;return(0,n.k)(t)?e&&s?s:r?i/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Et}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():(0,n.ae)(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return(0,n.af)(this.canvas,this.ctx),this}stop(){return s.stop(this),this}resize(t,e){s.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const i=this.options,r=this.canvas,s=i.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,t,e,s),a=i.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,(0,n.ae)(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),(0,n.Q)(i.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};(0,n.F)(t,((t,e)=>{t.id=e}))}buildOrUpdateScales(){const t=this.options,e=t.scales,i=this.scales,r=Object.keys(i).reduce(((t,e)=>(t[e]=!1,t)),{});let s=[];e&&(s=s.concat(Object.keys(e).map((t=>{const i=e[t],n=Ft(t,i),r="r"===n,s="x"===n;return{options:i,dposition:r?"chartArea":s?"bottom":"left",dtype:r?"radialLinear":s?"category":"linear"}})))),(0,n.F)(s,(e=>{const s=e.options,o=s.id,a=Ft(o,s),l=(0,n.v)(s.type,e.dtype);void 0!==s.position&&Gt(s.position,a)===Gt(e.dposition)||(s.position=e.dposition),r[o]=!0;let c=null;o in i&&i[o].type===l?c=i[o]:(c=new(Et.getScale(l))({id:o,type:l,ctx:this.ctx,chart:this}),i[c.id]=c),c.init(s,t)})),(0,n.F)(r,((t,e)=>{t||delete i[e]})),(0,n.F)(i,(t=>{Q.configure(this,t,t.options),Q.addBox(this,t)}))}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,i=t.length;if(t.sort(((t,e)=>t.index-e.index)),i>e){for(let t=e;t<i;++t)this._destroyDatasetMeta(t);t.splice(e,i-e)}this._sortedMetasets=t.slice(0).sort(Ht("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach(((t,i)=>{0===e.filter((e=>e===t._dataset)).length&&this._destroyDatasetMeta(i)}))}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let i,r;for(this._removeUnreferencedMetasets(),i=0,r=e.length;i<r;i++){const r=e[i];let s=this.getDatasetMeta(i);const o=r.type||this.config.type;if(s.type&&s.type!==o&&(this._destroyDatasetMeta(i),s=this.getDatasetMeta(i)),s.type=o,s.indexAxis=r.indexAxis||Pt(o,this.options),s.order=r.order||0,s.index=i,s.label=""+r.label,s.visible=this.isDatasetVisible(i),s.controller)s.controller.updateIndex(i),s.controller.linkScales();else{const e=Et.getController(o),{datasetElementType:r,dataElementType:a}=n.d.datasets[o];Object.assign(e,{dataElementType:Et.getElement(a),datasetElementType:r&&Et.getElement(r)}),s.controller=new e(this,i),t.push(s.controller)}}return this._updateMetasets(),t}_resetElements(){(0,n.F)(this.data.datasets,((t,e)=>{this.getDatasetMeta(e).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const i=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0}))return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let t=0,e=this.data.datasets.length;t<e;t++){const{controller:e}=this.getDatasetMeta(t),i=!r&&-1===s.indexOf(e);e.buildOrUpdateElements(i),o=Math.max(+e.getMaxOverflow(),o)}o=this._minPadding=i.layout.autoPadding?o:0,this._updateLayout(o),r||(0,n.F)(s,(t=>{t.reset()})),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Ht("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){(0,n.F)(this.scales,(t=>{Q.removeBox(this,t)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),i=new Set(t.events);(0,n.ag)(e,i)&&!!this._responsiveListeners===t.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:i,start:n,count:r}of e)te(t,n,"_removeElements"===i?-r:r)}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,i=e=>new Set(t.filter((t=>t[0]===e)).map(((t,e)=>e+","+t.splice(1).join(",")))),r=i(0);for(let t=1;t<e;t++)if(!(0,n.ag)(r,i(t)))return;return Array.from(r).map((t=>t.split(","))).map((t=>({method:t[1],start:+t[2],count:+t[3]})))}_updateLayout(t){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;Q.update(this,this.width,this.height,t);const e=this.chartArea,i=e.width<=0||e.height<=0;this._layers=[],(0,n.F)(this.boxes,(t=>{i&&"chartArea"===t.position||(t.configure&&t.configure(),this._layers.push(...t._layers()))}),this),this._layers.forEach(((t,e)=>{t._idx=e})),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})){for(let t=0,e=this.data.datasets.length;t<e;++t)this.getDatasetMeta(t).controller.configure();for(let e=0,i=this.data.datasets.length;e<i;++e)this._updateDataset(e,(0,n.a7)(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const i=this.getDatasetMeta(t),n={meta:i,index:t,mode:e,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",n)&&(i.controller._update(e),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(s.has(this)?this.attached&&!s.running(this)&&s.start(this):(this.draw(),Xt({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:t,height:e}=this._resizeBeforeDraw;this._resize(t,e),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,i=[];let n,r;for(n=0,r=e.length;n<r;++n){const r=e[n];t&&!r.visible||i.push(r)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,i=t._clip,r=!i.disabled,s=function(t,e){const{xScale:i,yScale:n}=t;return i&&n?{left:ee(i,e,"left"),right:ee(i,e,"right"),top:ee(n,e,"top"),bottom:ee(n,e,"bottom")}:e}(t,this.chartArea),o={meta:t,index:t.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",o)&&(r&&(0,n.Y)(e,{left:!1===i.left?0:s.left-i.left,right:!1===i.right?this.width:s.right+i.right,top:!1===i.top?0:s.top-i.top,bottom:!1===i.bottom?this.height:s.bottom+i.bottom}),t.controller.draw(),r&&(0,n.$)(e),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(t){return(0,n.C)(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,i,n){const r=q.modes[e];return"function"==typeof r?r(this,t,i,n):[]}getDatasetMeta(t){const e=this.data.datasets[t],i=this._metasets;let n=i.filter((t=>t&&t._dataset===e)).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},i.push(n)),n}getContext(){return this.$context||(this.$context=(0,n.j)(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const i=this.getDatasetMeta(t);return"boolean"==typeof i.hidden?!i.hidden:!e.hidden}setDatasetVisibility(t,e){this.getDatasetMeta(t).hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,i){const r=i?"show":"hide",s=this.getDatasetMeta(t),o=s.controller._resolveAnimations(void 0,r);(0,n.h)(e)?(s.data[e].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),o.update(s,{visible:i}),this.update((e=>e.datasetIndex===t?r:void 0)))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),s.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),(0,n.af)(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete Jt[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,i=(i,n)=>{e.addEventListener(this,i,n),t[i]=n},r=(t,e,i)=>{t.offsetX=e,t.offsetY=i,this._eventHandler(t)};(0,n.F)(this.options.events,(t=>i(t,r)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,i=(i,n)=>{e.addEventListener(this,i,n),t[i]=n},n=(i,n)=>{t[i]&&(e.removeEventListener(this,i,n),delete t[i])},r=(t,e)=>{this.canvas&&this.resize(t,e)};let s;const o=()=>{n("attach",o),this.attached=!0,this.resize(),i("resize",r),i("detach",s)};s=()=>{this.attached=!1,n("resize",r),this._stop(),this._resize(0,0),i("attach",o)},e.isAttached(this.canvas)?o():s()}unbindEvents(){(0,n.F)(this._listeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._listeners={},(0,n.F)(this._responsiveListeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._responsiveListeners=void 0}updateHoverStyle(t,e,i){const n=i?"set":"remove";let r,s,o,a;for("dataset"===e&&(r=this.getDatasetMeta(t[0].datasetIndex),r.controller["_"+n+"DatasetHoverStyle"]()),o=0,a=t.length;o<a;++o){s=t[o];const e=s&&this.getDatasetMeta(s.datasetIndex).controller;e&&e[n+"HoverStyle"](s.element,s.datasetIndex,s.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],i=t.map((({datasetIndex:t,index:e})=>{const i=this.getDatasetMeta(t);if(!i)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:i.data[e],index:e}}));!(0,n.ah)(i,e)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,e))}notifyPlugins(t,e,i){return this._plugins.notify(this,t,e,i)}isPluginEnabled(t){return 1===this._plugins._cache.filter((e=>e.plugin.id===t)).length}_updateHoverStyles(t,e,i){const n=this.options.hover,r=(t,e)=>t.filter((t=>!e.some((e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)))),s=r(e,t),o=i?t:r(t,e);s.length&&this.updateHoverStyle(s,n.mode,!1),o.length&&n.mode&&this.updateHoverStyle(o,n.mode,!0)}_eventHandler(t,e){const i={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},n=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",i,n))return;const r=this._handleEvent(t,e,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,n),(r||i.changed)&&this.render(),this}_handleEvent(t,e,i){const{_active:r=[],options:s}=this,o=e,a=this._getActiveElements(t,r,i,o),l=(0,n.ai)(t),c=function(t,e,i,n){return i&&"mouseout"!==t.type?n?e:t:null}(t,this._lastEvent,i,l);i&&(this._lastEvent=null,(0,n.Q)(s.onHover,[t,a,this],this),l&&(0,n.Q)(s.onClick,[t,a,this],this));const u=!(0,n.ah)(a,r);return(u||e)&&(this._active=a,this._updateHoverStyles(a,r,e)),this._lastEvent=c,u}_getActiveElements(t,e,i,n){if("mouseout"===t.type)return[];if(!i)return e;const r=this.options.hover;return this.getElementsAtEventForMode(t,r.mode,r,n)}}function ne(){return(0,n.F)(ie.instances,(t=>t._plugins.invalidate()))}function re(t,e,i,n){return{x:i+t*Math.cos(e),y:n+t*Math.sin(e)}}function se(t,e,i,r,s,o){const{x:a,y:l,startAngle:c,pixelMargin:u,innerRadius:h}=e,d=Math.max(e.outerRadius+r+i-u,0),p=h>0?h+r+i+u:0;let f=0;const m=s-c;if(r){const t=((h>0?h-r:0)+(d>0?d-r:0))/2;f=(m-(0!==t?m*t/(t+r):m))/2}const g=(m-Math.max(.001,m*d-i/n.P)/d)/2,_=c+g+f,y=s-g-f,{outerStart:x,outerEnd:v,innerStart:b,innerEnd:w}=function(t,e,i,r){const s=(o=t.options.borderRadius,(0,n.ak)(o,["outerStart","outerEnd","innerStart","innerEnd"]));var o;const a=(i-e)/2,l=Math.min(a,r*e/2),c=t=>{const e=(i-Math.min(a,t))*r/2;return(0,n.S)(t,0,Math.min(a,e))};return{outerStart:c(s.outerStart),outerEnd:c(s.outerEnd),innerStart:(0,n.S)(s.innerStart,0,l),innerEnd:(0,n.S)(s.innerEnd,0,l)}}(e,p,d,y-_),k=d-x,S=d-v,T=_+x/k,A=y-v/S,M=p+b,C=p+w,E=_+b/M,I=y-w/C;if(t.beginPath(),o){const e=(T+A)/2;if(t.arc(a,l,d,T,e),t.arc(a,l,d,e,A),v>0){const e=re(S,A,a,l);t.arc(e.x,e.y,v,A,y+n.H)}const i=re(C,y,a,l);if(t.lineTo(i.x,i.y),w>0){const e=re(C,I,a,l);t.arc(e.x,e.y,w,y+n.H,I+Math.PI)}const r=(y-w/p+(_+b/p))/2;if(t.arc(a,l,p,y-w/p,r,!0),t.arc(a,l,p,r,_+b/p,!0),b>0){const e=re(M,E,a,l);t.arc(e.x,e.y,b,E+Math.PI,_-n.H)}const s=re(k,_,a,l);if(t.lineTo(s.x,s.y),x>0){const e=re(k,T,a,l);t.arc(e.x,e.y,x,_-n.H,T)}}else{t.moveTo(a,l);const e=Math.cos(T)*d+a,i=Math.sin(T)*d+l;t.lineTo(e,i);const n=Math.cos(A)*d+a,r=Math.sin(A)*d+l;t.lineTo(n,r)}t.closePath()}class oe extends _t{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>"borderDash"!==t};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,i){const r=this.getProps(["x","y"],i),{angle:s,distance:o}=(0,n.D)(r,{x:t,y:e}),{startAngle:a,endAngle:l,innerRadius:c,outerRadius:u,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),d=(this.options.spacing+this.options.borderWidth)/2,p=(0,n.v)(h,l-a)>=n.T||(0,n.p)(s,a,l),f=(0,n.aj)(o,c+d,u+d);return p&&f}getCenterPoint(t){const{x:e,y:i,startAngle:n,endAngle:r,innerRadius:s,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:a,spacing:l}=this.options,c=(n+r)/2,u=(s+o+l+a)/2;return{x:e+Math.cos(c)*u,y:i+Math.sin(c)*u}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:i}=this,r=(e.offset||0)/4,s=(e.spacing||0)/2,o=e.circular;if(this.pixelMargin="inner"===e.borderAlign?.33:0,this.fullCircles=i>n.T?Math.floor(i/n.T):0,0===i||this.innerRadius<0||this.outerRadius<0)return;t.save();const a=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(a)*r,Math.sin(a)*r);const l=r*(1-Math.sin(Math.min(n.P,i||0)));t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,function(t,e,i,r,s){const{fullCircles:o,startAngle:a,circumference:l}=e;let c=e.endAngle;if(o){se(t,e,i,r,c,s);for(let e=0;e<o;++e)t.fill();isNaN(l)||(c=a+(l%n.T||n.T))}se(t,e,i,r,c,s),t.fill()}(t,this,l,s,o),function(t,e,i,r,s){const{fullCircles:o,startAngle:a,circumference:l,options:c}=e,{borderWidth:u,borderJoinStyle:h,borderDash:d,borderDashOffset:p}=c,f="inner"===c.borderAlign;if(!u)return;t.setLineDash(d||[]),t.lineDashOffset=p,f?(t.lineWidth=2*u,t.lineJoin=h||"round"):(t.lineWidth=u,t.lineJoin=h||"bevel");let m=e.endAngle;if(o){se(t,e,i,r,m,s);for(let e=0;e<o;++e)t.stroke();isNaN(l)||(m=a+(l%n.T||n.T))}f&&function(t,e,i){const{startAngle:r,pixelMargin:s,x:o,y:a,outerRadius:l,innerRadius:c}=e;let u=s/l;t.beginPath(),t.arc(o,a,l,r-u,i+u),c>s?(u=s/c,t.arc(o,a,c,i+u,r-u,!0)):t.arc(o,a,s,i+n.H,r-n.H),t.closePath(),t.clip()}(t,e,m),o||(se(t,e,i,r,m,s),t.stroke())}(t,this,l,s,o),t.restore()}}function ae(t,e,i=e){t.lineCap=(0,n.v)(i.borderCapStyle,e.borderCapStyle),t.setLineDash((0,n.v)(i.borderDash,e.borderDash)),t.lineDashOffset=(0,n.v)(i.borderDashOffset,e.borderDashOffset),t.lineJoin=(0,n.v)(i.borderJoinStyle,e.borderJoinStyle),t.lineWidth=(0,n.v)(i.borderWidth,e.borderWidth),t.strokeStyle=(0,n.v)(i.borderColor,e.borderColor)}function le(t,e,i){t.lineTo(i.x,i.y)}function ce(t,e,i={}){const n=t.length,{start:r=0,end:s=n-1}=i,{start:o,end:a}=e,l=Math.max(r,o),c=Math.min(s,a),u=r<o&&s<o||r>a&&s>a;return{count:n,start:l,loop:e.loop,ilen:c<l&&!u?n+c-l:c-l}}function ue(t,e,i,r){const{points:s,options:o}=e,{count:a,start:l,loop:c,ilen:u}=ce(s,i,r),h=function(t){return t.stepped?n.ar:t.tension||"monotone"===t.cubicInterpolationMode?n.as:le}(o);let d,p,f,{move:m=!0,reverse:g}=r||{};for(d=0;d<=u;++d)p=s[(l+(g?u-d:d))%a],p.skip||(m?(t.moveTo(p.x,p.y),m=!1):h(t,f,p,g,o.stepped),f=p);return c&&(p=s[(l+(g?u:0))%a],h(t,f,p,g,o.stepped)),!!c}function he(t,e,i,n){const r=e.points,{count:s,start:o,ilen:a}=ce(r,i,n),{move:l=!0,reverse:c}=n||{};let u,h,d,p,f,m,g=0,_=0;const y=t=>(o+(c?a-t:t))%s,x=()=>{p!==f&&(t.lineTo(g,f),t.lineTo(g,p),t.lineTo(g,m))};for(l&&(h=r[y(0)],t.moveTo(h.x,h.y)),u=0;u<=a;++u){if(h=r[y(u)],h.skip)continue;const e=h.x,i=h.y,n=0|e;n===d?(i<p?p=i:i>f&&(f=i),g=(_*g+e)/++_):(x(),t.lineTo(e,i),d=n,_=0,p=f=i),m=i}x()}function de(t){const e=t.options,i=e.borderDash&&e.borderDash.length;return t._decimated||t._loop||e.tension||"monotone"===e.cubicInterpolationMode||e.stepped||i?ue:he}const pe="function"==typeof Path2D;class fe extends _t{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>"borderDash"!==t&&"fill"!==t};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const i=this.options;if((i.tension||"monotone"===i.cubicInterpolationMode)&&!i.stepped&&!this._pointsUpdated){const r=i.spanGaps?this._loop:this._fullLoop;(0,n.al)(this._points,i,t,r,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=(0,n.am)(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,i=t.length;return i&&e[t[i-1].end]}interpolate(t,e){const i=this.options,r=t[e],s=this.points,o=(0,n.an)(this,{property:e,start:r,end:r});if(!o.length)return;const a=[],l=function(t){return t.stepped?n.ao:t.tension||"monotone"===t.cubicInterpolationMode?n.ap:n.aq}(i);let c,u;for(c=0,u=o.length;c<u;++c){const{start:n,end:u}=o[c],h=s[n],d=s[u];if(h===d){a.push(h);continue}const p=l(h,d,Math.abs((r-h[e])/(d[e]-h[e])),i.stepped);p[e]=t[e],a.push(p)}return 1===a.length?a[0]:a}pathSegment(t,e,i){return de(this)(t,this,e,i)}path(t,e,i){const n=this.segments,r=de(this);let s=this._loop;e=e||0,i=i||this.points.length-e;for(const o of n)s&=r(t,this,o,{start:e,end:e+i-1});return!!s}draw(t,e,i,n){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(t.save(),function(t,e,i,n){pe&&!e.options.segment?function(t,e,i,n){let r=e._path;r||(r=e._path=new Path2D,e.path(r,i,n)&&r.closePath()),ae(t,e.options),t.stroke(r)}(t,e,i,n):function(t,e,i,n){const{segments:r,options:s}=e,o=de(e);for(const a of r)ae(t,s,a.style),t.beginPath(),o(t,e,a,{start:i,end:i+n-1})&&t.closePath(),t.stroke()}(t,e,i,n)}(t,this,i,n),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function me(t,e,i,n){const r=t.options,{[i]:s}=t.getProps([i],n);return Math.abs(e-s)<r.radius+r.hitRadius}class ge extends _t{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,i){const n=this.options,{x:r,y:s}=this.getProps(["x","y"],i);return Math.pow(t-r,2)+Math.pow(e-s,2)<Math.pow(n.hitRadius+n.radius,2)}inXRange(t,e){return me(this,t,"x",e)}inYRange(t,e){return me(this,t,"y",e)}getCenterPoint(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}size(t){let e=(t=t||this.options||{}).radius||0;return e=Math.max(e,e&&t.hoverRadius||0),2*(e+(e&&t.borderWidth||0))}draw(t,e){const i=this.options;this.skip||i.radius<.1||!(0,n.C)(this,e,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,(0,n.at)(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function _e(t,e){const{x:i,y:n,base:r,width:s,height:o}=t.getProps(["x","y","base","width","height"],e);let a,l,c,u,h;return t.horizontal?(h=o/2,a=Math.min(i,r),l=Math.max(i,r),c=n-h,u=n+h):(h=s/2,a=i-h,l=i+h,c=Math.min(n,r),u=Math.max(n,r)),{left:a,top:c,right:l,bottom:u}}function ye(t,e,i,r){return t?0:(0,n.S)(e,i,r)}function xe(t,e,i,r){const s=null===e,o=null===i,a=t&&!(s&&o)&&_e(t,r);return a&&(s||(0,n.aj)(e,a.left,a.right))&&(o||(0,n.aj)(i,a.top,a.bottom))}function ve(t,e){t.rect(e.x,e.y,e.w,e.h)}function be(t,e,i={}){const n=t.x!==i.x?-e:0,r=t.y!==i.y?-e:0,s=(t.x+t.w!==i.x+i.w?e:0)-n,o=(t.y+t.h!==i.y+i.h?e:0)-r;return{x:t.x+n,y:t.y+r,w:t.w+s,h:t.h+o,radius:t.radius}}class we extends _t{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:i,backgroundColor:r}}=this,{inner:s,outer:o}=function(t){const e=_e(t),i=e.right-e.left,r=e.bottom-e.top,s=function(t,e,i){const r=t.options.borderWidth,s=t.borderSkipped,o=(0,n.av)(r);return{t:ye(s.top,o.top,0,i),r:ye(s.right,o.right,0,e),b:ye(s.bottom,o.bottom,0,i),l:ye(s.left,o.left,0,e)}}(t,i/2,r/2),o=function(t,e,i){const{enableBorderRadius:r}=t.getProps(["enableBorderRadius"]),s=t.options.borderRadius,o=(0,n.aw)(s),a=Math.min(e,i),l=t.borderSkipped,c=r||(0,n.i)(s);return{topLeft:ye(!c||l.top||l.left,o.topLeft,0,a),topRight:ye(!c||l.top||l.right,o.topRight,0,a),bottomLeft:ye(!c||l.bottom||l.left,o.bottomLeft,0,a),bottomRight:ye(!c||l.bottom||l.right,o.bottomRight,0,a)}}(t,i/2,r/2);return{outer:{x:e.left,y:e.top,w:i,h:r,radius:o},inner:{x:e.left+s.l,y:e.top+s.t,w:i-s.l-s.r,h:r-s.t-s.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,o.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(s.b,s.r))}}}}(this),a=(l=o.radius).topLeft||l.topRight||l.bottomLeft||l.bottomRight?n.au:ve;var l;t.save(),o.w===s.w&&o.h===s.h||(t.beginPath(),a(t,be(o,e,s)),t.clip(),a(t,be(s,-e,o)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),a(t,be(s,e)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,e,i){return xe(this,t,e,i)}inXRange(t,e){return xe(this,t,null,e)}inYRange(t,e){return xe(this,null,t,e)}getCenterPoint(t){const{x:e,y:i,base:n,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(e+n)/2:e,y:r?i:(i+n)/2}}getRange(t){return"x"===t?this.width/2:this.height/2}}var ke=Object.freeze({__proto__:null,ArcElement:oe,BarElement:we,LineElement:fe,PointElement:ge});const Se=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],Te=Se.map((t=>t.replace("rgb(","rgba(").replace(")",", 0.5)")));function Ae(t){return Se[t%Se.length]}function Me(t){return Te[t%Te.length]}function Ce(t){let e;for(e in t)if(t[e].borderColor||t[e].backgroundColor)return!0;return!1}var Ee={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,e,i){if(!i.enabled)return;const{data:{datasets:n},options:r}=t.config,{elements:s}=r;if(!i.forceOverride&&(Ce(n)||(o=r)&&(o.borderColor||o.backgroundColor)||s&&Ce(s)))return;var o;const a=function(t){let e=0;return(i,n)=>{const r=t.getDatasetMeta(n).controller;r instanceof I?e=function(t,e){return t.backgroundColor=t.data.map((()=>Ae(e++))),e}(i,e):r instanceof D?e=function(t,e){return t.backgroundColor=t.data.map((()=>Me(e++))),e}(i,e):r&&(e=function(t,e){return t.borderColor=Ae(e),t.backgroundColor=Me(e),++e}(i,e))}}(t);n.forEach(a)}};function Ie(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function De(t){t.data.datasets.forEach((t=>{Ie(t)}))}var ze={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,i)=>{if(!i.enabled)return void De(t);const r=t.width;t.data.datasets.forEach(((e,s)=>{const{_data:o,indexAxis:a}=e,l=t.getDatasetMeta(s),c=o||e.data;if("y"===(0,n.a)([a,t.options.indexAxis]))return;if(!l.controller.supportsDecimation)return;const u=t.scales[l.xAxisID];if("linear"!==u.type&&"time"!==u.type)return;if(t.options.parsing)return;let h,{start:d,count:p}=function(t,e){const i=e.length;let r,s=0;const{iScale:o}=t,{min:a,max:l,minDefined:c,maxDefined:u}=o.getUserBounds();return c&&(s=(0,n.S)((0,n.B)(e,o.axis,a).lo,0,i-1)),r=u?(0,n.S)((0,n.B)(e,o.axis,l).hi+1,s,i)-s:i-s,{start:s,count:r}}(l,c);if(p<=(i.threshold||4*r))Ie(e);else{switch((0,n.k)(o)&&(e._data=c,delete e.data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(t){this._data=t}})),i.algorithm){case"lttb":h=function(t,e,i,n,r){const s=r.samples||n;if(s>=i)return t.slice(e,e+i);const o=[],a=(i-2)/(s-2);let l=0;const c=e+i-1;let u,h,d,p,f,m=e;for(o[l++]=t[m],u=0;u<s-2;u++){let n,r=0,s=0;const c=Math.floor((u+1)*a)+1+e,g=Math.min(Math.floor((u+2)*a)+1,i)+e,_=g-c;for(n=c;n<g;n++)r+=t[n].x,s+=t[n].y;r/=_,s/=_;const y=Math.floor(u*a)+1+e,x=Math.min(Math.floor((u+1)*a)+1,i)+e,{x:v,y:b}=t[m];for(d=p=-1,n=y;n<x;n++)p=.5*Math.abs((v-r)*(t[n].y-b)-(v-t[n].x)*(s-b)),p>d&&(d=p,h=t[n],f=n);o[l++]=h,m=f}return o[l++]=t[c],o}(c,d,p,r,i);break;case"min-max":h=function(t,e,i,r){let s,o,a,l,c,u,h,d,p,f,m=0,g=0;const _=[],y=e+i-1,x=t[e].x,v=t[y].x-x;for(s=e;s<e+i;++s){o=t[s],a=(o.x-x)/v*r,l=o.y;const e=0|a;if(e===c)l<p?(p=l,u=s):l>f&&(f=l,h=s),m=(g*m+o.x)/++g;else{const i=s-1;if(!(0,n.k)(u)&&!(0,n.k)(h)){const e=Math.min(u,h),n=Math.max(u,h);e!==d&&e!==i&&_.push({...t[e],x:m}),n!==d&&n!==i&&_.push({...t[n],x:m})}s>0&&i!==d&&_.push(t[i]),_.push(o),c=e,g=0,p=f=l,u=h=d=s}}return _}(c,d,p,r);break;default:throw new Error(`Unsupported decimation algorithm '${i.algorithm}'`)}e._decimated=h}}))},destroy(t){De(t)}};function Pe(t,e,i,r){if(r)return;let s=e[t],o=i[t];return"angle"===t&&(s=(0,n.ay)(s),o=(0,n.ay)(o)),{property:t,start:s,end:o}}function Le(t,e,i){for(;e>t;e--){const t=i[e];if(!isNaN(t.x)&&!isNaN(t.y))break}return e}function Fe(t,e,i,n){return t&&e?n(t[i],e[i]):t?t[i]:e?e[i]:0}function Re(t,e){let i=[],r=!1;return(0,n.b)(t)?(r=!0,i=t):i=function(t,e){const{x:i=null,y:n=null}=t||{},r=e.points,s=[];return e.segments.forEach((({start:t,end:e})=>{e=Le(t,e,r);const o=r[t],a=r[e];null!==n?(s.push({x:o.x,y:n}),s.push({x:a.x,y:n})):null!==i&&(s.push({x:i,y:o.y}),s.push({x:i,y:a.y}))})),s}(t,e),i.length?new fe({points:i,options:{tension:0},_loop:r,_fullLoop:r}):null}function Oe(t){return t&&!1!==t.fill}function Be(t,e,i){let r=t[e].fill;const s=[e];let o;if(!i)return r;for(;!1!==r&&-1===s.indexOf(r);){if(!(0,n.g)(r))return r;if(o=t[r],!o)return!1;if(o.visible)return r;s.push(r),r=o.fill}return!1}function Ve(t,e,i){const r=function(t){const e=t.options,i=e.fill;let r=(0,n.v)(i&&i.target,i);return void 0===r&&(r=!!e.backgroundColor),!1!==r&&null!==r&&(!0===r?"origin":r)}(t);if((0,n.i)(r))return!isNaN(r.value)&&r;let s=parseFloat(r);return(0,n.g)(s)&&Math.floor(s)===s?function(t,e,i,n){return"-"!==t&&"+"!==t||(i=e+i),!(i===e||i<0||i>=n)&&i}(r[0],e,s,i):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function Ne(t,e,i){const n=[];for(let r=0;r<i.length;r++){const s=i[r],{first:o,last:a,point:l}=qe(s,e,"x");if(!(!l||o&&a))if(o)n.unshift(l);else if(t.push(l),!a)break}t.push(...n)}function qe(t,e,i){const r=t.interpolate(e,i);if(!r)return{};const s=r[i],o=t.segments,a=t.points;let l=!1,c=!1;for(let t=0;t<o.length;t++){const e=o[t],r=a[e.start][i],u=a[e.end][i];if((0,n.aj)(s,r,u)){l=s===r,c=s===u;break}}return{first:l,last:c,point:r}}class je{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,i){const{x:r,y:s,radius:o}=this;return e=e||{start:0,end:n.T},t.arc(r,s,o,e.end,e.start,!0),!i.bounds}interpolate(t){const{x:e,y:i,radius:n}=this,r=t.angle;return{x:e+Math.cos(r)*n,y:i+Math.sin(r)*n,angle:r}}}function $e(t,e,i){const r=function(t){const{chart:e,fill:i,line:r}=t;if((0,n.g)(i))return function(t,e){const i=t.getDatasetMeta(e);return i&&t.isDatasetVisible(e)?i.dataset:null}(e,i);if("stack"===i)return function(t){const{scale:e,index:i,line:n}=t,r=[],s=n.segments,o=n.points,a=function(t,e){const i=[],n=t.getMatchingVisibleMetas("line");for(let t=0;t<n.length;t++){const r=n[t];if(r.index===e)break;r.hidden||i.unshift(r.dataset)}return i}(e,i);a.push(Re({x:null,y:e.bottom},n));for(let t=0;t<s.length;t++){const e=s[t];for(let t=e.start;t<=e.end;t++)Ne(r,o[t],a)}return new fe({points:r,options:{}})}(t);if("shape"===i)return!0;const s=function(t){return(t.scale||{}).getPointPositionForValue?function(t){const{scale:e,fill:i}=t,r=e.options,s=e.getLabels().length,o=r.reverse?e.max:e.min,a=function(t,e,i){let r;return r="start"===t?i:"end"===t?e.options.reverse?e.min:e.max:(0,n.i)(t)?t.value:e.getBaseValue(),r}(i,e,o),l=[];if(r.grid.circular){const t=e.getPointPositionForValue(0,o);return new je({x:t.x,y:t.y,radius:e.getDistanceFromCenterForValue(a)})}for(let t=0;t<s;++t)l.push(e.getPointPositionForValue(t,a));return l}(t):function(t){const{scale:e={},fill:i}=t,r=function(t,e){let i=null;return"start"===t?i=e.bottom:"end"===t?i=e.top:(0,n.i)(t)?i=e.getPixelForValue(t.value):e.getBasePixel&&(i=e.getBasePixel()),i}(i,e);if((0,n.g)(r)){const t=e.isHorizontal();return{x:t?r:null,y:t?null:r}}return null}(t)}(t);return s instanceof je?s:Re(s,r)}(e),{line:s,scale:o,axis:a}=e,l=s.options,c=l.fill,u=l.backgroundColor,{above:h=u,below:d=u}=c||{};r&&s.points.length&&((0,n.Y)(t,i),function(t,e){const{line:i,target:n,above:r,below:s,area:o,scale:a}=e,l=i._loop?"angle":e.axis;t.save(),"x"===l&&s!==r&&(Ue(t,n,o.top),Ze(t,{line:i,target:n,color:r,scale:a,property:l}),t.restore(),t.save(),Ue(t,n,o.bottom)),Ze(t,{line:i,target:n,color:s,scale:a,property:l}),t.restore()}(t,{line:s,target:r,above:h,below:d,area:i,scale:o,axis:a}),(0,n.$)(t))}function Ue(t,e,i){const{segments:n,points:r}=e;let s=!0,o=!1;t.beginPath();for(const a of n){const{start:n,end:l}=a,c=r[n],u=r[Le(n,l,r)];s?(t.moveTo(c.x,c.y),s=!1):(t.lineTo(c.x,i),t.lineTo(c.x,c.y)),o=!!e.pathSegment(t,a,{move:o}),o?t.closePath():t.lineTo(u.x,i)}t.lineTo(e.first().x,i),t.closePath(),t.clip()}function Ze(t,e){const{line:i,target:r,property:s,color:o,scale:a}=e,l=function(t,e,i){const r=t.segments,s=t.points,o=e.points,a=[];for(const t of r){let{start:r,end:l}=t;l=Le(r,l,s);const c=Pe(i,s[r],s[l],t.loop);if(!e.segments){a.push({source:t,target:c,start:s[r],end:s[l]});continue}const u=(0,n.an)(e,c);for(const e of u){const r=Pe(i,o[e.start],o[e.end],e.loop),l=(0,n.ax)(t,s,r);for(const t of l)a.push({source:t,target:e,start:{[i]:Fe(c,r,"start",Math.max)},end:{[i]:Fe(c,r,"end",Math.min)}})}}return a}(i,r,s);for(const{source:e,target:n,start:c,end:u}of l){const{style:{backgroundColor:l=o}={}}=e,h=!0!==r;t.save(),t.fillStyle=l,We(t,a,h&&Pe(s,c,u)),t.beginPath();const d=!!i.pathSegment(t,e);let p;if(h){d?t.closePath():Ge(t,r,u,s);const e=!!r.pathSegment(t,n,{move:d,reverse:!0});p=d&&e,p||Ge(t,r,c,s)}t.closePath(),t.fill(p?"evenodd":"nonzero"),t.restore()}}function We(t,e,i){const{top:n,bottom:r}=e.chart.chartArea,{property:s,start:o,end:a}=i||{};"x"===s&&(t.beginPath(),t.rect(o,n,a-o,r-n),t.clip())}function Ge(t,e,i,n){const r=e.interpolate(i,n);r&&t.lineTo(r.x,r.y)}var He={id:"filler",afterDatasetsUpdate(t,e,i){const n=(t.data.datasets||[]).length,r=[];let s,o,a,l;for(o=0;o<n;++o)s=t.getDatasetMeta(o),a=s.dataset,l=null,a&&a.options&&a instanceof fe&&(l={visible:t.isDatasetVisible(o),index:o,fill:Ve(a,o,n),chart:t,axis:s.controller.options.indexAxis,scale:s.vScale,line:a}),s.$filler=l,r.push(l);for(o=0;o<n;++o)l=r[o],l&&!1!==l.fill&&(l.fill=Be(r,o,i.propagate))},beforeDraw(t,e,i){const n="beforeDraw"===i.drawTime,r=t.getSortedVisibleDatasetMetas(),s=t.chartArea;for(let e=r.length-1;e>=0;--e){const i=r[e].$filler;i&&(i.line.updateControlPoints(s,i.axis),n&&i.fill&&$e(t.ctx,i,s))}},beforeDatasetsDraw(t,e,i){if("beforeDatasetsDraw"!==i.drawTime)return;const n=t.getSortedVisibleDatasetMetas();for(let e=n.length-1;e>=0;--e){const i=n[e].$filler;Oe(i)&&$e(t.ctx,i,t.chartArea)}},beforeDatasetDraw(t,e,i){const n=e.meta.$filler;Oe(n)&&"beforeDatasetDraw"===i.drawTime&&$e(t.ctx,n,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Xe=(t,e)=>{let{boxHeight:i=e,boxWidth:n=e}=t;return t.usePointStyle&&(i=Math.min(i,e),n=t.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:i,itemHeight:Math.max(e,i)}};class Ye extends _t{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,i){this.maxWidth=t,this.maxHeight=e,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=(0,n.Q)(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter((e=>t.filter(e,this.chart.data)))),t.sort&&(e=e.sort(((e,i)=>t.sort(e,i,this.chart.data)))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display)return void(this.width=this.height=0);const i=t.labels,r=(0,n.a0)(i.font),s=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=Xe(i,s);let c,u;e.font=r.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(o,s,a,l)+10):(u=this.maxHeight,c=this._fitCols(o,r,a,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(u,t.maxHeight||this.maxHeight)}_fitRows(t,e,i,n){const{ctx:r,maxWidth:s,options:{labels:{padding:o}}}=this,a=this.legendHitBoxes=[],l=this.lineWidths=[0],c=n+o;let u=t;r.textAlign="left",r.textBaseline="middle";let h=-1,d=-c;return this.legendItems.forEach(((t,p)=>{const f=i+e/2+r.measureText(t.text).width;(0===p||l[l.length-1]+f+2*o>s)&&(u+=c,l[l.length-(p>0?0:1)]=0,d+=c,h++),a[p]={left:0,top:d,row:h,width:f,height:n},l[l.length-1]+=f+o})),u}_fitCols(t,e,i,n){const{ctx:r,maxHeight:s,options:{labels:{padding:o}}}=this,a=this.legendHitBoxes=[],l=this.columnSizes=[],c=s-t;let u=o,h=0,d=0,p=0,f=0;return this.legendItems.forEach(((t,s)=>{const{itemWidth:m,itemHeight:g}=function(t,e,i,n,r){const s=function(t,e,i,n){let r=t.text;return r&&"string"!=typeof r&&(r=r.reduce(((t,e)=>t.length>e.length?t:e))),e+i.size/2+n.measureText(r).width}(n,t,e,i),o=function(t,e,i){let n=t;return"string"!=typeof e.text&&(n=Ke(e,i)),n}(r,n,e.lineHeight);return{itemWidth:s,itemHeight:o}}(i,e,r,t,n);s>0&&d+g+2*o>c&&(u+=h+o,l.push({width:h,height:d}),p+=h+o,f++,h=d=0),a[s]={left:p,top:d,col:f,width:m,height:g},h=Math.max(h,m),d+=g+o})),u+=h,l.push({width:h,height:d}),u}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:i,labels:{padding:r},rtl:s}}=this,o=(0,n.az)(s,this.left,this.width);if(this.isHorizontal()){let s=0,a=(0,n.a2)(i,this.left+r,this.right-this.lineWidths[s]);for(const l of e)s!==l.row&&(s=l.row,a=(0,n.a2)(i,this.left+r,this.right-this.lineWidths[s])),l.top+=this.top+t+r,l.left=o.leftForLtr(o.x(a),l.width),a+=l.width+r}else{let s=0,a=(0,n.a2)(i,this.top+t+r,this.bottom-this.columnSizes[s].height);for(const l of e)l.col!==s&&(s=l.col,a=(0,n.a2)(i,this.top+t+r,this.bottom-this.columnSizes[s].height)),l.top=a,l.left+=this.left+r,l.left=o.leftForLtr(o.x(l.left),l.width),a+=l.height+r}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const t=this.ctx;(0,n.Y)(t,this),this._draw(),(0,n.$)(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:i,ctx:r}=this,{align:s,labels:o}=t,a=n.d.color,l=(0,n.az)(t.rtl,this.left,this.width),c=(0,n.a0)(o.font),{padding:u}=o,h=c.size,d=h/2;let p;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;const{boxWidth:f,boxHeight:m,itemHeight:g}=Xe(o,h),_=this.isHorizontal(),y=this._computeTitleHeight();p=_?{x:(0,n.a2)(s,this.left+u,this.right-i[0]),y:this.top+u+y,line:0}:{x:this.left+u,y:(0,n.a2)(s,this.top+y+u,this.bottom-e[0].height),line:0},(0,n.aA)(this.ctx,t.textDirection);const x=g+u;this.legendItems.forEach(((v,b)=>{r.strokeStyle=v.fontColor,r.fillStyle=v.fontColor;const w=r.measureText(v.text).width,k=l.textAlign(v.textAlign||(v.textAlign=o.textAlign)),S=f+d+w;let T=p.x,A=p.y;if(l.setWidth(this.width),_?b>0&&T+S+u>this.right&&(A=p.y+=x,p.line++,T=p.x=(0,n.a2)(s,this.left+u,this.right-i[p.line])):b>0&&A+x>this.bottom&&(T=p.x=T+e[p.line].width+u,p.line++,A=p.y=(0,n.a2)(s,this.top+y+u,this.bottom-e[p.line].height)),function(t,e,i){if(isNaN(f)||f<=0||isNaN(m)||m<0)return;r.save();const s=(0,n.v)(i.lineWidth,1);if(r.fillStyle=(0,n.v)(i.fillStyle,a),r.lineCap=(0,n.v)(i.lineCap,"butt"),r.lineDashOffset=(0,n.v)(i.lineDashOffset,0),r.lineJoin=(0,n.v)(i.lineJoin,"miter"),r.lineWidth=s,r.strokeStyle=(0,n.v)(i.strokeStyle,a),r.setLineDash((0,n.v)(i.lineDash,[])),o.usePointStyle){const a={radius:m*Math.SQRT2/2,pointStyle:i.pointStyle,rotation:i.rotation,borderWidth:s},c=l.xPlus(t,f/2),u=e+d;(0,n.aD)(r,a,c,u,o.pointStyleWidth&&f)}else{const o=e+Math.max((h-m)/2,0),a=l.leftForLtr(t,f),c=(0,n.aw)(i.borderRadius);r.beginPath(),Object.values(c).some((t=>0!==t))?(0,n.au)(r,{x:a,y:o,w:f,h:m,radius:c}):r.rect(a,o,f,m),r.fill(),0!==s&&r.stroke()}r.restore()}(l.x(T),A,v),T=(0,n.aB)(k,T+f+d,_?T+S:this.right,t.rtl),function(t,e,i){(0,n.Z)(r,i.text,t,e+g/2,c,{strikethrough:i.hidden,textAlign:l.textAlign(i.textAlign)})}(l.x(T),A,v),_)p.x+=S+u;else if("string"!=typeof v.text){const t=c.lineHeight;p.y+=Ke(v,t)+u}else p.y+=x})),(0,n.aC)(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,i=(0,n.a0)(e.font),r=(0,n.E)(e.padding);if(!e.display)return;const s=(0,n.az)(t.rtl,this.left,this.width),o=this.ctx,a=e.position,l=i.size/2,c=r.top+l;let u,h=this.left,d=this.width;if(this.isHorizontal())d=Math.max(...this.lineWidths),u=this.top+c,h=(0,n.a2)(t.align,h,this.right-d);else{const e=this.columnSizes.reduce(((t,e)=>Math.max(t,e.height)),0);u=c+(0,n.a2)(t.align,this.top,this.bottom-e-t.labels.padding-this._computeTitleHeight())}const p=(0,n.a2)(a,h,h+d);o.textAlign=s.textAlign((0,n.a1)(a)),o.textBaseline="middle",o.strokeStyle=e.color,o.fillStyle=e.color,o.font=i.string,(0,n.Z)(o,e.text,p,u,i)}_computeTitleHeight(){const t=this.options.title,e=(0,n.a0)(t.font),i=(0,n.E)(t.padding);return t.display?e.lineHeight+i.height:0}_getLegendItemAt(t,e){let i,r,s;if((0,n.aj)(t,this.left,this.right)&&(0,n.aj)(e,this.top,this.bottom))for(s=this.legendHitBoxes,i=0;i<s.length;++i)if(r=s[i],(0,n.aj)(t,r.left,r.left+r.width)&&(0,n.aj)(e,r.top,r.top+r.height))return this.legendItems[i];return null}handleEvent(t){const e=this.options;if(!function(t,e){return!("mousemove"!==t&&"mouseout"!==t||!e.onHover&&!e.onLeave)||!(!e.onClick||"click"!==t&&"mouseup"!==t)}(t.type,e))return;const i=this._getLegendItemAt(t.x,t.y);if("mousemove"===t.type||"mouseout"===t.type){const o=this._hoveredItem,a=(s=i,null!==(r=o)&&null!==s&&r.datasetIndex===s.datasetIndex&&r.index===s.index);o&&!a&&(0,n.Q)(e.onLeave,[t,o,this],this),this._hoveredItem=i,i&&!a&&(0,n.Q)(e.onHover,[t,i,this],this)}else i&&(0,n.Q)(e.onClick,[t,i,this],this);var r,s}}function Ke(t,e){return e*(t.text?t.text.length:0)}var Je={id:"legend",_element:Ye,start(t,e,i){const n=t.legend=new Ye({ctx:t.ctx,options:i,chart:t});Q.configure(t,n,i),Q.addBox(t,n)},stop(t){Q.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,i){const n=t.legend;Q.configure(t,n,i),n.options=i},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,i){const n=e.datasetIndex,r=i.chart;r.isDatasetVisible(n)?(r.hide(n),e.hidden=!0):(r.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:i,pointStyle:r,textAlign:s,color:o,useBorderRadius:a,borderRadius:l}}=t.legend.options;return t._getSortedDatasetMetas().map((t=>{const c=t.controller.getStyle(i?0:void 0),u=(0,n.E)(c.borderWidth);return{text:e[t.index].label,fillStyle:c.backgroundColor,fontColor:o,hidden:!t.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:r||c.pointStyle,rotation:c.rotation,textAlign:s||c.textAlign,borderRadius:a&&(l||c.borderRadius),datasetIndex:t.index}}),this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class Qe extends _t{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const i=this.options;if(this.left=0,this.top=0,!i.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=t,this.height=this.bottom=e;const r=(0,n.b)(i.text)?i.text.length:1;this._padding=(0,n.E)(i.padding);const s=r*(0,n.a0)(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const t=this.options.position;return"top"===t||"bottom"===t}_drawArgs(t){const{top:e,left:i,bottom:r,right:s,options:o}=this,a=o.align;let l,c,u,h=0;return this.isHorizontal()?(c=(0,n.a2)(a,i,s),u=e+t,l=s-i):("left"===o.position?(c=i+t,u=(0,n.a2)(a,r,e),h=-.5*n.P):(c=s-t,u=(0,n.a2)(a,e,r),h=.5*n.P),l=r-e),{titleX:c,titleY:u,maxWidth:l,rotation:h}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const i=(0,n.a0)(e.font),r=i.lineHeight/2+this._padding.top,{titleX:s,titleY:o,maxWidth:a,rotation:l}=this._drawArgs(r);(0,n.Z)(t,e.text,0,0,i,{color:e.color,maxWidth:a,rotation:l,textAlign:(0,n.a1)(e.align),textBaseline:"middle",translation:[s,o]})}}var ti={id:"title",_element:Qe,start(t,e,i){!function(t,e){const i=new Qe({ctx:t.ctx,options:e,chart:t});Q.configure(t,i,e),Q.addBox(t,i),t.titleBlock=i}(t,i)},stop(t){const e=t.titleBlock;Q.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,i){const n=t.titleBlock;Q.configure(t,n,i),n.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ei=new WeakMap;var ii={id:"subtitle",start(t,e,i){const n=new Qe({ctx:t.ctx,options:i,chart:t});Q.configure(t,n,i),Q.addBox(t,n),ei.set(t,n)},stop(t){Q.removeBox(t,ei.get(t)),ei.delete(t)},beforeUpdate(t,e,i){const n=ei.get(t);Q.configure(t,n,i),n.options=i},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ni={average(t){if(!t.length)return!1;let e,i,n=new Set,r=0,s=0;for(e=0,i=t.length;e<i;++e){const i=t[e].element;if(i&&i.hasValue()){const t=i.tooltipPosition();n.add(t.x),r+=t.y,++s}}return{x:[...n].reduce(((t,e)=>t+e))/n.size,y:r/s}},nearest(t,e){if(!t.length)return!1;let i,r,s,o=e.x,a=e.y,l=Number.POSITIVE_INFINITY;for(i=0,r=t.length;i<r;++i){const r=t[i].element;if(r&&r.hasValue()){const t=r.getCenterPoint(),i=(0,n.aE)(e,t);i<l&&(l=i,s=r)}}if(s){const t=s.tooltipPosition();o=t.x,a=t.y}return{x:o,y:a}}};function ri(t,e){return e&&((0,n.b)(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function si(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function oi(t,e){const{element:i,datasetIndex:n,index:r}=e,s=t.getDatasetMeta(n).controller,{label:o,value:a}=s.getLabelAndValue(r);return{chart:t,label:o,parsed:s.getParsed(r),raw:t.data.datasets[n].data[r],formattedValue:a,dataset:s.getDataset(),dataIndex:r,datasetIndex:n,element:i}}function ai(t,e){const i=t.chart.ctx,{body:r,footer:s,title:o}=t,{boxWidth:a,boxHeight:l}=e,c=(0,n.a0)(e.bodyFont),u=(0,n.a0)(e.titleFont),h=(0,n.a0)(e.footerFont),d=o.length,p=s.length,f=r.length,m=(0,n.E)(e.padding);let g=m.height,_=0,y=r.reduce(((t,e)=>t+e.before.length+e.lines.length+e.after.length),0);y+=t.beforeBody.length+t.afterBody.length,d&&(g+=d*u.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),y&&(g+=f*(e.displayColors?Math.max(l,c.lineHeight):c.lineHeight)+(y-f)*c.lineHeight+(y-1)*e.bodySpacing),p&&(g+=e.footerMarginTop+p*h.lineHeight+(p-1)*e.footerSpacing);let x=0;const v=function(t){_=Math.max(_,i.measureText(t).width+x)};return i.save(),i.font=u.string,(0,n.F)(t.title,v),i.font=c.string,(0,n.F)(t.beforeBody.concat(t.afterBody),v),x=e.displayColors?a+2+e.boxPadding:0,(0,n.F)(r,(t=>{(0,n.F)(t.before,v),(0,n.F)(t.lines,v),(0,n.F)(t.after,v)})),x=0,i.font=h.string,(0,n.F)(t.footer,v),i.restore(),_+=m.width,{width:_,height:g}}function li(t,e,i,n){const{x:r,width:s}=i,{width:o,chartArea:{left:a,right:l}}=t;let c="center";return"center"===n?c=r<=(a+l)/2?"left":"right":r<=s/2?c="left":r>=o-s/2&&(c="right"),function(t,e,i,n){const{x:r,width:s}=n,o=i.caretSize+i.caretPadding;return"left"===t&&r+s+o>e.width||"right"===t&&r-s-o<0||void 0}(c,t,e,i)&&(c="center"),c}function ci(t,e,i){const n=i.yAlign||e.yAlign||function(t,e){const{y:i,height:n}=e;return i<n/2?"top":i>t.height-n/2?"bottom":"center"}(t,i);return{xAlign:i.xAlign||e.xAlign||li(t,e,i,n),yAlign:n}}function ui(t,e,i,r){const{caretSize:s,caretPadding:o,cornerRadius:a}=t,{xAlign:l,yAlign:c}=i,u=s+o,{topLeft:h,topRight:d,bottomLeft:p,bottomRight:f}=(0,n.aw)(a);let m=function(t,e){let{x:i,width:n}=t;return"right"===e?i-=n:"center"===e&&(i-=n/2),i}(e,l);const g=function(t,e,i){let{y:n,height:r}=t;return"top"===e?n+=i:n-="bottom"===e?r+i:r/2,n}(e,c,u);return"center"===c?"left"===l?m+=u:"right"===l&&(m-=u):"left"===l?m-=Math.max(h,p)+s:"right"===l&&(m+=Math.max(d,f)+s),{x:(0,n.S)(m,0,r.width-e.width),y:(0,n.S)(g,0,r.height-e.height)}}function hi(t,e,i){const r=(0,n.E)(i.padding);return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-r.right:t.x+r.left}function di(t){return ri([],si(t))}function pi(t,e){const i=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return i?t.override(i):t}const fi={beforeTitle:n.aF,title(t){if(t.length>0){const e=t[0],i=e.chart.data.labels,n=i?i.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return i[e.dataIndex]}return""},afterTitle:n.aF,beforeBody:n.aF,beforeLabel:n.aF,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const i=t.formattedValue;return(0,n.k)(i)||(e+=i),e},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:n.aF,afterBody:n.aF,beforeFooter:n.aF,footer:n.aF,afterFooter:n.aF};function mi(t,e,i,n){const r=t[e].call(i,n);return void 0===r?fi[e].call(i,n):r}class gi extends _t{static positioners=ni;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,i=this.options.setContext(this.getContext()),n=i.enabled&&e.options.animation&&i.animations,r=new c(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=(t=this.chart.getContext(),this,e=this._tooltipItems,(0,n.j)(t,{tooltip:this,tooltipItems:e,type:"tooltip"})));var t,e}getTitle(t,e){const{callbacks:i}=e,n=mi(i,"beforeTitle",this,t),r=mi(i,"title",this,t),s=mi(i,"afterTitle",this,t);let o=[];return o=ri(o,si(n)),o=ri(o,si(r)),o=ri(o,si(s)),o}getBeforeBody(t,e){return di(mi(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:i}=e,r=[];return(0,n.F)(t,(t=>{const e={before:[],lines:[],after:[]},n=pi(i,t);ri(e.before,si(mi(n,"beforeLabel",this,t))),ri(e.lines,mi(n,"label",this,t)),ri(e.after,si(mi(n,"afterLabel",this,t))),r.push(e)})),r}getAfterBody(t,e){return di(mi(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:i}=e,n=mi(i,"beforeFooter",this,t),r=mi(i,"footer",this,t),s=mi(i,"afterFooter",this,t);let o=[];return o=ri(o,si(n)),o=ri(o,si(r)),o=ri(o,si(s)),o}_createItems(t){const e=this._active,i=this.chart.data,r=[],s=[],o=[];let a,l,c=[];for(a=0,l=e.length;a<l;++a)c.push(oi(this.chart,e[a]));return t.filter&&(c=c.filter(((e,n,r)=>t.filter(e,n,r,i)))),t.itemSort&&(c=c.sort(((e,n)=>t.itemSort(e,n,i)))),(0,n.F)(c,(e=>{const i=pi(t.callbacks,e);r.push(mi(i,"labelColor",this,e)),s.push(mi(i,"labelPointStyle",this,e)),o.push(mi(i,"labelTextColor",this,e))})),this.labelColors=r,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=c,c}update(t,e){const i=this.options.setContext(this.getContext()),n=this._active;let r,s=[];if(n.length){const t=ni[i.position].call(this,n,this._eventPosition);s=this._createItems(i),this.title=this.getTitle(s,i),this.beforeBody=this.getBeforeBody(s,i),this.body=this.getBody(s,i),this.afterBody=this.getAfterBody(s,i),this.footer=this.getFooter(s,i);const e=this._size=ai(this,i),o=Object.assign({},t,e),a=ci(this.chart,i,o),l=ui(i,o,a,this.chart);this.xAlign=a.xAlign,this.yAlign=a.yAlign,r={opacity:1,x:l.x,y:l.y,width:e.width,height:e.height,caretX:t.x,caretY:t.y}}else 0!==this.opacity&&(r={opacity:0});this._tooltipItems=s,this.$context=void 0,r&&this._resolveAnimations().update(this,r),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,i,n){const r=this.getCaretPosition(t,i,n);e.lineTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.lineTo(r.x3,r.y3)}getCaretPosition(t,e,i){const{xAlign:r,yAlign:s}=this,{caretSize:o,cornerRadius:a}=i,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:h}=(0,n.aw)(a),{x:d,y:p}=t,{width:f,height:m}=e;let g,_,y,x,v,b;return"center"===s?(v=p+m/2,"left"===r?(g=d,_=g-o,x=v+o,b=v-o):(g=d+f,_=g+o,x=v-o,b=v+o),y=g):(_="left"===r?d+Math.max(l,u)+o:"right"===r?d+f-Math.max(c,h)-o:this.caretX,"top"===s?(x=p,v=x-o,g=_-o,y=_+o):(x=p+m,v=x+o,g=_+o,y=_-o),b=x),{x1:g,x2:_,x3:y,y1:x,y2:v,y3:b}}drawTitle(t,e,i){const r=this.title,s=r.length;let o,a,l;if(s){const c=(0,n.az)(i.rtl,this.x,this.width);for(t.x=hi(this,i.titleAlign,i),e.textAlign=c.textAlign(i.titleAlign),e.textBaseline="middle",o=(0,n.a0)(i.titleFont),a=i.titleSpacing,e.fillStyle=i.titleColor,e.font=o.string,l=0;l<s;++l)e.fillText(r[l],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a,l+1===s&&(t.y+=i.titleMarginBottom-a)}}_drawColorBox(t,e,i,r,s){const o=this.labelColors[i],a=this.labelPointStyles[i],{boxHeight:l,boxWidth:c}=s,u=(0,n.a0)(s.bodyFont),h=hi(this,"left",s),d=r.x(h),p=l<u.lineHeight?(u.lineHeight-l)/2:0,f=e.y+p;if(s.usePointStyle){const e={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},i=r.leftForLtr(d,c)+c/2,u=f+l/2;t.strokeStyle=s.multiKeyBackground,t.fillStyle=s.multiKeyBackground,(0,n.at)(t,e,i,u),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,(0,n.at)(t,e,i,u)}else{t.lineWidth=(0,n.i)(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const e=r.leftForLtr(d,c),i=r.leftForLtr(r.xPlus(d,1),c-2),a=(0,n.aw)(o.borderRadius);Object.values(a).some((t=>0!==t))?(t.beginPath(),t.fillStyle=s.multiKeyBackground,(0,n.au)(t,{x:e,y:f,w:c,h:l,radius:a}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),(0,n.au)(t,{x:i,y:f+1,w:c-2,h:l-2,radius:a}),t.fill()):(t.fillStyle=s.multiKeyBackground,t.fillRect(e,f,c,l),t.strokeRect(e,f,c,l),t.fillStyle=o.backgroundColor,t.fillRect(i,f+1,c-2,l-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,e,i){const{body:r}=this,{bodySpacing:s,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=i,h=(0,n.a0)(i.bodyFont);let d=h.lineHeight,p=0;const f=(0,n.az)(i.rtl,this.x,this.width),m=function(i){e.fillText(i,f.x(t.x+p),t.y+d/2),t.y+=d+s},g=f.textAlign(o);let _,y,x,v,b,w,k;for(e.textAlign=o,e.textBaseline="middle",e.font=h.string,t.x=hi(this,g,i),e.fillStyle=i.bodyColor,(0,n.F)(this.beforeBody,m),p=a&&"right"!==g?"center"===o?c/2+u:c+2+u:0,v=0,w=r.length;v<w;++v){for(_=r[v],y=this.labelTextColors[v],e.fillStyle=y,(0,n.F)(_.before,m),x=_.lines,a&&x.length&&(this._drawColorBox(e,t,v,f,i),d=Math.max(h.lineHeight,l)),b=0,k=x.length;b<k;++b)m(x[b]),d=h.lineHeight;(0,n.F)(_.after,m)}p=0,d=h.lineHeight,(0,n.F)(this.afterBody,m),t.y-=s}drawFooter(t,e,i){const r=this.footer,s=r.length;let o,a;if(s){const l=(0,n.az)(i.rtl,this.x,this.width);for(t.x=hi(this,i.footerAlign,i),t.y+=i.footerMarginTop,e.textAlign=l.textAlign(i.footerAlign),e.textBaseline="middle",o=(0,n.a0)(i.footerFont),e.fillStyle=i.footerColor,e.font=o.string,a=0;a<s;++a)e.fillText(r[a],l.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+i.footerSpacing}}drawBackground(t,e,i,r){const{xAlign:s,yAlign:o}=this,{x:a,y:l}=t,{width:c,height:u}=i,{topLeft:h,topRight:d,bottomLeft:p,bottomRight:f}=(0,n.aw)(r.cornerRadius);e.fillStyle=r.backgroundColor,e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.beginPath(),e.moveTo(a+h,l),"top"===o&&this.drawCaret(t,e,i,r),e.lineTo(a+c-d,l),e.quadraticCurveTo(a+c,l,a+c,l+d),"center"===o&&"right"===s&&this.drawCaret(t,e,i,r),e.lineTo(a+c,l+u-f),e.quadraticCurveTo(a+c,l+u,a+c-f,l+u),"bottom"===o&&this.drawCaret(t,e,i,r),e.lineTo(a+p,l+u),e.quadraticCurveTo(a,l+u,a,l+u-p),"center"===o&&"left"===s&&this.drawCaret(t,e,i,r),e.lineTo(a,l+h),e.quadraticCurveTo(a,l,a+h,l),e.closePath(),e.fill(),r.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,i=this.$animations,n=i&&i.x,r=i&&i.y;if(n||r){const i=ni[t.position].call(this,this._active,this._eventPosition);if(!i)return;const s=this._size=ai(this,t),o=Object.assign({},i,this._size),a=ci(e,t,o),l=ui(t,o,a,e);n._to===l.x&&r._to===l.y||(this.xAlign=a.xAlign,this.yAlign=a.yAlign,this.width=s.width,this.height=s.height,this.caretX=i.x,this.caretY=i.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(e);const r={width:this.width,height:this.height},s={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const o=(0,n.E)(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=i,this.drawBackground(s,t,r,e),(0,n.aA)(t,e.textDirection),s.y+=o.top,this.drawTitle(s,t,e),this.drawBody(s,t,e),this.drawFooter(s,t,e),(0,n.aC)(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const i=this._active,r=t.map((({datasetIndex:t,index:e})=>{const i=this.chart.getDatasetMeta(t);if(!i)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:i.data[e],index:e}})),s=!(0,n.ah)(i,r),o=this._positionChanged(r,e);(s||o)&&(this._active=r,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,i=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,s=this._active||[],o=this._getActiveElements(t,s,e,i),a=this._positionChanged(o,t),l=e||!(0,n.ah)(o,s)||a;return l&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),l}_getActiveElements(t,e,i,n){const r=this.options;if("mouseout"===t.type)return[];if(!n)return e.filter((t=>this.chart.data.datasets[t.datasetIndex]&&void 0!==this.chart.getDatasetMeta(t.datasetIndex).controller.getParsed(t.index)));const s=this.chart.getElementsAtEventForMode(t,r.mode,r,i);return r.reverse&&s.reverse(),s}_positionChanged(t,e){const{caretX:i,caretY:n,options:r}=this,s=ni[r.position].call(this,t,e);return!1!==s&&(i!==s.x||n!==s.y)}}var _i={id:"tooltip",_element:gi,positioners:ni,afterInit(t,e,i){i&&(t.tooltip=new gi({chart:t,options:i}))},beforeUpdate(t,e,i){t.tooltip&&t.tooltip.initialize(i)},reset(t,e,i){t.tooltip&&t.tooltip.initialize(i)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const i={tooltip:e};if(!1===t.notifyPlugins("beforeTooltipDraw",{...i,cancelable:!0}))return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",i)}},afterEvent(t,e){if(t.tooltip){const i=e.replay;t.tooltip.handleEvent(e.event,i,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:fi},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},yi=Object.freeze({__proto__:null,Colors:Ee,Decimation:ze,Filler:He,Legend:Je,SubTitle:ii,Title:ti,Tooltip:_i});function xi(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}function vi(t,e,{horizontal:i,minRotation:r}){const s=(0,n.t)(r),o=(i?Math.sin(s):Math.cos(s))||.001,a=.75*e*(""+t).length;return Math.min(e/o,a)}class bi extends At{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return(0,n.k)(t)||("number"==typeof t||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:r,max:s}=this;const o=t=>r=e?r:t,a=t=>s=i?s:t;if(t){const t=(0,n.s)(r),e=(0,n.s)(s);t<0&&e<0?a(0):t>0&&e>0&&o(0)}if(r===s){let e=0===s?1:Math.abs(.05*s);a(s+e),t||o(r-e)}this.min=r,this.max=s}getTickLimit(){const t=this.options.ticks;let e,{maxTicksLimit:i,stepSize:n}=t;return n?(e=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,e>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${e} ticks. Limiting to 1000.`),e=1e3)):(e=this.computeTickLimit(),i=i||11),i&&(e=Math.min(i,e)),e}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const r=function(t,e){const i=[],{bounds:r,step:s,min:o,max:a,precision:l,count:c,maxTicks:u,maxDigits:h,includeBounds:d}=t,p=s||1,f=u-1,{min:m,max:g}=e,_=!(0,n.k)(o),y=!(0,n.k)(a),x=!(0,n.k)(c),v=(g-m)/(h+1);let b,w,k,S,T=(0,n.aH)((g-m)/f/p)*p;if(T<1e-14&&!_&&!y)return[{value:m},{value:g}];S=Math.ceil(g/T)-Math.floor(m/T),S>f&&(T=(0,n.aH)(S*T/f/p)*p),(0,n.k)(l)||(b=Math.pow(10,l),T=Math.ceil(T*b)/b),"ticks"===r?(w=Math.floor(m/T)*T,k=Math.ceil(g/T)*T):(w=m,k=g),_&&y&&s&&(0,n.aI)((a-o)/s,T/1e3)?(S=Math.round(Math.min((a-o)/T,u)),T=(a-o)/S,w=o,k=a):x?(w=_?o:w,k=y?a:k,S=c-1,T=(k-w)/S):(S=(k-w)/T,S=(0,n.aJ)(S,Math.round(S),T/1e3)?Math.round(S):Math.ceil(S));const A=Math.max((0,n.aK)(T),(0,n.aK)(w));b=Math.pow(10,(0,n.k)(l)?A:l),w=Math.round(w*b)/b,k=Math.round(k*b)/b;let M=0;for(_&&(d&&w!==o?(i.push({value:o}),w<o&&M++,(0,n.aJ)(Math.round((w+M*T)*b)/b,o,vi(o,v,t))&&M++):w<o&&M++);M<S;++M){const t=Math.round((w+M*T)*b)/b;if(y&&t>a)break;i.push({value:t})}return y&&d&&k!==a?i.length&&(0,n.aJ)(i[i.length-1].value,a,vi(a,v,t))?i[i.length-1].value=a:i.push({value:a}):y&&k!==a||i.push({value:k}),i}({maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},this._range||this);return"ticks"===t.bounds&&(0,n.aG)(r,this,"value"),t.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}configure(){const t=this.ticks;let e=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const n=(i-e)/Math.max(t.length-1,1)/2;e-=n,i+=n}this._startValue=e,this._endValue=i,this._valueRange=i-e}getLabelForValue(t){return(0,n.o)(t,this.chart.options.locale,this.options.ticks.format)}}class wi extends bi{static id="linear";static defaults={ticks:{callback:n.aL.formatters.numeric}};determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=(0,n.g)(t)?t:0,this.max=(0,n.g)(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,i=(0,n.t)(this.options.ticks.minRotation),r=(t?Math.sin(i):Math.cos(i))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,s.lineHeight/r))}getPixelForValue(t){return null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const ki=t=>Math.floor((0,n.aM)(t)),Si=(t,e)=>Math.pow(10,ki(t)+e);function Ti(t){return 1==t/Math.pow(10,ki(t))}function Ai(t,e,i){const n=Math.pow(10,i),r=Math.floor(t/n);return Math.ceil(e/n)-r}class Mi extends At{static id="logarithmic";static defaults={ticks:{callback:n.aL.formatters.logarithmic,major:{enabled:!0}}};constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const i=bi.prototype.parse.apply(this,[t,e]);if(0!==i)return(0,n.g)(i)&&i>0?i:null;this._zero=!0}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=(0,n.g)(t)?Math.max(0,t):null,this.max=(0,n.g)(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!(0,n.g)(this._userMin)&&(this.min=t===Si(this.min,0)?Si(this.min,-1):Si(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let i=this.min,n=this.max;const r=e=>i=t?i:e,s=t=>n=e?n:t;i===n&&(i<=0?(r(1),s(10)):(r(Si(i,-1)),s(Si(n,1)))),i<=0&&r(Si(n,-1)),n<=0&&s(Si(i,1)),this.min=i,this.max=n}buildTicks(){const t=this.options,e=function(t,{min:e,max:i}){e=(0,n.O)(t.min,e);const r=[],s=ki(e);let o=function(t,e){let i=ki(e-t);for(;Ai(t,e,i)>10;)i++;for(;Ai(t,e,i)<10;)i--;return Math.min(i,ki(t))}(e,i),a=o<0?Math.pow(10,Math.abs(o)):1;const l=Math.pow(10,o),c=s>o?Math.pow(10,s):0,u=Math.round((e-c)*a)/a,h=Math.floor((e-c)/l/10)*l*10;let d=Math.floor((u-h)/Math.pow(10,o)),p=(0,n.O)(t.min,Math.round((c+h+d*Math.pow(10,o))*a)/a);for(;p<i;)r.push({value:p,major:Ti(p),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(o++,d=2,a=o>=0?1:a),p=Math.round((c+h+d*Math.pow(10,o))*a)/a;const f=(0,n.O)(t.max,p);return r.push({value:f,major:Ti(f),significand:d}),r}({min:this._userMin,max:this._userMax},this);return"ticks"===t.bounds&&(0,n.aG)(e,this,"value"),t.reverse?(e.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),e}getLabelForValue(t){return void 0===t?"0":(0,n.o)(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=(0,n.aM)(t),this._valueRange=(0,n.aM)(this.max)-(0,n.aM)(t)}getPixelForValue(t){return void 0!==t&&0!==t||(t=this.min),null===t||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:((0,n.aM)(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function Ci(t){const e=t.ticks;if(e.display&&t.display){const t=(0,n.E)(e.backdropPadding);return(0,n.v)(e.font&&e.font.size,n.d.font.size)+t.height}return 0}function Ei(t,e,i,n,r){return t===n||t===r?{start:e-i/2,end:e+i/2}:t<n||t>r?{start:e-i,end:e}:{start:e,end:e+i}}function Ii(t,e,i,n,r){const s=Math.abs(Math.sin(i)),o=Math.abs(Math.cos(i));let a=0,l=0;n.start<e.l?(a=(e.l-n.start)/s,t.l=Math.min(t.l,e.l-a)):n.end>e.r&&(a=(n.end-e.r)/s,t.r=Math.max(t.r,e.r+a)),r.start<e.t?(l=(e.t-r.start)/o,t.t=Math.min(t.t,e.t-l)):r.end>e.b&&(l=(r.end-e.b)/o,t.b=Math.max(t.b,e.b+l))}function Di(t,e,i){const r=t.drawingArea,{extra:s,additionalAngle:o,padding:a,size:l}=i,c=t.getPointPosition(e,r+s+a,o),u=Math.round((0,n.U)((0,n.ay)(c.angle+n.H))),h=function(t,e,i){return 90===i||270===i?t-=e/2:(i>270||i<90)&&(t-=e),t}(c.y,l.h,u),d=function(t){return 0===t||180===t?"center":t<180?"left":"right"}(u),p=(f=c.x,m=l.w,"right"===(g=d)?f-=m:"center"===g&&(f-=m/2),f);var f,m,g;return{visible:!0,x:c.x,y:h,textAlign:d,left:p,top:h,right:p+l.w,bottom:h+l.h}}function zi(t,e){if(!e)return!0;const{left:i,top:r,right:s,bottom:o}=t;return!((0,n.C)({x:i,y:r},e)||(0,n.C)({x:i,y:o},e)||(0,n.C)({x:s,y:r},e)||(0,n.C)({x:s,y:o},e))}function Pi(t,e,i){const{left:r,top:s,right:o,bottom:a}=i,{backdropColor:l}=e;if(!(0,n.k)(l)){const i=(0,n.aw)(e.borderRadius),c=(0,n.E)(e.backdropPadding);t.fillStyle=l;const u=r-c.left,h=s-c.top,d=o-r+c.width,p=a-s+c.height;Object.values(i).some((t=>0!==t))?(t.beginPath(),(0,n.au)(t,{x:u,y:h,w:d,h:p,radius:i}),t.fill()):t.fillRect(u,h,d,p)}}function Li(t,e,i,r){const{ctx:s}=t;if(i)s.arc(t.xCenter,t.yCenter,e,0,n.T);else{let i=t.getPointPosition(0,e);s.moveTo(i.x,i.y);for(let n=1;n<r;n++)i=t.getPointPosition(n,e),s.lineTo(i.x,i.y)}}class Fi extends bi{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:n.aL.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=(0,n.E)(Ci(this.options)/2),e=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(e,i)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=(0,n.g)(t)&&!isNaN(t)?t:0,this.max=(0,n.g)(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Ci(this.options))}generateTickLabels(t){bi.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map(((t,e)=>{const i=(0,n.Q)(this.options.pointLabels.callback,[t,e],this);return i||0===i?i:""})).filter(((t,e)=>this.chart.getDataVisibility(e)))}fit(){const t=this.options;t.display&&t.pointLabels.display?function(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},i=Object.assign({},e),r=[],s=[],o=t._pointLabels.length,a=t.options.pointLabels,l=a.centerPointLabels?n.P/o:0;for(let d=0;d<o;d++){const o=a.setContext(t.getPointLabelContext(d));s[d]=o.padding;const p=t.getPointPosition(d,t.drawingArea+s[d],l),f=(0,n.a0)(o.font),m=(c=t.ctx,u=f,h=t._pointLabels[d],h=(0,n.b)(h)?h:[h],{w:(0,n.aN)(c,u.string,h),h:h.length*u.lineHeight});r[d]=m;const g=(0,n.ay)(t.getIndexAngle(d)+l),_=Math.round((0,n.U)(g));Ii(i,e,g,Ei(_,p.x,m.w,0,180),Ei(_,p.y,m.h,90,270))}var c,u,h;t.setCenterPoint(e.l-i.l,i.r-e.r,e.t-i.t,i.b-e.b),t._pointLabelItems=function(t,e,i){const r=[],s=t._pointLabels.length,o=t.options,{centerPointLabels:a,display:l}=o.pointLabels,c={extra:Ci(o)/2,additionalAngle:a?n.P/s:0};let u;for(let n=0;n<s;n++){c.padding=i[n],c.size=e[n];const s=Di(t,n,c);r.push(s),"auto"===l&&(s.visible=zi(s,u),s.visible&&(u=s))}return r}(t,r,s)}(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,i,n){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((i-n)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,i,n))}getIndexAngle(t){const e=n.T/(this._pointLabels.length||1),i=this.options.startAngle||0;return(0,n.ay)(t*e+(0,n.t)(i))}getDistanceFromCenterForValue(t){if((0,n.k)(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if((0,n.k)(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const i=e[t];return function(t,e,i){return(0,n.j)(t,{label:i,index:e,type:"pointLabel"})}(this.getContext(),t,i)}}getPointPosition(t,e,i=0){const r=this.getIndexAngle(t)-n.H+i;return{x:Math.cos(r)*e+this.xCenter,y:Math.sin(r)*e+this.yCenter,angle:r}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:i,right:n,bottom:r}=this._pointLabelItems[t];return{left:e,top:i,right:n,bottom:r}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const i=this.ctx;i.save(),i.beginPath(),Li(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:i,grid:r,border:s}=e,o=this._pointLabels.length;let a,l,c;if(e.pointLabels.display&&function(t,e){const{ctx:i,options:{pointLabels:r}}=t;for(let s=e-1;s>=0;s--){const e=t._pointLabelItems[s];if(!e.visible)continue;const o=r.setContext(t.getPointLabelContext(s));Pi(i,o,e);const a=(0,n.a0)(o.font),{x:l,y:c,textAlign:u}=e;(0,n.Z)(i,t._pointLabels[s],l,c+a.lineHeight/2,a,{color:o.color,textAlign:u,textBaseline:"middle"})}}(this,o),r.display&&this.ticks.forEach(((t,e)=>{if(0!==e||0===e&&this.min<0){l=this.getDistanceFromCenterForValue(t.value);const i=this.getContext(e),n=r.setContext(i),a=s.setContext(i);!function(t,e,i,n,r){const s=t.ctx,o=e.circular,{color:a,lineWidth:l}=e;!o&&!n||!a||!l||i<0||(s.save(),s.strokeStyle=a,s.lineWidth=l,s.setLineDash(r.dash),s.lineDashOffset=r.dashOffset,s.beginPath(),Li(t,i,o,n),s.closePath(),s.stroke(),s.restore())}(this,n,l,o,a)}})),i.display){for(t.save(),a=o-1;a>=0;a--){const n=i.setContext(this.getPointLabelContext(a)),{color:r,lineWidth:s}=n;s&&r&&(t.lineWidth=s,t.strokeStyle=r,t.setLineDash(n.borderDash),t.lineDashOffset=n.borderDashOffset,l=this.getDistanceFromCenterForValue(e.ticks.reverse?this.min:this.max),c=this.getPointPosition(a,l),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(c.x,c.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,i=e.ticks;if(!i.display)return;const r=this.getIndexAngle(0);let s,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(r),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach(((r,a)=>{if(0===a&&this.min>=0&&!e.reverse)return;const l=i.setContext(this.getContext(a)),c=(0,n.a0)(l.font);if(s=this.getDistanceFromCenterForValue(this.ticks[a].value),l.showLabelBackdrop){t.font=c.string,o=t.measureText(r.label).width,t.fillStyle=l.backdropColor;const e=(0,n.E)(l.backdropPadding);t.fillRect(-o/2-e.left,-s-c.size/2-e.top,o+e.width,c.size+e.height)}(0,n.Z)(t,r.label,0,-s,c,{color:l.color,strokeColor:l.textStrokeColor,strokeWidth:l.textStrokeWidth})})),t.restore()}drawTitle(){}}const Ri={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Oi=Object.keys(Ri);function Bi(t,e){return t-e}function Vi(t,e){if((0,n.k)(e))return null;const i=t._adapter,{parser:r,round:s,isoWeekday:o}=t._parseOpts;let a=e;return"function"==typeof r&&(a=r(a)),(0,n.g)(a)||(a="string"==typeof r?i.parse(a,r):i.parse(a)),null===a?null:(s&&(a="week"!==s||!(0,n.x)(o)&&!0!==o?i.startOf(a,s):i.startOf(a,"isoWeek",o)),+a)}function Ni(t,e,i,n){const r=Oi.length;for(let s=Oi.indexOf(t);s<r-1;++s){const t=Ri[Oi[s]],r=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((i-e)/(r*t.size))<=n)return Oi[s]}return Oi[r-1]}function qi(t,e,i){if(i){if(i.length){const{lo:r,hi:s}=(0,n.aP)(i,e);t[i[r]>=e?i[r]:i[s]]=!0}}else t[e]=!0}function ji(t,e,i){const n=[],r={},s=e.length;let o,a;for(o=0;o<s;++o)a=e[o],r[a]=o,n.push({value:a,major:!1});return 0!==s&&i?function(t,e,i,n){const r=t._adapter,s=+r.startOf(e[0].value,n),o=e[e.length-1].value;let a,l;for(a=s;a<=o;a=+r.add(a,1,n))l=i[a],l>=0&&(e[l].major=!0);return e}(t,n,r,i):n}class $i extends At{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const i=t.time||(t.time={}),r=this._adapter=new F._date(t.adapters.date);r.init(e),(0,n.ab)(i.displayFormats,r.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return void 0===t?null:Vi(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,i=t.time.unit||"day";let{min:r,max:s,minDefined:o,maxDefined:a}=this.getUserBounds();function l(t){o||isNaN(t.min)||(r=Math.min(r,t.min)),a||isNaN(t.max)||(s=Math.max(s,t.max))}o&&a||(l(this._getLabelBounds()),"ticks"===t.bounds&&"labels"===t.ticks.source||l(this.getMinMax(!1))),r=(0,n.g)(r)&&!isNaN(r)?r:+e.startOf(Date.now(),i),s=(0,n.g)(s)&&!isNaN(s)?s:+e.endOf(Date.now(),i)+1,this.min=Math.min(r,s-1),this.max=Math.max(r+1,s)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],i=t[t.length-1]),{min:e,max:i}}buildTicks(){const t=this.options,e=t.time,i=t.ticks,r="labels"===i.source?this.getLabelTimestamps():this._generate();"ticks"===t.bounds&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const s=this.min,o=this.max,a=(0,n.aO)(r,s,o);return this._unit=e.unit||(i.autoSkip?Ni(e.minUnit,this.min,this.max,this._getLabelCapacity(s)):function(t,e,i,n,r){for(let s=Oi.length-1;s>=Oi.indexOf(i);s--){const i=Oi[s];if(Ri[i].common&&t._adapter.diff(r,n,i)>=e-1)return i}return Oi[i?Oi.indexOf(i):0]}(this,a.length,e.minUnit,this.min,this.max)),this._majorUnit=i.major.enabled&&"year"!==this._unit?function(t){for(let e=Oi.indexOf(t)+1,i=Oi.length;e<i;++e)if(Ri[Oi[e]].common)return Oi[e]}(this._unit):void 0,this.initOffsets(r),t.reverse&&a.reverse(),ji(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((t=>+t.value)))}initOffsets(t=[]){let e,i,r=0,s=0;this.options.offset&&t.length&&(e=this.getDecimalForValue(t[0]),r=1===t.length?1-e:(this.getDecimalForValue(t[1])-e)/2,i=this.getDecimalForValue(t[t.length-1]),s=1===t.length?i:(i-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;r=(0,n.S)(r,0,o),s=(0,n.S)(s,0,o),this._offsets={start:r,end:s,factor:1/(r+1+s)}}_generate(){const t=this._adapter,e=this.min,i=this.max,r=this.options,s=r.time,o=s.unit||Ni(s.minUnit,e,i,this._getLabelCapacity(e)),a=(0,n.v)(r.ticks.stepSize,1),l="week"===o&&s.isoWeekday,c=(0,n.x)(l)||!0===l,u={};let h,d,p=e;if(c&&(p=+t.startOf(p,"isoWeek",l)),p=+t.startOf(p,c?"day":o),t.diff(i,e,o)>1e5*a)throw new Error(e+" and "+i+" are too far apart with stepSize of "+a+" "+o);const f="data"===r.ticks.source&&this.getDataTimestamps();for(h=p,d=0;h<i;h=+t.add(h,a,o),d++)qi(u,h,f);return h!==i&&"ticks"!==r.bounds&&1!==d||qi(u,h,f),Object.keys(u).sort(Bi).map((t=>+t))}getLabelForValue(t){const e=this._adapter,i=this.options.time;return i.tooltipFormat?e.format(t,i.tooltipFormat):e.format(t,i.displayFormats.datetime)}format(t,e){const i=this.options.time.displayFormats,n=this._unit,r=e||i[n];return this._adapter.format(t,r)}_tickFormatFunction(t,e,i,r){const s=this.options,o=s.ticks.callback;if(o)return(0,n.Q)(o,[t,e,i],this);const a=s.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],h=c&&a[c],d=i[e],p=c&&h&&d&&d.major;return this._adapter.format(t,r||(p?h:u))}generateTickLabels(t){let e,i,n;for(e=0,i=t.length;e<i;++e)n=t[e],n.label=this._tickFormatFunction(n.value,e,t)}getDecimalForValue(t){return null===t?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+i)*e.factor)}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,i=this.ctx.measureText(t).width,r=(0,n.t)(this.isHorizontal()?e.maxRotation:e.minRotation),s=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:i*s+a*o,h:i*o+a*s}}_getLabelCapacity(t){const e=this.options.time,i=e.displayFormats,n=i[e.unit]||i.millisecond,r=this._tickFormatFunction(t,0,ji(this,[t],this._majorUnit),n),s=this._getLabelSize(r),o=Math.floor(this.isHorizontal()?this.width/s.w:this.height/s.h)-1;return o>0?o:1}getDataTimestamps(){let t,e,i=this._cache.data||[];if(i.length)return i;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(t=0,e=n.length;t<e;++t)i=i.concat(n[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(i)}getLabelTimestamps(){const t=this._cache.labels||[];let e,i;if(t.length)return t;const n=this.getLabels();for(e=0,i=n.length;e<i;++e)t.push(Vi(this,n[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return(0,n._)(t.sort(Bi))}}function Ui(t,e,i){let r,s,o,a,l=0,c=t.length-1;i?(e>=t[l].pos&&e<=t[c].pos&&({lo:l,hi:c}=(0,n.B)(t,"pos",e)),({pos:r,time:o}=t[l]),({pos:s,time:a}=t[c])):(e>=t[l].time&&e<=t[c].time&&({lo:l,hi:c}=(0,n.B)(t,"time",e)),({time:r,pos:o}=t[l]),({time:s,pos:a}=t[c]));const u=s-r;return u?o+(a-o)*(e-r)/u:o}var Zi=Object.freeze({__proto__:null,CategoryScale:class extends At{static id="category";static defaults={ticks:{callback:xi}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const t=this.getLabels();for(const{index:i,label:n}of e)t[i]===n&&t.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,e){if((0,n.k)(t))return null;const i=this.getLabels();return((t,e)=>null===t?null:(0,n.S)(Math.round(t),0,e))(e=isFinite(e)&&i[e]===t?e:function(t,e,i,n){const r=t.indexOf(e);return-1===r?((t,e,i,n)=>("string"==typeof e?(i=t.push(e)-1,n.unshift({index:i,label:e})):isNaN(e)&&(i=null),i))(t,e,i,n):r!==t.lastIndexOf(e)?i:r}(i,t,(0,n.v)(e,t),this._addedLabels),i.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:i,max:n}=this.getMinMax(!0);"ticks"===this.options.bounds&&(t||(i=0),e||(n=this.getLabels().length-1)),this.min=i,this.max=n}buildTicks(){const t=this.min,e=this.max,i=this.options.offset,n=[];let r=this.getLabels();r=0===t&&e===r.length-1?r:r.slice(t,e+1),this._valueRange=Math.max(r.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let i=t;i<=e;i++)n.push({value:i});return n}getLabelForValue(t){return xi.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return"number"!=typeof t&&(t=this.parse(t)),null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}},LinearScale:wi,LogarithmicScale:Mi,RadialLinearScale:Fi,TimeScale:$i,TimeSeriesScale:class extends $i{static id="timeseries";static defaults=$i.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=Ui(e,this.min),this._tableRange=Ui(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:i}=this,n=[],r=[];let s,o,a,l,c;for(s=0,o=t.length;s<o;++s)l=t[s],l>=e&&l<=i&&n.push(l);if(n.length<2)return[{time:e,pos:0},{time:i,pos:1}];for(s=0,o=n.length;s<o;++s)c=n[s+1],a=n[s-1],l=n[s],Math.round((c+a)/2)!==l&&r.push({time:l,pos:s/(o-1)});return r}_generate(){const t=this.min,e=this.max;let i=super.getDataTimestamps();return i.includes(t)&&i.length||i.splice(0,0,t),i.includes(e)&&1!==i.length||i.push(e),i.sort(((t,e)=>t-e))}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),i=this.getLabelTimestamps();return t=e.length&&i.length?this.normalize(e.concat(i)):e.length?e:i,t=this._cache.all=t,t}getDecimalForValue(t){return(Ui(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return Ui(this._table,i*this._tableRange+this._minPos,!0)}}});const Wi=[z,ke,yi,Zi]},9006:function(t,e,i){"use strict";function n(t){return t+.5|0}i.d(e,{$:function(){return be},A:function(){return Lt},B:function(){return Pt},C:function(){return xe},D:function(){return St},E:function(){return Le},F:function(){return U},G:function(){return pi},H:function(){return ut},I:function(){return oi},J:function(){return gi},K:function(){return mi},L:function(){return qt},M:function(){return si},N:function(){return _t},O:function(){return V},P:function(){return st},Q:function(){return $},R:function(){return Oe},S:function(){return Et},T:function(){return ot},U:function(){return wt},V:function(){return pe},W:function(){return It},X:function(){return me},Y:function(){return ve},Z:function(){return Ae},_:function(){return Vt},a:function(){return Re},a0:function(){return Fe},a1:function(){return $t},a2:function(){return Ut},a3:function(){return ae},a4:function(){return X},a5:function(){return tt},a6:function(){return le},a7:function(){return it},a8:function(){return Ne},a9:function(){return Ve},aA:function(){return bi},aB:function(){return Zt},aC:function(){return wi},aD:function(){return ye},aE:function(){return Tt},aF:function(){return P},aG:function(){return vt},aH:function(){return gt},aI:function(){return xt},aJ:function(){return mt},aK:function(){return kt},aL:function(){return oe},aM:function(){return pt},aN:function(){return fe},aO:function(){return Ft},aP:function(){return zt},aa:function(){return qe},ab:function(){return Y},ac:function(){return L},ad:function(){return jt},ae:function(){return fi},af:function(){return ge},ag:function(){return nt},ah:function(){return Z},ai:function(){return rt},aj:function(){return Dt},ak:function(){return De},al:function(){return ri},am:function(){return Mi},an:function(){return Ai},ao:function(){return yi},ap:function(){return xi},aq:function(){return _i},ar:function(){return we},as:function(){return ke},at:function(){return _e},au:function(){return Me},av:function(){return ze},aw:function(){return Pe},ax:function(){return Ti},ay:function(){return Mt},az:function(){return vi},b:function(){return R},c:function(){return Qt},d:function(){return de},e:function(){return Kt},f:function(){return Q},g:function(){return B},h:function(){return et},i:function(){return O},j:function(){return Be},k:function(){return F},l:function(){return Ot},m:function(){return q},n:function(){return j},o:function(){return re},p:function(){return Ct},q:function(){return Wt},r:function(){return Nt},s:function(){return ft},t:function(){return bt},u:function(){return Bt},v:function(){return N},w:function(){return Gt},x:function(){return yt},y:function(){return Je},z:function(){return hi}});const r=(t,e,i)=>Math.max(Math.min(t,i),e);function s(t){return r(n(2.55*t),0,255)}function o(t){return r(n(255*t),0,255)}function a(t){return r(n(t/2.55)/100,0,1)}function l(t){return r(n(100*t),0,100)}const c={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},u=[..."0123456789ABCDEF"],h=t=>u[15&t],d=t=>u[(240&t)>>4]+u[15&t],p=t=>(240&t)>>4==(15&t);const f=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function m(t,e,i){const n=e*Math.min(i,1-i),r=(e,r=(e+t/30)%12)=>i-n*Math.max(Math.min(r-3,9-r,1),-1);return[r(0),r(8),r(4)]}function g(t,e,i){const n=(n,r=(n+t/60)%6)=>i-i*e*Math.max(Math.min(r,4-r,1),0);return[n(5),n(3),n(1)]}function _(t,e,i){const n=m(t,1,.5);let r;for(e+i>1&&(r=1/(e+i),e*=r,i*=r),r=0;r<3;r++)n[r]*=1-e-i,n[r]+=e;return n}function y(t){const e=t.r/255,i=t.g/255,n=t.b/255,r=Math.max(e,i,n),s=Math.min(e,i,n),o=(r+s)/2;let a,l,c;return r!==s&&(c=r-s,l=o>.5?c/(2-r-s):c/(r+s),a=function(t,e,i,n,r){return t===r?(e-i)/n+(e<i?6:0):e===r?(i-t)/n+2:(t-e)/n+4}(e,i,n,c,r),a=60*a+.5),[0|a,l||0,o]}function x(t,e,i,n){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,i,n)).map(o)}function v(t,e,i){return x(m,t,e,i)}function b(t){return(t%360+360)%360}const w={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},k={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let S;const T=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,A=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,M=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function C(t,e,i){if(t){let n=y(t);n[e]=Math.max(0,Math.min(n[e]+n[e]*i,0===e?360:1)),n=v(n),t.r=n[0],t.g=n[1],t.b=n[2]}}function E(t,e){return t?Object.assign(e||{},t):t}function I(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=o(t[3]))):(e=E(t,{r:0,g:0,b:0,a:1})).a=o(e.a),e}function D(t){return"r"===t.charAt(0)?function(t){const e=T.exec(t);let i,n,o,a=255;if(e){if(e[7]!==i){const t=+e[7];a=e[8]?s(t):r(255*t,0,255)}return i=+e[1],n=+e[3],o=+e[5],i=255&(e[2]?s(i):r(i,0,255)),n=255&(e[4]?s(n):r(n,0,255)),o=255&(e[6]?s(o):r(o,0,255)),{r:i,g:n,b:o,a:a}}}(t):function(t){const e=f.exec(t);let i,n=255;if(!e)return;e[5]!==i&&(n=e[6]?s(+e[5]):o(+e[5]));const r=b(+e[2]),a=+e[3]/100,l=+e[4]/100;return i="hwb"===e[1]?function(t,e,i){return x(_,t,e,i)}(r,a,l):"hsv"===e[1]?function(t,e,i){return x(g,t,e,i)}(r,a,l):v(r,a,l),{r:i[0],g:i[1],b:i[2],a:n}}(t)}class z{constructor(t){if(t instanceof z)return t;const e=typeof t;let i;var n,r,s;"object"===e?i=I(t):"string"===e&&(s=(n=t).length,"#"===n[0]&&(4===s||5===s?r={r:255&17*c[n[1]],g:255&17*c[n[2]],b:255&17*c[n[3]],a:5===s?17*c[n[4]]:255}:7!==s&&9!==s||(r={r:c[n[1]]<<4|c[n[2]],g:c[n[3]]<<4|c[n[4]],b:c[n[5]]<<4|c[n[6]],a:9===s?c[n[7]]<<4|c[n[8]]:255})),i=r||function(t){S||(S=function(){const t={},e=Object.keys(k),i=Object.keys(w);let n,r,s,o,a;for(n=0;n<e.length;n++){for(o=a=e[n],r=0;r<i.length;r++)s=i[r],a=a.replace(s,w[s]);s=parseInt(k[o],16),t[a]=[s>>16&255,s>>8&255,255&s]}return t}(),S.transparent=[0,0,0,0]);const e=S[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:4===e.length?e[3]:255}}(t)||D(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=E(this._rgb);return t&&(t.a=a(t.a)),t}set rgb(t){this._rgb=I(t)}rgbString(){return this._valid?(t=this._rgb)&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${a(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`):void 0;var t}hexString(){return this._valid?(t=this._rgb,e=(t=>p(t.r)&&p(t.g)&&p(t.b)&&p(t.a))(t)?h:d,t?"#"+e(t.r)+e(t.g)+e(t.b)+((t,e)=>t<255?e(t):"")(t.a,e):void 0):void 0;var t,e}hslString(){return this._valid?function(t){if(!t)return;const e=y(t),i=e[0],n=l(e[1]),r=l(e[2]);return t.a<255?`hsla(${i}, ${n}%, ${r}%, ${a(t.a)})`:`hsl(${i}, ${n}%, ${r}%)`}(this._rgb):void 0}mix(t,e){if(t){const i=this.rgb,n=t.rgb;let r;const s=e===r?.5:e,o=2*s-1,a=i.a-n.a,l=((o*a==-1?o:(o+a)/(1+o*a))+1)/2;r=1-l,i.r=255&l*i.r+r*n.r+.5,i.g=255&l*i.g+r*n.g+.5,i.b=255&l*i.b+r*n.b+.5,i.a=s*i.a+(1-s)*n.a,this.rgb=i}return this}interpolate(t,e){return t&&(this._rgb=function(t,e,i){const n=M(a(t.r)),r=M(a(t.g)),s=M(a(t.b));return{r:o(A(n+i*(M(a(e.r))-n))),g:o(A(r+i*(M(a(e.g))-r))),b:o(A(s+i*(M(a(e.b))-s))),a:t.a+i*(e.a-t.a)}}(this._rgb,t._rgb,e)),this}clone(){return new z(this.rgb)}alpha(t){return this._rgb.a=o(t),this}clearer(t){return this._rgb.a*=1-t,this}greyscale(){const t=this._rgb,e=n(.3*t.r+.59*t.g+.11*t.b);return t.r=t.g=t.b=e,this}opaquer(t){return this._rgb.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return C(this._rgb,2,t),this}darken(t){return C(this._rgb,2,-t),this}saturate(t){return C(this._rgb,1,t),this}desaturate(t){return C(this._rgb,1,-t),this}rotate(t){return function(t,e){var i=y(t);i[0]=b(i[0]+e),i=v(i),t.r=i[0],t.g=i[1],t.b=i[2]}(this._rgb,t),this}}function P(){}const L=(()=>{let t=0;return()=>t++})();function F(t){return null==t}function R(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return"[object"===e.slice(0,7)&&"Array]"===e.slice(-6)}function O(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}function B(t){return("number"==typeof t||t instanceof Number)&&isFinite(+t)}function V(t,e){return B(t)?t:e}function N(t,e){return void 0===t?e:t}const q=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100:+t/e,j=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100*e:+t;function $(t,e,i){if(t&&"function"==typeof t.call)return t.apply(i,e)}function U(t,e,i,n){let r,s,o;if(R(t))if(s=t.length,n)for(r=s-1;r>=0;r--)e.call(i,t[r],r);else for(r=0;r<s;r++)e.call(i,t[r],r);else if(O(t))for(o=Object.keys(t),s=o.length,r=0;r<s;r++)e.call(i,t[o[r]],o[r])}function Z(t,e){let i,n,r,s;if(!t||!e||t.length!==e.length)return!1;for(i=0,n=t.length;i<n;++i)if(r=t[i],s=e[i],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function W(t){if(R(t))return t.map(W);if(O(t)){const e=Object.create(null),i=Object.keys(t),n=i.length;let r=0;for(;r<n;++r)e[i[r]]=W(t[i[r]]);return e}return t}function G(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}function H(t,e,i,n){if(!G(t))return;const r=e[t],s=i[t];O(r)&&O(s)?X(r,s,n):e[t]=W(s)}function X(t,e,i){const n=R(e)?e:[e],r=n.length;if(!O(t))return t;const s=(i=i||{}).merger||H;let o;for(let e=0;e<r;++e){if(o=n[e],!O(o))continue;const r=Object.keys(o);for(let e=0,n=r.length;e<n;++e)s(r[e],t,o,i)}return t}function Y(t,e){return X(t,e,{merger:K})}function K(t,e,i){if(!G(t))return;const n=e[t],r=i[t];O(n)&&O(r)?Y(n,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=W(r))}const J={"":t=>t,x:t=>t.x,y:t=>t.y};function Q(t,e){const i=J[e]||(J[e]=function(t){const e=function(t){const e=t.split("."),i=[];let n="";for(const t of e)n+=t,n.endsWith("\\")?n=n.slice(0,-1)+".":(i.push(n),n="");return i}(t);return t=>{for(const i of e){if(""===i)break;t=t&&t[i]}return t}}(e));return i(t)}function tt(t){return t.charAt(0).toUpperCase()+t.slice(1)}const et=t=>void 0!==t,it=t=>"function"==typeof t,nt=(t,e)=>{if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0};function rt(t){return"mouseup"===t.type||"click"===t.type||"contextmenu"===t.type}const st=Math.PI,ot=2*st,at=ot+st,lt=Number.POSITIVE_INFINITY,ct=st/180,ut=st/2,ht=st/4,dt=2*st/3,pt=Math.log10,ft=Math.sign;function mt(t,e,i){return Math.abs(t-e)<i}function gt(t){const e=Math.round(t);t=mt(t,e,t/1e3)?e:t;const i=Math.pow(10,Math.floor(pt(t))),n=t/i;return(n<=1?1:n<=2?2:n<=5?5:10)*i}function _t(t){const e=[],i=Math.sqrt(t);let n;for(n=1;n<i;n++)t%n==0&&(e.push(n),e.push(t/n));return i===(0|i)&&e.push(i),e.sort(((t,e)=>t-e)).pop(),e}function yt(t){return!isNaN(parseFloat(t))&&isFinite(t)}function xt(t,e){const i=Math.round(t);return i-e<=t&&i+e>=t}function vt(t,e,i){let n,r,s;for(n=0,r=t.length;n<r;n++)s=t[n][i],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function bt(t){return t*(st/180)}function wt(t){return t*(180/st)}function kt(t){if(!B(t))return;let e=1,i=0;for(;Math.round(t*e)/e!==t;)e*=10,i++;return i}function St(t,e){const i=e.x-t.x,n=e.y-t.y,r=Math.sqrt(i*i+n*n);let s=Math.atan2(n,i);return s<-.5*st&&(s+=ot),{angle:s,distance:r}}function Tt(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function At(t,e){return(t-e+at)%ot-st}function Mt(t){return(t%ot+ot)%ot}function Ct(t,e,i,n){const r=Mt(t),s=Mt(e),o=Mt(i),a=Mt(s-r),l=Mt(o-r),c=Mt(r-s),u=Mt(r-o);return r===s||r===o||n&&s===o||a>l&&c<u}function Et(t,e,i){return Math.max(e,Math.min(i,t))}function It(t){return Et(t,-32768,32767)}function Dt(t,e,i,n=1e-6){return t>=Math.min(e,i)-n&&t<=Math.max(e,i)+n}function zt(t,e,i){i=i||(i=>t[i]<e);let n,r=t.length-1,s=0;for(;r-s>1;)n=s+r>>1,i(n)?s=n:r=n;return{lo:s,hi:r}}const Pt=(t,e,i,n)=>zt(t,i,n?n=>{const r=t[n][e];return r<i||r===i&&t[n+1][e]===i}:n=>t[n][e]<i),Lt=(t,e,i)=>zt(t,i,(n=>t[n][e]>=i));function Ft(t,e,i){let n=0,r=t.length;for(;n<r&&t[n]<e;)n++;for(;r>n&&t[r-1]>i;)r--;return n>0||r<t.length?t.slice(n,r):t}const Rt=["push","pop","shift","splice","unshift"];function Ot(t,e){t._chartjs?t._chartjs.listeners.push(e):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Rt.forEach((e=>{const i="_onData"+tt(e),n=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value(...e){const r=n.apply(this,e);return t._chartjs.listeners.forEach((t=>{"function"==typeof t[i]&&t[i](...e)})),r}})})))}function Bt(t,e){const i=t._chartjs;if(!i)return;const n=i.listeners,r=n.indexOf(e);-1!==r&&n.splice(r,1),n.length>0||(Rt.forEach((e=>{delete t[e]})),delete t._chartjs)}function Vt(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const Nt="undefined"==typeof window?function(t){return t()}:window.requestAnimationFrame;function qt(t,e){let i=[],n=!1;return function(...r){i=r,n||(n=!0,Nt.call(window,(()=>{n=!1,t.apply(e,i)})))}}function jt(t,e){let i;return function(...n){return e?(clearTimeout(i),i=setTimeout(t,e,n)):t.apply(this,n),e}}const $t=t=>"start"===t?"left":"end"===t?"right":"center",Ut=(t,e,i)=>"start"===t?e:"end"===t?i:(e+i)/2,Zt=(t,e,i,n)=>t===(n?"left":"right")?i:"center"===t?(e+i)/2:e;function Wt(t,e,i){const n=e.length;let r=0,s=n;if(t._sorted){const{iScale:o,_parsed:a}=t,l=o.axis,{min:c,max:u,minDefined:h,maxDefined:d}=o.getUserBounds();h&&(r=Et(Math.min(Pt(a,l,c).lo,i?n:Pt(e,l,o.getPixelForValue(c)).lo),0,n-1)),s=d?Et(Math.max(Pt(a,o.axis,u,!0).hi+1,i?0:Pt(e,l,o.getPixelForValue(u),!0).hi+1),r,n)-r:n-r}return{start:r,count:s}}function Gt(t){const{xScale:e,yScale:i,_scaleRanges:n}=t,r={xmin:e.min,xmax:e.max,ymin:i.min,ymax:i.max};if(!n)return t._scaleRanges=r,!0;const s=n.xmin!==e.min||n.xmax!==e.max||n.ymin!==i.min||n.ymax!==i.max;return Object.assign(n,r),s}const Ht=t=>0===t||1===t,Xt=(t,e,i)=>-Math.pow(2,10*(t-=1))*Math.sin((t-e)*ot/i),Yt=(t,e,i)=>Math.pow(2,-10*t)*Math.sin((t-e)*ot/i)+1,Kt={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>1-Math.cos(t*ut),easeOutSine:t=>Math.sin(t*ut),easeInOutSine:t=>-.5*(Math.cos(st*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>Ht(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,-10*(2*t-1))),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Ht(t)?t:Xt(t,.075,.3),easeOutElastic:t=>Ht(t)?t:Yt(t,.075,.3),easeInOutElastic(t){const e=.1125;return Ht(t)?t:t<.5?.5*Xt(2*t,e,.45):.5+.5*Yt(2*t-1,e,.45)},easeInBack(t){const e=1.70158;return t*t*((e+1)*t-e)},easeOutBack(t){const e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:t=>1-Kt.easeOutBounce(1-t),easeOutBounce(t){const e=7.5625,i=2.75;return t<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375},easeInOutBounce:t=>t<.5?.5*Kt.easeInBounce(2*t):.5*Kt.easeOutBounce(2*t-1)+.5};function Jt(t){if(t&&"object"==typeof t){const e=t.toString();return"[object CanvasPattern]"===e||"[object CanvasGradient]"===e}return!1}function Qt(t){return Jt(t)?t:new z(t)}function te(t){return Jt(t)?t:new z(t).saturate(.5).darken(.1).hexString()}const ee=["x","y","borderWidth","radius","tension"],ie=["color","borderColor","backgroundColor"],ne=new Map;function re(t,e,i){return function(t,e){e=e||{};const i=t+JSON.stringify(e);let n=ne.get(i);return n||(n=new Intl.NumberFormat(t,e),ne.set(i,n)),n}(e,i).format(t)}const se={values(t){return R(t)?t:""+t},numeric(t,e,i){if(0===t)return"0";const n=this.chart.options.locale;let r,s=t;if(i.length>1){const e=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(e<1e-4||e>1e15)&&(r="scientific"),s=function(t,e){let i=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(i)>=1&&t!==Math.floor(t)&&(i=t-Math.floor(t)),i}(t,i)}const o=pt(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),re(t,n,l)},logarithmic(t,e,i){if(0===t)return"0";const n=i[e].significand||t/Math.pow(10,Math.floor(pt(t)));return[1,2,3,5,10,15].includes(n)||e>.8*i.length?se.numeric.call(this,t,e,i):""}};var oe={formatters:se};const ae=Object.create(null),le=Object.create(null);function ce(t,e){if(!e)return t;const i=e.split(".");for(let e=0,n=i.length;e<n;++e){const n=i[e];t=t[n]||(t[n]=Object.create(null))}return t}function ue(t,e,i){return"string"==typeof e?X(ce(t,e),i):X(ce(t,""),e)}class he{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,e)=>te(e.backgroundColor),this.hoverBorderColor=(t,e)=>te(e.borderColor),this.hoverColor=(t,e)=>te(e.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return ue(this,t,e)}get(t){return ce(this,t)}describe(t,e){return ue(le,t,e)}override(t,e){return ue(ae,t,e)}route(t,e,i,n){const r=ce(this,t),s=ce(this,i),o="_"+e;Object.defineProperties(r,{[o]:{value:r[e],writable:!0},[e]:{enumerable:!0,get(){const t=this[o],e=s[n];return O(t)?Object.assign({},e,t):N(t,e)},set(t){this[o]=t}}})}apply(t){t.forEach((t=>t(this)))}}var de=new he({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>"onProgress"!==t&&"onComplete"!==t&&"fn"!==t}),t.set("animations",{colors:{type:"color",properties:ie},numbers:{type:"number",properties:ee}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>0|t}}}})},function(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:oe.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&"callback"!==t&&"parser"!==t,_indexable:t=>"borderDash"!==t&&"tickBorderDash"!==t&&"dash"!==t}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:t=>"backdropPadding"!==t&&"callback"!==t,_indexable:t=>"backdropPadding"!==t})}]);function pe(t,e,i,n,r){let s=e[r];return s||(s=e[r]=t.measureText(r).width,i.push(r)),s>n&&(n=s),n}function fe(t,e,i,n){let r=(n=n||{}).data=n.data||{},s=n.garbageCollect=n.garbageCollect||[];n.font!==e&&(r=n.data={},s=n.garbageCollect=[],n.font=e),t.save(),t.font=e;let o=0;const a=i.length;let l,c,u,h,d;for(l=0;l<a;l++)if(h=i[l],null==h||R(h)){if(R(h))for(c=0,u=h.length;c<u;c++)d=h[c],null==d||R(d)||(o=pe(t,r,s,o,d))}else o=pe(t,r,s,o,h);t.restore();const p=s.length/2;if(p>i.length){for(l=0;l<p;l++)delete r[s[l]];s.splice(0,p)}return o}function me(t,e,i){const n=t.currentDevicePixelRatio,r=0!==i?Math.max(i/2,.5):0;return Math.round((e-r)*n)/n+r}function ge(t,e){(e=e||t.getContext("2d")).save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore()}function _e(t,e,i,n){ye(t,e,i,n,null)}function ye(t,e,i,n,r){let s,o,a,l,c,u,h,d;const p=e.pointStyle,f=e.rotation,m=e.radius;let g=(f||0)*ct;if(p&&"object"==typeof p&&(s=p.toString(),"[object HTMLImageElement]"===s||"[object HTMLCanvasElement]"===s))return t.save(),t.translate(i,n),t.rotate(g),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),void t.restore();if(!(isNaN(m)||m<=0)){switch(t.beginPath(),p){default:r?t.ellipse(i,n,r/2,m,0,0,ot):t.arc(i,n,m,0,ot),t.closePath();break;case"triangle":u=r?r/2:m,t.moveTo(i+Math.sin(g)*u,n-Math.cos(g)*m),g+=dt,t.lineTo(i+Math.sin(g)*u,n-Math.cos(g)*m),g+=dt,t.lineTo(i+Math.sin(g)*u,n-Math.cos(g)*m),t.closePath();break;case"rectRounded":c=.516*m,l=m-c,o=Math.cos(g+ht)*l,h=Math.cos(g+ht)*(r?r/2-c:l),a=Math.sin(g+ht)*l,d=Math.sin(g+ht)*(r?r/2-c:l),t.arc(i-h,n-a,c,g-st,g-ut),t.arc(i+d,n-o,c,g-ut,g),t.arc(i+h,n+a,c,g,g+ut),t.arc(i-d,n+o,c,g+ut,g+st),t.closePath();break;case"rect":if(!f){l=Math.SQRT1_2*m,u=r?r/2:l,t.rect(i-u,n-l,2*u,2*l);break}g+=ht;case"rectRot":h=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),t.moveTo(i-h,n-a),t.lineTo(i+d,n-o),t.lineTo(i+h,n+a),t.lineTo(i-d,n+o),t.closePath();break;case"crossRot":g+=ht;case"cross":h=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),t.moveTo(i-h,n-a),t.lineTo(i+h,n+a),t.moveTo(i+d,n-o),t.lineTo(i-d,n+o);break;case"star":h=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),t.moveTo(i-h,n-a),t.lineTo(i+h,n+a),t.moveTo(i+d,n-o),t.lineTo(i-d,n+o),g+=ht,h=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),t.moveTo(i-h,n-a),t.lineTo(i+h,n+a),t.moveTo(i+d,n-o),t.lineTo(i-d,n+o);break;case"line":o=r?r/2:Math.cos(g)*m,a=Math.sin(g)*m,t.moveTo(i-o,n-a),t.lineTo(i+o,n+a);break;case"dash":t.moveTo(i,n),t.lineTo(i+Math.cos(g)*(r?r/2:m),n+Math.sin(g)*m);break;case!1:t.closePath()}t.fill(),e.borderWidth>0&&t.stroke()}}function xe(t,e,i){return i=i||.5,!e||t&&t.x>e.left-i&&t.x<e.right+i&&t.y>e.top-i&&t.y<e.bottom+i}function ve(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function be(t){t.restore()}function we(t,e,i,n,r){if(!e)return t.lineTo(i.x,i.y);if("middle"===r){const n=(e.x+i.x)/2;t.lineTo(n,e.y),t.lineTo(n,i.y)}else"after"===r!=!!n?t.lineTo(e.x,i.y):t.lineTo(i.x,e.y);t.lineTo(i.x,i.y)}function ke(t,e,i,n){if(!e)return t.lineTo(i.x,i.y);t.bezierCurveTo(n?e.cp1x:e.cp2x,n?e.cp1y:e.cp2y,n?i.cp2x:i.cp1x,n?i.cp2y:i.cp1y,i.x,i.y)}function Se(t,e,i,n,r){if(r.strikethrough||r.underline){const s=t.measureText(n),o=e-s.actualBoundingBoxLeft,a=e+s.actualBoundingBoxRight,l=i-s.actualBoundingBoxAscent,c=i+s.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(o,u),t.lineTo(a,u),t.stroke()}}function Te(t,e){const i=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=i}function Ae(t,e,i,n,r,s={}){const o=R(e)?e:[e],a=s.strokeWidth>0&&""!==s.strokeColor;let l,c;for(t.save(),t.font=r.string,function(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),F(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}(t,s),l=0;l<o.length;++l)c=o[l],s.backdrop&&Te(t,s.backdrop),a&&(s.strokeColor&&(t.strokeStyle=s.strokeColor),F(s.strokeWidth)||(t.lineWidth=s.strokeWidth),t.strokeText(c,i,n,s.maxWidth)),t.fillText(c,i,n,s.maxWidth),Se(t,i,n,c,s),n+=Number(r.lineHeight);t.restore()}function Me(t,e){const{x:i,y:n,w:r,h:s,radius:o}=e;t.arc(i+o.topLeft,n+o.topLeft,o.topLeft,1.5*st,st,!0),t.lineTo(i,n+s-o.bottomLeft),t.arc(i+o.bottomLeft,n+s-o.bottomLeft,o.bottomLeft,st,ut,!0),t.lineTo(i+r-o.bottomRight,n+s),t.arc(i+r-o.bottomRight,n+s-o.bottomRight,o.bottomRight,ut,0,!0),t.lineTo(i+r,n+o.topRight),t.arc(i+r-o.topRight,n+o.topRight,o.topRight,0,-ut,!0),t.lineTo(i+o.topLeft,n)}const Ce=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Ee=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Ie(t,e){const i=(""+t).match(Ce);if(!i||"normal"===i[1])return 1.2*e;switch(t=+i[2],i[3]){case"px":return t;case"%":t/=100}return e*t}function De(t,e){const i={},n=O(e),r=n?Object.keys(e):e,s=O(t)?n?i=>N(t[i],t[e[i]]):e=>t[e]:()=>t;for(const t of r)i[t]=+s(t)||0;return i}function ze(t){return De(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Pe(t){return De(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Le(t){const e=ze(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Fe(t,e){t=t||{},e=e||de.font;let i=N(t.size,e.size);"string"==typeof i&&(i=parseInt(i,10));let n=N(t.style,e.style);n&&!(""+n).match(Ee)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const r={family:N(t.family,e.family),lineHeight:Ie(N(t.lineHeight,e.lineHeight),i),size:i,style:n,weight:N(t.weight,e.weight),string:""};return r.string=function(t){return!t||F(t.size)||F(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}(r),r}function Re(t,e,i,n){let r,s,o,a=!0;for(r=0,s=t.length;r<s;++r)if(o=t[r],void 0!==o&&(void 0!==e&&"function"==typeof o&&(o=o(e),a=!1),void 0!==i&&R(o)&&(o=o[i%o.length],a=!1),void 0!==o))return n&&!a&&(n.cacheable=!1),o}function Oe(t,e,i){const{min:n,max:r}=t,s=j(e,(r-n)/2),o=(t,e)=>i&&0===t?0:t+e;return{min:o(n,-Math.abs(s)),max:o(r,s)}}function Be(t,e){return Object.assign(Object.create(t),e)}function Ve(t,e=[""],i,n,r=(()=>t[0])){const s=i||t;void 0===n&&(n=Ye("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:s,_fallback:n,_getTarget:r,override:i=>Ve([i,...t],e,s,n)};return new Proxy(o,{deleteProperty(e,i){return delete e[i],delete e._keys,delete t[0][i],!0},get(i,n){return Ue(i,n,(()=>function(t,e,i,n){let r;for(const s of e)if(r=Ye(je(s,t),i),void 0!==r)return $e(t,r)?He(i,n,t,r):r}(n,e,t,i)))},getOwnPropertyDescriptor(t,e){return Reflect.getOwnPropertyDescriptor(t._scopes[0],e)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(t,e){return Ke(t).includes(e)},ownKeys(t){return Ke(t)},set(t,e,i){const n=t._storage||(t._storage=r());return t[e]=n[e]=i,delete t._keys,!0}})}function Ne(t,e,i,n){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:i,_stack:new Set,_descriptors:qe(t,n),setContext:e=>Ne(t,e,i,n),override:r=>Ne(t.override(r),e,i,n)};return new Proxy(r,{deleteProperty(e,i){return delete e[i],delete t[i],!0},get(t,e,i){return Ue(t,e,(()=>function(t,e,i){const{_proxy:n,_context:r,_subProxy:s,_descriptors:o}=t;let a=n[e];return it(a)&&o.isScriptable(e)&&(a=function(t,e,i,n){const{_proxy:r,_context:s,_subProxy:o,_stack:a}=i;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(s,o||n);return a.delete(t),$e(t,l)&&(l=He(r._scopes,r,t,l)),l}(e,a,t,i)),R(a)&&a.length&&(a=function(t,e,i,n){const{_proxy:r,_context:s,_subProxy:o,_descriptors:a}=i;if(void 0!==s.index&&n(t))return e[s.index%e.length];if(O(e[0])){const i=e,n=r._scopes.filter((t=>t!==i));e=[];for(const l of i){const i=He(n,r,t,l);e.push(Ne(i,s,o&&o[t],a))}}return e}(e,a,t,o.isIndexable)),$e(e,a)&&(a=Ne(a,r,s&&s[e],o)),a}(t,e,i)))},getOwnPropertyDescriptor(e,i){return e._descriptors.allKeys?Reflect.has(t,i)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,i)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(e,i){return Reflect.has(t,i)},ownKeys(){return Reflect.ownKeys(t)},set(e,i,n){return t[i]=n,delete e[i],!0}})}function qe(t,e={scriptable:!0,indexable:!0}){const{_scriptable:i=e.scriptable,_indexable:n=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:i,indexable:n,isScriptable:it(i)?i:()=>i,isIndexable:it(n)?n:()=>n}}const je=(t,e)=>t?t+tt(e):e,$e=(t,e)=>O(e)&&"adapters"!==t&&(null===Object.getPrototypeOf(e)||e.constructor===Object);function Ue(t,e,i){if(Object.prototype.hasOwnProperty.call(t,e))return t[e];const n=i();return t[e]=n,n}function Ze(t,e,i){return it(t)?t(e,i):t}const We=(t,e)=>!0===t?e:"string"==typeof t?Q(e,t):void 0;function Ge(t,e,i,n,r){for(const s of e){const e=We(i,s);if(e){t.add(e);const s=Ze(e._fallback,i,r);if(void 0!==s&&s!==i&&s!==n)return s}else if(!1===e&&void 0!==n&&i!==n)return null}return!1}function He(t,e,i,n){const r=e._rootScopes,s=Ze(e._fallback,i,n),o=[...t,...r],a=new Set;a.add(n);let l=Xe(a,o,i,s||i,n);return null!==l&&(void 0===s||s===i||(l=Xe(a,o,s,l,n),null!==l))&&Ve(Array.from(a),[""],r,s,(()=>function(t,e,i){const n=t._getTarget();e in n||(n[e]={});const r=n[e];return R(r)&&O(i)?i:r||{}}(e,i,n)))}function Xe(t,e,i,n,r){for(;i;)i=Ge(t,e,i,n,r);return i}function Ye(t,e){for(const i of e){if(!i)continue;const e=i[t];if(void 0!==e)return e}}function Ke(t){let e=t._keys;return e||(e=t._keys=function(t){const e=new Set;for(const i of t)for(const t of Object.keys(i).filter((t=>!t.startsWith("_"))))e.add(t);return Array.from(e)}(t._scopes)),e}function Je(t,e,i,n){const{iScale:r}=t,{key:s="r"}=this._parsing,o=new Array(n);let a,l,c,u;for(a=0,l=n;a<l;++a)c=a+i,u=e[c],o[a]={r:r.parse(Q(u,s),c)};return o}const Qe=Number.EPSILON||1e-14,ti=(t,e)=>e<t.length&&!t[e].skip&&t[e],ei=t=>"x"===t?"y":"x";function ii(t,e,i,n){const r=t.skip?e:t,s=e,o=i.skip?e:i,a=Tt(s,r),l=Tt(o,s);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const h=n*c,d=n*u;return{previous:{x:s.x-h*(o.x-r.x),y:s.y-h*(o.y-r.y)},next:{x:s.x+d*(o.x-r.x),y:s.y+d*(o.y-r.y)}}}function ni(t,e,i){return Math.max(Math.min(t,i),e)}function ri(t,e,i,n,r){let s,o,a,l;if(e.spanGaps&&(t=t.filter((t=>!t.skip))),"monotone"===e.cubicInterpolationMode)!function(t,e="x"){const i=ei(e),n=t.length,r=Array(n).fill(0),s=Array(n);let o,a,l,c=ti(t,0);for(o=0;o<n;++o)if(a=l,l=c,c=ti(t,o+1),l){if(c){const t=c[e]-l[e];r[o]=0!==t?(c[i]-l[i])/t:0}s[o]=a?c?ft(r[o-1])!==ft(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}!function(t,e,i){const n=t.length;let r,s,o,a,l,c=ti(t,0);for(let u=0;u<n-1;++u)l=c,c=ti(t,u+1),l&&c&&(mt(e[u],0,Qe)?i[u]=i[u+1]=0:(r=i[u]/e[u],s=i[u+1]/e[u],a=Math.pow(r,2)+Math.pow(s,2),a<=9||(o=3/Math.sqrt(a),i[u]=r*o*e[u],i[u+1]=s*o*e[u])))}(t,r,s),function(t,e,i="x"){const n=ei(i),r=t.length;let s,o,a,l=ti(t,0);for(let c=0;c<r;++c){if(o=a,a=l,l=ti(t,c+1),!a)continue;const r=a[i],u=a[n];o&&(s=(r-o[i])/3,a[`cp1${i}`]=r-s,a[`cp1${n}`]=u-s*e[c]),l&&(s=(l[i]-r)/3,a[`cp2${i}`]=r+s,a[`cp2${n}`]=u+s*e[c])}}(t,s,e)}(t,r);else{let i=n?t[t.length-1]:t[0];for(s=0,o=t.length;s<o;++s)a=t[s],l=ii(i,a,t[Math.min(s+1,o-(n?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,i=a}e.capBezierPoints&&function(t,e){let i,n,r,s,o,a=xe(t[0],e);for(i=0,n=t.length;i<n;++i)o=s,s=a,a=i<n-1&&xe(t[i+1],e),s&&(r=t[i],o&&(r.cp1x=ni(r.cp1x,e.left,e.right),r.cp1y=ni(r.cp1y,e.top,e.bottom)),a&&(r.cp2x=ni(r.cp2x,e.left,e.right),r.cp2y=ni(r.cp2y,e.top,e.bottom)))}(t,i)}function si(){return"undefined"!=typeof window&&"undefined"!=typeof document}function oi(t){let e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e}function ai(t,e,i){let n;return"string"==typeof t?(n=parseInt(t,10),-1!==t.indexOf("%")&&(n=n/100*e.parentNode[i])):n=t,n}const li=t=>t.ownerDocument.defaultView.getComputedStyle(t,null),ci=["top","right","bottom","left"];function ui(t,e,i){const n={};i=i?"-"+i:"";for(let r=0;r<4;r++){const s=ci[r];n[s]=parseFloat(t[e+"-"+s+i])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}function hi(t,e){if("native"in t)return t;const{canvas:i,currentDevicePixelRatio:n}=e,r=li(i),s="border-box"===r.boxSizing,o=ui(r,"padding"),a=ui(r,"border","width"),{x:l,y:c,box:u}=function(t,e){const i=t.touches,n=i&&i.length?i[0]:t,{offsetX:r,offsetY:s}=n;let o,a,l=!1;if(((t,e,i)=>(t>0||e>0)&&(!i||!i.shadowRoot))(r,s,t.target))o=r,a=s;else{const t=e.getBoundingClientRect();o=n.clientX-t.left,a=n.clientY-t.top,l=!0}return{x:o,y:a,box:l}}(t,i),h=o.left+(u&&a.left),d=o.top+(u&&a.top);let{width:p,height:f}=e;return s&&(p-=o.width+a.width,f-=o.height+a.height),{x:Math.round((l-h)/p*i.width/n),y:Math.round((c-d)/f*i.height/n)}}const di=t=>Math.round(10*t)/10;function pi(t,e,i,n){const r=li(t),s=ui(r,"margin"),o=ai(r.maxWidth,t,"clientWidth")||lt,a=ai(r.maxHeight,t,"clientHeight")||lt,l=function(t,e,i){let n,r;if(void 0===e||void 0===i){const s=oi(t);if(s){const t=s.getBoundingClientRect(),o=li(s),a=ui(o,"border","width"),l=ui(o,"padding");e=t.width-l.width-a.width,i=t.height-l.height-a.height,n=ai(o.maxWidth,s,"clientWidth"),r=ai(o.maxHeight,s,"clientHeight")}else e=t.clientWidth,i=t.clientHeight}return{width:e,height:i,maxWidth:n||lt,maxHeight:r||lt}}(t,e,i);let{width:c,height:u}=l;if("content-box"===r.boxSizing){const t=ui(r,"border","width"),e=ui(r,"padding");c-=e.width+t.width,u-=e.height+t.height}return c=Math.max(0,c-s.width),u=Math.max(0,n?c/n:u-s.height),c=di(Math.min(c,o,l.maxWidth)),u=di(Math.min(u,a,l.maxHeight)),c&&!u&&(u=di(c/2)),(void 0!==e||void 0!==i)&&n&&l.height&&u>l.height&&(u=l.height,c=di(Math.floor(u*n))),{width:c,height:u}}function fi(t,e,i){const n=e||1,r=Math.floor(t.height*n),s=Math.floor(t.width*n);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const o=t.canvas;return o.style&&(i||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),(t.currentDevicePixelRatio!==n||o.height!==r||o.width!==s)&&(t.currentDevicePixelRatio=n,o.height=r,o.width=s,t.ctx.setTransform(n,0,0,n,0,0),!0)}const mi=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};si()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch(t){}return t}();function gi(t,e){const i=function(t,e){return li(t).getPropertyValue(e)}(t,e),n=i&&i.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function _i(t,e,i,n){return{x:t.x+i*(e.x-t.x),y:t.y+i*(e.y-t.y)}}function yi(t,e,i,n){return{x:t.x+i*(e.x-t.x),y:"middle"===n?i<.5?t.y:e.y:"after"===n?i<1?t.y:e.y:i>0?e.y:t.y}}function xi(t,e,i,n){const r={x:t.cp2x,y:t.cp2y},s={x:e.cp1x,y:e.cp1y},o=_i(t,r,i),a=_i(r,s,i),l=_i(s,e,i),c=_i(o,a,i),u=_i(a,l,i);return _i(c,u,i)}function vi(t,e,i){return t?function(t,e){return{x(i){return t+t+e-i},setWidth(t){e=t},textAlign(t){return"center"===t?t:"right"===t?"left":"right"},xPlus(t,e){return t-e},leftForLtr(t,e){return t-e}}}(e,i):{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}}function bi(t,e){let i,n;"ltr"!==e&&"rtl"!==e||(i=t.canvas.style,n=[i.getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",e,"important"),t.prevTextDirection=n)}function wi(t,e){void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function ki(t){return"angle"===t?{between:Ct,compare:At,normalize:Mt}:{between:Dt,compare:(t,e)=>t-e,normalize:t=>t}}function Si({start:t,end:e,count:i,loop:n,style:r}){return{start:t%i,end:e%i,loop:n&&(e-t+1)%i==0,style:r}}function Ti(t,e,i){if(!i)return[t];const{property:n,start:r,end:s}=i,o=e.length,{compare:a,between:l,normalize:c}=ki(n),{start:u,end:h,loop:d,style:p}=function(t,e,i){const{property:n,start:r,end:s}=i,{between:o,normalize:a}=ki(n),l=e.length;let c,u,{start:h,end:d,loop:p}=t;if(p){for(h+=l,d+=l,c=0,u=l;c<u&&o(a(e[h%l][n]),r,s);++c)h--,d--;h%=l,d%=l}return d<h&&(d+=l),{start:h,end:d,loop:p,style:t.style}}(t,e,i),f=[];let m,g,_,y=!1,x=null;for(let t=u,i=u;t<=h;++t)g=e[t%o],g.skip||(m=c(g[n]),m!==_&&(y=l(m,r,s),null===x&&(y||l(r,_,m)&&0!==a(r,_))&&(x=0===a(m,r)?t:i),null!==x&&(!y||0===a(s,m)||l(s,_,m))&&(f.push(Si({start:x,end:t,loop:d,count:o,style:p})),x=null),i=t,_=m));return null!==x&&f.push(Si({start:x,end:h,loop:d,count:o,style:p})),f}function Ai(t,e){const i=[],n=t.segments;for(let r=0;r<n.length;r++){const s=Ti(n[r],t.points,e);s.length&&i.push(...s)}return i}function Mi(t,e){const i=t.points,n=t.options.spanGaps,r=i.length;if(!r)return[];const s=!!t._loop,{start:o,end:a}=function(t,e,i,n){let r=0,s=e-1;if(i&&!n)for(;r<e&&!t[r].skip;)r++;for(;r<e&&t[r].skip;)r++;for(r%=e,i&&(s+=r);s>r&&t[s%e].skip;)s--;return s%=e,{start:r,end:s}}(i,r,s,n);return Ci(t,!0===n?[{start:o,end:a,loop:s}]:function(t,e,i,n){const r=t.length,s=[];let o,a=e,l=t[e];for(o=e+1;o<=i;++o){const i=t[o%r];i.skip||i.stop?l.skip||(n=!1,s.push({start:e%r,end:(o-1)%r,loop:n}),e=a=i.stop?o:null):(a=o,l.skip&&(e=o)),l=i}return null!==a&&s.push({start:e%r,end:a%r,loop:n}),s}(i,o,a<o?a+r:a,!!t._fullLoop&&0===o&&a===r-1),i,e)}function Ci(t,e,i,n){return n&&n.setContext&&i?function(t,e,i,n){const r=t._chart.getContext(),s=Ei(t.options),{_datasetIndex:o,options:{spanGaps:a}}=t,l=i.length,c=[];let u=s,h=e[0].start,d=h;function p(t,e,n,r){const s=a?-1:1;if(t!==e){for(t+=l;i[t%l].skip;)t-=s;for(;i[e%l].skip;)e+=s;t%l!=e%l&&(c.push({start:t%l,end:e%l,loop:n,style:r}),u=r,h=e%l)}}for(const t of e){h=a?h:t.start;let e,s=i[h%l];for(d=h+1;d<=t.end;d++){const a=i[d%l];e=Ei(n.setContext(Be(r,{type:"segment",p0:s,p1:a,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:o}))),Ii(e,u)&&p(h,d-1,t.loop,u),s=a,u=e}h<d-1&&p(h,d-1,t.loop,u)}return c}(t,e,i,n):e}function Ei(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function Ii(t,e){if(!e)return!1;const i=[],n=function(t,e){return Jt(e)?(i.includes(e)||i.push(e),i.indexOf(e)):e};return JSON.stringify(t,n)!==JSON.stringify(e,n)}},47220:function(t,e,i){"use strict";i.d(e,{P:function(){return z},T:function(){return y}});var n=i(68518),r=i(9006);const s=(t,e)=>e>t||t.length>e.length&&t.slice(0,e.length)===e,o=t=>""+t;function a(t,e,i,n=[],s=0,l=[]){const c=s-1;if(t[0]in i&&s>0){const r=n.reduce((function(t,e,i){return i!==c&&(t[o(i)]=e),t}),{});r[e]=n[c],t.forEach((function(t){r[t]=i[t]})),l.push(r)}else for(const o of Object.keys(i)){const c=i[o];(0,r.i)(c)&&(n.push(o),a(t,e,c,n,s+1,l))}return n.splice(c,1),l}function l(t,e,i){const n=a(t,e,i);if(!n.length)return n;const r=n.reduce((function(t,e){const i=Object.keys(e).length-2;return t>i?t:i}));return n.forEach((function(t){for(let e=0;e<r;e++){const i=o(e);t[i]||(t[i]="")}})),n}function c(t,e,i){if(!t.length)return;const n=[];for(const r of t){const t=e[r];if(""===t){n.push(i);break}n.push(t)}return n.length?n.join("."):i}const u=new Map;function h(t,e){const{x:i,y:n,width:r,height:s}=t.getProps(["x","y","width","height"],e);return{left:i,top:n,right:i+r,bottom:n+s}}function d(t,e,i){return Math.max(Math.min(t,i),e)}function p(t,e,i){const n=(0,r.av)(t);return{t:d(n.top,0,i),r:d(n.right,0,e),b:d(n.bottom,0,i),l:d(n.left,0,e)}}function f(t,e,i,n){const r=null===e,s=null===i,o=!(!t||r&&s)&&h(t,n);return o&&(r||e>=o.left&&e<=o.right)&&(s||i>=o.top&&i<=o.bottom)}function m(t,e){t.rect(e.x,e.y,e.w,e.h)}function g(t,e){if(!e||!1===e.display)return!1;const{w:i,h:n}=t,s=(0,r.a0)(e.font).lineHeight,o=d(2*(0,r.v)(e.padding,3),0,Math.min(i,n));return i-o>s&&n-o>s}function _(t,e,i){return"left"===e?t.x+i:"right"===e?t.x+t.w-i:t.x+t.w/2}class y extends n.Hg{constructor(t){super(),this.options=void 0,this.width=void 0,this.height=void 0,t&&Object.assign(this,t)}draw(t,e,i=0){if(!e)return;const n=this.options,{inner:s,outer:o}=function(t){const e=h(t),i=e.right-e.left,n=e.bottom-e.top,s=p(t.options.borderWidth,i/2,n/2),o=function(t,e,i){const n=(0,r.aw)(t),s=Math.min(e,i);return{topLeft:d(n.topLeft,0,s),topRight:d(n.topRight,0,s),bottomLeft:d(n.bottomLeft,0,s),bottomRight:d(n.bottomRight,0,s)}}(t.options.borderRadius,i/2,n/2),a={x:e.left,y:e.top,w:i,h:n,active:t.active,radius:o};return{outer:a,inner:{x:a.x+s.l,y:a.y+s.t,w:a.w-s.l-s.r,h:a.h-s.t-s.b,active:t.active,radius:{topLeft:Math.max(0,o.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,o.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(s.b,s.r))}}}}(this),a=(l=o.radius).topLeft||l.topRight||l.bottomLeft||l.bottomRight?r.au:m;var l;t.save(),o.w===s.w&&o.h===s.h||(t.beginPath(),a(t,o),t.clip(),a(t,s),t.fillStyle=n.borderColor,t.fill("evenodd")),t.beginPath(),a(t,s),t.fillStyle=n.backgroundColor,t.fill(),function(t,e,i,n){const r=i.dividers;if(!r.display||!n._data.children.length)return;const{x:s,y:o,w:a,h:l}=e,{lineColor:c,lineCapStyle:u,lineDash:h,lineDashOffset:d,lineWidth:p}=r;if(t.save(),t.strokeStyle=c,t.lineCap=u,t.setLineDash(h),t.lineDashOffset=d,t.lineWidth=p,t.beginPath(),a>l){const e=a/2;t.moveTo(s+e,o),t.lineTo(s+e,o+l)}else{const e=l/2;t.moveTo(s,o+e),t.lineTo(s+a,o+e)}t.stroke(),t.restore()}(t,s,n,e),function(t,e,i,n,s){const{captions:o,labels:a}=i;t.save(),t.beginPath(),t.rect(e.x,e.y,e.w,e.h),t.clip();const l=n&&(!(0,r.h)(n.l)||n.l===s);l&&a.display?function(t,e,i){const n=i.labels,s=n.formatter;if(!s)return;const o=(0,r.b)(s)?s:[s];let a=function(t,e){const{font:i,hoverFont:n}=e,s=(t.active?n:i)||i;return(0,r.b)(s)?s.map((t=>(0,r.a0)(t))):[(0,r.a0)(s)]}(e,n),l=function(t,e,i){const n=i.reduce((function(t,e){return t+e.string}),""),r=e.join()+n+(t._measureText?"-spriting":"");if(!u.has(r)){t.save();const n=e.length;let s=0,o=0;for(let r=0;r<n;r++){const n=i[Math.min(r,i.length-1)];t.font=n.string;const a=e[r];s=Math.max(s,t.measureText(a).width),o+=n.lineHeight}t.restore(),u.set(r,{width:s,height:o})}return u.get(r)}(t,o,a);const c=function(t,e,i,n){const{overflow:r,padding:s}=i,{width:o,height:a}=n;if("hidden"===r)return!(o+2*s>e.w||a+2*s>e.h);if("fit"===r){const t=Math.min(e.w/(o+2*s),e.h/(a+2*s));if(t<1)return t}return!0}(0,e,n,l);if(!c)return;(0,r.x)(c)&&(l={width:l.width*c,height:l.height*c},a=function(t,e){return t.map((function(t){return t.size=Math.floor(t.size*e),t.lineHeight=void 0,(0,r.a0)(t)}))}(a,c));const{color:h,hoverColor:d,align:p}=n,f=(e.active?d:h)||h,m=(0,r.b)(f)?f:[f],g=function(t,e,i){const{align:n,position:r,padding:s}=e;let o,a;return o=_(t,n,s),a="top"===r?t.y+s:"bottom"===r?t.y+t.h-s-i.height:t.y+(t.h-i.height)/2+s,{x:o,y:a}}(e,n,l);t.textAlign=p,t.textBaseline="middle";let y=0;o.forEach((function(e,i){const n=m[Math.min(i,m.length-1)],r=a[Math.min(i,a.length-1)],s=r.lineHeight;t.font=r.string,t.fillStyle=n,t.fillText(e,g.x,g.y+s/2+y),y+=s}))}(t,e,i):!l&&g(e,o)&&function(t,e,i,n){const{captions:s,spacing:o,rtl:a}=i,{color:l,hoverColor:c,font:u,hoverFont:h,padding:d,align:p,formatter:f}=s,m=(e.active?c:l)||l,g=p||(a?"right":"left"),y=(e.active?h:u)||u,x=(0,r.a0)(y),v=x.lineHeight/2,b=_(e,g,d);t.fillStyle=m,t.font=x.string,t.textAlign=g,t.textBaseline="middle",t.fillText(f||n.g,b,e.y+d+o+v)}(t,e,i,n),t.restore()}(t,s,n,e,i),t.restore()}inRange(t,e,i){return f(this,t,e,i)}inXRange(t,e){return f(this,t,null,e)}inYRange(t,e){return f(this,null,t,e)}getCenterPoint(t){const{x:e,y:i,width:n,height:r}=this.getProps(["x","y","width","height"],t);return{x:e+n/2,y:i+r/2}}tooltipPosition(){return this.getCenterPoint()}getRange(t){return"x"===t?this.width/2:this.height/2}}function x(t,e,i,n){const r=t._normalized,s=e*r/i,o=Math.sqrt(r*s),a=r/o;return{d1:o,d2:a,w:"_ix"===n?o:a,h:"_ix"===n?a:o}}y.id="treemap",y.defaults={label:void 0,borderRadius:0,borderWidth:0,captions:{align:void 0,color:"black",display:!0,font:{},formatter:t=>t.raw.g||t.raw._data.label||"",padding:3},dividers:{display:!1,lineCapStyle:"butt",lineColor:"black",lineDash:[],lineDashOffset:0,lineWidth:1},labels:{align:"center",color:"black",display:!1,font:{},formatter(t){return t.raw.g?[t.raw.g,t.raw.v+""]:t.raw._data.label?[t.raw._data.label,t.raw.v+""]:t.raw.v+""},overflow:"cut",position:"middle",padding:3},rtl:!1,spacing:.5},y.descriptors={labels:{_fallback:!0},captions:{_fallback:!0},_scriptable:!0,_indexable:!1},y.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};const v=(t,e)=>t.rtl?t.x+t.iw-e:t.x+t._ix;function b(t,e,i,n){const r={x:v(t,i.w),y:t.y+t._iy,w:i.w,h:i.h,a:e._normalized,v:e.value,vs:e.values,s:n,_data:e._data};return e.group&&(r.g=e.group,r.l=e.level,r.gs=e.groupSum),r}class w{constructor(t){t=t||{w:1,h:1},this.rtl=!!t.rtl,this.x=t.x||t.left||0,this.y=t.y||t.top||0,this._ix=0,this._iy=0,this.w=t.w||t.width||t.right-t.left,this.h=t.h||t.height||t.bottom-t.top}get area(){return this.w*this.h}get iw(){return this.w-this._ix}get ih(){return this.h-this._iy}get dir(){const t=this.ih;return t<=this.iw&&t>0?"y":"x"}get side(){return"x"===this.dir?this.iw:this.ih}map(t){const{dir:e,side:i}=this,n="x"===e?"_ix":"_iy",r=t.nsum,s=t.get(),o=i*i,a=r*r,l=[];let c=0,u=0;for(const e of s){const i=x(e,o,a,n);u+=i.d1,c=Math.max(c,i.d2),l.push(b(this,e,i,t.sum)),this[n]+=i.d1}return this["x"===e?"_iy":"_ix"]+=c,this[n]-=u,l}}const k=Math.min,S=Math.max;function T(t,e){const i=+e[t.key],n=i*t.ratio;return e._normalized=n,{min:k(t.min,i),max:S(t.max,i),sum:t.sum+i,nmin:k(t.nmin,n),nmax:S(t.nmax,n),nsum:t.nsum+n}}function A(t,e,i){t._arr.push(e),function(t,e){Object.assign(t,e)}(t,i)}class M{constructor(t,e){const i=this;i.key=t,i.ratio=e,i.reset()}get length(){return this._arr.length}reset(){const t=this;t._arr=[],t._hist=[],t.sum=0,t.nsum=0,t.min=1/0,t.max=-1/0,t.nmin=1/0,t.nmax=-1/0}push(t){A(this,t,T(this,t))}pushIf(t,e,...i){const n=T(this,t);if(!e((r=this,{min:r.min,max:r.max,sum:r.sum,nmin:r.nmin,nmax:r.nmax,nsum:r.nsum}),n,i))return t;var r;A(this,t,n)}get(){return this._arr}}function C(t,e,i){if(0===t.sum)return!0;const[n]=i,r=t.nsum*t.nsum,s=e.nsum*e.nsum,o=n*n,a=Math.max(o*t.nmax/r,r/(o*t.nmin));return Math.max(o*e.nmax/s,s/(o*e.nmin))<=a}function E(t,e,i=[],n,s,o){t=t||[];const a=[],l=new w(e),c=new M("value",l.area/function(t,e){let i,n,r;for(i=0,n=0,r=t.length;n<r;++n)i+=e?+t[n][e]:+t[n];return i}(t,i[0]));let u=l.side;const h=t.length;let d,p;if(!h)return a;const f=t.slice();let m=function(t,e){let i,n=t.length;if(!n)return e;const s=(0,r.i)(t[0]);for(e=s?e:"v",i=0,n=t.length;i<n;++i)s?t[i]._idx=i:t[i]={v:t[i],_idx:i};return e}(f,i[0]);!function(t,e){e?t.sort(((t,i)=>+i[e]-+t[e])):t.sort(((t,e)=>+e-+t))}(f,m);const g=t=>n&&f[t][n];for(d=0;d<h;++d){if(p={value:(_=d,m?+f[_][m]:+f[_]),groupSum:o,_data:t[f[d]._idx],level:void 0,group:void 0},n){p.level=s,p.group=g(d);const t=f[d];p.values=i.reduce((function(e,i){return e[i]=+t[i],e}),{})}p=c.pushIf(p,C,u),p&&(a.push(l.map(c)),u=l.side,c.reset(),c.push(p))}var _;return c.length&&a.push(l.map(c)),function(t){const e=[...t],i=[];for(;e.length;){const t=e.pop();Array.isArray(t)?e.push(...t):i.push(t)}return i.reverse()}(a)}function I(t,e,i,n){const r=2*n,s=e.getPixelForValue(t.x),o=i.getPixelForValue(t.y),a=e.getPixelForValue(t.x+t.w)-s,l=i.getPixelForValue(t.y+t.h)-o;return{x:s+n,y:o+n,width:a-r,height:l-r,hidden:r>a||r>l}}function D(t,e){let i,n;if(!t||!e)return!0;if(t===e)return!1;if(t.length!==e.length)return!0;for(i=0,n=t.length;i<n;++i)if(t[i]!==e[i])return!0;return!1}class z extends n.n{constructor(t,e){super(t,e),this._groups=void 0,this._keys=void 0,this._rect=void 0,this._rectChanged=!0}initialize(){this.enableOptionSharing=!0,super.initialize()}getMinMax(t){return{min:0,max:"x"===t.axis?t.right-t.left:t.bottom-t.top}}configure(){super.configure();const{xScale:t,yScale:e}=this.getMeta();if(!t||!e)return;const i=t.right-t.left,n=e.bottom-e.top,r={x:0,y:0,w:i,h:n,rtl:!!this.options.rtl};var s,o;o=r,(s=this._rect)&&o&&s.x===o.x&&s.y===o.y&&s.w===o.w&&s.h===o.h&&s.rtl===o.rtl||(this._rect=r,this._rectChanged=!0),this._rectChanged&&(t.max=i,t.configure(),e.max=n,e.configure())}update(t){const e=this.getDataset(),{data:i}=this.getMeta(),n=e.groups||[],s=[e.key||""].concat(e.sumKeys||[]),a=e.tree=e.tree||e.data||[];"reset"===t&&this.configure(),(this._rectChanged||D(this._keys,s)||D(this._groups,n)||this._prevTree!==a)&&(this._groups=n.slice(),this._keys=s.slice(),this._prevTree=a,this._rectChanged=!1,e.data=function(t,e,i,n){const s=e.treeLeafKey||"_leaf";(0,r.i)(t)&&(t=l(i,s,t));const a=e.groups||[],u=a.length,h=(0,r.v)(e.spacing,0),d=e.captions||{},f=(0,r.a0)(d.font),m=(0,r.v)(d.padding,3);return u?function n(r,l,_,y){const x=o(a[r]),v=r>0&&o(a[r-1]),b=function(t,e,i,n,r,s,o=[]){const a=i[0],l=i.slice(1),u=Object.create(null),h=Object.create(null),d=[];let p,f,m;for(f=0,m=t.length;f<m;++f){const i=t[f];if(r&&i[r]!==s)continue;if(p=i[e]||i[n]||"",!(p in u)){const t=u[p]={value:0};l.forEach((function(e){t[e]=0})),h[p]=[]}u[p].value+=+i[a],u[p].label=i[e]||"";const d=u[p];l.forEach((function(t){d[t]+=i[t]})),u[p].path=c(o,i,p),h[p].push(i)}return Object.keys(u).forEach((t=>{const i={children:h[t]};i[a]=+u[t].value,l.forEach((function(e){i[e]=+u[t][e]})),i[e]=u[t].label,i.label=t,i.path=u[t].path,r&&(i[r]=s),d.push(i)})),d}(t,x,i,s,v,_,a.filter(((t,e)=>e<=r))),w=E(b,l,i,x,r,y),k=w.slice();return r<u-1&&w.forEach((t=>{const i=p(e.borderWidth,t.w/2,t.h/2),s={...l,x:t.x+h+i.l,y:t.y+h+i.t,w:t.w-2*h-i.l-i.r,h:t.h-2*h-i.t-i.b};g(s,d)&&(s.y+=f.lineHeight+2*m,s.h-=f.lineHeight+2*m),k.push(...n(r+1,s,t.g,t.s))})),k}(0,n):E(t,n,i)}(a,e,this._keys,this._rect),this._dataCheck(),this._resyncElements()),this.updateElements(i,0,i.length,t)}updateElements(t,e,i,n){const r="reset"===n,s=this.getDataset(),o=this._rect.options=this.resolveDataElementOptions(e,n),a=this.getSharedOptions(o),l=this.includeOptions(n,a),{xScale:c,yScale:u}=this.getMeta(this.index);for(let o=e;o<e+i;o++){const e=a||this.resolveDataElementOptions(o,n),i=I(s.data[o],c,u,e.spacing);r&&(i.width=0,i.height=0),l&&(i.options=e),this.updateElement(t[o],o,i,n)}this.updateSharedOptions(a,n,o)}draw(){const{ctx:t,chartArea:e}=this.chart,i=this.getMeta().data||[],n=this.getDataset(),s=(n.groups||[]).length-1,o=n.data;(0,r.Y)(t,e);for(let e=0,n=i.length;e<n;++e){const n=i[e];n.hidden||n.draw(t,o[e],s)}(0,r.$)(t)}}z.id="treemap",z.version="2.3.0",z.defaults={dataElementType:"treemap",animations:{numbers:{type:"number",properties:["x","y","width","height"]}}},z.descriptors={_scriptable:!0,_indexable:!1},z.overrides={interaction:{mode:"point",includeInvisible:!0,intersect:!0},hover:{},plugins:{tooltip:{position:"treemap",intersect:!0,callbacks:{title(t){return t.length&&t[0].dataset.key||""},label(t){const e=t.dataset,i=e.data[t.dataIndex],n=i.g||i._data.label||e.label;return(n?n+": ":"")+i.v}}}},scales:{x:{type:"linear",alignToPixels:!0,bounds:"data",display:!1},y:{type:"linear",alignToPixels:!0,bounds:"data",display:!1,reverse:!0}}},z.beforeRegister=function(){!function(t,e,i,n=!0){const r=i.split(".");let o=0;for(const a of e.split(".")){const l=r[o++];if(parseInt(a,10)<parseInt(l,10))break;if(s(l,a)){if(n)throw new Error(`${t} v${i} is not supported. v${e} or newer is required.`);return!1}}}("chart.js","3.8",n.t1.version)},z.afterRegister=function(){const t=n.u5.plugins.get("tooltip");t?t.positioners.treemap=function(t){return!!t.length&&t[t.length-1].element.tooltipPosition()}:console.warn("Unable to register the treemap positioner because tooltip plugin is not registered")},z.afterUnregister=function(){const t=n.u5.plugins.get("tooltip");t&&delete t.positioners.treemap}},6207:function(t,e,i){"use strict";i.d(e,{ph:function(){return n}});class n{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let i=0;for(let n=0;n<this._n&&n<32;n++){const r=e[n],s=t+r,o=Math.abs(t)<Math.abs(r)?t-(s-r):r-(s-t);o&&(e[i++]=o),t=s}return e[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let e,i,n,r=this._n,s=0;if(r>0){for(s=t[--r];r>0&&(e=s,i=t[--r],s=e+i,n=i-(s-e),!n););r>0&&(n<0&&t[r-1]<0||n>0&&t[r-1]>0)&&(i=2*n,e=s+i,i==e-s&&(s=e))}return s}}},92956:function(t,e){"use strict";e.A=t=>t},28992:function(t,e,i){"use strict";i.d(e,{$t:function(){return r},F2:function(){return u},F8:function(){return _},FA:function(){return l},FP:function(){return p},HQ:function(){return b},Ml:function(){return v},Ni:function(){return n},RZ:function(){return x},Rm:function(){return g},TW:function(){return o},_S:function(){return y},gn:function(){return f},gz:function(){return a},oN:function(){return m},pi:function(){return s},qR:function(){return w},rY:function(){return d},tn:function(){return h},uj:function(){return c}});var n=1e-6,r=1e-12,s=Math.PI,o=s/2,a=s/4,l=2*s,c=180/s,u=s/180,h=Math.abs,d=Math.atan,p=Math.atan2,f=Math.cos,m=(Math.ceil,Math.exp),g=(Math.floor,Math.hypot,Math.log),_=(Math.pow,Math.sin),y=Math.sign||function(t){return t>0?1:t<0?-1:0},x=Math.sqrt,v=Math.tan;function b(t){return t>1?0:t<-1?s:Math.acos(t)}function w(t){return t>1?o:t<-1?-o:Math.asin(t)}},87254:function(t,e,i){"use strict";function n(){}i.d(e,{A:function(){return n}})},44983:function(t,e,i){"use strict";var n=i(87254),r=1/0,s=r,o=-r,a=o,l={point:function(t,e){t<r&&(r=t),t>o&&(o=t),e<s&&(s=e),e>a&&(a=e)},lineStart:n.A,lineEnd:n.A,polygonStart:n.A,polygonEnd:n.A,result:function(){var t=[[r,s],[o,a]];return o=a=-(s=r=1/0),t}};e.A=l},60625:function(t,e,i){"use strict";i.d(e,{A:function(){return rt}});var n,r,s,o,a=i(92956),l=i(16598),c=i(6207),u=i(28992),h=i(87254),d=new c.ph,p=new c.ph,f={point:h.A,lineStart:h.A,lineEnd:h.A,polygonStart:function(){f.lineStart=m,f.lineEnd=y},polygonEnd:function(){f.lineStart=f.lineEnd=f.point=h.A,d.add((0,u.tn)(p)),p=new c.ph},result:function(){var t=d/2;return d=new c.ph,t}};function m(){f.point=g}function g(t,e){f.point=_,n=s=t,r=o=e}function _(t,e){p.add(o*t-s*e),s=t,o=e}function y(){_(n,r)}var x,v,b,w,k=f,S=i(44983),T=0,A=0,M=0,C=0,E=0,I=0,D=0,z=0,P=0,L={point:F,lineStart:R,lineEnd:V,polygonStart:function(){L.lineStart=N,L.lineEnd=q},polygonEnd:function(){L.point=F,L.lineStart=R,L.lineEnd=V},result:function(){var t=P?[D/P,z/P]:I?[C/I,E/I]:M?[T/M,A/M]:[NaN,NaN];return T=A=M=C=E=I=D=z=P=0,t}};function F(t,e){T+=t,A+=e,++M}function R(){L.point=O}function O(t,e){L.point=B,F(b=t,w=e)}function B(t,e){var i=t-b,n=e-w,r=(0,u.RZ)(i*i+n*n);C+=r*(b+t)/2,E+=r*(w+e)/2,I+=r,F(b=t,w=e)}function V(){L.point=F}function N(){L.point=j}function q(){$(x,v)}function j(t,e){L.point=$,F(x=b=t,v=w=e)}function $(t,e){var i=t-b,n=e-w,r=(0,u.RZ)(i*i+n*n);C+=r*(b+t)/2,E+=r*(w+e)/2,I+=r,D+=(r=w*t-b*e)*(b+t),z+=r*(w+e),P+=3*r,F(b=t,w=e)}var U=L;function Z(t){this._context=t}Z.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,u.FA)}},result:h.A};var W,G,H,X,Y,K=new c.ph,J={point:h.A,lineStart:function(){J.point=Q},lineEnd:function(){W&&tt(G,H),J.point=h.A},polygonStart:function(){W=!0},polygonEnd:function(){W=null},result:function(){var t=+K;return K=new c.ph,t}};function Q(t,e){J.point=tt,G=X=t,H=Y=e}function tt(t,e){X-=t,Y-=e,K.add((0,u.RZ)(X*X+Y*Y)),X=t,Y=e}var et=J;function it(){this._string=[]}function nt(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function rt(t,e){var i,n,r=4.5;function s(t){return t&&("function"==typeof r&&n.pointRadius(+r.apply(this,arguments)),(0,l.A)(t,i(n))),n.result()}return s.area=function(t){return(0,l.A)(t,i(k)),k.result()},s.measure=function(t){return(0,l.A)(t,i(et)),et.result()},s.bounds=function(t){return(0,l.A)(t,i(S.A)),S.A.result()},s.centroid=function(t){return(0,l.A)(t,i(U)),U.result()},s.projection=function(e){return arguments.length?(i=null==e?(t=null,a.A):(t=e).stream,s):t},s.context=function(t){return arguments.length?(n=null==t?(e=null,new it):new Z(e=t),"function"!=typeof r&&n.pointRadius(r),s):e},s.pointRadius=function(t){return arguments.length?(r="function"==typeof t?t:(n.pointRadius(+t),+t),s):r},s.projection(t).context(e)}it.prototype={_radius:4.5,_circle:nt(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=nt(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}}},10290:function(t,e,i){"use strict";i.d(e,{Ay:function(){return G}});var n=i(28992);function r(t,e){function i(i,n){return i=t(i,n),e(i[0],i[1])}return t.invert&&e.invert&&(i.invert=function(i,n){return(i=e.invert(i,n))&&t.invert(i[0],i[1])}),i}function s(t,e){return[(0,n.tn)(t)>n.pi?t+Math.round(-t/n.FA)*n.FA:t,e]}function o(t,e,i){return(t%=n.FA)?e||i?r(l(t),c(e,i)):l(t):e||i?c(e,i):s}function a(t){return function(e,i){return[(e+=t)>n.pi?e-n.FA:e<-n.pi?e+n.FA:e,i]}}function l(t){var e=a(t);return e.invert=a(-t),e}function c(t,e){var i=(0,n.gn)(t),r=(0,n.F8)(t),s=(0,n.gn)(e),o=(0,n.F8)(e);function a(t,e){var a=(0,n.gn)(e),l=(0,n.gn)(t)*a,c=(0,n.F8)(t)*a,u=(0,n.F8)(e),h=u*i+l*r;return[(0,n.FP)(c*s-h*o,l*i-u*r),(0,n.qR)(h*s+c*o)]}return a.invert=function(t,e){var a=(0,n.gn)(e),l=(0,n.gn)(t)*a,c=(0,n.F8)(t)*a,u=(0,n.F8)(e),h=u*s-c*o;return[(0,n.FP)(c*s+u*o,l*i+h*r),(0,n.qR)(h*i-l*r)]},a}s.invert=s;var u=i(87254);function h(){var t,e=[];return{point:function(e,i,n){t.push([e,i,n])},lineStart:function(){e.push(t=[])},lineEnd:u.A,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function d(t,e){return(0,n.tn)(t[0]-e[0])<n.Ni&&(0,n.tn)(t[1]-e[1])<n.Ni}function p(t,e,i,n){this.x=t,this.z=e,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function f(t,e,i,r,s){var o,a,l=[],c=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,i,r=t[0],a=t[e];if(d(r,a)){if(!r[2]&&!a[2]){for(s.lineStart(),o=0;o<e;++o)s.point((r=t[o])[0],r[1]);return void s.lineEnd()}a[0]+=2*n.Ni}l.push(i=new p(r,t,null,!0)),c.push(i.o=new p(r,null,i,!1)),l.push(i=new p(a,t,null,!1)),c.push(i.o=new p(a,null,i,!0))}})),l.length){for(c.sort(e),m(l),m(c),o=0,a=c.length;o<a;++o)c[o].e=i=!i;for(var u,h,f=l[0];;){for(var g=f,_=!0;g.v;)if((g=g.n)===f)return;u=g.z,s.lineStart();do{if(g.v=g.o.v=!0,g.e){if(_)for(o=0,a=u.length;o<a;++o)s.point((h=u[o])[0],h[1]);else r(g.x,g.n.x,1,s);g=g.n}else{if(_)for(u=g.p.z,o=u.length-1;o>=0;--o)s.point((h=u[o])[0],h[1]);else r(g.x,g.p.x,-1,s);g=g.p}u=(g=g.o).z,_=!_}while(!g.v);s.lineEnd()}}}function m(t){if(e=t.length){for(var e,i,n=0,r=t[0];++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}var g=i(6207);function _(t){return[(0,n.FP)(t[1],t[0]),(0,n.qR)(t[2])]}function y(t){var e=t[0],i=t[1],r=(0,n.gn)(i);return[r*(0,n.gn)(e),r*(0,n.F8)(e),(0,n.F8)(i)]}function x(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function v(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function b(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function w(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function k(t){var e=(0,n.RZ)(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function S(t){return(0,n.tn)(t[0])<=n.pi?t[0]:(0,n._S)(t[0])*(((0,n.tn)(t[0])+n.pi)%n.FA-n.pi)}function T(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function A(t,e,i,r){return function(s){var o,a,l,c=e(s),u=h(),d=e(u),p=!1,m={point:_,lineStart:b,lineEnd:w,polygonStart:function(){m.point=A,m.lineStart=E,m.lineEnd=I,a=[],o=[]},polygonEnd:function(){m.point=_,m.lineStart=b,m.lineEnd=w,a=T(a);var t=function(t,e){var i=S(e),r=e[1],s=(0,n.F8)(r),o=[(0,n.F8)(i),-(0,n.gn)(i),0],a=0,l=0,c=new g.ph;1===s?r=n.TW+n.Ni:-1===s&&(r=-n.TW-n.Ni);for(var u=0,h=t.length;u<h;++u)if(p=(d=t[u]).length)for(var d,p,f=d[p-1],m=S(f),_=f[1]/2+n.gz,x=(0,n.F8)(_),b=(0,n.gn)(_),w=0;w<p;++w,m=A,x=C,b=E,f=T){var T=d[w],A=S(T),M=T[1]/2+n.gz,C=(0,n.F8)(M),E=(0,n.gn)(M),I=A-m,D=I>=0?1:-1,z=D*I,P=z>n.pi,L=x*C;if(c.add((0,n.FP)(L*D*(0,n.F8)(z),b*E+L*(0,n.gn)(z))),a+=P?I+D*n.FA:I,P^m>=i^A>=i){var F=v(y(f),y(T));k(F);var R=v(o,F);k(R);var O=(P^I>=0?-1:1)*(0,n.qR)(R[2]);(r>O||r===O&&(F[0]||F[1]))&&(l+=P^I>=0?1:-1)}}return(a<-n.Ni||a<n.Ni&&c<-n.$t)^1&l}(o,r);a.length?(p||(s.polygonStart(),p=!0),f(a,C,t,i,s)):t&&(p||(s.polygonStart(),p=!0),s.lineStart(),i(null,null,1,s),s.lineEnd()),p&&(s.polygonEnd(),p=!1),a=o=null},sphere:function(){s.polygonStart(),s.lineStart(),i(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function _(e,i){t(e,i)&&s.point(e,i)}function x(t,e){c.point(t,e)}function b(){m.point=x,c.lineStart()}function w(){m.point=_,c.lineEnd()}function A(t,e){l.push([t,e]),d.point(t,e)}function E(){d.lineStart(),l=[]}function I(){A(l[0][0],l[0][1]),d.lineEnd();var t,e,i,n,r=d.clean(),c=u.result(),h=c.length;if(l.pop(),o.push(l),l=null,h)if(1&r){if((e=(i=c[0]).length-1)>0){for(p||(s.polygonStart(),p=!0),s.lineStart(),t=0;t<e;++t)s.point((n=i[t])[0],n[1]);s.lineEnd()}}else h>1&&2&r&&c.push(c.pop().concat(c.shift())),a.push(c.filter(M))}return m}}function M(t){return t.length>1}function C(t,e){return((t=t.x)[0]<0?t[1]-n.TW-n.Ni:n.TW-t[1])-((e=e.x)[0]<0?e[1]-n.TW-n.Ni:n.TW-e[1])}var E=A((function(){return!0}),(function(t){var e,i=NaN,r=NaN,s=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var l=o>0?n.pi:-n.pi,c=(0,n.tn)(o-i);(0,n.tn)(c-n.pi)<n.Ni?(t.point(i,r=(r+a)/2>0?n.TW:-n.TW),t.point(s,r),t.lineEnd(),t.lineStart(),t.point(l,r),t.point(o,r),e=0):s!==l&&c>=n.pi&&((0,n.tn)(i-s)<n.Ni&&(i-=s*n.Ni),(0,n.tn)(o-l)<n.Ni&&(o-=l*n.Ni),r=function(t,e,i,r){var s,o,a=(0,n.F8)(t-i);return(0,n.tn)(a)>n.Ni?(0,n.rY)(((0,n.F8)(e)*(o=(0,n.gn)(r))*(0,n.F8)(i)-(0,n.F8)(r)*(s=(0,n.gn)(e))*(0,n.F8)(t))/(s*o*a)):(e+r)/2}(i,r,o,a),t.point(s,r),t.lineEnd(),t.lineStart(),t.point(l,r),e=0),t.point(i=o,r=a),s=l},lineEnd:function(){t.lineEnd(),i=r=NaN},clean:function(){return 2-e}}}),(function(t,e,i,r){var s;if(null==t)s=i*n.TW,r.point(-n.pi,s),r.point(0,s),r.point(n.pi,s),r.point(n.pi,0),r.point(n.pi,-s),r.point(0,-s),r.point(-n.pi,-s),r.point(-n.pi,0),r.point(-n.pi,s);else if((0,n.tn)(t[0]-e[0])>n.Ni){var o=t[0]<e[0]?n.pi:-n.pi;s=i*o/2,r.point(-o,s),r.point(0,s),r.point(o,s)}else r.point(e[0],e[1])}),[-n.pi,-n.TW]);function I(t,e){(e=y(e))[0]-=t,k(e);var i=(0,n.HQ)(-e[1]);return((-e[2]<0?-i:i)+n.FA-n.Ni)%n.FA}function D(t){var e=(0,n.gn)(t),i=6*n.F2,r=e>0,s=(0,n.tn)(e)>n.Ni;function o(t,i){return(0,n.gn)(t)*(0,n.gn)(i)>e}function a(t,i,r){var s=[1,0,0],o=v(y(t),y(i)),a=x(o,o),l=o[0],c=a-l*l;if(!c)return!r&&t;var u=e*a/c,h=-e*l/c,d=v(s,o),p=w(s,u);b(p,w(o,h));var f=d,m=x(p,f),g=x(f,f),k=m*m-g*(x(p,p)-1);if(!(k<0)){var S=(0,n.RZ)(k),T=w(f,(-m-S)/g);if(b(T,p),T=_(T),!r)return T;var A,M=t[0],C=i[0],E=t[1],I=i[1];C<M&&(A=M,M=C,C=A);var D=C-M,z=(0,n.tn)(D-n.pi)<n.Ni;if(!z&&I<E&&(A=E,E=I,I=A),z||D<n.Ni?z?E+I>0^T[1]<((0,n.tn)(T[0]-M)<n.Ni?E:I):E<=T[1]&&T[1]<=I:D>n.pi^(M<=T[0]&&T[0]<=C)){var P=w(f,(-m+S)/g);return b(P,p),[T,_(P)]}}}function l(e,i){var s=r?t:n.pi-t,o=0;return e<-s?o|=1:e>s&&(o|=2),i<-s?o|=4:i>s&&(o|=8),o}return A(o,(function(t){var e,i,c,u,h;return{lineStart:function(){u=c=!1,h=1},point:function(p,f){var m,g=[p,f],_=o(p,f),y=r?_?0:l(p,f):_?l(p+(p<0?n.pi:-n.pi),f):0;if(!e&&(u=c=_)&&t.lineStart(),_!==c&&(!(m=a(e,g))||d(e,m)||d(g,m))&&(g[2]=1),_!==c)h=0,_?(t.lineStart(),m=a(g,e),t.point(m[0],m[1])):(m=a(e,g),t.point(m[0],m[1],2),t.lineEnd()),e=m;else if(s&&e&&r^_){var x;y&i||!(x=a(g,e,!0))||(h=0,r?(t.lineStart(),t.point(x[0][0],x[0][1]),t.point(x[1][0],x[1][1]),t.lineEnd()):(t.point(x[1][0],x[1][1]),t.lineEnd(),t.lineStart(),t.point(x[0][0],x[0][1],3)))}!_||e&&d(e,g)||t.point(g[0],g[1]),e=g,c=_,i=y},lineEnd:function(){c&&t.lineEnd(),e=null},clean:function(){return h|(u&&c)<<1}}}),(function(e,r,s,o){!function(t,e,i,r,s,o){if(i){var a=(0,n.gn)(e),l=(0,n.F8)(e),c=r*i;null==s?(s=e+r*n.FA,o=e-c/2):(s=I(a,s),o=I(a,o),(r>0?s<o:s>o)&&(s+=r*n.FA));for(var u,h=s;r>0?h>o:h<o;h-=c)u=_([a,-l*(0,n.gn)(h),-l*(0,n.F8)(h)]),t.point(u[0],u[1])}}(o,t,i,s,e,r)}),r?[0,-t]:[-n.pi,t-n.pi])}var z=1e9,P=-z;function L(t,e,i,r){function s(n,s){return t<=n&&n<=i&&e<=s&&s<=r}function o(n,s,o,l){var u=0,h=0;if(null==n||(u=a(n,o))!==(h=a(s,o))||c(n,s)<0^o>0)do{l.point(0===u||3===u?t:i,u>1?r:e)}while((u=(u+o+4)%4)!==h);else l.point(s[0],s[1])}function a(r,s){return(0,n.tn)(r[0]-t)<n.Ni?s>0?0:3:(0,n.tn)(r[0]-i)<n.Ni?s>0?2:1:(0,n.tn)(r[1]-e)<n.Ni?s>0?1:0:s>0?3:2}function l(t,e){return c(t.x,e.x)}function c(t,e){var i=a(t,1),n=a(e,1);return i!==n?i-n:0===i?e[1]-t[1]:1===i?t[0]-e[0]:2===i?t[1]-e[1]:e[0]-t[0]}return function(n){var a,c,u,d,p,m,g,_,y,x,v,b=n,w=h(),k={point:S,lineStart:function(){k.point=A,c&&c.push(u=[]),x=!0,y=!1,g=_=NaN},lineEnd:function(){a&&(A(d,p),m&&y&&w.rejoin(),a.push(w.result())),k.point=S,y&&b.lineEnd()},polygonStart:function(){b=w,a=[],c=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,i=0,n=c.length;i<n;++i)for(var s,o,a=c[i],l=1,u=a.length,h=a[0],d=h[0],p=h[1];l<u;++l)s=d,o=p,d=(h=a[l])[0],p=h[1],o<=r?p>r&&(d-s)*(r-o)>(p-o)*(t-s)&&++e:p<=r&&(d-s)*(r-o)<(p-o)*(t-s)&&--e;return e}(),i=v&&e,s=(a=T(a)).length;(i||s)&&(n.polygonStart(),i&&(n.lineStart(),o(null,null,1,n),n.lineEnd()),s&&f(a,l,e,o,n),n.polygonEnd()),b=n,a=c=u=null}};function S(t,e){s(t,e)&&b.point(t,e)}function A(n,o){var a=s(n,o);if(c&&u.push([n,o]),x)d=n,p=o,m=a,x=!1,a&&(b.lineStart(),b.point(n,o));else if(a&&y)b.point(n,o);else{var l=[g=Math.max(P,Math.min(z,g)),_=Math.max(P,Math.min(z,_))],h=[n=Math.max(P,Math.min(z,n)),o=Math.max(P,Math.min(z,o))];!function(t,e,i,n,r,s){var o,a=t[0],l=t[1],c=0,u=1,h=e[0]-a,d=e[1]-l;if(o=i-a,h||!(o>0)){if(o/=h,h<0){if(o<c)return;o<u&&(u=o)}else if(h>0){if(o>u)return;o>c&&(c=o)}if(o=r-a,h||!(o<0)){if(o/=h,h<0){if(o>u)return;o>c&&(c=o)}else if(h>0){if(o<c)return;o<u&&(u=o)}if(o=n-l,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<u&&(u=o)}else if(d>0){if(o>u)return;o>c&&(c=o)}if(o=s-l,d||!(o<0)){if(o/=d,d<0){if(o>u)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<u&&(u=o)}return c>0&&(t[0]=a+c*h,t[1]=l+c*d),u<1&&(e[0]=a+u*h,e[1]=l+u*d),!0}}}}}(l,h,t,e,i,r)?a&&(b.lineStart(),b.point(n,o),v=!1):(y||(b.lineStart(),b.point(l[0],l[1])),b.point(h[0],h[1]),a||b.lineEnd(),v=!1)}g=n,_=o,y=a}return k}}var F=i(92956);function R(t){return function(e){var i=new O;for(var n in t)i[n]=t[n];return i.stream=e,i}}function O(){}O.prototype={constructor:O,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var B=i(16598),V=i(44983);function N(t,e,i){var n=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=n&&t.clipExtent(null),(0,B.A)(i,t.stream(V.A)),e(V.A.result()),null!=n&&t.clipExtent(n),t}function q(t,e,i){return N(t,(function(i){var n=e[1][0]-e[0][0],r=e[1][1]-e[0][1],s=Math.min(n/(i[1][0]-i[0][0]),r/(i[1][1]-i[0][1])),o=+e[0][0]+(n-s*(i[1][0]+i[0][0]))/2,a=+e[0][1]+(r-s*(i[1][1]+i[0][1]))/2;t.scale(150*s).translate([o,a])}),i)}var j=(0,n.gn)(30*n.F2);function $(t,e){return+e?function(t,e){function i(r,s,o,a,l,c,u,h,d,p,f,m,g,_){var y=u-r,x=h-s,v=y*y+x*x;if(v>4*e&&g--){var b=a+p,w=l+f,k=c+m,S=(0,n.RZ)(b*b+w*w+k*k),T=(0,n.qR)(k/=S),A=(0,n.tn)((0,n.tn)(k)-1)<n.Ni||(0,n.tn)(o-d)<n.Ni?(o+d)/2:(0,n.FP)(w,b),M=t(A,T),C=M[0],E=M[1],I=C-r,D=E-s,z=x*I-y*D;(z*z/v>e||(0,n.tn)((y*I+x*D)/v-.5)>.3||a*p+l*f+c*m<j)&&(i(r,s,o,a,l,c,C,E,A,b/=S,w/=S,k,g,_),_.point(C,E),i(C,E,A,b,w,k,u,h,d,p,f,m,g,_))}}return function(e){var n,r,s,o,a,l,c,u,h,d,p,f,m={point:g,lineStart:_,lineEnd:v,polygonStart:function(){e.polygonStart(),m.lineStart=b},polygonEnd:function(){e.polygonEnd(),m.lineStart=_}};function g(i,n){i=t(i,n),e.point(i[0],i[1])}function _(){u=NaN,m.point=x,e.lineStart()}function x(n,r){var s=y([n,r]),o=t(n,r);i(u,h,c,d,p,f,u=o[0],h=o[1],c=n,d=s[0],p=s[1],f=s[2],16,e),e.point(u,h)}function v(){m.point=g,e.lineEnd()}function b(){_(),m.point=w,m.lineEnd=k}function w(t,e){x(n=t,e),r=u,s=h,o=d,a=p,l=f,m.point=x}function k(){i(u,h,c,d,p,f,r,s,n,o,a,l,16,e),m.lineEnd=v,v()}return m}}(t,e):function(t){return R({point:function(e,i){e=t(e,i),this.stream.point(e[0],e[1])}})}(t)}var U=R({point:function(t,e){this.stream.point(t*n.F2,e*n.F2)}});function Z(t,e,i,r,s,o){if(!o)return function(t,e,i,n,r){function s(s,o){return[e+t*(s*=n),i-t*(o*=r)]}return s.invert=function(s,o){return[(s-e)/t*n,(i-o)/t*r]},s}(t,e,i,r,s);var a=(0,n.gn)(o),l=(0,n.F8)(o),c=a*t,u=l*t,h=a/t,d=l/t,p=(l*i-a*e)/t,f=(l*e+a*i)/t;function m(t,n){return[c*(t*=r)-u*(n*=s)+e,i-u*t-c*n]}return m.invert=function(t,e){return[r*(h*t-d*e+p),s*(f-d*t-h*e)]},m}function W(t,e){return[t,(0,n.Rm)((0,n.Ml)((n.TW+e)/2))]}function G(){return function(t){var e,i,s,a=function(t){return function(t){var e,i,s,a,l,c,u,h,d,p,f=150,m=480,g=250,_=0,y=0,x=0,v=0,b=0,w=0,k=1,S=1,T=null,A=E,M=null,C=F.A,I=.5;function z(t){return h(t[0]*n.F2,t[1]*n.F2)}function P(t){return(t=h.invert(t[0],t[1]))&&[t[0]*n.uj,t[1]*n.uj]}function O(){var t=Z(f,0,0,k,S,w).apply(null,e(_,y)),n=Z(f,m-t[0],g-t[1],k,S,w);return i=o(x,v,b),u=r(e,n),h=r(i,u),c=$(u,I),B()}function B(){return d=p=null,z}return z.stream=function(t){return d&&p===t?d:d=U(function(t){return R({point:function(e,i){var n=t(e,i);return this.stream.point(n[0],n[1])}})}(i)(A(c(C(p=t)))))},z.preclip=function(t){return arguments.length?(A=t,T=void 0,B()):A},z.postclip=function(t){return arguments.length?(C=t,M=s=a=l=null,B()):C},z.clipAngle=function(t){return arguments.length?(A=+t?D(T=t*n.F2):(T=null,E),B()):T*n.uj},z.clipExtent=function(t){return arguments.length?(C=null==t?(M=s=a=l=null,F.A):L(M=+t[0][0],s=+t[0][1],a=+t[1][0],l=+t[1][1]),B()):null==M?null:[[M,s],[a,l]]},z.scale=function(t){return arguments.length?(f=+t,O()):f},z.translate=function(t){return arguments.length?(m=+t[0],g=+t[1],O()):[m,g]},z.center=function(t){return arguments.length?(_=t[0]%360*n.F2,y=t[1]%360*n.F2,O()):[_*n.uj,y*n.uj]},z.rotate=function(t){return arguments.length?(x=t[0]%360*n.F2,v=t[1]%360*n.F2,b=t.length>2?t[2]%360*n.F2:0,O()):[x*n.uj,v*n.uj,b*n.uj]},z.angle=function(t){return arguments.length?(w=t%360*n.F2,O()):w*n.uj},z.reflectX=function(t){return arguments.length?(k=t?-1:1,O()):k<0},z.reflectY=function(t){return arguments.length?(S=t?-1:1,O()):S<0},z.precision=function(t){return arguments.length?(c=$(u,I=t*t),B()):(0,n.RZ)(I)},z.fitExtent=function(t,e){return q(z,t,e)},z.fitSize=function(t,e){return function(t,e,i){return q(t,[[0,0],e],i)}(z,t,e)},z.fitWidth=function(t,e){return function(t,e,i){return N(t,(function(i){var n=+e,r=n/(i[1][0]-i[0][0]),s=(n-r*(i[1][0]+i[0][0]))/2,o=-r*i[0][1];t.scale(150*r).translate([s,o])}),i)}(z,t,e)},z.fitHeight=function(t,e){return function(t,e,i){return N(t,(function(i){var n=+e,r=n/(i[1][1]-i[0][1]),s=-r*i[0][0],o=(n-r*(i[1][1]+i[0][1]))/2;t.scale(150*r).translate([s,o])}),i)}(z,t,e)},function(){return e=t.apply(this,arguments),z.invert=e.invert&&P,O()}}((function(){return t}))()}(t),l=a.center,c=a.scale,u=a.translate,h=a.clipExtent,d=null;function p(){var r=n.pi*c(),l=a(function(t){function e(e){return(e=t(e[0]*n.F2,e[1]*n.F2))[0]*=n.uj,e[1]*=n.uj,e}return t=o(t[0]*n.F2,t[1]*n.F2,t.length>2?t[2]*n.F2:0),e.invert=function(e){return(e=t.invert(e[0]*n.F2,e[1]*n.F2))[0]*=n.uj,e[1]*=n.uj,e},e}(a.rotate()).invert([0,0]));return h(null==d?[[l[0]-r,l[1]-r],[l[0]+r,l[1]+r]]:t===W?[[Math.max(l[0]-r,d),e],[Math.min(l[0]+r,i),s]]:[[d,Math.max(l[1]-r,e)],[i,Math.min(l[1]+r,s)]])}return a.scale=function(t){return arguments.length?(c(t),p()):c()},a.translate=function(t){return arguments.length?(u(t),p()):u()},a.center=function(t){return arguments.length?(l(t),p()):l()},a.clipExtent=function(t){return arguments.length?(null==t?d=e=i=s=null:(d=+t[0][0],e=+t[0][1],i=+t[1][0],s=+t[1][1]),p()):null==d?null:[[d,e],[i,s]]},p()}(W).scale(961/n.FA)}W.invert=function(t,e){return[t,2*(0,n.rY)((0,n.oN)(e))-n.TW]}},16598:function(t,e,i){"use strict";function n(t,e){t&&s.hasOwnProperty(t.type)&&s[t.type](t,e)}i.d(e,{A:function(){return l}});var r={Feature:function(t,e){n(t.geometry,e)},FeatureCollection:function(t,e){for(var i=t.features,r=-1,s=i.length;++r<s;)n(i[r].geometry,e)}},s={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)t=i[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){o(t.coordinates,e,0)},MultiLineString:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)o(i[n],e,0)},Polygon:function(t,e){a(t.coordinates,e)},MultiPolygon:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)a(i[n],e)},GeometryCollection:function(t,e){for(var i=t.geometries,r=-1,s=i.length;++r<s;)n(i[r],e)}};function o(t,e,i){var n,r=-1,s=t.length-i;for(e.lineStart();++r<s;)n=t[r],e.point(n[0],n[1],n[2]);e.lineEnd()}function a(t,e){var i=-1,n=t.length;for(e.polygonStart();++i<n;)o(t[i],e,1);e.polygonEnd()}function l(t,e){t&&r.hasOwnProperty(t.type)?r[t.type](t,e):n(t,e)}},41042:function(t,e,i){"use strict";i.d(e,{c9:function(){return Gi}});class n extends Error{}class r extends n{constructor(t){super(`Invalid DateTime: ${t.toMessage()}`)}}class s extends n{constructor(t){super(`Invalid Interval: ${t.toMessage()}`)}}class o extends n{constructor(t){super(`Invalid Duration: ${t.toMessage()}`)}}class a extends n{}class l extends n{constructor(t){super(`Invalid unit ${t}`)}}class c extends n{}class u extends n{constructor(){super("Zone is an abstract class")}}const h="numeric",d="short",p="long",f={year:h,month:h,day:h},m={year:h,month:d,day:h},g={year:h,month:d,day:h,weekday:d},_={year:h,month:p,day:h},y={year:h,month:p,day:h,weekday:p},x={hour:h,minute:h},v={hour:h,minute:h,second:h},b={hour:h,minute:h,second:h,timeZoneName:d},w={hour:h,minute:h,second:h,timeZoneName:p},k={hour:h,minute:h,hourCycle:"h23"},S={hour:h,minute:h,second:h,hourCycle:"h23"},T={hour:h,minute:h,second:h,hourCycle:"h23",timeZoneName:d},A={hour:h,minute:h,second:h,hourCycle:"h23",timeZoneName:p},M={year:h,month:h,day:h,hour:h,minute:h},C={year:h,month:h,day:h,hour:h,minute:h,second:h},E={year:h,month:d,day:h,hour:h,minute:h},I={year:h,month:d,day:h,hour:h,minute:h,second:h},D={year:h,month:d,day:h,weekday:d,hour:h,minute:h},z={year:h,month:p,day:h,hour:h,minute:h,timeZoneName:d},P={year:h,month:p,day:h,hour:h,minute:h,second:h,timeZoneName:d},L={year:h,month:p,day:h,weekday:p,hour:h,minute:h,timeZoneName:p},F={year:h,month:p,day:h,weekday:p,hour:h,minute:h,second:h,timeZoneName:p};function R(t){return void 0===t}function O(t){return"number"==typeof t}function B(t){return"number"==typeof t&&t%1==0}function V(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(t){return!1}}function N(t,e,i){if(0!==t.length)return t.reduce(((t,n)=>{const r=[e(n),n];return t&&i(t[0],r[0])===t[0]?t:r}),null)[1]}function q(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function j(t,e,i){return B(t)&&t>=e&&t<=i}function $(t,e=2){let i;return i=t<0?"-"+(""+-t).padStart(e,"0"):(""+t).padStart(e,"0"),i}function U(t){return R(t)||null===t||""===t?void 0:parseInt(t,10)}function Z(t){return R(t)||null===t||""===t?void 0:parseFloat(t)}function W(t){if(!R(t)&&null!==t&&""!==t){const e=1e3*parseFloat("0."+t);return Math.floor(e)}}function G(t,e,i=!1){const n=10**e;return(i?Math.trunc:Math.round)(t*n)/n}function H(t){return t%4==0&&(t%100!=0||t%400==0)}function X(t){return H(t)?366:365}function Y(t,e){const i=(n=e-1)-12*Math.floor(n/12)+1;var n;return 2===i?H(t+(e-i)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}function K(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(e.getUTCFullYear()-1900)),+e}function J(t){const e=(t+Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/400))%7,i=t-1,n=(i+Math.floor(i/4)-Math.floor(i/100)+Math.floor(i/400))%7;return 4===e||3===n?53:52}function Q(t){return t>99?t:t>60?1900+t:2e3+t}function tt(t,e,i,n=null){const r=new Date(t),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};n&&(s.timeZone=n);const o={timeZoneName:e,...s},a=new Intl.DateTimeFormat(i,o).formatToParts(r).find((t=>"timezonename"===t.type.toLowerCase()));return a?a.value:null}function et(t,e){let i=parseInt(t,10);Number.isNaN(i)&&(i=0);const n=parseInt(e,10)||0;return 60*i+(i<0||Object.is(i,-0)?-n:n)}function it(t){const e=Number(t);if("boolean"==typeof t||""===t||Number.isNaN(e))throw new c(`Invalid unit value ${t}`);return e}function nt(t,e){const i={};for(const n in t)if(q(t,n)){const r=t[n];if(null==r)continue;i[e(n)]=it(r)}return i}function rt(t,e){const i=Math.trunc(Math.abs(t/60)),n=Math.trunc(Math.abs(t%60)),r=t>=0?"+":"-";switch(e){case"short":return`${r}${$(i,2)}:${$(n,2)}`;case"narrow":return`${r}${i}${n>0?`:${n}`:""}`;case"techie":return`${r}${$(i,2)}${$(n,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function st(t){return function(t,e){return["hour","minute","second","millisecond"].reduce(((e,i)=>(e[i]=t[i],e)),{})}(t)}const ot=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/,at=["January","February","March","April","May","June","July","August","September","October","November","December"],lt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ct=["J","F","M","A","M","J","J","A","S","O","N","D"];function ut(t){switch(t){case"narrow":return[...ct];case"short":return[...lt];case"long":return[...at];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const ht=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],dt=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],pt=["M","T","W","T","F","S","S"];function ft(t){switch(t){case"narrow":return[...pt];case"short":return[...dt];case"long":return[...ht];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const mt=["AM","PM"],gt=["Before Christ","Anno Domini"],_t=["BC","AD"],yt=["B","A"];function xt(t){switch(t){case"narrow":return[...yt];case"short":return[..._t];case"long":return[...gt];default:return null}}function vt(t,e){let i="";for(const n of t)n.literal?i+=n.val:i+=e(n.val);return i}const bt={D:f,DD:m,DDD:_,DDDD:y,t:x,tt:v,ttt:b,tttt:w,T:k,TT:S,TTT:T,TTTT:A,f:M,ff:E,fff:z,ffff:L,F:C,FF:I,FFF:P,FFFF:F};class wt{static create(t,e={}){return new wt(t,e)}static parseFormat(t){let e=null,i="",n=!1;const r=[];for(let s=0;s<t.length;s++){const o=t.charAt(s);"'"===o?(i.length>0&&r.push({literal:n,val:i}),e=null,i="",n=!n):n||o===e?i+=o:(i.length>0&&r.push({literal:!1,val:i}),i=o,e=o)}return i.length>0&&r.push({literal:n,val:i}),r}static macroTokenToFormatOpts(t){return bt[t]}constructor(t,e){this.opts=e,this.loc=t,this.systemLoc=null}formatWithSystemDefault(t,e){return null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(t,{...this.opts,...e}).format()}formatDateTime(t,e={}){return this.loc.dtFormatter(t,{...this.opts,...e}).format()}formatDateTimeParts(t,e={}){return this.loc.dtFormatter(t,{...this.opts,...e}).formatToParts()}resolvedOptions(t,e={}){return this.loc.dtFormatter(t,{...this.opts,...e}).resolvedOptions()}num(t,e=0){if(this.opts.forceSimple)return $(t,e);const i={...this.opts};return e>0&&(i.padTo=e),this.loc.numberFormatter(i).format(t)}formatDateTimeFromString(t,e){const i="en"===this.loc.listingMode(),n=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar,r=(e,i)=>this.loc.extract(t,e,i),s=e=>t.isOffsetFixed&&0===t.offset&&e.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,e.format):"",o=(e,n)=>i?function(t,e){return ut(e)[t.month-1]}(t,e):r(n?{month:e}:{month:e,day:"numeric"},"month"),a=(e,n)=>i?function(t,e){return ft(e)[t.weekday-1]}(t,e):r(n?{weekday:e}:{weekday:e,month:"long",day:"numeric"},"weekday"),l=e=>{const i=wt.macroTokenToFormatOpts(e);return i?this.formatWithSystemDefault(t,i):e},c=e=>i?function(t,e){return xt(e)[t.year<0?0:1]}(t,e):r({era:e},"era");return vt(wt.parseFormat(e),(e=>{switch(e){case"S":return this.num(t.millisecond);case"u":case"SSS":return this.num(t.millisecond,3);case"s":return this.num(t.second);case"ss":return this.num(t.second,2);case"uu":return this.num(Math.floor(t.millisecond/10),2);case"uuu":return this.num(Math.floor(t.millisecond/100));case"m":return this.num(t.minute);case"mm":return this.num(t.minute,2);case"h":return this.num(t.hour%12==0?12:t.hour%12);case"hh":return this.num(t.hour%12==0?12:t.hour%12,2);case"H":return this.num(t.hour);case"HH":return this.num(t.hour,2);case"Z":return s({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return s({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return s({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return t.zone.offsetName(t.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return t.zone.offsetName(t.ts,{format:"long",locale:this.loc.locale});case"z":return t.zoneName;case"a":return i?function(t){return mt[t.hour<12?0:1]}(t):r({hour:"numeric",hourCycle:"h12"},"dayperiod");case"d":return n?r({day:"numeric"},"day"):this.num(t.day);case"dd":return n?r({day:"2-digit"},"day"):this.num(t.day,2);case"c":case"E":return this.num(t.weekday);case"ccc":return a("short",!0);case"cccc":return a("long",!0);case"ccccc":return a("narrow",!0);case"EEE":return a("short",!1);case"EEEE":return a("long",!1);case"EEEEE":return a("narrow",!1);case"L":return n?r({month:"numeric",day:"numeric"},"month"):this.num(t.month);case"LL":return n?r({month:"2-digit",day:"numeric"},"month"):this.num(t.month,2);case"LLL":return o("short",!0);case"LLLL":return o("long",!0);case"LLLLL":return o("narrow",!0);case"M":return n?r({month:"numeric"},"month"):this.num(t.month);case"MM":return n?r({month:"2-digit"},"month"):this.num(t.month,2);case"MMM":return o("short",!1);case"MMMM":return o("long",!1);case"MMMMM":return o("narrow",!1);case"y":return n?r({year:"numeric"},"year"):this.num(t.year);case"yy":return n?r({year:"2-digit"},"year"):this.num(t.year.toString().slice(-2),2);case"yyyy":return n?r({year:"numeric"},"year"):this.num(t.year,4);case"yyyyyy":return n?r({year:"numeric"},"year"):this.num(t.year,6);case"G":return c("short");case"GG":return c("long");case"GGGGG":return c("narrow");case"kk":return this.num(t.weekYear.toString().slice(-2),2);case"kkkk":return this.num(t.weekYear,4);case"W":return this.num(t.weekNumber);case"WW":return this.num(t.weekNumber,2);case"o":return this.num(t.ordinal);case"ooo":return this.num(t.ordinal,3);case"q":return this.num(t.quarter);case"qq":return this.num(t.quarter,2);case"X":return this.num(Math.floor(t.ts/1e3));case"x":return this.num(t.ts);default:return l(e)}}))}formatDurationFromString(t,e){const i=t=>{switch(t[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},n=wt.parseFormat(e),r=n.reduce(((t,{literal:e,val:i})=>e?t:t.concat(i)),[]);return vt(n,(t=>e=>{const n=i(e);return n?this.num(t.get(n),e.length):e})(t.shiftTo(...r.map(i).filter((t=>t)))))}}class kt{constructor(t,e){this.reason=t,this.explanation=e}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}class St{get type(){throw new u}get name(){throw new u}get ianaName(){return this.name}get isUniversal(){throw new u}offsetName(t,e){throw new u}formatOffset(t,e){throw new u}offset(t){throw new u}equals(t){throw new u}get isValid(){throw new u}}let Tt=null;class At extends St{static get instance(){return null===Tt&&(Tt=new At),Tt}get type(){return"system"}get name(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(t,{format:e,locale:i}){return tt(t,e,i)}formatOffset(t,e){return rt(this.offset(t),e)}offset(t){return-new Date(t).getTimezoneOffset()}equals(t){return"system"===t.type}get isValid(){return!0}}let Mt={};const Ct={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};let Et={};class It extends St{static create(t){return Et[t]||(Et[t]=new It(t)),Et[t]}static resetCache(){Et={},Mt={}}static isValidSpecifier(t){return this.isValidZone(t)}static isValidZone(t){if(!t)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:t}).format(),!0}catch(t){return!1}}constructor(t){super(),this.zoneName=t,this.valid=It.isValidZone(t)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(t,{format:e,locale:i}){return tt(t,e,i,this.name)}formatOffset(t,e){return rt(this.offset(t),e)}offset(t){const e=new Date(t);if(isNaN(e))return NaN;const i=(n=this.name,Mt[n]||(Mt[n]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:n,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),Mt[n]);var n;let[r,s,o,a,l,c,u]=i.formatToParts?function(t,e){const i=t.formatToParts(e),n=[];for(let t=0;t<i.length;t++){const{type:e,value:r}=i[t],s=Ct[e];"era"===e?n[s]=r:R(s)||(n[s]=parseInt(r,10))}return n}(i,e):function(t,e){const i=t.format(e).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),[,r,s,o,a,l,c,u]=n;return[o,r,s,a,l,c,u]}(i,e);"BC"===a&&(r=1-Math.abs(r));let h=+e;const d=h%1e3;return h-=d>=0?d:1e3+d,(K({year:r,month:s,day:o,hour:24===l?0:l,minute:c,second:u,millisecond:0})-h)/6e4}equals(t){return"iana"===t.type&&t.name===this.name}get isValid(){return this.valid}}let Dt=null;class zt extends St{static get utcInstance(){return null===Dt&&(Dt=new zt(0)),Dt}static instance(t){return 0===t?zt.utcInstance:new zt(t)}static parseSpecifier(t){if(t){const e=t.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(e)return new zt(et(e[1],e[2]))}return null}constructor(t){super(),this.fixed=t}get type(){return"fixed"}get name(){return 0===this.fixed?"UTC":`UTC${rt(this.fixed,"narrow")}`}get ianaName(){return 0===this.fixed?"Etc/UTC":`Etc/GMT${rt(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(t,e){return rt(this.fixed,e)}get isUniversal(){return!0}offset(){return this.fixed}equals(t){return"fixed"===t.type&&t.fixed===this.fixed}get isValid(){return!0}}class Pt extends St{constructor(t){super(),this.zoneName=t}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Lt(t,e){if(R(t)||null===t)return e;if(t instanceof St)return t;if("string"==typeof t){const i=t.toLowerCase();return"local"===i||"system"===i?e:"utc"===i||"gmt"===i?zt.utcInstance:zt.parseSpecifier(i)||It.create(t)}return O(t)?zt.instance(t):"object"==typeof t&&t.offset&&"number"==typeof t.offset?t:new Pt(t)}let Ft,Rt=()=>Date.now(),Ot="system",Bt=null,Vt=null,Nt=null;class qt{static get now(){return Rt}static set now(t){Rt=t}static set defaultZone(t){Ot=t}static get defaultZone(){return Lt(Ot,At.instance)}static get defaultLocale(){return Bt}static set defaultLocale(t){Bt=t}static get defaultNumberingSystem(){return Vt}static set defaultNumberingSystem(t){Vt=t}static get defaultOutputCalendar(){return Nt}static set defaultOutputCalendar(t){Nt=t}static get throwOnInvalid(){return Ft}static set throwOnInvalid(t){Ft=t}static resetCaches(){Jt.resetCache(),It.resetCache()}}let jt={},$t={};function Ut(t,e={}){const i=JSON.stringify([t,e]);let n=$t[i];return n||(n=new Intl.DateTimeFormat(t,e),$t[i]=n),n}let Zt={},Wt={},Gt=null;function Ht(t,e,i,n,r){const s=t.listingMode(i);return"error"===s?null:"en"===s?n(e):r(e)}class Xt{constructor(t,e,i){this.padTo=i.padTo||0,this.floor=i.floor||!1;const{padTo:n,floor:r,...s}=i;if(!e||Object.keys(s).length>0){const e={useGrouping:!1,...i};i.padTo>0&&(e.minimumIntegerDigits=i.padTo),this.inf=function(t,e={}){const i=JSON.stringify([t,e]);let n=Zt[i];return n||(n=new Intl.NumberFormat(t,e),Zt[i]=n),n}(t,e)}}format(t){if(this.inf){const e=this.floor?Math.floor(t):t;return this.inf.format(e)}return $(this.floor?Math.floor(t):G(t,3),this.padTo)}}class Yt{constructor(t,e,i){let n;if(this.opts=i,t.zone.isUniversal){const e=t.offset/60*-1,r=e>=0?`Etc/GMT+${e}`:`Etc/GMT${e}`;0!==t.offset&&It.create(r).valid?(n=r,this.dt=t):(n="UTC",i.timeZoneName?this.dt=t:this.dt=0===t.offset?t:Gi.fromMillis(t.ts+60*t.offset*1e3))}else"system"===t.zone.type?this.dt=t:(this.dt=t,n=t.zone.name);const r={...this.opts};n&&(r.timeZone=n),this.dtf=Ut(e,r)}format(){return this.dtf.format(this.dt.toJSDate())}formatToParts(){return this.dtf.formatToParts(this.dt.toJSDate())}resolvedOptions(){return this.dtf.resolvedOptions()}}class Kt{constructor(t,e,i){this.opts={style:"long",...i},!e&&V()&&(this.rtf=function(t,e={}){const{base:i,...n}=e,r=JSON.stringify([t,n]);let s=Wt[r];return s||(s=new Intl.RelativeTimeFormat(t,e),Wt[r]=s),s}(t,i))}format(t,e){return this.rtf?this.rtf.format(t,e):function(t,e,i="always",n=!1){const r={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=-1===["hours","minutes","seconds"].indexOf(t);if("auto"===i&&s){const i="days"===t;switch(e){case 1:return i?"tomorrow":`next ${r[t][0]}`;case-1:return i?"yesterday":`last ${r[t][0]}`;case 0:return i?"today":`this ${r[t][0]}`}}const o=Object.is(e,-0)||e<0,a=Math.abs(e),l=1===a,c=r[t],u=n?l?c[1]:c[2]||c[1]:l?r[t][0]:t;return o?`${a} ${u} ago`:`in ${a} ${u}`}(e,t,this.opts.numeric,"long"!==this.opts.style)}formatToParts(t,e){return this.rtf?this.rtf.formatToParts(t,e):[]}}class Jt{static fromOpts(t){return Jt.create(t.locale,t.numberingSystem,t.outputCalendar,t.defaultToEN)}static create(t,e,i,n=!1){const r=t||qt.defaultLocale,s=r||(n?"en-US":Gt||(Gt=(new Intl.DateTimeFormat).resolvedOptions().locale,Gt)),o=e||qt.defaultNumberingSystem,a=i||qt.defaultOutputCalendar;return new Jt(s,o,a,r)}static resetCache(){Gt=null,$t={},Zt={},Wt={}}static fromObject({locale:t,numberingSystem:e,outputCalendar:i}={}){return Jt.create(t,e,i)}constructor(t,e,i,n){const[r,s,o]=function(t){const e=t.indexOf("-u-");if(-1===e)return[t];{let i;const n=t.substring(0,e);try{i=Ut(t).resolvedOptions()}catch(t){i=Ut(n).resolvedOptions()}const{numberingSystem:r,calendar:s}=i;return[n,r,s]}}(t);this.locale=r,this.numberingSystem=e||s||null,this.outputCalendar=i||o||null,this.intl=function(t,e,i){return i||e?(t+="-u",i&&(t+=`-ca-${i}`),e&&(t+=`-nu-${e}`),t):t}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}get fastNumbers(){var t;return null==this.fastNumbersCached&&(this.fastNumbersCached=(!(t=this).numberingSystem||"latn"===t.numberingSystem)&&("latn"===t.numberingSystem||!t.locale||t.locale.startsWith("en")||"latn"===new Intl.DateTimeFormat(t.intl).resolvedOptions().numberingSystem)),this.fastNumbersCached}listingMode(){const t=this.isEnglish(),e=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return t&&e?"en":"intl"}clone(t){return t&&0!==Object.getOwnPropertyNames(t).length?Jt.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,t.defaultToEN||!1):this}redefaultToEN(t={}){return this.clone({...t,defaultToEN:!0})}redefaultToSystem(t={}){return this.clone({...t,defaultToEN:!1})}months(t,e=!1,i=!0){return Ht(this,t,i,ut,(()=>{const i=e?{month:t,day:"numeric"}:{month:t},n=e?"format":"standalone";return this.monthsCache[n][t]||(this.monthsCache[n][t]=function(t){const e=[];for(let i=1;i<=12;i++){const n=Gi.utc(2016,i,1);e.push(t(n))}return e}((t=>this.extract(t,i,"month")))),this.monthsCache[n][t]}))}weekdays(t,e=!1,i=!0){return Ht(this,t,i,ft,(()=>{const i=e?{weekday:t,year:"numeric",month:"long",day:"numeric"}:{weekday:t},n=e?"format":"standalone";return this.weekdaysCache[n][t]||(this.weekdaysCache[n][t]=function(t){const e=[];for(let i=1;i<=7;i++){const n=Gi.utc(2016,11,13+i);e.push(t(n))}return e}((t=>this.extract(t,i,"weekday")))),this.weekdaysCache[n][t]}))}meridiems(t=!0){return Ht(this,void 0,t,(()=>mt),(()=>{if(!this.meridiemCache){const t={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[Gi.utc(2016,11,13,9),Gi.utc(2016,11,13,19)].map((e=>this.extract(e,t,"dayperiod")))}return this.meridiemCache}))}eras(t,e=!0){return Ht(this,t,e,xt,(()=>{const e={era:t};return this.eraCache[t]||(this.eraCache[t]=[Gi.utc(-40,1,1),Gi.utc(2017,1,1)].map((t=>this.extract(t,e,"era")))),this.eraCache[t]}))}extract(t,e,i){const n=this.dtFormatter(t,e).formatToParts().find((t=>t.type.toLowerCase()===i));return n?n.value:null}numberFormatter(t={}){return new Xt(this.intl,t.forceSimple||this.fastNumbers,t)}dtFormatter(t,e={}){return new Yt(t,this.intl,e)}relFormatter(t={}){return new Kt(this.intl,this.isEnglish(),t)}listFormatter(t={}){return function(t,e={}){const i=JSON.stringify([t,e]);let n=jt[i];return n||(n=new Intl.ListFormat(t,e),jt[i]=n),n}(this.intl,t)}isEnglish(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(t){return this.locale===t.locale&&this.numberingSystem===t.numberingSystem&&this.outputCalendar===t.outputCalendar}}function Qt(...t){const e=t.reduce(((t,e)=>t+e.source),"");return RegExp(`^${e}$`)}function te(...t){return e=>t.reduce((([t,i,n],r)=>{const[s,o,a]=r(e,n);return[{...t,...s},o||i,a]}),[{},null,1]).slice(0,2)}function ee(t,...e){if(null==t)return[null,null];for(const[i,n]of e){const e=i.exec(t);if(e)return n(e)}return[null,null]}function ie(...t){return(e,i)=>{const n={};let r;for(r=0;r<t.length;r++)n[t[r]]=U(e[i+r]);return[n,null,i+r]}}const ne=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,re=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,se=RegExp(`${re.source}(?:${ne.source}?(?:\\[(${ot.source})\\])?)?`),oe=RegExp(`(?:T${se.source})?`),ae=ie("weekYear","weekNumber","weekDay"),le=ie("year","ordinal"),ce=RegExp(`${re.source} ?(?:${ne.source}|(${ot.source}))?`),ue=RegExp(`(?: ${ce.source})?`);function he(t,e,i){const n=t[e];return R(n)?i:U(n)}function de(t,e){return[{hours:he(t,e,0),minutes:he(t,e+1,0),seconds:he(t,e+2,0),milliseconds:W(t[e+3])},null,e+4]}function pe(t,e){const i=!t[e]&&!t[e+1],n=et(t[e+1],t[e+2]);return[{},i?null:zt.instance(n),e+3]}function fe(t,e){return[{},t[e]?It.create(t[e]):null,e+1]}const me=RegExp(`^T?${re.source}$`),ge=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function _e(t){const[e,i,n,r,s,o,a,l,c]=t,u="-"===e[0],h=l&&"-"===l[0],d=(t,e=!1)=>void 0!==t&&(e||t&&u)?-t:t;return[{years:d(Z(i)),months:d(Z(n)),weeks:d(Z(r)),days:d(Z(s)),hours:d(Z(o)),minutes:d(Z(a)),seconds:d(Z(l),"-0"===l),milliseconds:d(W(c),h)}]}const ye={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function xe(t,e,i,n,r,s,o){const a={year:2===e.length?Q(U(e)):U(e),month:lt.indexOf(i)+1,day:U(n),hour:U(r),minute:U(s)};return o&&(a.second=U(o)),t&&(a.weekday=t.length>3?ht.indexOf(t)+1:dt.indexOf(t)+1),a}const ve=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function be(t){const[,e,i,n,r,s,o,a,l,c,u,h]=t,d=xe(e,r,n,i,s,o,a);let p;return p=l?ye[l]:c?0:et(u,h),[d,new zt(p)]}const we=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,ke=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Se=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Te(t){const[,e,i,n,r,s,o,a]=t;return[xe(e,r,n,i,s,o,a),zt.utcInstance]}function Ae(t){const[,e,i,n,r,s,o,a]=t;return[xe(e,a,i,n,r,s,o),zt.utcInstance]}const Me=Qt(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,oe),Ce=Qt(/(\d{4})-?W(\d\d)(?:-?(\d))?/,oe),Ee=Qt(/(\d{4})-?(\d{3})/,oe),Ie=Qt(se),De=te((function(t,e){return[{year:he(t,e),month:he(t,e+1,1),day:he(t,e+2,1)},null,e+3]}),de,pe,fe),ze=te(ae,de,pe,fe),Pe=te(le,de,pe,fe),Le=te(de,pe,fe),Fe=te(de),Re=Qt(/(\d{4})-(\d\d)-(\d\d)/,ue),Oe=Qt(ce),Be=te(de,pe,fe),Ve={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},Ne={years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6},...Ve},qe={years:{quarters:4,months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:4.3481250000000005,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3},...Ve},je=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],$e=je.slice(0).reverse();function Ue(t,e,i=!1){const n={values:i?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy};return new We(n)}function Ze(t,e,i,n,r){const s=t[r][i],o=e[i]/s,a=Math.sign(o)!==Math.sign(n[r])&&0!==n[r]&&Math.abs(o)<=1?function(t){return t<0?Math.floor(t):Math.ceil(t)}(o):Math.trunc(o);n[r]+=a,e[i]-=a*s}class We{constructor(t){const e="longterm"===t.conversionAccuracy||!1;this.values=t.values,this.loc=t.loc||Jt.create(),this.conversionAccuracy=e?"longterm":"casual",this.invalid=t.invalid||null,this.matrix=e?qe:Ne,this.isLuxonDuration=!0}static fromMillis(t,e){return We.fromObject({milliseconds:t},e)}static fromObject(t,e={}){if(null==t||"object"!=typeof t)throw new c("Duration.fromObject: argument expected to be an object, got "+(null===t?"null":typeof t));return new We({values:nt(t,We.normalizeUnit),loc:Jt.fromObject(e),conversionAccuracy:e.conversionAccuracy})}static fromDurationLike(t){if(O(t))return We.fromMillis(t);if(We.isDuration(t))return t;if("object"==typeof t)return We.fromObject(t);throw new c(`Unknown duration argument ${t} of type ${typeof t}`)}static fromISO(t,e){const[i]=function(t){return ee(t,[ge,_e])}(t);return i?We.fromObject(i,e):We.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static fromISOTime(t,e){const[i]=function(t){return ee(t,[me,Fe])}(t);return i?We.fromObject(i,e):We.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static invalid(t,e=null){if(!t)throw new c("need to specify a reason the Duration is invalid");const i=t instanceof kt?t:new kt(t,e);if(qt.throwOnInvalid)throw new o(i);return new We({invalid:i})}static normalizeUnit(t){const e={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[t?t.toLowerCase():t];if(!e)throw new l(t);return e}static isDuration(t){return t&&t.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(t,e={}){const i={...e,floor:!1!==e.round&&!1!==e.floor};return this.isValid?wt.create(this.loc,i).formatDurationFromString(this,t):"Invalid Duration"}toHuman(t={}){const e=je.map((e=>{const i=this.values[e];return R(i)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...t,unit:e.slice(0,-1)}).format(i)})).filter((t=>t));return this.loc.listFormatter({type:"conjunction",style:t.listStyle||"narrow",...t}).format(e)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let t="P";return 0!==this.years&&(t+=this.years+"Y"),0===this.months&&0===this.quarters||(t+=this.months+3*this.quarters+"M"),0!==this.weeks&&(t+=this.weeks+"W"),0!==this.days&&(t+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(t+="T"),0!==this.hours&&(t+=this.hours+"H"),0!==this.minutes&&(t+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(t+=G(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===t&&(t+="T0S"),t}toISOTime(t={}){if(!this.isValid)return null;const e=this.toMillis();if(e<0||e>=864e5)return null;t={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...t};const i=this.shiftTo("hours","minutes","seconds","milliseconds");let n="basic"===t.format?"hhmm":"hh:mm";t.suppressSeconds&&0===i.seconds&&0===i.milliseconds||(n+="basic"===t.format?"ss":":ss",t.suppressMilliseconds&&0===i.milliseconds||(n+=".SSS"));let r=i.toFormat(n);return t.includePrefix&&(r="T"+r),r}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.as("milliseconds")}valueOf(){return this.toMillis()}plus(t){if(!this.isValid)return this;const e=We.fromDurationLike(t),i={};for(const t of je)(q(e.values,t)||q(this.values,t))&&(i[t]=e.get(t)+this.get(t));return Ue(this,{values:i},!0)}minus(t){if(!this.isValid)return this;const e=We.fromDurationLike(t);return this.plus(e.negate())}mapUnits(t){if(!this.isValid)return this;const e={};for(const i of Object.keys(this.values))e[i]=it(t(this.values[i],i));return Ue(this,{values:e},!0)}get(t){return this[We.normalizeUnit(t)]}set(t){return this.isValid?Ue(this,{values:{...this.values,...nt(t,We.normalizeUnit)}}):this}reconfigure({locale:t,numberingSystem:e,conversionAccuracy:i}={}){const n={loc:this.loc.clone({locale:t,numberingSystem:e})};return i&&(n.conversionAccuracy=i),Ue(this,n)}as(t){return this.isValid?this.shiftTo(t).get(t):NaN}normalize(){if(!this.isValid)return this;const t=this.toObject();return function(t,e){$e.reduce(((i,n)=>R(e[n])?i:(i&&Ze(t,e,i,e,n),n)),null)}(this.matrix,t),Ue(this,{values:t},!0)}shiftTo(...t){if(!this.isValid)return this;if(0===t.length)return this;t=t.map((t=>We.normalizeUnit(t)));const e={},i={},n=this.toObject();let r;for(const s of je)if(t.indexOf(s)>=0){r=s;let t=0;for(const e in i)t+=this.matrix[e][s]*i[e],i[e]=0;O(n[s])&&(t+=n[s]);const o=Math.trunc(t);e[s]=o,i[s]=(1e3*t-1e3*o)/1e3;for(const t in n)je.indexOf(t)>je.indexOf(s)&&Ze(this.matrix,n,t,e,s)}else O(n[s])&&(i[s]=n[s]);for(const t in i)0!==i[t]&&(e[r]+=t===r?i[t]:i[t]/this.matrix[r][t]);return Ue(this,{values:e},!0).normalize()}negate(){if(!this.isValid)return this;const t={};for(const e of Object.keys(this.values))t[e]=0===this.values[e]?0:-this.values[e];return Ue(this,{values:t},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(t){if(!this.isValid||!t.isValid)return!1;if(!this.loc.equals(t.loc))return!1;for(const n of je)if(e=this.values[n],i=t.values[n],!(void 0===e||0===e?void 0===i||0===i:e===i))return!1;var e,i;return!0}}const Ge="Invalid Interval";class He{constructor(t){this.s=t.start,this.e=t.end,this.invalid=t.invalid||null,this.isLuxonInterval=!0}static invalid(t,e=null){if(!t)throw new c("need to specify a reason the Interval is invalid");const i=t instanceof kt?t:new kt(t,e);if(qt.throwOnInvalid)throw new s(i);return new He({invalid:i})}static fromDateTimes(t,e){const i=Hi(t),n=Hi(e),r=function(t,e){return t&&t.isValid?e&&e.isValid?e<t?He.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null:He.invalid("missing or invalid end"):He.invalid("missing or invalid start")}(i,n);return null==r?new He({start:i,end:n}):r}static after(t,e){const i=We.fromDurationLike(e),n=Hi(t);return He.fromDateTimes(n,n.plus(i))}static before(t,e){const i=We.fromDurationLike(e),n=Hi(t);return He.fromDateTimes(n.minus(i),n)}static fromISO(t,e){const[i,n]=(t||"").split("/",2);if(i&&n){let t,r,s,o;try{t=Gi.fromISO(i,e),r=t.isValid}catch(n){r=!1}try{s=Gi.fromISO(n,e),o=s.isValid}catch(n){o=!1}if(r&&o)return He.fromDateTimes(t,s);if(r){const i=We.fromISO(n,e);if(i.isValid)return He.after(t,i)}else if(o){const t=We.fromISO(i,e);if(t.isValid)return He.before(s,t)}}return He.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static isInterval(t){return t&&t.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return null===this.invalidReason}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(t="milliseconds"){return this.isValid?this.toDuration(t).get(t):NaN}count(t="milliseconds"){if(!this.isValid)return NaN;const e=this.start.startOf(t),i=this.end.startOf(t);return Math.floor(i.diff(e,t).get(t))+1}hasSame(t){return!!this.isValid&&(this.isEmpty()||this.e.minus(1).hasSame(this.s,t))}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(t){return!!this.isValid&&this.s>t}isBefore(t){return!!this.isValid&&this.e<=t}contains(t){return!!this.isValid&&this.s<=t&&this.e>t}set({start:t,end:e}={}){return this.isValid?He.fromDateTimes(t||this.s,e||this.e):this}splitAt(...t){if(!this.isValid)return[];const e=t.map(Hi).filter((t=>this.contains(t))).sort(),i=[];let{s:n}=this,r=0;for(;n<this.e;){const t=e[r]||this.e,s=+t>+this.e?this.e:t;i.push(He.fromDateTimes(n,s)),n=s,r+=1}return i}splitBy(t){const e=We.fromDurationLike(t);if(!this.isValid||!e.isValid||0===e.as("milliseconds"))return[];let i,{s:n}=this,r=1;const s=[];for(;n<this.e;){const t=this.start.plus(e.mapUnits((t=>t*r)));i=+t>+this.e?this.e:t,s.push(He.fromDateTimes(n,i)),n=i,r+=1}return s}divideEqually(t){return this.isValid?this.splitBy(this.length()/t).slice(0,t):[]}overlaps(t){return this.e>t.s&&this.s<t.e}abutsStart(t){return!!this.isValid&&+this.e==+t.s}abutsEnd(t){return!!this.isValid&&+t.e==+this.s}engulfs(t){return!!this.isValid&&this.s<=t.s&&this.e>=t.e}equals(t){return!(!this.isValid||!t.isValid)&&this.s.equals(t.s)&&this.e.equals(t.e)}intersection(t){if(!this.isValid)return this;const e=this.s>t.s?this.s:t.s,i=this.e<t.e?this.e:t.e;return e>=i?null:He.fromDateTimes(e,i)}union(t){if(!this.isValid)return this;const e=this.s<t.s?this.s:t.s,i=this.e>t.e?this.e:t.e;return He.fromDateTimes(e,i)}static merge(t){const[e,i]=t.sort(((t,e)=>t.s-e.s)).reduce((([t,e],i)=>e?e.overlaps(i)||e.abutsStart(i)?[t,e.union(i)]:[t.concat([e]),i]:[t,i]),[[],null]);return i&&e.push(i),e}static xor(t){let e=null,i=0;const n=[],r=t.map((t=>[{time:t.s,type:"s"},{time:t.e,type:"e"}])),s=Array.prototype.concat(...r).sort(((t,e)=>t.time-e.time));for(const t of s)i+="s"===t.type?1:-1,1===i?e=t.time:(e&&+e!=+t.time&&n.push(He.fromDateTimes(e,t.time)),e=null);return He.merge(n)}difference(...t){return He.xor([this].concat(t)).map((t=>this.intersection(t))).filter((t=>t&&!t.isEmpty()))}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:Ge}toISO(t){return this.isValid?`${this.s.toISO(t)}/${this.e.toISO(t)}`:Ge}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Ge}toISOTime(t){return this.isValid?`${this.s.toISOTime(t)}/${this.e.toISOTime(t)}`:Ge}toFormat(t,{separator:e=" – "}={}){return this.isValid?`${this.s.toFormat(t)}${e}${this.e.toFormat(t)}`:Ge}toDuration(t,e){return this.isValid?this.e.diff(this.s,t,e):We.invalid(this.invalidReason)}mapEndpoints(t){return He.fromDateTimes(t(this.s),t(this.e))}}class Xe{static hasDST(t=qt.defaultZone){const e=Gi.now().setZone(t).set({month:12});return!t.isUniversal&&e.offset!==e.set({month:6}).offset}static isValidIANAZone(t){return It.isValidZone(t)}static normalizeZone(t){return Lt(t,qt.defaultZone)}static months(t="long",{locale:e=null,numberingSystem:i=null,locObj:n=null,outputCalendar:r="gregory"}={}){return(n||Jt.create(e,i,r)).months(t)}static monthsFormat(t="long",{locale:e=null,numberingSystem:i=null,locObj:n=null,outputCalendar:r="gregory"}={}){return(n||Jt.create(e,i,r)).months(t,!0)}static weekdays(t="long",{locale:e=null,numberingSystem:i=null,locObj:n=null}={}){return(n||Jt.create(e,i,null)).weekdays(t)}static weekdaysFormat(t="long",{locale:e=null,numberingSystem:i=null,locObj:n=null}={}){return(n||Jt.create(e,i,null)).weekdays(t,!0)}static meridiems({locale:t=null}={}){return Jt.create(t).meridiems()}static eras(t="short",{locale:e=null}={}){return Jt.create(e,null,"gregory").eras(t)}static features(){return{relative:V()}}}function Ye(t,e){const i=t=>t.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),n=i(e)-i(t);return Math.floor(We.fromMillis(n).as("days"))}const Ke={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},Je={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Qe=Ke.hanidec.replace(/[\[|\]]/g,"").split("");function ti({numberingSystem:t},e=""){return new RegExp(`${Ke[t||"latn"]}${e}`)}function ei(t,e=(t=>t)){return{regex:t,deser:([t])=>e(function(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let i=0;i<t.length;i++){const n=t.charCodeAt(i);if(-1!==t[i].search(Ke.hanidec))e+=Qe.indexOf(t[i]);else for(const t in Je){const[i,r]=Je[t];n>=i&&n<=r&&(e+=n-i)}}return parseInt(e,10)}return e}(t))}}const ii=`[ ${String.fromCharCode(160)}]`,ni=new RegExp(ii,"g");function ri(t){return t.replace(/\./g,"\\.?").replace(ni,ii)}function si(t){return t.replace(/\./g,"").replace(ni," ").toLowerCase()}function oi(t,e){return null===t?null:{regex:RegExp(t.map(ri).join("|")),deser:([i])=>t.findIndex((t=>si(i)===si(t)))+e}}function ai(t,e){return{regex:t,deser:([,t,e])=>et(t,e),groups:e}}function li(t){return{regex:t,deser:([t])=>t}}const ci={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"}};let ui=null;function hi(t,e,i){const n=function(t,e){return Array.prototype.concat(...t.map((t=>function(t,e){if(t.literal)return t;const i=wt.macroTokenToFormatOpts(t.val);if(!i)return t;const n=wt.create(e,i).formatDateTimeParts((ui||(ui=Gi.fromMillis(1555555555555)),ui)).map((t=>function(t,e,i){const{type:n,value:r}=t;if("literal"===n)return{literal:!0,val:r};const s=i[n];let o=ci[n];return"object"==typeof o&&(o=o[s]),o?{literal:!1,val:o}:void 0}(t,0,i)));return n.includes(void 0)?t:n}(t,e))))}(wt.parseFormat(i),t),r=n.map((e=>function(t,e){const i=ti(e),n=ti(e,"{2}"),r=ti(e,"{3}"),s=ti(e,"{4}"),o=ti(e,"{6}"),a=ti(e,"{1,2}"),l=ti(e,"{1,3}"),c=ti(e,"{1,6}"),u=ti(e,"{1,9}"),h=ti(e,"{2,4}"),d=ti(e,"{4,6}"),p=t=>{return{regex:RegExp((e=t.val,e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"))),deser:([t])=>t,literal:!0};var e},f=(f=>{if(t.literal)return p(f);switch(f.val){case"G":return oi(e.eras("short",!1),0);case"GG":return oi(e.eras("long",!1),0);case"y":return ei(c);case"yy":case"kk":return ei(h,Q);case"yyyy":case"kkkk":return ei(s);case"yyyyy":return ei(d);case"yyyyyy":return ei(o);case"M":case"L":case"d":case"H":case"h":case"m":case"q":case"s":case"W":return ei(a);case"MM":case"LL":case"dd":case"HH":case"hh":case"mm":case"qq":case"ss":case"WW":return ei(n);case"MMM":return oi(e.months("short",!0,!1),1);case"MMMM":return oi(e.months("long",!0,!1),1);case"LLL":return oi(e.months("short",!1,!1),1);case"LLLL":return oi(e.months("long",!1,!1),1);case"o":case"S":return ei(l);case"ooo":case"SSS":return ei(r);case"u":return li(u);case"uu":return li(a);case"uuu":case"E":case"c":return ei(i);case"a":return oi(e.meridiems(),0);case"EEE":return oi(e.weekdays("short",!1,!1),1);case"EEEE":return oi(e.weekdays("long",!1,!1),1);case"ccc":return oi(e.weekdays("short",!0,!1),1);case"cccc":return oi(e.weekdays("long",!0,!1),1);case"Z":case"ZZ":return ai(new RegExp(`([+-]${a.source})(?::(${n.source}))?`),2);case"ZZZ":return ai(new RegExp(`([+-]${a.source})(${n.source})?`),2);case"z":return li(/[a-z_+-/]{1,256}?/i);default:return p(f)}})(t)||{invalidReason:"missing Intl.DateTimeFormat.formatToParts support"};return f.token=t,f}(e,t))),s=r.find((t=>t.invalidReason));if(s)return{input:e,tokens:n,invalidReason:s.invalidReason};{const[t,i]=function(t){return[`^${t.map((t=>t.regex)).reduce(((t,e)=>`${t}(${e.source})`),"")}$`,t]}(r),s=RegExp(t,"i"),[o,l]=function(t,e,i){const n=t.match(e);if(n){const t={};let e=1;for(const r in i)if(q(i,r)){const s=i[r],o=s.groups?s.groups+1:1;!s.literal&&s.token&&(t[s.token.val[0]]=s.deser(n.slice(e,e+o))),e+=o}return[n,t]}return[n,{}]}(e,s,i),[c,u,h]=l?function(t){let e,i=null;return R(t.z)||(i=It.create(t.z)),R(t.Z)||(i||(i=new zt(t.Z)),e=t.Z),R(t.q)||(t.M=3*(t.q-1)+1),R(t.h)||(t.h<12&&1===t.a?t.h+=12:12===t.h&&0===t.a&&(t.h=0)),0===t.G&&t.y&&(t.y=-t.y),R(t.u)||(t.S=W(t.u)),[Object.keys(t).reduce(((e,i)=>{const n=(t=>{switch(t){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}})(i);return n&&(e[n]=t[i]),e}),{}),i,e]}(l):[null,null,void 0];if(q(l,"a")&&q(l,"H"))throw new a("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:n,regex:s,rawMatches:o,matches:l,result:c,zone:u,specificOffset:h}}}const di=[0,31,59,90,120,151,181,212,243,273,304,334],pi=[0,31,60,91,121,152,182,213,244,274,305,335];function fi(t,e){return new kt("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function mi(t,e,i){const n=new Date(Date.UTC(t,e-1,i));t<100&&t>=0&&n.setUTCFullYear(n.getUTCFullYear()-1900);const r=n.getUTCDay();return 0===r?7:r}function gi(t,e,i){return i+(H(t)?pi:di)[e-1]}function _i(t,e){const i=H(t)?pi:di,n=i.findIndex((t=>t<e));return{month:n+1,day:e-i[n]}}function yi(t){const{year:e,month:i,day:n}=t,r=gi(e,i,n),s=mi(e,i,n);let o,a=Math.floor((r-s+10)/7);return a<1?(o=e-1,a=J(o)):a>J(e)?(o=e+1,a=1):o=e,{weekYear:o,weekNumber:a,weekday:s,...st(t)}}function xi(t){const{weekYear:e,weekNumber:i,weekday:n}=t,r=mi(e,1,4),s=X(e);let o,a=7*i+n-r-3;a<1?(o=e-1,a+=X(o)):a>s?(o=e+1,a-=X(e)):o=e;const{month:l,day:c}=_i(o,a);return{year:o,month:l,day:c,...st(t)}}function vi(t){const{year:e,month:i,day:n}=t;return{year:e,ordinal:gi(e,i,n),...st(t)}}function bi(t){const{year:e,ordinal:i}=t,{month:n,day:r}=_i(e,i);return{year:e,month:n,day:r,...st(t)}}function wi(t){const e=B(t.year),i=j(t.month,1,12),n=j(t.day,1,Y(t.year,t.month));return e?i?!n&&fi("day",t.day):fi("month",t.month):fi("year",t.year)}function ki(t){const{hour:e,minute:i,second:n,millisecond:r}=t,s=j(e,0,23)||24===e&&0===i&&0===n&&0===r,o=j(i,0,59),a=j(n,0,59),l=j(r,0,999);return s?o?a?!l&&fi("millisecond",r):fi("second",n):fi("minute",i):fi("hour",e)}const Si="Invalid DateTime",Ti=864e13;function Ai(t){return new kt("unsupported zone",`the zone "${t.name}" is not supported`)}function Mi(t){return null===t.weekData&&(t.weekData=yi(t.c)),t.weekData}function Ci(t,e){const i={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new Gi({...i,...e,old:i})}function Ei(t,e,i){let n=t-60*e*1e3;const r=i.offset(n);if(e===r)return[n,e];n-=60*(r-e)*1e3;const s=i.offset(n);return r===s?[n,r]:[t-60*Math.min(r,s)*1e3,Math.max(r,s)]}function Ii(t,e){const i=new Date(t+=60*e*1e3);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function Di(t,e,i){return Ei(K(t),e,i)}function zi(t,e){const i=t.o,n=t.c.year+Math.trunc(e.years),r=t.c.month+Math.trunc(e.months)+3*Math.trunc(e.quarters),s={...t.c,year:n,month:r,day:Math.min(t.c.day,Y(n,r))+Math.trunc(e.days)+7*Math.trunc(e.weeks)},o=We.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=K(s);let[l,c]=Ei(a,i,t.zone);return 0!==o&&(l+=o,c=t.zone.offset(l)),{ts:l,o:c}}function Pi(t,e,i,n,r,s){const{setZone:o,zone:a}=i;if(t&&0!==Object.keys(t).length){const n=e||a,r=Gi.fromObject(t,{...i,zone:n,specificOffset:s});return o?r:r.setZone(a)}return Gi.invalid(new kt("unparsable",`the input "${r}" can't be parsed as ${n}`))}function Li(t,e,i=!0){return t.isValid?wt.create(Jt.create("en-US"),{allowZ:i,forceSimple:!0}).formatDateTimeFromString(t,e):null}function Fi(t,e){const i=t.c.year>9999||t.c.year<0;let n="";return i&&t.c.year>=0&&(n+="+"),n+=$(t.c.year,i?6:4),e?(n+="-",n+=$(t.c.month),n+="-",n+=$(t.c.day)):(n+=$(t.c.month),n+=$(t.c.day)),n}function Ri(t,e,i,n,r,s){let o=$(t.c.hour);return e?(o+=":",o+=$(t.c.minute),0===t.c.second&&i||(o+=":")):o+=$(t.c.minute),0===t.c.second&&i||(o+=$(t.c.second),0===t.c.millisecond&&n||(o+=".",o+=$(t.c.millisecond,3))),r&&(t.isOffsetFixed&&0===t.offset&&!s?o+="Z":t.o<0?(o+="-",o+=$(Math.trunc(-t.o/60)),o+=":",o+=$(Math.trunc(-t.o%60))):(o+="+",o+=$(Math.trunc(t.o/60)),o+=":",o+=$(Math.trunc(t.o%60)))),s&&(o+="["+t.zone.ianaName+"]"),o}const Oi={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Bi={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Vi={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Ni=["year","month","day","hour","minute","second","millisecond"],qi=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],ji=["year","ordinal","hour","minute","second","millisecond"];function $i(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new l(t);return e}function Ui(t,e){const i=Lt(e.zone,qt.defaultZone),n=Jt.fromObject(e),r=qt.now();let s,o;if(R(t.year))s=r;else{for(const e of Ni)R(t[e])&&(t[e]=Oi[e]);const e=wi(t)||ki(t);if(e)return Gi.invalid(e);const n=i.offset(r);[s,o]=Di(t,n,i)}return new Gi({ts:s,zone:i,loc:n,o:o})}function Zi(t,e,i){const n=!!R(i.round)||i.round,r=(t,r)=>(t=G(t,n||i.calendary?0:2,!0),e.loc.clone(i).relFormatter(i).format(t,r)),s=n=>i.calendary?e.hasSame(t,n)?0:e.startOf(n).diff(t.startOf(n),n).get(n):e.diff(t,n).get(n);if(i.unit)return r(s(i.unit),i.unit);for(const t of i.units){const e=s(t);if(Math.abs(e)>=1)return r(e,t)}return r(t>e?-0:0,i.units[i.units.length-1])}function Wi(t){let e,i={};return t.length>0&&"object"==typeof t[t.length-1]?(i=t[t.length-1],e=Array.from(t).slice(0,t.length-1)):e=Array.from(t),[i,e]}class Gi{constructor(t){const e=t.zone||qt.defaultZone;let i=t.invalid||(Number.isNaN(t.ts)?new kt("invalid input"):null)||(e.isValid?null:Ai(e));this.ts=R(t.ts)?qt.now():t.ts;let n=null,r=null;if(!i)if(t.old&&t.old.ts===this.ts&&t.old.zone.equals(e))[n,r]=[t.old.c,t.old.o];else{const t=e.offset(this.ts);n=Ii(this.ts,t),i=Number.isNaN(n.year)?new kt("invalid input"):null,n=i?null:n,r=i?null:t}this._zone=e,this.loc=t.loc||Jt.create(),this.invalid=i,this.weekData=null,this.c=n,this.o=r,this.isLuxonDateTime=!0}static now(){return new Gi({})}static local(){const[t,e]=Wi(arguments),[i,n,r,s,o,a,l]=e;return Ui({year:i,month:n,day:r,hour:s,minute:o,second:a,millisecond:l},t)}static utc(){const[t,e]=Wi(arguments),[i,n,r,s,o,a,l]=e;return t.zone=zt.utcInstance,Ui({year:i,month:n,day:r,hour:s,minute:o,second:a,millisecond:l},t)}static fromJSDate(t,e={}){const i=(n=t,"[object Date]"===Object.prototype.toString.call(n)?t.valueOf():NaN);var n;if(Number.isNaN(i))return Gi.invalid("invalid input");const r=Lt(e.zone,qt.defaultZone);return r.isValid?new Gi({ts:i,zone:r,loc:Jt.fromObject(e)}):Gi.invalid(Ai(r))}static fromMillis(t,e={}){if(O(t))return t<-Ti||t>Ti?Gi.invalid("Timestamp out of range"):new Gi({ts:t,zone:Lt(e.zone,qt.defaultZone),loc:Jt.fromObject(e)});throw new c(`fromMillis requires a numerical input, but received a ${typeof t} with value ${t}`)}static fromSeconds(t,e={}){if(O(t))return new Gi({ts:1e3*t,zone:Lt(e.zone,qt.defaultZone),loc:Jt.fromObject(e)});throw new c("fromSeconds requires a numerical input")}static fromObject(t,e={}){t=t||{};const i=Lt(e.zone,qt.defaultZone);if(!i.isValid)return Gi.invalid(Ai(i));const n=qt.now(),r=R(e.specificOffset)?i.offset(n):e.specificOffset,s=nt(t,$i),o=!R(s.ordinal),l=!R(s.year),c=!R(s.month)||!R(s.day),u=l||c,h=s.weekYear||s.weekNumber,d=Jt.fromObject(e);if((u||o)&&h)throw new a("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(c&&o)throw new a("Can't mix ordinal dates with month/day");const p=h||s.weekday&&!u;let f,m,g=Ii(n,r);p?(f=qi,m=Bi,g=yi(g)):o?(f=ji,m=Vi,g=vi(g)):(f=Ni,m=Oi);let _=!1;for(const t of f)R(s[t])?s[t]=_?m[t]:g[t]:_=!0;const y=p?function(t){const e=B(t.weekYear),i=j(t.weekNumber,1,J(t.weekYear)),n=j(t.weekday,1,7);return e?i?!n&&fi("weekday",t.weekday):fi("week",t.week):fi("weekYear",t.weekYear)}(s):o?function(t){const e=B(t.year),i=j(t.ordinal,1,X(t.year));return e?!i&&fi("ordinal",t.ordinal):fi("year",t.year)}(s):wi(s),x=y||ki(s);if(x)return Gi.invalid(x);const v=p?xi(s):o?bi(s):s,[b,w]=Di(v,r,i),k=new Gi({ts:b,zone:i,o:w,loc:d});return s.weekday&&u&&t.weekday!==k.weekday?Gi.invalid("mismatched weekday",`you can't specify both a weekday of ${s.weekday} and a date of ${k.toISO()}`):k}static fromISO(t,e={}){const[i,n]=function(t){return ee(t,[Me,De],[Ce,ze],[Ee,Pe],[Ie,Le])}(t);return Pi(i,n,e,"ISO 8601",t)}static fromRFC2822(t,e={}){const[i,n]=function(t){return ee(function(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(t),[ve,be])}(t);return Pi(i,n,e,"RFC 2822",t)}static fromHTTP(t,e={}){const[i,n]=function(t){return ee(t,[we,Te],[ke,Te],[Se,Ae])}(t);return Pi(i,n,e,"HTTP",e)}static fromFormat(t,e,i={}){if(R(t)||R(e))throw new c("fromFormat requires an input string and a format");const{locale:n=null,numberingSystem:r=null}=i,s=Jt.fromOpts({locale:n,numberingSystem:r,defaultToEN:!0}),[o,a,l,u]=function(t,e,i){const{result:n,zone:r,specificOffset:s,invalidReason:o}=hi(t,e,i);return[n,r,s,o]}(s,t,e);return u?Gi.invalid(u):Pi(o,a,i,`format ${e}`,t,l)}static fromString(t,e,i={}){return Gi.fromFormat(t,e,i)}static fromSQL(t,e={}){const[i,n]=function(t){return ee(t,[Re,De],[Oe,Be])}(t);return Pi(i,n,e,"SQL",t)}static invalid(t,e=null){if(!t)throw new c("need to specify a reason the DateTime is invalid");const i=t instanceof kt?t:new kt(t,e);if(qt.throwOnInvalid)throw new r(i);return new Gi({invalid:i})}static isDateTime(t){return t&&t.isLuxonDateTime||!1}get(t){return this[t]}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?Mi(this).weekYear:NaN}get weekNumber(){return this.isValid?Mi(this).weekNumber:NaN}get weekday(){return this.isValid?Mi(this).weekday:NaN}get ordinal(){return this.isValid?vi(this.c).ordinal:NaN}get monthShort(){return this.isValid?Xe.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Xe.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Xe.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Xe.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return!this.isOffsetFixed&&(this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset)}get isInLeapYear(){return H(this.year)}get daysInMonth(){return Y(this.year,this.month)}get daysInYear(){return this.isValid?X(this.year):NaN}get weeksInWeekYear(){return this.isValid?J(this.weekYear):NaN}resolvedLocaleOptions(t={}){const{locale:e,numberingSystem:i,calendar:n}=wt.create(this.loc.clone(t),t).resolvedOptions(this);return{locale:e,numberingSystem:i,outputCalendar:n}}toUTC(t=0,e={}){return this.setZone(zt.instance(t),e)}toLocal(){return this.setZone(qt.defaultZone)}setZone(t,{keepLocalTime:e=!1,keepCalendarTime:i=!1}={}){if((t=Lt(t,qt.defaultZone)).equals(this.zone))return this;if(t.isValid){let n=this.ts;if(e||i){const e=t.offset(this.ts),i=this.toObject();[n]=Di(i,e,t)}return Ci(this,{ts:n,zone:t})}return Gi.invalid(Ai(t))}reconfigure({locale:t,numberingSystem:e,outputCalendar:i}={}){return Ci(this,{loc:this.loc.clone({locale:t,numberingSystem:e,outputCalendar:i})})}setLocale(t){return this.reconfigure({locale:t})}set(t){if(!this.isValid)return this;const e=nt(t,$i),i=!R(e.weekYear)||!R(e.weekNumber)||!R(e.weekday),n=!R(e.ordinal),r=!R(e.year),s=!R(e.month)||!R(e.day),o=r||s,l=e.weekYear||e.weekNumber;if((o||n)&&l)throw new a("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(s&&n)throw new a("Can't mix ordinal dates with month/day");let c;i?c=xi({...yi(this.c),...e}):R(e.ordinal)?(c={...this.toObject(),...e},R(e.day)&&(c.day=Math.min(Y(c.year,c.month),c.day))):c=bi({...vi(this.c),...e});const[u,h]=Di(c,this.o,this.zone);return Ci(this,{ts:u,o:h})}plus(t){return this.isValid?Ci(this,zi(this,We.fromDurationLike(t))):this}minus(t){return this.isValid?Ci(this,zi(this,We.fromDurationLike(t).negate())):this}startOf(t){if(!this.isValid)return this;const e={},i=We.normalizeUnit(t);switch(i){case"years":e.month=1;case"quarters":case"months":e.day=1;case"weeks":case"days":e.hour=0;case"hours":e.minute=0;case"minutes":e.second=0;case"seconds":e.millisecond=0}if("weeks"===i&&(e.weekday=1),"quarters"===i){const t=Math.ceil(this.month/3);e.month=3*(t-1)+1}return this.set(e)}endOf(t){return this.isValid?this.plus({[t]:1}).startOf(t).minus(1):this}toFormat(t,e={}){return this.isValid?wt.create(this.loc.redefaultToEN(e)).formatDateTimeFromString(this,t):Si}toLocaleString(t=f,e={}){return this.isValid?wt.create(this.loc.clone(e),t).formatDateTime(this):Si}toLocaleParts(t={}){return this.isValid?wt.create(this.loc.clone(t),t).formatDateTimeParts(this):[]}toISO({format:t="extended",suppressSeconds:e=!1,suppressMilliseconds:i=!1,includeOffset:n=!0,extendedZone:r=!1}={}){if(!this.isValid)return null;const s="extended"===t;let o=Fi(this,s);return o+="T",o+=Ri(this,s,e,i,n,r),o}toISODate({format:t="extended"}={}){return this.isValid?Fi(this,"extended"===t):null}toISOWeekDate(){return Li(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:t=!1,suppressSeconds:e=!1,includeOffset:i=!0,includePrefix:n=!1,extendedZone:r=!1,format:s="extended"}={}){return this.isValid?(n?"T":"")+Ri(this,"extended"===s,e,t,i,r):null}toRFC2822(){return Li(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return Li(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?Fi(this,!0):null}toSQLTime({includeOffset:t=!0,includeZone:e=!1,includeOffsetSpace:i=!0}={}){let n="HH:mm:ss.SSS";return(e||t)&&(i&&(n+=" "),e?n+="z":t&&(n+="ZZ")),Li(this,n,!0)}toSQL(t={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(t)}`:null}toString(){return this.isValid?this.toISO():Si}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(t={}){if(!this.isValid)return{};const e={...this.c};return t.includeConfig&&(e.outputCalendar=this.outputCalendar,e.numberingSystem=this.loc.numberingSystem,e.locale=this.loc.locale),e}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(t,e="milliseconds",i={}){if(!this.isValid||!t.isValid)return We.invalid("created by diffing an invalid DateTime");const n={locale:this.locale,numberingSystem:this.numberingSystem,...i},r=(a=e,Array.isArray(a)?a:[a]).map(We.normalizeUnit),s=t.valueOf()>this.valueOf(),o=function(t,e,i,n){let[r,s,o,a]=function(t,e,i){const n=[["years",(t,e)=>e.year-t.year],["quarters",(t,e)=>e.quarter-t.quarter],["months",(t,e)=>e.month-t.month+12*(e.year-t.year)],["weeks",(t,e)=>{const i=Ye(t,e);return(i-i%7)/7}],["days",Ye]],r={};let s,o;for(const[a,l]of n)if(i.indexOf(a)>=0){s=a;let i=l(t,e);o=t.plus({[a]:i}),o>e?(t=t.plus({[a]:i-1}),i-=1):t=o,r[a]=i}return[t,r,o,s]}(t,e,i);const l=e-r,c=i.filter((t=>["hours","minutes","seconds","milliseconds"].indexOf(t)>=0));0===c.length&&(o<e&&(o=r.plus({[a]:1})),o!==r&&(s[a]=(s[a]||0)+l/(o-r)));const u=We.fromObject(s,n);return c.length>0?We.fromMillis(l,n).shiftTo(...c).plus(u):u}(s?this:t,s?t:this,r,n);var a;return s?o.negate():o}diffNow(t="milliseconds",e={}){return this.diff(Gi.now(),t,e)}until(t){return this.isValid?He.fromDateTimes(this,t):this}hasSame(t,e){if(!this.isValid)return!1;const i=t.valueOf(),n=this.setZone(t.zone,{keepLocalTime:!0});return n.startOf(e)<=i&&i<=n.endOf(e)}equals(t){return this.isValid&&t.isValid&&this.valueOf()===t.valueOf()&&this.zone.equals(t.zone)&&this.loc.equals(t.loc)}toRelative(t={}){if(!this.isValid)return null;const e=t.base||Gi.fromObject({},{zone:this.zone}),i=t.padding?this<e?-t.padding:t.padding:0;let n=["years","months","days","hours","minutes","seconds"],r=t.unit;return Array.isArray(t.unit)&&(n=t.unit,r=void 0),Zi(e,this.plus(i),{...t,numeric:"always",units:n,unit:r})}toRelativeCalendar(t={}){return this.isValid?Zi(t.base||Gi.fromObject({},{zone:this.zone}),this,{...t,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...t){if(!t.every(Gi.isDateTime))throw new c("min requires all arguments be DateTimes");return N(t,(t=>t.valueOf()),Math.min)}static max(...t){if(!t.every(Gi.isDateTime))throw new c("max requires all arguments be DateTimes");return N(t,(t=>t.valueOf()),Math.max)}static fromFormatExplain(t,e,i={}){const{locale:n=null,numberingSystem:r=null}=i;return hi(Jt.fromOpts({locale:n,numberingSystem:r,defaultToEN:!0}),t,e)}static fromStringExplain(t,e,i={}){return Gi.fromFormatExplain(t,e,i)}static get DATE_SHORT(){return f}static get DATE_MED(){return m}static get DATE_MED_WITH_WEEKDAY(){return g}static get DATE_FULL(){return _}static get DATE_HUGE(){return y}static get TIME_SIMPLE(){return x}static get TIME_WITH_SECONDS(){return v}static get TIME_WITH_SHORT_OFFSET(){return b}static get TIME_WITH_LONG_OFFSET(){return w}static get TIME_24_SIMPLE(){return k}static get TIME_24_WITH_SECONDS(){return S}static get TIME_24_WITH_SHORT_OFFSET(){return T}static get TIME_24_WITH_LONG_OFFSET(){return A}static get DATETIME_SHORT(){return M}static get DATETIME_SHORT_WITH_SECONDS(){return C}static get DATETIME_MED(){return E}static get DATETIME_MED_WITH_SECONDS(){return I}static get DATETIME_MED_WITH_WEEKDAY(){return D}static get DATETIME_FULL(){return z}static get DATETIME_FULL_WITH_SECONDS(){return P}static get DATETIME_HUGE(){return L}static get DATETIME_HUGE_WITH_SECONDS(){return F}}function Hi(t){if(Gi.isDateTime(t))return t;if(t&&t.valueOf&&O(t.valueOf()))return Gi.fromJSDate(t);if(t&&"object"==typeof t)return Gi.fromObject(t);throw new c(`Unknown datetime argument: ${t}, of type ${typeof t}`)}},9752:function(t){"use strict";t.exports=JSON.parse('{"Aacute":"Á","aacute":"á","Abreve":"Ă","abreve":"ă","ac":"∾","acd":"∿","acE":"∾̳","Acirc":"Â","acirc":"â","acute":"´","Acy":"А","acy":"а","AElig":"Æ","aelig":"æ","af":"⁡","Afr":"𝔄","afr":"𝔞","Agrave":"À","agrave":"à","alefsym":"ℵ","aleph":"ℵ","Alpha":"Α","alpha":"α","Amacr":"Ā","amacr":"ā","amalg":"⨿","amp":"&","AMP":"&","andand":"⩕","And":"⩓","and":"∧","andd":"⩜","andslope":"⩘","andv":"⩚","ang":"∠","ange":"⦤","angle":"∠","angmsdaa":"⦨","angmsdab":"⦩","angmsdac":"⦪","angmsdad":"⦫","angmsdae":"⦬","angmsdaf":"⦭","angmsdag":"⦮","angmsdah":"⦯","angmsd":"∡","angrt":"∟","angrtvb":"⊾","angrtvbd":"⦝","angsph":"∢","angst":"Å","angzarr":"⍼","Aogon":"Ą","aogon":"ą","Aopf":"𝔸","aopf":"𝕒","apacir":"⩯","ap":"≈","apE":"⩰","ape":"≊","apid":"≋","apos":"\'","ApplyFunction":"⁡","approx":"≈","approxeq":"≊","Aring":"Å","aring":"å","Ascr":"𝒜","ascr":"𝒶","Assign":"≔","ast":"*","asymp":"≈","asympeq":"≍","Atilde":"Ã","atilde":"ã","Auml":"Ä","auml":"ä","awconint":"∳","awint":"⨑","backcong":"≌","backepsilon":"϶","backprime":"‵","backsim":"∽","backsimeq":"⋍","Backslash":"∖","Barv":"⫧","barvee":"⊽","barwed":"⌅","Barwed":"⌆","barwedge":"⌅","bbrk":"⎵","bbrktbrk":"⎶","bcong":"≌","Bcy":"Б","bcy":"б","bdquo":"„","becaus":"∵","because":"∵","Because":"∵","bemptyv":"⦰","bepsi":"϶","bernou":"ℬ","Bernoullis":"ℬ","Beta":"Β","beta":"β","beth":"ℶ","between":"≬","Bfr":"𝔅","bfr":"𝔟","bigcap":"⋂","bigcirc":"◯","bigcup":"⋃","bigodot":"⨀","bigoplus":"⨁","bigotimes":"⨂","bigsqcup":"⨆","bigstar":"★","bigtriangledown":"▽","bigtriangleup":"△","biguplus":"⨄","bigvee":"⋁","bigwedge":"⋀","bkarow":"⤍","blacklozenge":"⧫","blacksquare":"▪","blacktriangle":"▴","blacktriangledown":"▾","blacktriangleleft":"◂","blacktriangleright":"▸","blank":"␣","blk12":"▒","blk14":"░","blk34":"▓","block":"█","bne":"=⃥","bnequiv":"≡⃥","bNot":"⫭","bnot":"⌐","Bopf":"𝔹","bopf":"𝕓","bot":"⊥","bottom":"⊥","bowtie":"⋈","boxbox":"⧉","boxdl":"┐","boxdL":"╕","boxDl":"╖","boxDL":"╗","boxdr":"┌","boxdR":"╒","boxDr":"╓","boxDR":"╔","boxh":"─","boxH":"═","boxhd":"┬","boxHd":"╤","boxhD":"╥","boxHD":"╦","boxhu":"┴","boxHu":"╧","boxhU":"╨","boxHU":"╩","boxminus":"⊟","boxplus":"⊞","boxtimes":"⊠","boxul":"┘","boxuL":"╛","boxUl":"╜","boxUL":"╝","boxur":"└","boxuR":"╘","boxUr":"╙","boxUR":"╚","boxv":"│","boxV":"║","boxvh":"┼","boxvH":"╪","boxVh":"╫","boxVH":"╬","boxvl":"┤","boxvL":"╡","boxVl":"╢","boxVL":"╣","boxvr":"├","boxvR":"╞","boxVr":"╟","boxVR":"╠","bprime":"‵","breve":"˘","Breve":"˘","brvbar":"¦","bscr":"𝒷","Bscr":"ℬ","bsemi":"⁏","bsim":"∽","bsime":"⋍","bsolb":"⧅","bsol":"\\\\","bsolhsub":"⟈","bull":"•","bullet":"•","bump":"≎","bumpE":"⪮","bumpe":"≏","Bumpeq":"≎","bumpeq":"≏","Cacute":"Ć","cacute":"ć","capand":"⩄","capbrcup":"⩉","capcap":"⩋","cap":"∩","Cap":"⋒","capcup":"⩇","capdot":"⩀","CapitalDifferentialD":"ⅅ","caps":"∩︀","caret":"⁁","caron":"ˇ","Cayleys":"ℭ","ccaps":"⩍","Ccaron":"Č","ccaron":"č","Ccedil":"Ç","ccedil":"ç","Ccirc":"Ĉ","ccirc":"ĉ","Cconint":"∰","ccups":"⩌","ccupssm":"⩐","Cdot":"Ċ","cdot":"ċ","cedil":"¸","Cedilla":"¸","cemptyv":"⦲","cent":"¢","centerdot":"·","CenterDot":"·","cfr":"𝔠","Cfr":"ℭ","CHcy":"Ч","chcy":"ч","check":"✓","checkmark":"✓","Chi":"Χ","chi":"χ","circ":"ˆ","circeq":"≗","circlearrowleft":"↺","circlearrowright":"↻","circledast":"⊛","circledcirc":"⊚","circleddash":"⊝","CircleDot":"⊙","circledR":"®","circledS":"Ⓢ","CircleMinus":"⊖","CirclePlus":"⊕","CircleTimes":"⊗","cir":"○","cirE":"⧃","cire":"≗","cirfnint":"⨐","cirmid":"⫯","cirscir":"⧂","ClockwiseContourIntegral":"∲","CloseCurlyDoubleQuote":"”","CloseCurlyQuote":"’","clubs":"♣","clubsuit":"♣","colon":":","Colon":"∷","Colone":"⩴","colone":"≔","coloneq":"≔","comma":",","commat":"@","comp":"∁","compfn":"∘","complement":"∁","complexes":"ℂ","cong":"≅","congdot":"⩭","Congruent":"≡","conint":"∮","Conint":"∯","ContourIntegral":"∮","copf":"𝕔","Copf":"ℂ","coprod":"∐","Coproduct":"∐","copy":"©","COPY":"©","copysr":"℗","CounterClockwiseContourIntegral":"∳","crarr":"↵","cross":"✗","Cross":"⨯","Cscr":"𝒞","cscr":"𝒸","csub":"⫏","csube":"⫑","csup":"⫐","csupe":"⫒","ctdot":"⋯","cudarrl":"⤸","cudarrr":"⤵","cuepr":"⋞","cuesc":"⋟","cularr":"↶","cularrp":"⤽","cupbrcap":"⩈","cupcap":"⩆","CupCap":"≍","cup":"∪","Cup":"⋓","cupcup":"⩊","cupdot":"⊍","cupor":"⩅","cups":"∪︀","curarr":"↷","curarrm":"⤼","curlyeqprec":"⋞","curlyeqsucc":"⋟","curlyvee":"⋎","curlywedge":"⋏","curren":"¤","curvearrowleft":"↶","curvearrowright":"↷","cuvee":"⋎","cuwed":"⋏","cwconint":"∲","cwint":"∱","cylcty":"⌭","dagger":"†","Dagger":"‡","daleth":"ℸ","darr":"↓","Darr":"↡","dArr":"⇓","dash":"‐","Dashv":"⫤","dashv":"⊣","dbkarow":"⤏","dblac":"˝","Dcaron":"Ď","dcaron":"ď","Dcy":"Д","dcy":"д","ddagger":"‡","ddarr":"⇊","DD":"ⅅ","dd":"ⅆ","DDotrahd":"⤑","ddotseq":"⩷","deg":"°","Del":"∇","Delta":"Δ","delta":"δ","demptyv":"⦱","dfisht":"⥿","Dfr":"𝔇","dfr":"𝔡","dHar":"⥥","dharl":"⇃","dharr":"⇂","DiacriticalAcute":"´","DiacriticalDot":"˙","DiacriticalDoubleAcute":"˝","DiacriticalGrave":"`","DiacriticalTilde":"˜","diam":"⋄","diamond":"⋄","Diamond":"⋄","diamondsuit":"♦","diams":"♦","die":"¨","DifferentialD":"ⅆ","digamma":"ϝ","disin":"⋲","div":"÷","divide":"÷","divideontimes":"⋇","divonx":"⋇","DJcy":"Ђ","djcy":"ђ","dlcorn":"⌞","dlcrop":"⌍","dollar":"$","Dopf":"𝔻","dopf":"𝕕","Dot":"¨","dot":"˙","DotDot":"⃜","doteq":"≐","doteqdot":"≑","DotEqual":"≐","dotminus":"∸","dotplus":"∔","dotsquare":"⊡","doublebarwedge":"⌆","DoubleContourIntegral":"∯","DoubleDot":"¨","DoubleDownArrow":"⇓","DoubleLeftArrow":"⇐","DoubleLeftRightArrow":"⇔","DoubleLeftTee":"⫤","DoubleLongLeftArrow":"⟸","DoubleLongLeftRightArrow":"⟺","DoubleLongRightArrow":"⟹","DoubleRightArrow":"⇒","DoubleRightTee":"⊨","DoubleUpArrow":"⇑","DoubleUpDownArrow":"⇕","DoubleVerticalBar":"∥","DownArrowBar":"⤓","downarrow":"↓","DownArrow":"↓","Downarrow":"⇓","DownArrowUpArrow":"⇵","DownBreve":"̑","downdownarrows":"⇊","downharpoonleft":"⇃","downharpoonright":"⇂","DownLeftRightVector":"⥐","DownLeftTeeVector":"⥞","DownLeftVectorBar":"⥖","DownLeftVector":"↽","DownRightTeeVector":"⥟","DownRightVectorBar":"⥗","DownRightVector":"⇁","DownTeeArrow":"↧","DownTee":"⊤","drbkarow":"⤐","drcorn":"⌟","drcrop":"⌌","Dscr":"𝒟","dscr":"𝒹","DScy":"Ѕ","dscy":"ѕ","dsol":"⧶","Dstrok":"Đ","dstrok":"đ","dtdot":"⋱","dtri":"▿","dtrif":"▾","duarr":"⇵","duhar":"⥯","dwangle":"⦦","DZcy":"Џ","dzcy":"џ","dzigrarr":"⟿","Eacute":"É","eacute":"é","easter":"⩮","Ecaron":"Ě","ecaron":"ě","Ecirc":"Ê","ecirc":"ê","ecir":"≖","ecolon":"≕","Ecy":"Э","ecy":"э","eDDot":"⩷","Edot":"Ė","edot":"ė","eDot":"≑","ee":"ⅇ","efDot":"≒","Efr":"𝔈","efr":"𝔢","eg":"⪚","Egrave":"È","egrave":"è","egs":"⪖","egsdot":"⪘","el":"⪙","Element":"∈","elinters":"⏧","ell":"ℓ","els":"⪕","elsdot":"⪗","Emacr":"Ē","emacr":"ē","empty":"∅","emptyset":"∅","EmptySmallSquare":"◻","emptyv":"∅","EmptyVerySmallSquare":"▫","emsp13":" ","emsp14":" ","emsp":" ","ENG":"Ŋ","eng":"ŋ","ensp":" ","Eogon":"Ę","eogon":"ę","Eopf":"𝔼","eopf":"𝕖","epar":"⋕","eparsl":"⧣","eplus":"⩱","epsi":"ε","Epsilon":"Ε","epsilon":"ε","epsiv":"ϵ","eqcirc":"≖","eqcolon":"≕","eqsim":"≂","eqslantgtr":"⪖","eqslantless":"⪕","Equal":"⩵","equals":"=","EqualTilde":"≂","equest":"≟","Equilibrium":"⇌","equiv":"≡","equivDD":"⩸","eqvparsl":"⧥","erarr":"⥱","erDot":"≓","escr":"ℯ","Escr":"ℰ","esdot":"≐","Esim":"⩳","esim":"≂","Eta":"Η","eta":"η","ETH":"Ð","eth":"ð","Euml":"Ë","euml":"ë","euro":"€","excl":"!","exist":"∃","Exists":"∃","expectation":"ℰ","exponentiale":"ⅇ","ExponentialE":"ⅇ","fallingdotseq":"≒","Fcy":"Ф","fcy":"ф","female":"♀","ffilig":"ﬃ","fflig":"ﬀ","ffllig":"ﬄ","Ffr":"𝔉","ffr":"𝔣","filig":"ﬁ","FilledSmallSquare":"◼","FilledVerySmallSquare":"▪","fjlig":"fj","flat":"♭","fllig":"ﬂ","fltns":"▱","fnof":"ƒ","Fopf":"𝔽","fopf":"𝕗","forall":"∀","ForAll":"∀","fork":"⋔","forkv":"⫙","Fouriertrf":"ℱ","fpartint":"⨍","frac12":"½","frac13":"⅓","frac14":"¼","frac15":"⅕","frac16":"⅙","frac18":"⅛","frac23":"⅔","frac25":"⅖","frac34":"¾","frac35":"⅗","frac38":"⅜","frac45":"⅘","frac56":"⅚","frac58":"⅝","frac78":"⅞","frasl":"⁄","frown":"⌢","fscr":"𝒻","Fscr":"ℱ","gacute":"ǵ","Gamma":"Γ","gamma":"γ","Gammad":"Ϝ","gammad":"ϝ","gap":"⪆","Gbreve":"Ğ","gbreve":"ğ","Gcedil":"Ģ","Gcirc":"Ĝ","gcirc":"ĝ","Gcy":"Г","gcy":"г","Gdot":"Ġ","gdot":"ġ","ge":"≥","gE":"≧","gEl":"⪌","gel":"⋛","geq":"≥","geqq":"≧","geqslant":"⩾","gescc":"⪩","ges":"⩾","gesdot":"⪀","gesdoto":"⪂","gesdotol":"⪄","gesl":"⋛︀","gesles":"⪔","Gfr":"𝔊","gfr":"𝔤","gg":"≫","Gg":"⋙","ggg":"⋙","gimel":"ℷ","GJcy":"Ѓ","gjcy":"ѓ","gla":"⪥","gl":"≷","glE":"⪒","glj":"⪤","gnap":"⪊","gnapprox":"⪊","gne":"⪈","gnE":"≩","gneq":"⪈","gneqq":"≩","gnsim":"⋧","Gopf":"𝔾","gopf":"𝕘","grave":"`","GreaterEqual":"≥","GreaterEqualLess":"⋛","GreaterFullEqual":"≧","GreaterGreater":"⪢","GreaterLess":"≷","GreaterSlantEqual":"⩾","GreaterTilde":"≳","Gscr":"𝒢","gscr":"ℊ","gsim":"≳","gsime":"⪎","gsiml":"⪐","gtcc":"⪧","gtcir":"⩺","gt":">","GT":">","Gt":"≫","gtdot":"⋗","gtlPar":"⦕","gtquest":"⩼","gtrapprox":"⪆","gtrarr":"⥸","gtrdot":"⋗","gtreqless":"⋛","gtreqqless":"⪌","gtrless":"≷","gtrsim":"≳","gvertneqq":"≩︀","gvnE":"≩︀","Hacek":"ˇ","hairsp":" ","half":"½","hamilt":"ℋ","HARDcy":"Ъ","hardcy":"ъ","harrcir":"⥈","harr":"↔","hArr":"⇔","harrw":"↭","Hat":"^","hbar":"ℏ","Hcirc":"Ĥ","hcirc":"ĥ","hearts":"♥","heartsuit":"♥","hellip":"…","hercon":"⊹","hfr":"𝔥","Hfr":"ℌ","HilbertSpace":"ℋ","hksearow":"⤥","hkswarow":"⤦","hoarr":"⇿","homtht":"∻","hookleftarrow":"↩","hookrightarrow":"↪","hopf":"𝕙","Hopf":"ℍ","horbar":"―","HorizontalLine":"─","hscr":"𝒽","Hscr":"ℋ","hslash":"ℏ","Hstrok":"Ħ","hstrok":"ħ","HumpDownHump":"≎","HumpEqual":"≏","hybull":"⁃","hyphen":"‐","Iacute":"Í","iacute":"í","ic":"⁣","Icirc":"Î","icirc":"î","Icy":"И","icy":"и","Idot":"İ","IEcy":"Е","iecy":"е","iexcl":"¡","iff":"⇔","ifr":"𝔦","Ifr":"ℑ","Igrave":"Ì","igrave":"ì","ii":"ⅈ","iiiint":"⨌","iiint":"∭","iinfin":"⧜","iiota":"℩","IJlig":"Ĳ","ijlig":"ĳ","Imacr":"Ī","imacr":"ī","image":"ℑ","ImaginaryI":"ⅈ","imagline":"ℐ","imagpart":"ℑ","imath":"ı","Im":"ℑ","imof":"⊷","imped":"Ƶ","Implies":"⇒","incare":"℅","in":"∈","infin":"∞","infintie":"⧝","inodot":"ı","intcal":"⊺","int":"∫","Int":"∬","integers":"ℤ","Integral":"∫","intercal":"⊺","Intersection":"⋂","intlarhk":"⨗","intprod":"⨼","InvisibleComma":"⁣","InvisibleTimes":"⁢","IOcy":"Ё","iocy":"ё","Iogon":"Į","iogon":"į","Iopf":"𝕀","iopf":"𝕚","Iota":"Ι","iota":"ι","iprod":"⨼","iquest":"¿","iscr":"𝒾","Iscr":"ℐ","isin":"∈","isindot":"⋵","isinE":"⋹","isins":"⋴","isinsv":"⋳","isinv":"∈","it":"⁢","Itilde":"Ĩ","itilde":"ĩ","Iukcy":"І","iukcy":"і","Iuml":"Ï","iuml":"ï","Jcirc":"Ĵ","jcirc":"ĵ","Jcy":"Й","jcy":"й","Jfr":"𝔍","jfr":"𝔧","jmath":"ȷ","Jopf":"𝕁","jopf":"𝕛","Jscr":"𝒥","jscr":"𝒿","Jsercy":"Ј","jsercy":"ј","Jukcy":"Є","jukcy":"є","Kappa":"Κ","kappa":"κ","kappav":"ϰ","Kcedil":"Ķ","kcedil":"ķ","Kcy":"К","kcy":"к","Kfr":"𝔎","kfr":"𝔨","kgreen":"ĸ","KHcy":"Х","khcy":"х","KJcy":"Ќ","kjcy":"ќ","Kopf":"𝕂","kopf":"𝕜","Kscr":"𝒦","kscr":"𝓀","lAarr":"⇚","Lacute":"Ĺ","lacute":"ĺ","laemptyv":"⦴","lagran":"ℒ","Lambda":"Λ","lambda":"λ","lang":"⟨","Lang":"⟪","langd":"⦑","langle":"⟨","lap":"⪅","Laplacetrf":"ℒ","laquo":"«","larrb":"⇤","larrbfs":"⤟","larr":"←","Larr":"↞","lArr":"⇐","larrfs":"⤝","larrhk":"↩","larrlp":"↫","larrpl":"⤹","larrsim":"⥳","larrtl":"↢","latail":"⤙","lAtail":"⤛","lat":"⪫","late":"⪭","lates":"⪭︀","lbarr":"⤌","lBarr":"⤎","lbbrk":"❲","lbrace":"{","lbrack":"[","lbrke":"⦋","lbrksld":"⦏","lbrkslu":"⦍","Lcaron":"Ľ","lcaron":"ľ","Lcedil":"Ļ","lcedil":"ļ","lceil":"⌈","lcub":"{","Lcy":"Л","lcy":"л","ldca":"⤶","ldquo":"“","ldquor":"„","ldrdhar":"⥧","ldrushar":"⥋","ldsh":"↲","le":"≤","lE":"≦","LeftAngleBracket":"⟨","LeftArrowBar":"⇤","leftarrow":"←","LeftArrow":"←","Leftarrow":"⇐","LeftArrowRightArrow":"⇆","leftarrowtail":"↢","LeftCeiling":"⌈","LeftDoubleBracket":"⟦","LeftDownTeeVector":"⥡","LeftDownVectorBar":"⥙","LeftDownVector":"⇃","LeftFloor":"⌊","leftharpoondown":"↽","leftharpoonup":"↼","leftleftarrows":"⇇","leftrightarrow":"↔","LeftRightArrow":"↔","Leftrightarrow":"⇔","leftrightarrows":"⇆","leftrightharpoons":"⇋","leftrightsquigarrow":"↭","LeftRightVector":"⥎","LeftTeeArrow":"↤","LeftTee":"⊣","LeftTeeVector":"⥚","leftthreetimes":"⋋","LeftTriangleBar":"⧏","LeftTriangle":"⊲","LeftTriangleEqual":"⊴","LeftUpDownVector":"⥑","LeftUpTeeVector":"⥠","LeftUpVectorBar":"⥘","LeftUpVector":"↿","LeftVectorBar":"⥒","LeftVector":"↼","lEg":"⪋","leg":"⋚","leq":"≤","leqq":"≦","leqslant":"⩽","lescc":"⪨","les":"⩽","lesdot":"⩿","lesdoto":"⪁","lesdotor":"⪃","lesg":"⋚︀","lesges":"⪓","lessapprox":"⪅","lessdot":"⋖","lesseqgtr":"⋚","lesseqqgtr":"⪋","LessEqualGreater":"⋚","LessFullEqual":"≦","LessGreater":"≶","lessgtr":"≶","LessLess":"⪡","lesssim":"≲","LessSlantEqual":"⩽","LessTilde":"≲","lfisht":"⥼","lfloor":"⌊","Lfr":"𝔏","lfr":"𝔩","lg":"≶","lgE":"⪑","lHar":"⥢","lhard":"↽","lharu":"↼","lharul":"⥪","lhblk":"▄","LJcy":"Љ","ljcy":"љ","llarr":"⇇","ll":"≪","Ll":"⋘","llcorner":"⌞","Lleftarrow":"⇚","llhard":"⥫","lltri":"◺","Lmidot":"Ŀ","lmidot":"ŀ","lmoustache":"⎰","lmoust":"⎰","lnap":"⪉","lnapprox":"⪉","lne":"⪇","lnE":"≨","lneq":"⪇","lneqq":"≨","lnsim":"⋦","loang":"⟬","loarr":"⇽","lobrk":"⟦","longleftarrow":"⟵","LongLeftArrow":"⟵","Longleftarrow":"⟸","longleftrightarrow":"⟷","LongLeftRightArrow":"⟷","Longleftrightarrow":"⟺","longmapsto":"⟼","longrightarrow":"⟶","LongRightArrow":"⟶","Longrightarrow":"⟹","looparrowleft":"↫","looparrowright":"↬","lopar":"⦅","Lopf":"𝕃","lopf":"𝕝","loplus":"⨭","lotimes":"⨴","lowast":"∗","lowbar":"_","LowerLeftArrow":"↙","LowerRightArrow":"↘","loz":"◊","lozenge":"◊","lozf":"⧫","lpar":"(","lparlt":"⦓","lrarr":"⇆","lrcorner":"⌟","lrhar":"⇋","lrhard":"⥭","lrm":"‎","lrtri":"⊿","lsaquo":"‹","lscr":"𝓁","Lscr":"ℒ","lsh":"↰","Lsh":"↰","lsim":"≲","lsime":"⪍","lsimg":"⪏","lsqb":"[","lsquo":"‘","lsquor":"‚","Lstrok":"Ł","lstrok":"ł","ltcc":"⪦","ltcir":"⩹","lt":"<","LT":"<","Lt":"≪","ltdot":"⋖","lthree":"⋋","ltimes":"⋉","ltlarr":"⥶","ltquest":"⩻","ltri":"◃","ltrie":"⊴","ltrif":"◂","ltrPar":"⦖","lurdshar":"⥊","luruhar":"⥦","lvertneqq":"≨︀","lvnE":"≨︀","macr":"¯","male":"♂","malt":"✠","maltese":"✠","Map":"⤅","map":"↦","mapsto":"↦","mapstodown":"↧","mapstoleft":"↤","mapstoup":"↥","marker":"▮","mcomma":"⨩","Mcy":"М","mcy":"м","mdash":"—","mDDot":"∺","measuredangle":"∡","MediumSpace":" ","Mellintrf":"ℳ","Mfr":"𝔐","mfr":"𝔪","mho":"℧","micro":"µ","midast":"*","midcir":"⫰","mid":"∣","middot":"·","minusb":"⊟","minus":"−","minusd":"∸","minusdu":"⨪","MinusPlus":"∓","mlcp":"⫛","mldr":"…","mnplus":"∓","models":"⊧","Mopf":"𝕄","mopf":"𝕞","mp":"∓","mscr":"𝓂","Mscr":"ℳ","mstpos":"∾","Mu":"Μ","mu":"μ","multimap":"⊸","mumap":"⊸","nabla":"∇","Nacute":"Ń","nacute":"ń","nang":"∠⃒","nap":"≉","napE":"⩰̸","napid":"≋̸","napos":"ŉ","napprox":"≉","natural":"♮","naturals":"ℕ","natur":"♮","nbsp":" ","nbump":"≎̸","nbumpe":"≏̸","ncap":"⩃","Ncaron":"Ň","ncaron":"ň","Ncedil":"Ņ","ncedil":"ņ","ncong":"≇","ncongdot":"⩭̸","ncup":"⩂","Ncy":"Н","ncy":"н","ndash":"–","nearhk":"⤤","nearr":"↗","neArr":"⇗","nearrow":"↗","ne":"≠","nedot":"≐̸","NegativeMediumSpace":"​","NegativeThickSpace":"​","NegativeThinSpace":"​","NegativeVeryThinSpace":"​","nequiv":"≢","nesear":"⤨","nesim":"≂̸","NestedGreaterGreater":"≫","NestedLessLess":"≪","NewLine":"\\n","nexist":"∄","nexists":"∄","Nfr":"𝔑","nfr":"𝔫","ngE":"≧̸","nge":"≱","ngeq":"≱","ngeqq":"≧̸","ngeqslant":"⩾̸","nges":"⩾̸","nGg":"⋙̸","ngsim":"≵","nGt":"≫⃒","ngt":"≯","ngtr":"≯","nGtv":"≫̸","nharr":"↮","nhArr":"⇎","nhpar":"⫲","ni":"∋","nis":"⋼","nisd":"⋺","niv":"∋","NJcy":"Њ","njcy":"њ","nlarr":"↚","nlArr":"⇍","nldr":"‥","nlE":"≦̸","nle":"≰","nleftarrow":"↚","nLeftarrow":"⇍","nleftrightarrow":"↮","nLeftrightarrow":"⇎","nleq":"≰","nleqq":"≦̸","nleqslant":"⩽̸","nles":"⩽̸","nless":"≮","nLl":"⋘̸","nlsim":"≴","nLt":"≪⃒","nlt":"≮","nltri":"⋪","nltrie":"⋬","nLtv":"≪̸","nmid":"∤","NoBreak":"⁠","NonBreakingSpace":" ","nopf":"𝕟","Nopf":"ℕ","Not":"⫬","not":"¬","NotCongruent":"≢","NotCupCap":"≭","NotDoubleVerticalBar":"∦","NotElement":"∉","NotEqual":"≠","NotEqualTilde":"≂̸","NotExists":"∄","NotGreater":"≯","NotGreaterEqual":"≱","NotGreaterFullEqual":"≧̸","NotGreaterGreater":"≫̸","NotGreaterLess":"≹","NotGreaterSlantEqual":"⩾̸","NotGreaterTilde":"≵","NotHumpDownHump":"≎̸","NotHumpEqual":"≏̸","notin":"∉","notindot":"⋵̸","notinE":"⋹̸","notinva":"∉","notinvb":"⋷","notinvc":"⋶","NotLeftTriangleBar":"⧏̸","NotLeftTriangle":"⋪","NotLeftTriangleEqual":"⋬","NotLess":"≮","NotLessEqual":"≰","NotLessGreater":"≸","NotLessLess":"≪̸","NotLessSlantEqual":"⩽̸","NotLessTilde":"≴","NotNestedGreaterGreater":"⪢̸","NotNestedLessLess":"⪡̸","notni":"∌","notniva":"∌","notnivb":"⋾","notnivc":"⋽","NotPrecedes":"⊀","NotPrecedesEqual":"⪯̸","NotPrecedesSlantEqual":"⋠","NotReverseElement":"∌","NotRightTriangleBar":"⧐̸","NotRightTriangle":"⋫","NotRightTriangleEqual":"⋭","NotSquareSubset":"⊏̸","NotSquareSubsetEqual":"⋢","NotSquareSuperset":"⊐̸","NotSquareSupersetEqual":"⋣","NotSubset":"⊂⃒","NotSubsetEqual":"⊈","NotSucceeds":"⊁","NotSucceedsEqual":"⪰̸","NotSucceedsSlantEqual":"⋡","NotSucceedsTilde":"≿̸","NotSuperset":"⊃⃒","NotSupersetEqual":"⊉","NotTilde":"≁","NotTildeEqual":"≄","NotTildeFullEqual":"≇","NotTildeTilde":"≉","NotVerticalBar":"∤","nparallel":"∦","npar":"∦","nparsl":"⫽⃥","npart":"∂̸","npolint":"⨔","npr":"⊀","nprcue":"⋠","nprec":"⊀","npreceq":"⪯̸","npre":"⪯̸","nrarrc":"⤳̸","nrarr":"↛","nrArr":"⇏","nrarrw":"↝̸","nrightarrow":"↛","nRightarrow":"⇏","nrtri":"⋫","nrtrie":"⋭","nsc":"⊁","nsccue":"⋡","nsce":"⪰̸","Nscr":"𝒩","nscr":"𝓃","nshortmid":"∤","nshortparallel":"∦","nsim":"≁","nsime":"≄","nsimeq":"≄","nsmid":"∤","nspar":"∦","nsqsube":"⋢","nsqsupe":"⋣","nsub":"⊄","nsubE":"⫅̸","nsube":"⊈","nsubset":"⊂⃒","nsubseteq":"⊈","nsubseteqq":"⫅̸","nsucc":"⊁","nsucceq":"⪰̸","nsup":"⊅","nsupE":"⫆̸","nsupe":"⊉","nsupset":"⊃⃒","nsupseteq":"⊉","nsupseteqq":"⫆̸","ntgl":"≹","Ntilde":"Ñ","ntilde":"ñ","ntlg":"≸","ntriangleleft":"⋪","ntrianglelefteq":"⋬","ntriangleright":"⋫","ntrianglerighteq":"⋭","Nu":"Ν","nu":"ν","num":"#","numero":"№","numsp":" ","nvap":"≍⃒","nvdash":"⊬","nvDash":"⊭","nVdash":"⊮","nVDash":"⊯","nvge":"≥⃒","nvgt":">⃒","nvHarr":"⤄","nvinfin":"⧞","nvlArr":"⤂","nvle":"≤⃒","nvlt":"<⃒","nvltrie":"⊴⃒","nvrArr":"⤃","nvrtrie":"⊵⃒","nvsim":"∼⃒","nwarhk":"⤣","nwarr":"↖","nwArr":"⇖","nwarrow":"↖","nwnear":"⤧","Oacute":"Ó","oacute":"ó","oast":"⊛","Ocirc":"Ô","ocirc":"ô","ocir":"⊚","Ocy":"О","ocy":"о","odash":"⊝","Odblac":"Ő","odblac":"ő","odiv":"⨸","odot":"⊙","odsold":"⦼","OElig":"Œ","oelig":"œ","ofcir":"⦿","Ofr":"𝔒","ofr":"𝔬","ogon":"˛","Ograve":"Ò","ograve":"ò","ogt":"⧁","ohbar":"⦵","ohm":"Ω","oint":"∮","olarr":"↺","olcir":"⦾","olcross":"⦻","oline":"‾","olt":"⧀","Omacr":"Ō","omacr":"ō","Omega":"Ω","omega":"ω","Omicron":"Ο","omicron":"ο","omid":"⦶","ominus":"⊖","Oopf":"𝕆","oopf":"𝕠","opar":"⦷","OpenCurlyDoubleQuote":"“","OpenCurlyQuote":"‘","operp":"⦹","oplus":"⊕","orarr":"↻","Or":"⩔","or":"∨","ord":"⩝","order":"ℴ","orderof":"ℴ","ordf":"ª","ordm":"º","origof":"⊶","oror":"⩖","orslope":"⩗","orv":"⩛","oS":"Ⓢ","Oscr":"𝒪","oscr":"ℴ","Oslash":"Ø","oslash":"ø","osol":"⊘","Otilde":"Õ","otilde":"õ","otimesas":"⨶","Otimes":"⨷","otimes":"⊗","Ouml":"Ö","ouml":"ö","ovbar":"⌽","OverBar":"‾","OverBrace":"⏞","OverBracket":"⎴","OverParenthesis":"⏜","para":"¶","parallel":"∥","par":"∥","parsim":"⫳","parsl":"⫽","part":"∂","PartialD":"∂","Pcy":"П","pcy":"п","percnt":"%","period":".","permil":"‰","perp":"⊥","pertenk":"‱","Pfr":"𝔓","pfr":"𝔭","Phi":"Φ","phi":"φ","phiv":"ϕ","phmmat":"ℳ","phone":"☎","Pi":"Π","pi":"π","pitchfork":"⋔","piv":"ϖ","planck":"ℏ","planckh":"ℎ","plankv":"ℏ","plusacir":"⨣","plusb":"⊞","pluscir":"⨢","plus":"+","plusdo":"∔","plusdu":"⨥","pluse":"⩲","PlusMinus":"±","plusmn":"±","plussim":"⨦","plustwo":"⨧","pm":"±","Poincareplane":"ℌ","pointint":"⨕","popf":"𝕡","Popf":"ℙ","pound":"£","prap":"⪷","Pr":"⪻","pr":"≺","prcue":"≼","precapprox":"⪷","prec":"≺","preccurlyeq":"≼","Precedes":"≺","PrecedesEqual":"⪯","PrecedesSlantEqual":"≼","PrecedesTilde":"≾","preceq":"⪯","precnapprox":"⪹","precneqq":"⪵","precnsim":"⋨","pre":"⪯","prE":"⪳","precsim":"≾","prime":"′","Prime":"″","primes":"ℙ","prnap":"⪹","prnE":"⪵","prnsim":"⋨","prod":"∏","Product":"∏","profalar":"⌮","profline":"⌒","profsurf":"⌓","prop":"∝","Proportional":"∝","Proportion":"∷","propto":"∝","prsim":"≾","prurel":"⊰","Pscr":"𝒫","pscr":"𝓅","Psi":"Ψ","psi":"ψ","puncsp":" ","Qfr":"𝔔","qfr":"𝔮","qint":"⨌","qopf":"𝕢","Qopf":"ℚ","qprime":"⁗","Qscr":"𝒬","qscr":"𝓆","quaternions":"ℍ","quatint":"⨖","quest":"?","questeq":"≟","quot":"\\"","QUOT":"\\"","rAarr":"⇛","race":"∽̱","Racute":"Ŕ","racute":"ŕ","radic":"√","raemptyv":"⦳","rang":"⟩","Rang":"⟫","rangd":"⦒","range":"⦥","rangle":"⟩","raquo":"»","rarrap":"⥵","rarrb":"⇥","rarrbfs":"⤠","rarrc":"⤳","rarr":"→","Rarr":"↠","rArr":"⇒","rarrfs":"⤞","rarrhk":"↪","rarrlp":"↬","rarrpl":"⥅","rarrsim":"⥴","Rarrtl":"⤖","rarrtl":"↣","rarrw":"↝","ratail":"⤚","rAtail":"⤜","ratio":"∶","rationals":"ℚ","rbarr":"⤍","rBarr":"⤏","RBarr":"⤐","rbbrk":"❳","rbrace":"}","rbrack":"]","rbrke":"⦌","rbrksld":"⦎","rbrkslu":"⦐","Rcaron":"Ř","rcaron":"ř","Rcedil":"Ŗ","rcedil":"ŗ","rceil":"⌉","rcub":"}","Rcy":"Р","rcy":"р","rdca":"⤷","rdldhar":"⥩","rdquo":"”","rdquor":"”","rdsh":"↳","real":"ℜ","realine":"ℛ","realpart":"ℜ","reals":"ℝ","Re":"ℜ","rect":"▭","reg":"®","REG":"®","ReverseElement":"∋","ReverseEquilibrium":"⇋","ReverseUpEquilibrium":"⥯","rfisht":"⥽","rfloor":"⌋","rfr":"𝔯","Rfr":"ℜ","rHar":"⥤","rhard":"⇁","rharu":"⇀","rharul":"⥬","Rho":"Ρ","rho":"ρ","rhov":"ϱ","RightAngleBracket":"⟩","RightArrowBar":"⇥","rightarrow":"→","RightArrow":"→","Rightarrow":"⇒","RightArrowLeftArrow":"⇄","rightarrowtail":"↣","RightCeiling":"⌉","RightDoubleBracket":"⟧","RightDownTeeVector":"⥝","RightDownVectorBar":"⥕","RightDownVector":"⇂","RightFloor":"⌋","rightharpoondown":"⇁","rightharpoonup":"⇀","rightleftarrows":"⇄","rightleftharpoons":"⇌","rightrightarrows":"⇉","rightsquigarrow":"↝","RightTeeArrow":"↦","RightTee":"⊢","RightTeeVector":"⥛","rightthreetimes":"⋌","RightTriangleBar":"⧐","RightTriangle":"⊳","RightTriangleEqual":"⊵","RightUpDownVector":"⥏","RightUpTeeVector":"⥜","RightUpVectorBar":"⥔","RightUpVector":"↾","RightVectorBar":"⥓","RightVector":"⇀","ring":"˚","risingdotseq":"≓","rlarr":"⇄","rlhar":"⇌","rlm":"‏","rmoustache":"⎱","rmoust":"⎱","rnmid":"⫮","roang":"⟭","roarr":"⇾","robrk":"⟧","ropar":"⦆","ropf":"𝕣","Ropf":"ℝ","roplus":"⨮","rotimes":"⨵","RoundImplies":"⥰","rpar":")","rpargt":"⦔","rppolint":"⨒","rrarr":"⇉","Rrightarrow":"⇛","rsaquo":"›","rscr":"𝓇","Rscr":"ℛ","rsh":"↱","Rsh":"↱","rsqb":"]","rsquo":"’","rsquor":"’","rthree":"⋌","rtimes":"⋊","rtri":"▹","rtrie":"⊵","rtrif":"▸","rtriltri":"⧎","RuleDelayed":"⧴","ruluhar":"⥨","rx":"℞","Sacute":"Ś","sacute":"ś","sbquo":"‚","scap":"⪸","Scaron":"Š","scaron":"š","Sc":"⪼","sc":"≻","sccue":"≽","sce":"⪰","scE":"⪴","Scedil":"Ş","scedil":"ş","Scirc":"Ŝ","scirc":"ŝ","scnap":"⪺","scnE":"⪶","scnsim":"⋩","scpolint":"⨓","scsim":"≿","Scy":"С","scy":"с","sdotb":"⊡","sdot":"⋅","sdote":"⩦","searhk":"⤥","searr":"↘","seArr":"⇘","searrow":"↘","sect":"§","semi":";","seswar":"⤩","setminus":"∖","setmn":"∖","sext":"✶","Sfr":"𝔖","sfr":"𝔰","sfrown":"⌢","sharp":"♯","SHCHcy":"Щ","shchcy":"щ","SHcy":"Ш","shcy":"ш","ShortDownArrow":"↓","ShortLeftArrow":"←","shortmid":"∣","shortparallel":"∥","ShortRightArrow":"→","ShortUpArrow":"↑","shy":"­","Sigma":"Σ","sigma":"σ","sigmaf":"ς","sigmav":"ς","sim":"∼","simdot":"⩪","sime":"≃","simeq":"≃","simg":"⪞","simgE":"⪠","siml":"⪝","simlE":"⪟","simne":"≆","simplus":"⨤","simrarr":"⥲","slarr":"←","SmallCircle":"∘","smallsetminus":"∖","smashp":"⨳","smeparsl":"⧤","smid":"∣","smile":"⌣","smt":"⪪","smte":"⪬","smtes":"⪬︀","SOFTcy":"Ь","softcy":"ь","solbar":"⌿","solb":"⧄","sol":"/","Sopf":"𝕊","sopf":"𝕤","spades":"♠","spadesuit":"♠","spar":"∥","sqcap":"⊓","sqcaps":"⊓︀","sqcup":"⊔","sqcups":"⊔︀","Sqrt":"√","sqsub":"⊏","sqsube":"⊑","sqsubset":"⊏","sqsubseteq":"⊑","sqsup":"⊐","sqsupe":"⊒","sqsupset":"⊐","sqsupseteq":"⊒","square":"□","Square":"□","SquareIntersection":"⊓","SquareSubset":"⊏","SquareSubsetEqual":"⊑","SquareSuperset":"⊐","SquareSupersetEqual":"⊒","SquareUnion":"⊔","squarf":"▪","squ":"□","squf":"▪","srarr":"→","Sscr":"𝒮","sscr":"𝓈","ssetmn":"∖","ssmile":"⌣","sstarf":"⋆","Star":"⋆","star":"☆","starf":"★","straightepsilon":"ϵ","straightphi":"ϕ","strns":"¯","sub":"⊂","Sub":"⋐","subdot":"⪽","subE":"⫅","sube":"⊆","subedot":"⫃","submult":"⫁","subnE":"⫋","subne":"⊊","subplus":"⪿","subrarr":"⥹","subset":"⊂","Subset":"⋐","subseteq":"⊆","subseteqq":"⫅","SubsetEqual":"⊆","subsetneq":"⊊","subsetneqq":"⫋","subsim":"⫇","subsub":"⫕","subsup":"⫓","succapprox":"⪸","succ":"≻","succcurlyeq":"≽","Succeeds":"≻","SucceedsEqual":"⪰","SucceedsSlantEqual":"≽","SucceedsTilde":"≿","succeq":"⪰","succnapprox":"⪺","succneqq":"⪶","succnsim":"⋩","succsim":"≿","SuchThat":"∋","sum":"∑","Sum":"∑","sung":"♪","sup1":"¹","sup2":"²","sup3":"³","sup":"⊃","Sup":"⋑","supdot":"⪾","supdsub":"⫘","supE":"⫆","supe":"⊇","supedot":"⫄","Superset":"⊃","SupersetEqual":"⊇","suphsol":"⟉","suphsub":"⫗","suplarr":"⥻","supmult":"⫂","supnE":"⫌","supne":"⊋","supplus":"⫀","supset":"⊃","Supset":"⋑","supseteq":"⊇","supseteqq":"⫆","supsetneq":"⊋","supsetneqq":"⫌","supsim":"⫈","supsub":"⫔","supsup":"⫖","swarhk":"⤦","swarr":"↙","swArr":"⇙","swarrow":"↙","swnwar":"⤪","szlig":"ß","Tab":"\\t","target":"⌖","Tau":"Τ","tau":"τ","tbrk":"⎴","Tcaron":"Ť","tcaron":"ť","Tcedil":"Ţ","tcedil":"ţ","Tcy":"Т","tcy":"т","tdot":"⃛","telrec":"⌕","Tfr":"𝔗","tfr":"𝔱","there4":"∴","therefore":"∴","Therefore":"∴","Theta":"Θ","theta":"θ","thetasym":"ϑ","thetav":"ϑ","thickapprox":"≈","thicksim":"∼","ThickSpace":"  ","ThinSpace":" ","thinsp":" ","thkap":"≈","thksim":"∼","THORN":"Þ","thorn":"þ","tilde":"˜","Tilde":"∼","TildeEqual":"≃","TildeFullEqual":"≅","TildeTilde":"≈","timesbar":"⨱","timesb":"⊠","times":"×","timesd":"⨰","tint":"∭","toea":"⤨","topbot":"⌶","topcir":"⫱","top":"⊤","Topf":"𝕋","topf":"𝕥","topfork":"⫚","tosa":"⤩","tprime":"‴","trade":"™","TRADE":"™","triangle":"▵","triangledown":"▿","triangleleft":"◃","trianglelefteq":"⊴","triangleq":"≜","triangleright":"▹","trianglerighteq":"⊵","tridot":"◬","trie":"≜","triminus":"⨺","TripleDot":"⃛","triplus":"⨹","trisb":"⧍","tritime":"⨻","trpezium":"⏢","Tscr":"𝒯","tscr":"𝓉","TScy":"Ц","tscy":"ц","TSHcy":"Ћ","tshcy":"ћ","Tstrok":"Ŧ","tstrok":"ŧ","twixt":"≬","twoheadleftarrow":"↞","twoheadrightarrow":"↠","Uacute":"Ú","uacute":"ú","uarr":"↑","Uarr":"↟","uArr":"⇑","Uarrocir":"⥉","Ubrcy":"Ў","ubrcy":"ў","Ubreve":"Ŭ","ubreve":"ŭ","Ucirc":"Û","ucirc":"û","Ucy":"У","ucy":"у","udarr":"⇅","Udblac":"Ű","udblac":"ű","udhar":"⥮","ufisht":"⥾","Ufr":"𝔘","ufr":"𝔲","Ugrave":"Ù","ugrave":"ù","uHar":"⥣","uharl":"↿","uharr":"↾","uhblk":"▀","ulcorn":"⌜","ulcorner":"⌜","ulcrop":"⌏","ultri":"◸","Umacr":"Ū","umacr":"ū","uml":"¨","UnderBar":"_","UnderBrace":"⏟","UnderBracket":"⎵","UnderParenthesis":"⏝","Union":"⋃","UnionPlus":"⊎","Uogon":"Ų","uogon":"ų","Uopf":"𝕌","uopf":"𝕦","UpArrowBar":"⤒","uparrow":"↑","UpArrow":"↑","Uparrow":"⇑","UpArrowDownArrow":"⇅","updownarrow":"↕","UpDownArrow":"↕","Updownarrow":"⇕","UpEquilibrium":"⥮","upharpoonleft":"↿","upharpoonright":"↾","uplus":"⊎","UpperLeftArrow":"↖","UpperRightArrow":"↗","upsi":"υ","Upsi":"ϒ","upsih":"ϒ","Upsilon":"Υ","upsilon":"υ","UpTeeArrow":"↥","UpTee":"⊥","upuparrows":"⇈","urcorn":"⌝","urcorner":"⌝","urcrop":"⌎","Uring":"Ů","uring":"ů","urtri":"◹","Uscr":"𝒰","uscr":"𝓊","utdot":"⋰","Utilde":"Ũ","utilde":"ũ","utri":"▵","utrif":"▴","uuarr":"⇈","Uuml":"Ü","uuml":"ü","uwangle":"⦧","vangrt":"⦜","varepsilon":"ϵ","varkappa":"ϰ","varnothing":"∅","varphi":"ϕ","varpi":"ϖ","varpropto":"∝","varr":"↕","vArr":"⇕","varrho":"ϱ","varsigma":"ς","varsubsetneq":"⊊︀","varsubsetneqq":"⫋︀","varsupsetneq":"⊋︀","varsupsetneqq":"⫌︀","vartheta":"ϑ","vartriangleleft":"⊲","vartriangleright":"⊳","vBar":"⫨","Vbar":"⫫","vBarv":"⫩","Vcy":"В","vcy":"в","vdash":"⊢","vDash":"⊨","Vdash":"⊩","VDash":"⊫","Vdashl":"⫦","veebar":"⊻","vee":"∨","Vee":"⋁","veeeq":"≚","vellip":"⋮","verbar":"|","Verbar":"‖","vert":"|","Vert":"‖","VerticalBar":"∣","VerticalLine":"|","VerticalSeparator":"❘","VerticalTilde":"≀","VeryThinSpace":" ","Vfr":"𝔙","vfr":"𝔳","vltri":"⊲","vnsub":"⊂⃒","vnsup":"⊃⃒","Vopf":"𝕍","vopf":"𝕧","vprop":"∝","vrtri":"⊳","Vscr":"𝒱","vscr":"𝓋","vsubnE":"⫋︀","vsubne":"⊊︀","vsupnE":"⫌︀","vsupne":"⊋︀","Vvdash":"⊪","vzigzag":"⦚","Wcirc":"Ŵ","wcirc":"ŵ","wedbar":"⩟","wedge":"∧","Wedge":"⋀","wedgeq":"≙","weierp":"℘","Wfr":"𝔚","wfr":"𝔴","Wopf":"𝕎","wopf":"𝕨","wp":"℘","wr":"≀","wreath":"≀","Wscr":"𝒲","wscr":"𝓌","xcap":"⋂","xcirc":"◯","xcup":"⋃","xdtri":"▽","Xfr":"𝔛","xfr":"𝔵","xharr":"⟷","xhArr":"⟺","Xi":"Ξ","xi":"ξ","xlarr":"⟵","xlArr":"⟸","xmap":"⟼","xnis":"⋻","xodot":"⨀","Xopf":"𝕏","xopf":"𝕩","xoplus":"⨁","xotime":"⨂","xrarr":"⟶","xrArr":"⟹","Xscr":"𝒳","xscr":"𝓍","xsqcup":"⨆","xuplus":"⨄","xutri":"△","xvee":"⋁","xwedge":"⋀","Yacute":"Ý","yacute":"ý","YAcy":"Я","yacy":"я","Ycirc":"Ŷ","ycirc":"ŷ","Ycy":"Ы","ycy":"ы","yen":"¥","Yfr":"𝔜","yfr":"𝔶","YIcy":"Ї","yicy":"ї","Yopf":"𝕐","yopf":"𝕪","Yscr":"𝒴","yscr":"𝓎","YUcy":"Ю","yucy":"ю","yuml":"ÿ","Yuml":"Ÿ","Zacute":"Ź","zacute":"ź","Zcaron":"Ž","zcaron":"ž","Zcy":"З","zcy":"з","Zdot":"Ż","zdot":"ż","zeetrf":"ℨ","ZeroWidthSpace":"​","Zeta":"Ζ","zeta":"ζ","zfr":"𝔷","Zfr":"ℨ","ZHcy":"Ж","zhcy":"ж","zigrarr":"⇝","zopf":"𝕫","Zopf":"ℤ","Zscr":"𝒵","zscr":"𝓏","zwj":"‍","zwnj":"‌"}')}}]);